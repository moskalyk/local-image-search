var a8=Object.defineProperty;var bO=n=>{throw TypeError(n)};var l8=(n,e,t)=>e in n?a8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Se=(n,e,t)=>l8(n,typeof e!="symbol"?e+"":e,t),ek=(n,e,t)=>e.has(n)||bO("Cannot "+t);var Y=(n,e,t)=>(ek(n,e,"read from private field"),t?t.call(n):e.get(n)),_e=(n,e,t)=>e.has(n)?bO("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),se=(n,e,t,r)=>(ek(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),rt=(n,e,t)=>(ek(n,e,"access private method"),t);var Gg=(n,e,t,r)=>({set _(s){se(n,e,s,t)},get _(){return Y(n,e,r)}});function B3(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var jw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function u8(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var tk={exports:{}},Hg={},nk={exports:{}},Gt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vO;function c8(){if(vO)return Gt;vO=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.iterator;function p(R){return R===null||typeof R!="object"?null:(R=h&&R[h]||R["@@iterator"],typeof R=="function"?R:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,w={};function x(R,H,K){this.props=R,this.context=H,this.refs=w,this.updater=K||g}x.prototype.isReactComponent={},x.prototype.setState=function(R,H){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,H,"setState")},x.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function b(){}b.prototype=x.prototype;function C(R,H,K){this.props=R,this.context=H,this.refs=w,this.updater=K||g}var $=C.prototype=new b;$.constructor=C,m($,x.prototype),$.isPureReactComponent=!0;var k=Array.isArray,N=Object.prototype.hasOwnProperty,_={current:null},U={key:!0,ref:!0,__self:!0,__source:!0};function O(R,H,K){var Q,J={},ie=null,ce=null;if(H!=null)for(Q in H.ref!==void 0&&(ce=H.ref),H.key!==void 0&&(ie=""+H.key),H)N.call(H,Q)&&!U.hasOwnProperty(Q)&&(J[Q]=H[Q]);var ge=arguments.length-2;if(ge===1)J.children=K;else if(1<ge){for(var be=Array(ge),Ae=0;Ae<ge;Ae++)be[Ae]=arguments[Ae+2];J.children=be}if(R&&R.defaultProps)for(Q in ge=R.defaultProps,ge)J[Q]===void 0&&(J[Q]=ge[Q]);return{$$typeof:n,type:R,key:ie,ref:ce,props:J,_owner:_.current}}function L(R,H){return{$$typeof:n,type:R.type,key:H,ref:R.ref,props:R.props,_owner:R._owner}}function T(R){return typeof R=="object"&&R!==null&&R.$$typeof===n}function I(R){var H={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(K){return H[K]})}var v=/\/+/g;function A(R,H){return typeof R=="object"&&R!==null&&R.key!=null?I(""+R.key):H.toString(36)}function M(R,H,K,Q,J){var ie=typeof R;(ie==="undefined"||ie==="boolean")&&(R=null);var ce=!1;if(R===null)ce=!0;else switch(ie){case"string":case"number":ce=!0;break;case"object":switch(R.$$typeof){case n:case e:ce=!0}}if(ce)return ce=R,J=J(ce),R=Q===""?"."+A(ce,0):Q,k(J)?(K="",R!=null&&(K=R.replace(v,"$&/")+"/"),M(J,H,K,"",function(Ae){return Ae})):J!=null&&(T(J)&&(J=L(J,K+(!J.key||ce&&ce.key===J.key?"":(""+J.key).replace(v,"$&/")+"/")+R)),H.push(J)),1;if(ce=0,Q=Q===""?".":Q+":",k(R))for(var ge=0;ge<R.length;ge++){ie=R[ge];var be=Q+A(ie,ge);ce+=M(ie,H,K,be,J)}else if(be=p(R),typeof be=="function")for(R=be.call(R),ge=0;!(ie=R.next()).done;)ie=ie.value,be=Q+A(ie,ge++),ce+=M(ie,H,K,be,J);else if(ie==="object")throw H=String(R),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return ce}function D(R,H,K){if(R==null)return R;var Q=[],J=0;return M(R,Q,"","",function(ie){return H.call(K,ie,J++)}),Q}function B(R){if(R._status===-1){var H=R._result;H=H(),H.then(function(K){(R._status===0||R._status===-1)&&(R._status=1,R._result=K)},function(K){(R._status===0||R._status===-1)&&(R._status=2,R._result=K)}),R._status===-1&&(R._status=0,R._result=H)}if(R._status===1)return R._result.default;throw R._result}var j={current:null},W={transition:null},P={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:W,ReactCurrentOwner:_};function E(){throw Error("act(...) is not supported in production builds of React.")}return Gt.Children={map:D,forEach:function(R,H,K){D(R,function(){H.apply(this,arguments)},K)},count:function(R){var H=0;return D(R,function(){H++}),H},toArray:function(R){return D(R,function(H){return H})||[]},only:function(R){if(!T(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},Gt.Component=x,Gt.Fragment=t,Gt.Profiler=s,Gt.PureComponent=C,Gt.StrictMode=r,Gt.Suspense=l,Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,Gt.act=E,Gt.cloneElement=function(R,H,K){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var Q=m({},R.props),J=R.key,ie=R.ref,ce=R._owner;if(H!=null){if(H.ref!==void 0&&(ie=H.ref,ce=_.current),H.key!==void 0&&(J=""+H.key),R.type&&R.type.defaultProps)var ge=R.type.defaultProps;for(be in H)N.call(H,be)&&!U.hasOwnProperty(be)&&(Q[be]=H[be]===void 0&&ge!==void 0?ge[be]:H[be])}var be=arguments.length-2;if(be===1)Q.children=K;else if(1<be){ge=Array(be);for(var Ae=0;Ae<be;Ae++)ge[Ae]=arguments[Ae+2];Q.children=ge}return{$$typeof:n,type:R.type,key:J,ref:ie,props:Q,_owner:ce}},Gt.createContext=function(R){return R={$$typeof:o,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:i,_context:R},R.Consumer=R},Gt.createElement=O,Gt.createFactory=function(R){var H=O.bind(null,R);return H.type=R,H},Gt.createRef=function(){return{current:null}},Gt.forwardRef=function(R){return{$$typeof:a,render:R}},Gt.isValidElement=T,Gt.lazy=function(R){return{$$typeof:f,_payload:{_status:-1,_result:R},_init:B}},Gt.memo=function(R,H){return{$$typeof:u,type:R,compare:H===void 0?null:H}},Gt.startTransition=function(R){var H=W.transition;W.transition={};try{R()}finally{W.transition=H}},Gt.unstable_act=E,Gt.useCallback=function(R,H){return j.current.useCallback(R,H)},Gt.useContext=function(R){return j.current.useContext(R)},Gt.useDebugValue=function(){},Gt.useDeferredValue=function(R){return j.current.useDeferredValue(R)},Gt.useEffect=function(R,H){return j.current.useEffect(R,H)},Gt.useId=function(){return j.current.useId()},Gt.useImperativeHandle=function(R,H,K){return j.current.useImperativeHandle(R,H,K)},Gt.useInsertionEffect=function(R,H){return j.current.useInsertionEffect(R,H)},Gt.useLayoutEffect=function(R,H){return j.current.useLayoutEffect(R,H)},Gt.useMemo=function(R,H){return j.current.useMemo(R,H)},Gt.useReducer=function(R,H,K){return j.current.useReducer(R,H,K)},Gt.useRef=function(R){return j.current.useRef(R)},Gt.useState=function(R){return j.current.useState(R)},Gt.useSyncExternalStore=function(R,H,K){return j.current.useSyncExternalStore(R,H,K)},Gt.useTransition=function(){return j.current.useTransition()},Gt.version="18.3.1",Gt}var SO;function oc(){return SO||(SO=1,nk.exports=c8()),nk.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CO;function f8(){if(CO)return Hg;CO=1;var n=oc(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var f,h={},p=null,g=null;u!==void 0&&(p=""+u),l.key!==void 0&&(p=""+l.key),l.ref!==void 0&&(g=l.ref);for(f in l)r.call(l,f)&&!i.hasOwnProperty(f)&&(h[f]=l[f]);if(a&&a.defaultProps)for(f in l=a.defaultProps,l)h[f]===void 0&&(h[f]=l[f]);return{$$typeof:e,type:a,key:p,ref:g,props:h,_owner:s.current}}return Hg.Fragment=t,Hg.jsx=o,Hg.jsxs=o,Hg}var kO;function h8(){return kO||(kO=1,tk.exports=f8()),tk.exports}var Be=h8(),Pe=oc();const fo=fb(Pe),IO=B3({__proto__:null,default:fo},[Pe]);var Kw={},rk={exports:{}},ci={},sk={exports:{}},ik={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EO;function d8(){return EO||(EO=1,function(n){function e(W,P){var E=W.length;W.push(P);e:for(;0<E;){var R=E-1>>>1,H=W[R];if(0<s(H,P))W[R]=P,W[E]=H,E=R;else break e}}function t(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var P=W[0],E=W.pop();if(E!==P){W[0]=E;e:for(var R=0,H=W.length,K=H>>>1;R<K;){var Q=2*(R+1)-1,J=W[Q],ie=Q+1,ce=W[ie];if(0>s(J,E))ie<H&&0>s(ce,J)?(W[R]=ce,W[ie]=E,R=ie):(W[R]=J,W[Q]=E,R=Q);else if(ie<H&&0>s(ce,E))W[R]=ce,W[ie]=E,R=ie;else break e}}return P}function s(W,P){var E=W.sortIndex-P.sortIndex;return E!==0?E:W.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],f=1,h=null,p=3,g=!1,m=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function $(W){for(var P=t(u);P!==null;){if(P.callback===null)r(u);else if(P.startTime<=W)r(u),P.sortIndex=P.expirationTime,e(l,P);else break;P=t(u)}}function k(W){if(w=!1,$(W),!m)if(t(l)!==null)m=!0,B(N);else{var P=t(u);P!==null&&j(k,P.startTime-W)}}function N(W,P){m=!1,w&&(w=!1,b(O),O=-1),g=!0;var E=p;try{for($(P),h=t(l);h!==null&&(!(h.expirationTime>P)||W&&!I());){var R=h.callback;if(typeof R=="function"){h.callback=null,p=h.priorityLevel;var H=R(h.expirationTime<=P);P=n.unstable_now(),typeof H=="function"?h.callback=H:h===t(l)&&r(l),$(P)}else r(l);h=t(l)}if(h!==null)var K=!0;else{var Q=t(u);Q!==null&&j(k,Q.startTime-P),K=!1}return K}finally{h=null,p=E,g=!1}}var _=!1,U=null,O=-1,L=5,T=-1;function I(){return!(n.unstable_now()-T<L)}function v(){if(U!==null){var W=n.unstable_now();T=W;var P=!0;try{P=U(!0,W)}finally{P?A():(_=!1,U=null)}}else _=!1}var A;if(typeof C=="function")A=function(){C(v)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,D=M.port2;M.port1.onmessage=v,A=function(){D.postMessage(null)}}else A=function(){x(v,0)};function B(W){U=W,_||(_=!0,A())}function j(W,P){O=x(function(){W(n.unstable_now())},P)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_continueExecution=function(){m||g||(m=!0,B(N))},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(W){switch(p){case 1:case 2:case 3:var P=3;break;default:P=p}var E=p;p=P;try{return W()}finally{p=E}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(W,P){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var E=p;p=W;try{return P()}finally{p=E}},n.unstable_scheduleCallback=function(W,P,E){var R=n.unstable_now();switch(typeof E=="object"&&E!==null?(E=E.delay,E=typeof E=="number"&&0<E?R+E:R):E=R,W){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=E+H,W={id:f++,callback:P,priorityLevel:W,startTime:E,expirationTime:H,sortIndex:-1},E>R?(W.sortIndex=E,e(u,W),t(l)===null&&W===t(u)&&(w?(b(O),O=-1):w=!0,j(k,E-R))):(W.sortIndex=H,e(l,W),m||g||(m=!0,B(N))),W},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(W){var P=p;return function(){var E=p;p=P;try{return W.apply(this,arguments)}finally{p=E}}}}(ik)),ik}var AO;function p8(){return AO||(AO=1,sk.exports=d8()),sk.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TO;function g8(){if(TO)return ci;TO=1;var n=oc(),e=p8();function t(c){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+c,y=1;y<arguments.length;y++)d+="&args[]="+encodeURIComponent(arguments[y]);return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function i(c,d){o(c,d),o(c+"Capture",d)}function o(c,d){for(s[c]=d,c=0;c<d.length;c++)r.add(d[c])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function p(c){return l.call(h,c)?!0:l.call(f,c)?!1:u.test(c)?h[c]=!0:(f[c]=!0,!1)}function g(c,d,y,S){if(y!==null&&y.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return S?!1:y!==null?!y.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function m(c,d,y,S){if(d===null||typeof d>"u"||g(c,d,y,S))return!0;if(S)return!1;if(y!==null)switch(y.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function w(c,d,y,S,F,V,X){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=S,this.attributeNamespace=F,this.mustUseProperty=y,this.propertyName=c,this.type=d,this.sanitizeURL=V,this.removeEmptyString=X}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){x[c]=new w(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var d=c[0];x[d]=new w(d,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){x[c]=new w(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){x[c]=new w(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){x[c]=new w(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){x[c]=new w(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){x[c]=new w(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){x[c]=new w(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){x[c]=new w(c,5,!1,c.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function C(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var d=c.replace(b,C);x[d]=new w(d,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var d=c.replace(b,C);x[d]=new w(d,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var d=c.replace(b,C);x[d]=new w(d,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){x[c]=new w(c,1,!1,c.toLowerCase(),null,!1,!1)}),x.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){x[c]=new w(c,1,!1,c.toLowerCase(),null,!0,!0)});function $(c,d,y,S){var F=x.hasOwnProperty(d)?x[d]:null;(F!==null?F.type!==0:S||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(m(d,y,F,S)&&(y=null),S||F===null?p(d)&&(y===null?c.removeAttribute(d):c.setAttribute(d,""+y)):F.mustUseProperty?c[F.propertyName]=y===null?F.type===3?!1:"":y:(d=F.attributeName,S=F.attributeNamespace,y===null?c.removeAttribute(d):(F=F.type,y=F===3||F===4&&y===!0?"":""+y,S?c.setAttributeNS(S,d,y):c.setAttribute(d,y))))}var k=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),_=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),j=Symbol.for("react.offscreen"),W=Symbol.iterator;function P(c){return c===null||typeof c!="object"?null:(c=W&&c[W]||c["@@iterator"],typeof c=="function"?c:null)}var E=Object.assign,R;function H(c){if(R===void 0)try{throw Error()}catch(y){var d=y.stack.trim().match(/\n( *(at )?)/);R=d&&d[1]||""}return`
`+R+c}var K=!1;function Q(c,d){if(!c||K)return"";K=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch($e){var S=$e}Reflect.construct(c,[],d)}else{try{d.call()}catch($e){S=$e}c.call(d.prototype)}else{try{throw Error()}catch($e){S=$e}c()}}catch($e){if($e&&S&&typeof $e.stack=="string"){for(var F=$e.stack.split(`
`),V=S.stack.split(`
`),X=F.length-1,re=V.length-1;1<=X&&0<=re&&F[X]!==V[re];)re--;for(;1<=X&&0<=re;X--,re--)if(F[X]!==V[re]){if(X!==1||re!==1)do if(X--,re--,0>re||F[X]!==V[re]){var le=`
`+F[X].replace(" at new "," at ");return c.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",c.displayName)),le}while(1<=X&&0<=re);break}}}finally{K=!1,Error.prepareStackTrace=y}return(c=c?c.displayName||c.name:"")?H(c):""}function J(c){switch(c.tag){case 5:return H(c.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return c=Q(c.type,!1),c;case 11:return c=Q(c.type.render,!1),c;case 1:return c=Q(c.type,!0),c;default:return""}}function ie(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case U:return"Fragment";case _:return"Portal";case L:return"Profiler";case O:return"StrictMode";case A:return"Suspense";case M:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case I:return(c.displayName||"Context")+".Consumer";case T:return(c._context.displayName||"Context")+".Provider";case v:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case D:return d=c.displayName||null,d!==null?d:ie(c.type)||"Memo";case B:d=c._payload,c=c._init;try{return ie(c(d))}catch{}}return null}function ce(c){var d=c.type;switch(c.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=d.render,c=c.displayName||c.name||"",d.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ie(d);case 8:return d===O?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function ge(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function be(c){var d=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Ae(c){var d=be(c)?"checked":"value",y=Object.getOwnPropertyDescriptor(c.constructor.prototype,d),S=""+c[d];if(!c.hasOwnProperty(d)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var F=y.get,V=y.set;return Object.defineProperty(c,d,{configurable:!0,get:function(){return F.call(this)},set:function(X){S=""+X,V.call(this,X)}}),Object.defineProperty(c,d,{enumerable:y.enumerable}),{getValue:function(){return S},setValue:function(X){S=""+X},stopTracking:function(){c._valueTracker=null,delete c[d]}}}}function ne(c){c._valueTracker||(c._valueTracker=Ae(c))}function he(c){if(!c)return!1;var d=c._valueTracker;if(!d)return!0;var y=d.getValue(),S="";return c&&(S=be(c)?c.checked?"true":"false":c.value),c=S,c!==y?(d.setValue(c),!0):!1}function Ie(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function ze(c,d){var y=d.checked;return E({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:y??c._wrapperState.initialChecked})}function Re(c,d){var y=d.defaultValue==null?"":d.defaultValue,S=d.checked!=null?d.checked:d.defaultChecked;y=ge(d.value!=null?d.value:y),c._wrapperState={initialChecked:S,initialValue:y,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Ke(c,d){d=d.checked,d!=null&&$(c,"checked",d,!1)}function tt(c,d){Ke(c,d);var y=ge(d.value),S=d.type;if(y!=null)S==="number"?(y===0&&c.value===""||c.value!=y)&&(c.value=""+y):c.value!==""+y&&(c.value=""+y);else if(S==="submit"||S==="reset"){c.removeAttribute("value");return}d.hasOwnProperty("value")?ot(c,d.type,y):d.hasOwnProperty("defaultValue")&&ot(c,d.type,ge(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(c.defaultChecked=!!d.defaultChecked)}function Xe(c,d,y){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var S=d.type;if(!(S!=="submit"&&S!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+c._wrapperState.initialValue,y||d===c.value||(c.value=d),c.defaultValue=d}y=c.name,y!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,y!==""&&(c.name=y)}function ot(c,d,y){(d!=="number"||Ie(c.ownerDocument)!==c)&&(y==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+y&&(c.defaultValue=""+y))}var et=Array.isArray;function mt(c,d,y,S){if(c=c.options,d){d={};for(var F=0;F<y.length;F++)d["$"+y[F]]=!0;for(y=0;y<c.length;y++)F=d.hasOwnProperty("$"+c[y].value),c[y].selected!==F&&(c[y].selected=F),F&&S&&(c[y].defaultSelected=!0)}else{for(y=""+ge(y),d=null,F=0;F<c.length;F++){if(c[F].value===y){c[F].selected=!0,S&&(c[F].defaultSelected=!0);return}d!==null||c[F].disabled||(d=c[F])}d!==null&&(d.selected=!0)}}function Ue(c,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return E({},d,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function Vt(c,d){var y=d.value;if(y==null){if(y=d.children,d=d.defaultValue,y!=null){if(d!=null)throw Error(t(92));if(et(y)){if(1<y.length)throw Error(t(93));y=y[0]}d=y}d==null&&(d=""),y=d}c._wrapperState={initialValue:ge(y)}}function At(c,d){var y=ge(d.value),S=ge(d.defaultValue);y!=null&&(y=""+y,y!==c.value&&(c.value=y),d.defaultValue==null&&c.defaultValue!==y&&(c.defaultValue=y)),S!=null&&(c.defaultValue=""+S)}function St(c){var d=c.textContent;d===c._wrapperState.initialValue&&d!==""&&d!==null&&(c.value=d)}function Dn(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function q(c,d){return c==null||c==="http://www.w3.org/1999/xhtml"?Dn(d):c==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var z,G=function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,y,S,F){MSApp.execUnsafeLocalFunction(function(){return c(d,y,S,F)})}:c}(function(c,d){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=d;else{for(z=z||document.createElement("div"),z.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=z.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;d.firstChild;)c.appendChild(d.firstChild)}});function Z(c,d){if(d){var y=c.firstChild;if(y&&y===c.lastChild&&y.nodeType===3){y.nodeValue=d;return}}c.textContent=d}var ae={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ke=["Webkit","ms","Moz","O"];Object.keys(ae).forEach(function(c){ke.forEach(function(d){d=d+c.charAt(0).toUpperCase()+c.substring(1),ae[d]=ae[c]})});function Ne(c,d,y){return d==null||typeof d=="boolean"||d===""?"":y||typeof d!="number"||d===0||ae.hasOwnProperty(c)&&ae[c]?(""+d).trim():d+"px"}function Ye(c,d){c=c.style;for(var y in d)if(d.hasOwnProperty(y)){var S=y.indexOf("--")===0,F=Ne(y,d[y],S);y==="float"&&(y="cssFloat"),S?c.setProperty(y,F):c[y]=F}}var He=E({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Me(c,d){if(d){if(He[c]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function Ze(c,d){if(c.indexOf("-")===-1)return typeof d.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var at=null;function bt(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var _t=null,sr=null,Wt=null;function Qt(c){if(c=Ng(c)){if(typeof _t!="function")throw Error(t(280));var d=c.stateNode;d&&(d=aw(d),_t(c.stateNode,c.type,d))}}function Ms(c){sr?Wt?Wt.push(c):Wt=[c]:sr=c}function kn(){if(sr){var c=sr,d=Wt;if(Wt=sr=null,Qt(c),d)for(c=0;c<d.length;c++)Qt(d[c])}}function In(c,d){return c(d)}function Ja(){}var cn=!1;function Un(c,d,y){if(cn)return c(d,y);cn=!0;try{return In(c,d,y)}finally{cn=!1,(sr!==null||Wt!==null)&&(Ja(),kn())}}function na(c,d){var y=c.stateNode;if(y===null)return null;var S=aw(y);if(S===null)return null;y=S[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(S=!S.disabled)||(c=c.type,S=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!S;break e;default:c=!1}if(c)return null;if(y&&typeof y!="function")throw Error(t(231,d,typeof y));return y}var _n=!1;if(a)try{var bn={};Object.defineProperty(bn,"passive",{get:function(){_n=!0}}),window.addEventListener("test",bn,bn),window.removeEventListener("test",bn,bn)}catch{_n=!1}function kh(c,d,y,S,F,V,X,re,le){var $e=Array.prototype.slice.call(arguments,3);try{d.apply(y,$e)}catch(Ge){this.onError(Ge)}}var mn=!1,yn=null,Ls=!1,Pn=null,qn={onError:function(c){mn=!0,yn=c}};function Ih(c,d,y,S,F,V,X,re,le){mn=!1,yn=null,kh.apply(qn,arguments)}function Xn(c,d,y,S,F,V,X,re,le){if(Ih.apply(this,arguments),mn){if(mn){var $e=yn;mn=!1,yn=null}else throw Error(t(198));Ls||(Ls=!0,Pn=$e)}}function fn(c){var d=c,y=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,d.flags&4098&&(y=d.return),c=d.return;while(c)}return d.tag===3?y:null}function ws(c){if(c.tag===13){var d=c.memoizedState;if(d===null&&(c=c.alternate,c!==null&&(d=c.memoizedState)),d!==null)return d.dehydrated}return null}function ql(c){if(fn(c)!==c)throw Error(t(188))}function xc(c){var d=c.alternate;if(!d){if(d=fn(c),d===null)throw Error(t(188));return d!==c?null:c}for(var y=c,S=d;;){var F=y.return;if(F===null)break;var V=F.alternate;if(V===null){if(S=F.return,S!==null){y=S;continue}break}if(F.child===V.child){for(V=F.child;V;){if(V===y)return ql(F),c;if(V===S)return ql(F),d;V=V.sibling}throw Error(t(188))}if(y.return!==S.return)y=F,S=V;else{for(var X=!1,re=F.child;re;){if(re===y){X=!0,y=F,S=V;break}if(re===S){X=!0,S=F,y=V;break}re=re.sibling}if(!X){for(re=V.child;re;){if(re===y){X=!0,y=V,S=F;break}if(re===S){X=!0,S=V,y=F;break}re=re.sibling}if(!X)throw Error(t(189))}}if(y.alternate!==S)throw Error(t(190))}if(y.tag!==3)throw Error(t(188));return y.stateNode.current===y?c:d}function Xl(c){return c=xc(c),c!==null?Ql(c):null}function Ql(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var d=Ql(c);if(d!==null)return d;c=c.sibling}return null}var Yl=e.unstable_scheduleCallback,ri=e.unstable_cancelCallback,bc=e.unstable_shouldYield,vc=e.unstable_requestPaint,En=e.unstable_now,Sc=e.unstable_getCurrentPriorityLevel,Za=e.unstable_ImmediatePriority,Co=e.unstable_UserBlockingPriority,ra=e.unstable_NormalPriority,Cc=e.unstable_LowPriority,Bs=e.unstable_IdlePriority,sa=null,xs=null;function kc(c){if(xs&&typeof xs.onCommitFiberRoot=="function")try{xs.onCommitFiberRoot(sa,c,void 0,(c.current.flags&128)===128)}catch{}}var ki=Math.clz32?Math.clz32:Eh,IS=Math.log,ES=Math.LN2;function Eh(c){return c>>>=0,c===0?32:31-(IS(c)/ES|0)|0}var Ah=64,ia=4194304;function Jl(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function Ic(c,d){var y=c.pendingLanes;if(y===0)return 0;var S=0,F=c.suspendedLanes,V=c.pingedLanes,X=y&268435455;if(X!==0){var re=X&~F;re!==0?S=Jl(re):(V&=X,V!==0&&(S=Jl(V)))}else X=y&~F,X!==0?S=Jl(X):V!==0&&(S=Jl(V));if(S===0)return 0;if(d!==0&&d!==S&&!(d&F)&&(F=S&-S,V=d&-d,F>=V||F===16&&(V&4194240)!==0))return d;if(S&4&&(S|=y&16),d=c.entangledLanes,d!==0)for(c=c.entanglements,d&=S;0<d;)y=31-ki(d),F=1<<y,S|=c[y],d&=~F;return S}function AS(c,d){switch(c){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TS(c,d){for(var y=c.suspendedLanes,S=c.pingedLanes,F=c.expirationTimes,V=c.pendingLanes;0<V;){var X=31-ki(V),re=1<<X,le=F[X];le===-1?(!(re&y)||re&S)&&(F[X]=AS(re,d)):le<=d&&(c.expiredLanes|=re),V&=~re}}function dg(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function Ky(){var c=Ah;return Ah<<=1,!(Ah&4194240)&&(Ah=64),c}function Th(c){for(var d=[],y=0;31>y;y++)d.push(c);return d}function Ec(c,d,y){c.pendingLanes|=d,d!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,d=31-ki(d),c[d]=y}function NS(c,d){var y=c.pendingLanes&~d;c.pendingLanes=d,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=d,c.mutableReadLanes&=d,c.entangledLanes&=d,d=c.entanglements;var S=c.eventTimes;for(c=c.expirationTimes;0<y;){var F=31-ki(y),V=1<<F;d[F]=0,S[F]=-1,c[F]=-1,y&=~V}}function Nh(c,d){var y=c.entangledLanes|=d;for(c=c.entanglements;y;){var S=31-ki(y),F=1<<S;F&d|c[S]&d&&(c[S]|=d),y&=~F}}var Yt=0;function el(c){return c&=-c,1<c?4<c?c&268435455?16:536870912:4:1}var qy,pg,ko,Xy,Qy,gg=!1,$h=[],oa=null,bs=null,Io=null,Ac=new Map,aa=new Map,la=[],mg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yy(c,d){switch(c){case"focusin":case"focusout":oa=null;break;case"dragenter":case"dragleave":bs=null;break;case"mouseover":case"mouseout":Io=null;break;case"pointerover":case"pointerout":Ac.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":aa.delete(d.pointerId)}}function Zl(c,d,y,S,F,V){return c===null||c.nativeEvent!==V?(c={blockedOn:d,domEventName:y,eventSystemFlags:S,nativeEvent:V,targetContainers:[F]},d!==null&&(d=Ng(d),d!==null&&pg(d)),c):(c.eventSystemFlags|=S,d=c.targetContainers,F!==null&&d.indexOf(F)===-1&&d.push(F),c)}function Jy(c,d,y,S,F){switch(d){case"focusin":return oa=Zl(oa,c,d,y,S,F),!0;case"dragenter":return bs=Zl(bs,c,d,y,S,F),!0;case"mouseover":return Io=Zl(Io,c,d,y,S,F),!0;case"pointerover":var V=F.pointerId;return Ac.set(V,Zl(Ac.get(V)||null,c,d,y,S,F)),!0;case"gotpointercapture":return V=F.pointerId,aa.set(V,Zl(aa.get(V)||null,c,d,y,S,F)),!0}return!1}function yg(c){var d=$c(c.target);if(d!==null){var y=fn(d);if(y!==null){if(d=y.tag,d===13){if(d=ws(y),d!==null){c.blockedOn=d,Qy(c.priority,function(){ko(y)});return}}else if(d===3&&y.stateNode.current.memoizedState.isDehydrated){c.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}c.blockedOn=null}function ua(c){if(c.blockedOn!==null)return!1;for(var d=c.targetContainers;0<d.length;){var y=Fn(c.domEventName,c.eventSystemFlags,d[0],c.nativeEvent);if(y===null){y=c.nativeEvent;var S=new y.constructor(y.type,y);at=S,y.target.dispatchEvent(S),at=null}else return d=Ng(y),d!==null&&pg(d),c.blockedOn=y,!1;d.shift()}return!0}function wg(c,d,y){ua(c)&&y.delete(d)}function $S(){gg=!1,oa!==null&&ua(oa)&&(oa=null),bs!==null&&ua(bs)&&(bs=null),Io!==null&&ua(Io)&&(Io=null),Ac.forEach(wg),aa.forEach(wg)}function Tc(c,d){c.blockedOn===d&&(c.blockedOn=null,gg||(gg=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$S)))}function Nc(c){function d(F){return Tc(F,c)}if(0<$h.length){Tc($h[0],c);for(var y=1;y<$h.length;y++){var S=$h[y];S.blockedOn===c&&(S.blockedOn=null)}}for(oa!==null&&Tc(oa,c),bs!==null&&Tc(bs,c),Io!==null&&Tc(Io,c),Ac.forEach(d),aa.forEach(d),y=0;y<la.length;y++)S=la[y],S.blockedOn===c&&(S.blockedOn=null);for(;0<la.length&&(y=la[0],y.blockedOn===null);)yg(y),y.blockedOn===null&&la.shift()}var te=k.ReactCurrentBatchConfig,me=!0;function Le(c,d,y,S){var F=Yt,V=te.transition;te.transition=null;try{Yt=1,wn(c,d,y,S)}finally{Yt=F,te.transition=V}}function ut(c,d,y,S){var F=Yt,V=te.transition;te.transition=null;try{Yt=4,wn(c,d,y,S)}finally{Yt=F,te.transition=V}}function wn(c,d,y,S){if(me){var F=Fn(c,d,y,S);if(F===null)GS(c,d,S,Ot,y),Yy(c,S);else if(Jy(F,c,d,y,S))S.stopPropagation();else if(Yy(c,S),d&4&&-1<mg.indexOf(c)){for(;F!==null;){var V=Ng(F);if(V!==null&&qy(V),V=Fn(c,d,y,S),V===null&&GS(c,d,S,Ot,y),V===F)break;F=V}F!==null&&S.stopPropagation()}else GS(c,d,S,null,y)}}var Ot=null;function Fn(c,d,y,S){if(Ot=null,c=bt(S),c=$c(c),c!==null)if(d=fn(c),d===null)c=null;else if(y=d.tag,y===13){if(c=ws(d),c!==null)return c;c=null}else if(y===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;c=null}else d!==c&&(c=null);return Ot=c,null}function yr(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Sc()){case Za:return 1;case Co:return 4;case ra:case Cc:return 16;case Bs:return 536870912;default:return 16}default:return 16}}var Mn=null,An=null,Hr=null;function si(){if(Hr)return Hr;var c,d=An,y=d.length,S,F="value"in Mn?Mn.value:Mn.textContent,V=F.length;for(c=0;c<y&&d[c]===F[c];c++);var X=y-c;for(S=1;S<=X&&d[y-S]===F[V-S];S++);return Hr=F.slice(c,1<S?1-S:void 0)}function wr(c){var d=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&d===13&&(c=13)):c=d,c===10&&(c=13),32<=c||c===13?c:0}function ss(){return!0}function zs(){return!1}function ir(c){function d(y,S,F,V,X){this._reactName=y,this._targetInst=F,this.type=S,this.nativeEvent=V,this.target=X,this.currentTarget=null;for(var re in c)c.hasOwnProperty(re)&&(y=c[re],this[re]=y?y(V):V[re]);return this.isDefaultPrevented=(V.defaultPrevented!=null?V.defaultPrevented:V.returnValue===!1)?ss:zs,this.isPropagationStopped=zs,this}return E(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!="unknown"&&(y.returnValue=!1),this.isDefaultPrevented=ss)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!="unknown"&&(y.cancelBubble=!0),this.isPropagationStopped=ss)},persist:function(){},isPersistent:ss}),d}var vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eo=ir(vs),eu=E({},vs,{view:0,detail:0}),Rh=ir(eu),tu,RS,xg,Zy=E({},eu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:DS,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==xg&&(xg&&c.type==="mousemove"?(tu=c.screenX-xg.screenX,RS=c.screenY-xg.screenY):RS=tu=0,xg=c),tu)},movementY:function(c){return"movementY"in c?c.movementY:RS}}),u$=ir(Zy),F5=E({},Zy,{dataTransfer:0}),M5=ir(F5),L5=E({},eu,{relatedTarget:0}),OS=ir(L5),B5=E({},vs,{animationName:0,elapsedTime:0,pseudoElement:0}),z5=ir(B5),U5=E({},vs,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),V5=ir(U5),W5=E({},vs,{data:0}),c$=ir(W5),G5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},H5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},j5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function K5(c){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(c):(c=j5[c])?!!d[c]:!1}function DS(){return K5}var q5=E({},eu,{key:function(c){if(c.key){var d=G5[c.key]||c.key;if(d!=="Unidentified")return d}return c.type==="keypress"?(c=wr(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?H5[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:DS,charCode:function(c){return c.type==="keypress"?wr(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?wr(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),X5=ir(q5),Q5=E({},Zy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),f$=ir(Q5),Y5=E({},eu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:DS}),J5=ir(Y5),Z5=E({},vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),eG=ir(Z5),tG=E({},Zy,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),nG=ir(tG),rG=[9,13,27,32],_S=a&&"CompositionEvent"in window,bg=null;a&&"documentMode"in document&&(bg=document.documentMode);var sG=a&&"TextEvent"in window&&!bg,h$=a&&(!_S||bg&&8<bg&&11>=bg),d$=" ",p$=!1;function g$(c,d){switch(c){case"keyup":return rG.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function m$(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Oh=!1;function iG(c,d){switch(c){case"compositionend":return m$(d);case"keypress":return d.which!==32?null:(p$=!0,d$);case"textInput":return c=d.data,c===d$&&p$?null:c;default:return null}}function oG(c,d){if(Oh)return c==="compositionend"||!_S&&g$(c,d)?(c=si(),Hr=An=Mn=null,Oh=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return h$&&d.locale!=="ko"?null:d.data;default:return null}}var aG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function y$(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d==="input"?!!aG[c.type]:d==="textarea"}function w$(c,d,y,S){Ms(S),d=sw(d,"onChange"),0<d.length&&(y=new Eo("onChange","change",null,y,S),c.push({event:y,listeners:d}))}var vg=null,Sg=null;function lG(c){F$(c,0)}function ew(c){var d=Mh(c);if(he(d))return c}function uG(c,d){if(c==="change")return d}var x$=!1;if(a){var PS;if(a){var FS="oninput"in document;if(!FS){var b$=document.createElement("div");b$.setAttribute("oninput","return;"),FS=typeof b$.oninput=="function"}PS=FS}else PS=!1;x$=PS&&(!document.documentMode||9<document.documentMode)}function v$(){vg&&(vg.detachEvent("onpropertychange",S$),Sg=vg=null)}function S$(c){if(c.propertyName==="value"&&ew(Sg)){var d=[];w$(d,Sg,c,bt(c)),Un(lG,d)}}function cG(c,d,y){c==="focusin"?(v$(),vg=d,Sg=y,vg.attachEvent("onpropertychange",S$)):c==="focusout"&&v$()}function fG(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return ew(Sg)}function hG(c,d){if(c==="click")return ew(d)}function dG(c,d){if(c==="input"||c==="change")return ew(d)}function pG(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var Ao=typeof Object.is=="function"?Object.is:pG;function Cg(c,d){if(Ao(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var y=Object.keys(c),S=Object.keys(d);if(y.length!==S.length)return!1;for(S=0;S<y.length;S++){var F=y[S];if(!l.call(d,F)||!Ao(c[F],d[F]))return!1}return!0}function C$(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function k$(c,d){var y=C$(c);c=0;for(var S;y;){if(y.nodeType===3){if(S=c+y.textContent.length,c<=d&&S>=d)return{node:y,offset:d-c};c=S}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=C$(y)}}function I$(c,d){return c&&d?c===d?!0:c&&c.nodeType===3?!1:d&&d.nodeType===3?I$(c,d.parentNode):"contains"in c?c.contains(d):c.compareDocumentPosition?!!(c.compareDocumentPosition(d)&16):!1:!1}function E$(){for(var c=window,d=Ie();d instanceof c.HTMLIFrameElement;){try{var y=typeof d.contentWindow.location.href=="string"}catch{y=!1}if(y)c=d.contentWindow;else break;d=Ie(c.document)}return d}function MS(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d&&(d==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||d==="textarea"||c.contentEditable==="true")}function gG(c){var d=E$(),y=c.focusedElem,S=c.selectionRange;if(d!==y&&y&&y.ownerDocument&&I$(y.ownerDocument.documentElement,y)){if(S!==null&&MS(y)){if(d=S.start,c=S.end,c===void 0&&(c=d),"selectionStart"in y)y.selectionStart=d,y.selectionEnd=Math.min(c,y.value.length);else if(c=(d=y.ownerDocument||document)&&d.defaultView||window,c.getSelection){c=c.getSelection();var F=y.textContent.length,V=Math.min(S.start,F);S=S.end===void 0?V:Math.min(S.end,F),!c.extend&&V>S&&(F=S,S=V,V=F),F=k$(y,V);var X=k$(y,S);F&&X&&(c.rangeCount!==1||c.anchorNode!==F.node||c.anchorOffset!==F.offset||c.focusNode!==X.node||c.focusOffset!==X.offset)&&(d=d.createRange(),d.setStart(F.node,F.offset),c.removeAllRanges(),V>S?(c.addRange(d),c.extend(X.node,X.offset)):(d.setEnd(X.node,X.offset),c.addRange(d)))}}for(d=[],c=y;c=c.parentNode;)c.nodeType===1&&d.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof y.focus=="function"&&y.focus(),y=0;y<d.length;y++)c=d[y],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var mG=a&&"documentMode"in document&&11>=document.documentMode,Dh=null,LS=null,kg=null,BS=!1;function A$(c,d,y){var S=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;BS||Dh==null||Dh!==Ie(S)||(S=Dh,"selectionStart"in S&&MS(S)?S={start:S.selectionStart,end:S.selectionEnd}:(S=(S.ownerDocument&&S.ownerDocument.defaultView||window).getSelection(),S={anchorNode:S.anchorNode,anchorOffset:S.anchorOffset,focusNode:S.focusNode,focusOffset:S.focusOffset}),kg&&Cg(kg,S)||(kg=S,S=sw(LS,"onSelect"),0<S.length&&(d=new Eo("onSelect","select",null,d,y),c.push({event:d,listeners:S}),d.target=Dh)))}function tw(c,d){var y={};return y[c.toLowerCase()]=d.toLowerCase(),y["Webkit"+c]="webkit"+d,y["Moz"+c]="moz"+d,y}var _h={animationend:tw("Animation","AnimationEnd"),animationiteration:tw("Animation","AnimationIteration"),animationstart:tw("Animation","AnimationStart"),transitionend:tw("Transition","TransitionEnd")},zS={},T$={};a&&(T$=document.createElement("div").style,"AnimationEvent"in window||(delete _h.animationend.animation,delete _h.animationiteration.animation,delete _h.animationstart.animation),"TransitionEvent"in window||delete _h.transitionend.transition);function nw(c){if(zS[c])return zS[c];if(!_h[c])return c;var d=_h[c],y;for(y in d)if(d.hasOwnProperty(y)&&y in T$)return zS[c]=d[y];return c}var N$=nw("animationend"),$$=nw("animationiteration"),R$=nw("animationstart"),O$=nw("transitionend"),D$=new Map,_$="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function nu(c,d){D$.set(c,d),i(d,[c])}for(var US=0;US<_$.length;US++){var VS=_$[US],yG=VS.toLowerCase(),wG=VS[0].toUpperCase()+VS.slice(1);nu(yG,"on"+wG)}nu(N$,"onAnimationEnd"),nu($$,"onAnimationIteration"),nu(R$,"onAnimationStart"),nu("dblclick","onDoubleClick"),nu("focusin","onFocus"),nu("focusout","onBlur"),nu(O$,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ig="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xG=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ig));function P$(c,d,y){var S=c.type||"unknown-event";c.currentTarget=y,Xn(S,d,void 0,c),c.currentTarget=null}function F$(c,d){d=(d&4)!==0;for(var y=0;y<c.length;y++){var S=c[y],F=S.event;S=S.listeners;e:{var V=void 0;if(d)for(var X=S.length-1;0<=X;X--){var re=S[X],le=re.instance,$e=re.currentTarget;if(re=re.listener,le!==V&&F.isPropagationStopped())break e;P$(F,re,$e),V=le}else for(X=0;X<S.length;X++){if(re=S[X],le=re.instance,$e=re.currentTarget,re=re.listener,le!==V&&F.isPropagationStopped())break e;P$(F,re,$e),V=le}}}if(Ls)throw c=Pn,Ls=!1,Pn=null,c}function Vn(c,d){var y=d[QS];y===void 0&&(y=d[QS]=new Set);var S=c+"__bubble";y.has(S)||(M$(d,c,2,!1),y.add(S))}function WS(c,d,y){var S=0;d&&(S|=4),M$(y,c,S,d)}var rw="_reactListening"+Math.random().toString(36).slice(2);function Eg(c){if(!c[rw]){c[rw]=!0,r.forEach(function(y){y!=="selectionchange"&&(xG.has(y)||WS(y,!1,c),WS(y,!0,c))});var d=c.nodeType===9?c:c.ownerDocument;d===null||d[rw]||(d[rw]=!0,WS("selectionchange",!1,d))}}function M$(c,d,y,S){switch(yr(d)){case 1:var F=Le;break;case 4:F=ut;break;default:F=wn}y=F.bind(null,d,y,c),F=void 0,!_n||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(F=!0),S?F!==void 0?c.addEventListener(d,y,{capture:!0,passive:F}):c.addEventListener(d,y,!0):F!==void 0?c.addEventListener(d,y,{passive:F}):c.addEventListener(d,y,!1)}function GS(c,d,y,S,F){var V=S;if(!(d&1)&&!(d&2)&&S!==null)e:for(;;){if(S===null)return;var X=S.tag;if(X===3||X===4){var re=S.stateNode.containerInfo;if(re===F||re.nodeType===8&&re.parentNode===F)break;if(X===4)for(X=S.return;X!==null;){var le=X.tag;if((le===3||le===4)&&(le=X.stateNode.containerInfo,le===F||le.nodeType===8&&le.parentNode===F))return;X=X.return}for(;re!==null;){if(X=$c(re),X===null)return;if(le=X.tag,le===5||le===6){S=V=X;continue e}re=re.parentNode}}S=S.return}Un(function(){var $e=V,Ge=bt(y),Qe=[];e:{var We=D$.get(c);if(We!==void 0){var lt=Eo,pt=c;switch(c){case"keypress":if(wr(y)===0)break e;case"keydown":case"keyup":lt=X5;break;case"focusin":pt="focus",lt=OS;break;case"focusout":pt="blur",lt=OS;break;case"beforeblur":case"afterblur":lt=OS;break;case"click":if(y.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":lt=u$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":lt=M5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":lt=J5;break;case N$:case $$:case R$:lt=z5;break;case O$:lt=eG;break;case"scroll":lt=Rh;break;case"wheel":lt=nG;break;case"copy":case"cut":case"paste":lt=V5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":lt=f$}var yt=(d&4)!==0,xr=!yt&&c==="scroll",ve=yt?We!==null?We+"Capture":null:We;yt=[];for(var de=$e,Ee;de!==null;){Ee=de;var Je=Ee.stateNode;if(Ee.tag===5&&Je!==null&&(Ee=Je,ve!==null&&(Je=na(de,ve),Je!=null&&yt.push(Ag(de,Je,Ee)))),xr)break;de=de.return}0<yt.length&&(We=new lt(We,pt,null,y,Ge),Qe.push({event:We,listeners:yt}))}}if(!(d&7)){e:{if(We=c==="mouseover"||c==="pointerover",lt=c==="mouseout"||c==="pointerout",We&&y!==at&&(pt=y.relatedTarget||y.fromElement)&&($c(pt)||pt[tl]))break e;if((lt||We)&&(We=Ge.window===Ge?Ge:(We=Ge.ownerDocument)?We.defaultView||We.parentWindow:window,lt?(pt=y.relatedTarget||y.toElement,lt=$e,pt=pt?$c(pt):null,pt!==null&&(xr=fn(pt),pt!==xr||pt.tag!==5&&pt.tag!==6)&&(pt=null)):(lt=null,pt=$e),lt!==pt)){if(yt=u$,Je="onMouseLeave",ve="onMouseEnter",de="mouse",(c==="pointerout"||c==="pointerover")&&(yt=f$,Je="onPointerLeave",ve="onPointerEnter",de="pointer"),xr=lt==null?We:Mh(lt),Ee=pt==null?We:Mh(pt),We=new yt(Je,de+"leave",lt,y,Ge),We.target=xr,We.relatedTarget=Ee,Je=null,$c(Ge)===$e&&(yt=new yt(ve,de+"enter",pt,y,Ge),yt.target=Ee,yt.relatedTarget=xr,Je=yt),xr=Je,lt&&pt)t:{for(yt=lt,ve=pt,de=0,Ee=yt;Ee;Ee=Ph(Ee))de++;for(Ee=0,Je=ve;Je;Je=Ph(Je))Ee++;for(;0<de-Ee;)yt=Ph(yt),de--;for(;0<Ee-de;)ve=Ph(ve),Ee--;for(;de--;){if(yt===ve||ve!==null&&yt===ve.alternate)break t;yt=Ph(yt),ve=Ph(ve)}yt=null}else yt=null;lt!==null&&L$(Qe,We,lt,yt,!1),pt!==null&&xr!==null&&L$(Qe,xr,pt,yt,!0)}}e:{if(We=$e?Mh($e):window,lt=We.nodeName&&We.nodeName.toLowerCase(),lt==="select"||lt==="input"&&We.type==="file")var xt=uG;else if(y$(We))if(x$)xt=dG;else{xt=fG;var It=cG}else(lt=We.nodeName)&&lt.toLowerCase()==="input"&&(We.type==="checkbox"||We.type==="radio")&&(xt=hG);if(xt&&(xt=xt(c,$e))){w$(Qe,xt,y,Ge);break e}It&&It(c,We,$e),c==="focusout"&&(It=We._wrapperState)&&It.controlled&&We.type==="number"&&ot(We,"number",We.value)}switch(It=$e?Mh($e):window,c){case"focusin":(y$(It)||It.contentEditable==="true")&&(Dh=It,LS=$e,kg=null);break;case"focusout":kg=LS=Dh=null;break;case"mousedown":BS=!0;break;case"contextmenu":case"mouseup":case"dragend":BS=!1,A$(Qe,y,Ge);break;case"selectionchange":if(mG)break;case"keydown":case"keyup":A$(Qe,y,Ge)}var Et;if(_S)e:{switch(c){case"compositionstart":var Rt="onCompositionStart";break e;case"compositionend":Rt="onCompositionEnd";break e;case"compositionupdate":Rt="onCompositionUpdate";break e}Rt=void 0}else Oh?g$(c,y)&&(Rt="onCompositionEnd"):c==="keydown"&&y.keyCode===229&&(Rt="onCompositionStart");Rt&&(h$&&y.locale!=="ko"&&(Oh||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&Oh&&(Et=si()):(Mn=Ge,An="value"in Mn?Mn.value:Mn.textContent,Oh=!0)),It=sw($e,Rt),0<It.length&&(Rt=new c$(Rt,c,null,y,Ge),Qe.push({event:Rt,listeners:It}),Et?Rt.data=Et:(Et=m$(y),Et!==null&&(Rt.data=Et)))),(Et=sG?iG(c,y):oG(c,y))&&($e=sw($e,"onBeforeInput"),0<$e.length&&(Ge=new c$("onBeforeInput","beforeinput",null,y,Ge),Qe.push({event:Ge,listeners:$e}),Ge.data=Et))}F$(Qe,d)})}function Ag(c,d,y){return{instance:c,listener:d,currentTarget:y}}function sw(c,d){for(var y=d+"Capture",S=[];c!==null;){var F=c,V=F.stateNode;F.tag===5&&V!==null&&(F=V,V=na(c,y),V!=null&&S.unshift(Ag(c,V,F)),V=na(c,d),V!=null&&S.push(Ag(c,V,F))),c=c.return}return S}function Ph(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function L$(c,d,y,S,F){for(var V=d._reactName,X=[];y!==null&&y!==S;){var re=y,le=re.alternate,$e=re.stateNode;if(le!==null&&le===S)break;re.tag===5&&$e!==null&&(re=$e,F?(le=na(y,V),le!=null&&X.unshift(Ag(y,le,re))):F||(le=na(y,V),le!=null&&X.push(Ag(y,le,re)))),y=y.return}X.length!==0&&c.push({event:d,listeners:X})}var bG=/\r\n?/g,vG=/\u0000|\uFFFD/g;function B$(c){return(typeof c=="string"?c:""+c).replace(bG,`
`).replace(vG,"")}function iw(c,d,y){if(d=B$(d),B$(c)!==d&&y)throw Error(t(425))}function ow(){}var HS=null,jS=null;function KS(c,d){return c==="textarea"||c==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var qS=typeof setTimeout=="function"?setTimeout:void 0,SG=typeof clearTimeout=="function"?clearTimeout:void 0,z$=typeof Promise=="function"?Promise:void 0,CG=typeof queueMicrotask=="function"?queueMicrotask:typeof z$<"u"?function(c){return z$.resolve(null).then(c).catch(kG)}:qS;function kG(c){setTimeout(function(){throw c})}function XS(c,d){var y=d,S=0;do{var F=y.nextSibling;if(c.removeChild(y),F&&F.nodeType===8)if(y=F.data,y==="/$"){if(S===0){c.removeChild(F),Nc(d);return}S--}else y!=="$"&&y!=="$?"&&y!=="$!"||S++;y=F}while(y);Nc(d)}function ru(c){for(;c!=null;c=c.nextSibling){var d=c.nodeType;if(d===1||d===3)break;if(d===8){if(d=c.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return c}function U$(c){c=c.previousSibling;for(var d=0;c;){if(c.nodeType===8){var y=c.data;if(y==="$"||y==="$!"||y==="$?"){if(d===0)return c;d--}else y==="/$"&&d++}c=c.previousSibling}return null}var Fh=Math.random().toString(36).slice(2),ca="__reactFiber$"+Fh,Tg="__reactProps$"+Fh,tl="__reactContainer$"+Fh,QS="__reactEvents$"+Fh,IG="__reactListeners$"+Fh,EG="__reactHandles$"+Fh;function $c(c){var d=c[ca];if(d)return d;for(var y=c.parentNode;y;){if(d=y[tl]||y[ca]){if(y=d.alternate,d.child!==null||y!==null&&y.child!==null)for(c=U$(c);c!==null;){if(y=c[ca])return y;c=U$(c)}return d}c=y,y=c.parentNode}return null}function Ng(c){return c=c[ca]||c[tl],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Mh(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function aw(c){return c[Tg]||null}var YS=[],Lh=-1;function su(c){return{current:c}}function Wn(c){0>Lh||(c.current=YS[Lh],YS[Lh]=null,Lh--)}function Ln(c,d){Lh++,YS[Lh]=c.current,c.current=d}var iu={},Ss=su(iu),ii=su(!1),Rc=iu;function Bh(c,d){var y=c.type.contextTypes;if(!y)return iu;var S=c.stateNode;if(S&&S.__reactInternalMemoizedUnmaskedChildContext===d)return S.__reactInternalMemoizedMaskedChildContext;var F={},V;for(V in y)F[V]=d[V];return S&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=d,c.__reactInternalMemoizedMaskedChildContext=F),F}function oi(c){return c=c.childContextTypes,c!=null}function lw(){Wn(ii),Wn(Ss)}function V$(c,d,y){if(Ss.current!==iu)throw Error(t(168));Ln(Ss,d),Ln(ii,y)}function W$(c,d,y){var S=c.stateNode;if(d=d.childContextTypes,typeof S.getChildContext!="function")return y;S=S.getChildContext();for(var F in S)if(!(F in d))throw Error(t(108,ce(c)||"Unknown",F));return E({},y,S)}function uw(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||iu,Rc=Ss.current,Ln(Ss,c),Ln(ii,ii.current),!0}function G$(c,d,y){var S=c.stateNode;if(!S)throw Error(t(169));y?(c=W$(c,d,Rc),S.__reactInternalMemoizedMergedChildContext=c,Wn(ii),Wn(Ss),Ln(Ss,c)):Wn(ii),Ln(ii,y)}var nl=null,cw=!1,JS=!1;function H$(c){nl===null?nl=[c]:nl.push(c)}function AG(c){cw=!0,H$(c)}function ou(){if(!JS&&nl!==null){JS=!0;var c=0,d=Yt;try{var y=nl;for(Yt=1;c<y.length;c++){var S=y[c];do S=S(!0);while(S!==null)}nl=null,cw=!1}catch(F){throw nl!==null&&(nl=nl.slice(c+1)),Yl(Za,ou),F}finally{Yt=d,JS=!1}}return null}var zh=[],Uh=0,fw=null,hw=0,Gi=[],Hi=0,Oc=null,rl=1,sl="";function Dc(c,d){zh[Uh++]=hw,zh[Uh++]=fw,fw=c,hw=d}function j$(c,d,y){Gi[Hi++]=rl,Gi[Hi++]=sl,Gi[Hi++]=Oc,Oc=c;var S=rl;c=sl;var F=32-ki(S)-1;S&=~(1<<F),y+=1;var V=32-ki(d)+F;if(30<V){var X=F-F%5;V=(S&(1<<X)-1).toString(32),S>>=X,F-=X,rl=1<<32-ki(d)+F|y<<F|S,sl=V+c}else rl=1<<V|y<<F|S,sl=c}function ZS(c){c.return!==null&&(Dc(c,1),j$(c,1,0))}function eC(c){for(;c===fw;)fw=zh[--Uh],zh[Uh]=null,hw=zh[--Uh],zh[Uh]=null;for(;c===Oc;)Oc=Gi[--Hi],Gi[Hi]=null,sl=Gi[--Hi],Gi[Hi]=null,rl=Gi[--Hi],Gi[Hi]=null}var Ii=null,Ei=null,Qn=!1,To=null;function K$(c,d){var y=Xi(5,null,null,0);y.elementType="DELETED",y.stateNode=d,y.return=c,d=c.deletions,d===null?(c.deletions=[y],c.flags|=16):d.push(y)}function q$(c,d){switch(c.tag){case 5:var y=c.type;return d=d.nodeType!==1||y.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(c.stateNode=d,Ii=c,Ei=ru(d.firstChild),!0):!1;case 6:return d=c.pendingProps===""||d.nodeType!==3?null:d,d!==null?(c.stateNode=d,Ii=c,Ei=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(y=Oc!==null?{id:rl,overflow:sl}:null,c.memoizedState={dehydrated:d,treeContext:y,retryLane:1073741824},y=Xi(18,null,null,0),y.stateNode=d,y.return=c,c.child=y,Ii=c,Ei=null,!0):!1;default:return!1}}function tC(c){return(c.mode&1)!==0&&(c.flags&128)===0}function nC(c){if(Qn){var d=Ei;if(d){var y=d;if(!q$(c,d)){if(tC(c))throw Error(t(418));d=ru(y.nextSibling);var S=Ii;d&&q$(c,d)?K$(S,y):(c.flags=c.flags&-4097|2,Qn=!1,Ii=c)}}else{if(tC(c))throw Error(t(418));c.flags=c.flags&-4097|2,Qn=!1,Ii=c}}}function X$(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Ii=c}function dw(c){if(c!==Ii)return!1;if(!Qn)return X$(c),Qn=!0,!1;var d;if((d=c.tag!==3)&&!(d=c.tag!==5)&&(d=c.type,d=d!=="head"&&d!=="body"&&!KS(c.type,c.memoizedProps)),d&&(d=Ei)){if(tC(c))throw Q$(),Error(t(418));for(;d;)K$(c,d),d=ru(d.nextSibling)}if(X$(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,d=0;c;){if(c.nodeType===8){var y=c.data;if(y==="/$"){if(d===0){Ei=ru(c.nextSibling);break e}d--}else y!=="$"&&y!=="$!"&&y!=="$?"||d++}c=c.nextSibling}Ei=null}}else Ei=Ii?ru(c.stateNode.nextSibling):null;return!0}function Q$(){for(var c=Ei;c;)c=ru(c.nextSibling)}function Vh(){Ei=Ii=null,Qn=!1}function rC(c){To===null?To=[c]:To.push(c)}var TG=k.ReactCurrentBatchConfig;function $g(c,d,y){if(c=y.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(y._owner){if(y=y._owner,y){if(y.tag!==1)throw Error(t(309));var S=y.stateNode}if(!S)throw Error(t(147,c));var F=S,V=""+c;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===V?d.ref:(d=function(X){var re=F.refs;X===null?delete re[V]:re[V]=X},d._stringRef=V,d)}if(typeof c!="string")throw Error(t(284));if(!y._owner)throw Error(t(290,c))}return c}function pw(c,d){throw c=Object.prototype.toString.call(d),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c))}function Y$(c){var d=c._init;return d(c._payload)}function J$(c){function d(ve,de){if(c){var Ee=ve.deletions;Ee===null?(ve.deletions=[de],ve.flags|=16):Ee.push(de)}}function y(ve,de){if(!c)return null;for(;de!==null;)d(ve,de),de=de.sibling;return null}function S(ve,de){for(ve=new Map;de!==null;)de.key!==null?ve.set(de.key,de):ve.set(de.index,de),de=de.sibling;return ve}function F(ve,de){return ve=pu(ve,de),ve.index=0,ve.sibling=null,ve}function V(ve,de,Ee){return ve.index=Ee,c?(Ee=ve.alternate,Ee!==null?(Ee=Ee.index,Ee<de?(ve.flags|=2,de):Ee):(ve.flags|=2,de)):(ve.flags|=1048576,de)}function X(ve){return c&&ve.alternate===null&&(ve.flags|=2),ve}function re(ve,de,Ee,Je){return de===null||de.tag!==6?(de=qC(Ee,ve.mode,Je),de.return=ve,de):(de=F(de,Ee),de.return=ve,de)}function le(ve,de,Ee,Je){var xt=Ee.type;return xt===U?Ge(ve,de,Ee.props.children,Je,Ee.key):de!==null&&(de.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===B&&Y$(xt)===de.type)?(Je=F(de,Ee.props),Je.ref=$g(ve,de,Ee),Je.return=ve,Je):(Je=Lw(Ee.type,Ee.key,Ee.props,null,ve.mode,Je),Je.ref=$g(ve,de,Ee),Je.return=ve,Je)}function $e(ve,de,Ee,Je){return de===null||de.tag!==4||de.stateNode.containerInfo!==Ee.containerInfo||de.stateNode.implementation!==Ee.implementation?(de=XC(Ee,ve.mode,Je),de.return=ve,de):(de=F(de,Ee.children||[]),de.return=ve,de)}function Ge(ve,de,Ee,Je,xt){return de===null||de.tag!==7?(de=Uc(Ee,ve.mode,Je,xt),de.return=ve,de):(de=F(de,Ee),de.return=ve,de)}function Qe(ve,de,Ee){if(typeof de=="string"&&de!==""||typeof de=="number")return de=qC(""+de,ve.mode,Ee),de.return=ve,de;if(typeof de=="object"&&de!==null){switch(de.$$typeof){case N:return Ee=Lw(de.type,de.key,de.props,null,ve.mode,Ee),Ee.ref=$g(ve,null,de),Ee.return=ve,Ee;case _:return de=XC(de,ve.mode,Ee),de.return=ve,de;case B:var Je=de._init;return Qe(ve,Je(de._payload),Ee)}if(et(de)||P(de))return de=Uc(de,ve.mode,Ee,null),de.return=ve,de;pw(ve,de)}return null}function We(ve,de,Ee,Je){var xt=de!==null?de.key:null;if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return xt!==null?null:re(ve,de,""+Ee,Je);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case N:return Ee.key===xt?le(ve,de,Ee,Je):null;case _:return Ee.key===xt?$e(ve,de,Ee,Je):null;case B:return xt=Ee._init,We(ve,de,xt(Ee._payload),Je)}if(et(Ee)||P(Ee))return xt!==null?null:Ge(ve,de,Ee,Je,null);pw(ve,Ee)}return null}function lt(ve,de,Ee,Je,xt){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return ve=ve.get(Ee)||null,re(de,ve,""+Je,xt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case N:return ve=ve.get(Je.key===null?Ee:Je.key)||null,le(de,ve,Je,xt);case _:return ve=ve.get(Je.key===null?Ee:Je.key)||null,$e(de,ve,Je,xt);case B:var It=Je._init;return lt(ve,de,Ee,It(Je._payload),xt)}if(et(Je)||P(Je))return ve=ve.get(Ee)||null,Ge(de,ve,Je,xt,null);pw(de,Je)}return null}function pt(ve,de,Ee,Je){for(var xt=null,It=null,Et=de,Rt=de=0,qr=null;Et!==null&&Rt<Ee.length;Rt++){Et.index>Rt?(qr=Et,Et=null):qr=Et.sibling;var nn=We(ve,Et,Ee[Rt],Je);if(nn===null){Et===null&&(Et=qr);break}c&&Et&&nn.alternate===null&&d(ve,Et),de=V(nn,de,Rt),It===null?xt=nn:It.sibling=nn,It=nn,Et=qr}if(Rt===Ee.length)return y(ve,Et),Qn&&Dc(ve,Rt),xt;if(Et===null){for(;Rt<Ee.length;Rt++)Et=Qe(ve,Ee[Rt],Je),Et!==null&&(de=V(Et,de,Rt),It===null?xt=Et:It.sibling=Et,It=Et);return Qn&&Dc(ve,Rt),xt}for(Et=S(ve,Et);Rt<Ee.length;Rt++)qr=lt(Et,ve,Rt,Ee[Rt],Je),qr!==null&&(c&&qr.alternate!==null&&Et.delete(qr.key===null?Rt:qr.key),de=V(qr,de,Rt),It===null?xt=qr:It.sibling=qr,It=qr);return c&&Et.forEach(function(gu){return d(ve,gu)}),Qn&&Dc(ve,Rt),xt}function yt(ve,de,Ee,Je){var xt=P(Ee);if(typeof xt!="function")throw Error(t(150));if(Ee=xt.call(Ee),Ee==null)throw Error(t(151));for(var It=xt=null,Et=de,Rt=de=0,qr=null,nn=Ee.next();Et!==null&&!nn.done;Rt++,nn=Ee.next()){Et.index>Rt?(qr=Et,Et=null):qr=Et.sibling;var gu=We(ve,Et,nn.value,Je);if(gu===null){Et===null&&(Et=qr);break}c&&Et&&gu.alternate===null&&d(ve,Et),de=V(gu,de,Rt),It===null?xt=gu:It.sibling=gu,It=gu,Et=qr}if(nn.done)return y(ve,Et),Qn&&Dc(ve,Rt),xt;if(Et===null){for(;!nn.done;Rt++,nn=Ee.next())nn=Qe(ve,nn.value,Je),nn!==null&&(de=V(nn,de,Rt),It===null?xt=nn:It.sibling=nn,It=nn);return Qn&&Dc(ve,Rt),xt}for(Et=S(ve,Et);!nn.done;Rt++,nn=Ee.next())nn=lt(Et,ve,Rt,nn.value,Je),nn!==null&&(c&&nn.alternate!==null&&Et.delete(nn.key===null?Rt:nn.key),de=V(nn,de,Rt),It===null?xt=nn:It.sibling=nn,It=nn);return c&&Et.forEach(function(o8){return d(ve,o8)}),Qn&&Dc(ve,Rt),xt}function xr(ve,de,Ee,Je){if(typeof Ee=="object"&&Ee!==null&&Ee.type===U&&Ee.key===null&&(Ee=Ee.props.children),typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case N:e:{for(var xt=Ee.key,It=de;It!==null;){if(It.key===xt){if(xt=Ee.type,xt===U){if(It.tag===7){y(ve,It.sibling),de=F(It,Ee.props.children),de.return=ve,ve=de;break e}}else if(It.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===B&&Y$(xt)===It.type){y(ve,It.sibling),de=F(It,Ee.props),de.ref=$g(ve,It,Ee),de.return=ve,ve=de;break e}y(ve,It);break}else d(ve,It);It=It.sibling}Ee.type===U?(de=Uc(Ee.props.children,ve.mode,Je,Ee.key),de.return=ve,ve=de):(Je=Lw(Ee.type,Ee.key,Ee.props,null,ve.mode,Je),Je.ref=$g(ve,de,Ee),Je.return=ve,ve=Je)}return X(ve);case _:e:{for(It=Ee.key;de!==null;){if(de.key===It)if(de.tag===4&&de.stateNode.containerInfo===Ee.containerInfo&&de.stateNode.implementation===Ee.implementation){y(ve,de.sibling),de=F(de,Ee.children||[]),de.return=ve,ve=de;break e}else{y(ve,de);break}else d(ve,de);de=de.sibling}de=XC(Ee,ve.mode,Je),de.return=ve,ve=de}return X(ve);case B:return It=Ee._init,xr(ve,de,It(Ee._payload),Je)}if(et(Ee))return pt(ve,de,Ee,Je);if(P(Ee))return yt(ve,de,Ee,Je);pw(ve,Ee)}return typeof Ee=="string"&&Ee!==""||typeof Ee=="number"?(Ee=""+Ee,de!==null&&de.tag===6?(y(ve,de.sibling),de=F(de,Ee),de.return=ve,ve=de):(y(ve,de),de=qC(Ee,ve.mode,Je),de.return=ve,ve=de),X(ve)):y(ve,de)}return xr}var Wh=J$(!0),Z$=J$(!1),gw=su(null),mw=null,Gh=null,sC=null;function iC(){sC=Gh=mw=null}function oC(c){var d=gw.current;Wn(gw),c._currentValue=d}function aC(c,d,y){for(;c!==null;){var S=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,S!==null&&(S.childLanes|=d)):S!==null&&(S.childLanes&d)!==d&&(S.childLanes|=d),c===y)break;c=c.return}}function Hh(c,d){mw=c,sC=Gh=null,c=c.dependencies,c!==null&&c.firstContext!==null&&(c.lanes&d&&(ai=!0),c.firstContext=null)}function ji(c){var d=c._currentValue;if(sC!==c)if(c={context:c,memoizedValue:d,next:null},Gh===null){if(mw===null)throw Error(t(308));Gh=c,mw.dependencies={lanes:0,firstContext:c}}else Gh=Gh.next=c;return d}var _c=null;function lC(c){_c===null?_c=[c]:_c.push(c)}function eR(c,d,y,S){var F=d.interleaved;return F===null?(y.next=y,lC(d)):(y.next=F.next,F.next=y),d.interleaved=y,il(c,S)}function il(c,d){c.lanes|=d;var y=c.alternate;for(y!==null&&(y.lanes|=d),y=c,c=c.return;c!==null;)c.childLanes|=d,y=c.alternate,y!==null&&(y.childLanes|=d),y=c,c=c.return;return y.tag===3?y.stateNode:null}var au=!1;function uC(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tR(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function ol(c,d){return{eventTime:c,lane:d,tag:0,payload:null,callback:null,next:null}}function lu(c,d,y){var S=c.updateQueue;if(S===null)return null;if(S=S.shared,en&2){var F=S.pending;return F===null?d.next=d:(d.next=F.next,F.next=d),S.pending=d,il(c,y)}return F=S.interleaved,F===null?(d.next=d,lC(S)):(d.next=F.next,F.next=d),S.interleaved=d,il(c,y)}function yw(c,d,y){if(d=d.updateQueue,d!==null&&(d=d.shared,(y&4194240)!==0)){var S=d.lanes;S&=c.pendingLanes,y|=S,d.lanes=y,Nh(c,y)}}function nR(c,d){var y=c.updateQueue,S=c.alternate;if(S!==null&&(S=S.updateQueue,y===S)){var F=null,V=null;if(y=y.firstBaseUpdate,y!==null){do{var X={eventTime:y.eventTime,lane:y.lane,tag:y.tag,payload:y.payload,callback:y.callback,next:null};V===null?F=V=X:V=V.next=X,y=y.next}while(y!==null);V===null?F=V=d:V=V.next=d}else F=V=d;y={baseState:S.baseState,firstBaseUpdate:F,lastBaseUpdate:V,shared:S.shared,effects:S.effects},c.updateQueue=y;return}c=y.lastBaseUpdate,c===null?y.firstBaseUpdate=d:c.next=d,y.lastBaseUpdate=d}function ww(c,d,y,S){var F=c.updateQueue;au=!1;var V=F.firstBaseUpdate,X=F.lastBaseUpdate,re=F.shared.pending;if(re!==null){F.shared.pending=null;var le=re,$e=le.next;le.next=null,X===null?V=$e:X.next=$e,X=le;var Ge=c.alternate;Ge!==null&&(Ge=Ge.updateQueue,re=Ge.lastBaseUpdate,re!==X&&(re===null?Ge.firstBaseUpdate=$e:re.next=$e,Ge.lastBaseUpdate=le))}if(V!==null){var Qe=F.baseState;X=0,Ge=$e=le=null,re=V;do{var We=re.lane,lt=re.eventTime;if((S&We)===We){Ge!==null&&(Ge=Ge.next={eventTime:lt,lane:0,tag:re.tag,payload:re.payload,callback:re.callback,next:null});e:{var pt=c,yt=re;switch(We=d,lt=y,yt.tag){case 1:if(pt=yt.payload,typeof pt=="function"){Qe=pt.call(lt,Qe,We);break e}Qe=pt;break e;case 3:pt.flags=pt.flags&-65537|128;case 0:if(pt=yt.payload,We=typeof pt=="function"?pt.call(lt,Qe,We):pt,We==null)break e;Qe=E({},Qe,We);break e;case 2:au=!0}}re.callback!==null&&re.lane!==0&&(c.flags|=64,We=F.effects,We===null?F.effects=[re]:We.push(re))}else lt={eventTime:lt,lane:We,tag:re.tag,payload:re.payload,callback:re.callback,next:null},Ge===null?($e=Ge=lt,le=Qe):Ge=Ge.next=lt,X|=We;if(re=re.next,re===null){if(re=F.shared.pending,re===null)break;We=re,re=We.next,We.next=null,F.lastBaseUpdate=We,F.shared.pending=null}}while(!0);if(Ge===null&&(le=Qe),F.baseState=le,F.firstBaseUpdate=$e,F.lastBaseUpdate=Ge,d=F.shared.interleaved,d!==null){F=d;do X|=F.lane,F=F.next;while(F!==d)}else V===null&&(F.shared.lanes=0);Mc|=X,c.lanes=X,c.memoizedState=Qe}}function rR(c,d,y){if(c=d.effects,d.effects=null,c!==null)for(d=0;d<c.length;d++){var S=c[d],F=S.callback;if(F!==null){if(S.callback=null,S=y,typeof F!="function")throw Error(t(191,F));F.call(S)}}}var Rg={},fa=su(Rg),Og=su(Rg),Dg=su(Rg);function Pc(c){if(c===Rg)throw Error(t(174));return c}function cC(c,d){switch(Ln(Dg,d),Ln(Og,c),Ln(fa,Rg),c=d.nodeType,c){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:q(null,"");break;default:c=c===8?d.parentNode:d,d=c.namespaceURI||null,c=c.tagName,d=q(d,c)}Wn(fa),Ln(fa,d)}function jh(){Wn(fa),Wn(Og),Wn(Dg)}function sR(c){Pc(Dg.current);var d=Pc(fa.current),y=q(d,c.type);d!==y&&(Ln(Og,c),Ln(fa,y))}function fC(c){Og.current===c&&(Wn(fa),Wn(Og))}var er=su(0);function xw(c){for(var d=c;d!==null;){if(d.tag===13){var y=d.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||y.data==="$?"||y.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if(d.flags&128)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var hC=[];function dC(){for(var c=0;c<hC.length;c++)hC[c]._workInProgressVersionPrimary=null;hC.length=0}var bw=k.ReactCurrentDispatcher,pC=k.ReactCurrentBatchConfig,Fc=0,tr=null,Lr=null,jr=null,vw=!1,_g=!1,Pg=0,NG=0;function Cs(){throw Error(t(321))}function gC(c,d){if(d===null)return!1;for(var y=0;y<d.length&&y<c.length;y++)if(!Ao(c[y],d[y]))return!1;return!0}function mC(c,d,y,S,F,V){if(Fc=V,tr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,bw.current=c===null||c.memoizedState===null?DG:_G,c=y(S,F),_g){V=0;do{if(_g=!1,Pg=0,25<=V)throw Error(t(301));V+=1,jr=Lr=null,d.updateQueue=null,bw.current=PG,c=y(S,F)}while(_g)}if(bw.current=kw,d=Lr!==null&&Lr.next!==null,Fc=0,jr=Lr=tr=null,vw=!1,d)throw Error(t(300));return c}function yC(){var c=Pg!==0;return Pg=0,c}function ha(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jr===null?tr.memoizedState=jr=c:jr=jr.next=c,jr}function Ki(){if(Lr===null){var c=tr.alternate;c=c!==null?c.memoizedState:null}else c=Lr.next;var d=jr===null?tr.memoizedState:jr.next;if(d!==null)jr=d,Lr=c;else{if(c===null)throw Error(t(310));Lr=c,c={memoizedState:Lr.memoizedState,baseState:Lr.baseState,baseQueue:Lr.baseQueue,queue:Lr.queue,next:null},jr===null?tr.memoizedState=jr=c:jr=jr.next=c}return jr}function Fg(c,d){return typeof d=="function"?d(c):d}function wC(c){var d=Ki(),y=d.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=c;var S=Lr,F=S.baseQueue,V=y.pending;if(V!==null){if(F!==null){var X=F.next;F.next=V.next,V.next=X}S.baseQueue=F=V,y.pending=null}if(F!==null){V=F.next,S=S.baseState;var re=X=null,le=null,$e=V;do{var Ge=$e.lane;if((Fc&Ge)===Ge)le!==null&&(le=le.next={lane:0,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null}),S=$e.hasEagerState?$e.eagerState:c(S,$e.action);else{var Qe={lane:Ge,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null};le===null?(re=le=Qe,X=S):le=le.next=Qe,tr.lanes|=Ge,Mc|=Ge}$e=$e.next}while($e!==null&&$e!==V);le===null?X=S:le.next=re,Ao(S,d.memoizedState)||(ai=!0),d.memoizedState=S,d.baseState=X,d.baseQueue=le,y.lastRenderedState=S}if(c=y.interleaved,c!==null){F=c;do V=F.lane,tr.lanes|=V,Mc|=V,F=F.next;while(F!==c)}else F===null&&(y.lanes=0);return[d.memoizedState,y.dispatch]}function xC(c){var d=Ki(),y=d.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=c;var S=y.dispatch,F=y.pending,V=d.memoizedState;if(F!==null){y.pending=null;var X=F=F.next;do V=c(V,X.action),X=X.next;while(X!==F);Ao(V,d.memoizedState)||(ai=!0),d.memoizedState=V,d.baseQueue===null&&(d.baseState=V),y.lastRenderedState=V}return[V,S]}function iR(){}function oR(c,d){var y=tr,S=Ki(),F=d(),V=!Ao(S.memoizedState,F);if(V&&(S.memoizedState=F,ai=!0),S=S.queue,bC(uR.bind(null,y,S,c),[c]),S.getSnapshot!==d||V||jr!==null&&jr.memoizedState.tag&1){if(y.flags|=2048,Mg(9,lR.bind(null,y,S,F,d),void 0,null),Kr===null)throw Error(t(349));Fc&30||aR(y,d,F)}return F}function aR(c,d,y){c.flags|=16384,c={getSnapshot:d,value:y},d=tr.updateQueue,d===null?(d={lastEffect:null,stores:null},tr.updateQueue=d,d.stores=[c]):(y=d.stores,y===null?d.stores=[c]:y.push(c))}function lR(c,d,y,S){d.value=y,d.getSnapshot=S,cR(d)&&fR(c)}function uR(c,d,y){return y(function(){cR(d)&&fR(c)})}function cR(c){var d=c.getSnapshot;c=c.value;try{var y=d();return!Ao(c,y)}catch{return!0}}function fR(c){var d=il(c,1);d!==null&&Oo(d,c,1,-1)}function hR(c){var d=ha();return typeof c=="function"&&(c=c()),d.memoizedState=d.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fg,lastRenderedState:c},d.queue=c,c=c.dispatch=OG.bind(null,tr,c),[d.memoizedState,c]}function Mg(c,d,y,S){return c={tag:c,create:d,destroy:y,deps:S,next:null},d=tr.updateQueue,d===null?(d={lastEffect:null,stores:null},tr.updateQueue=d,d.lastEffect=c.next=c):(y=d.lastEffect,y===null?d.lastEffect=c.next=c:(S=y.next,y.next=c,c.next=S,d.lastEffect=c)),c}function dR(){return Ki().memoizedState}function Sw(c,d,y,S){var F=ha();tr.flags|=c,F.memoizedState=Mg(1|d,y,void 0,S===void 0?null:S)}function Cw(c,d,y,S){var F=Ki();S=S===void 0?null:S;var V=void 0;if(Lr!==null){var X=Lr.memoizedState;if(V=X.destroy,S!==null&&gC(S,X.deps)){F.memoizedState=Mg(d,y,V,S);return}}tr.flags|=c,F.memoizedState=Mg(1|d,y,V,S)}function pR(c,d){return Sw(8390656,8,c,d)}function bC(c,d){return Cw(2048,8,c,d)}function gR(c,d){return Cw(4,2,c,d)}function mR(c,d){return Cw(4,4,c,d)}function yR(c,d){if(typeof d=="function")return c=c(),d(c),function(){d(null)};if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function wR(c,d,y){return y=y!=null?y.concat([c]):null,Cw(4,4,yR.bind(null,d,c),y)}function vC(){}function xR(c,d){var y=Ki();d=d===void 0?null:d;var S=y.memoizedState;return S!==null&&d!==null&&gC(d,S[1])?S[0]:(y.memoizedState=[c,d],c)}function bR(c,d){var y=Ki();d=d===void 0?null:d;var S=y.memoizedState;return S!==null&&d!==null&&gC(d,S[1])?S[0]:(c=c(),y.memoizedState=[c,d],c)}function vR(c,d,y){return Fc&21?(Ao(y,d)||(y=Ky(),tr.lanes|=y,Mc|=y,c.baseState=!0),d):(c.baseState&&(c.baseState=!1,ai=!0),c.memoizedState=y)}function $G(c,d){var y=Yt;Yt=y!==0&&4>y?y:4,c(!0);var S=pC.transition;pC.transition={};try{c(!1),d()}finally{Yt=y,pC.transition=S}}function SR(){return Ki().memoizedState}function RG(c,d,y){var S=hu(c);if(y={lane:S,action:y,hasEagerState:!1,eagerState:null,next:null},CR(c))kR(d,y);else if(y=eR(c,d,y,S),y!==null){var F=Vs();Oo(y,c,S,F),IR(y,d,S)}}function OG(c,d,y){var S=hu(c),F={lane:S,action:y,hasEagerState:!1,eagerState:null,next:null};if(CR(c))kR(d,F);else{var V=c.alternate;if(c.lanes===0&&(V===null||V.lanes===0)&&(V=d.lastRenderedReducer,V!==null))try{var X=d.lastRenderedState,re=V(X,y);if(F.hasEagerState=!0,F.eagerState=re,Ao(re,X)){var le=d.interleaved;le===null?(F.next=F,lC(d)):(F.next=le.next,le.next=F),d.interleaved=F;return}}catch{}finally{}y=eR(c,d,F,S),y!==null&&(F=Vs(),Oo(y,c,S,F),IR(y,d,S))}}function CR(c){var d=c.alternate;return c===tr||d!==null&&d===tr}function kR(c,d){_g=vw=!0;var y=c.pending;y===null?d.next=d:(d.next=y.next,y.next=d),c.pending=d}function IR(c,d,y){if(y&4194240){var S=d.lanes;S&=c.pendingLanes,y|=S,d.lanes=y,Nh(c,y)}}var kw={readContext:ji,useCallback:Cs,useContext:Cs,useEffect:Cs,useImperativeHandle:Cs,useInsertionEffect:Cs,useLayoutEffect:Cs,useMemo:Cs,useReducer:Cs,useRef:Cs,useState:Cs,useDebugValue:Cs,useDeferredValue:Cs,useTransition:Cs,useMutableSource:Cs,useSyncExternalStore:Cs,useId:Cs,unstable_isNewReconciler:!1},DG={readContext:ji,useCallback:function(c,d){return ha().memoizedState=[c,d===void 0?null:d],c},useContext:ji,useEffect:pR,useImperativeHandle:function(c,d,y){return y=y!=null?y.concat([c]):null,Sw(4194308,4,yR.bind(null,d,c),y)},useLayoutEffect:function(c,d){return Sw(4194308,4,c,d)},useInsertionEffect:function(c,d){return Sw(4,2,c,d)},useMemo:function(c,d){var y=ha();return d=d===void 0?null:d,c=c(),y.memoizedState=[c,d],c},useReducer:function(c,d,y){var S=ha();return d=y!==void 0?y(d):d,S.memoizedState=S.baseState=d,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:d},S.queue=c,c=c.dispatch=RG.bind(null,tr,c),[S.memoizedState,c]},useRef:function(c){var d=ha();return c={current:c},d.memoizedState=c},useState:hR,useDebugValue:vC,useDeferredValue:function(c){return ha().memoizedState=c},useTransition:function(){var c=hR(!1),d=c[0];return c=$G.bind(null,c[1]),ha().memoizedState=c,[d,c]},useMutableSource:function(){},useSyncExternalStore:function(c,d,y){var S=tr,F=ha();if(Qn){if(y===void 0)throw Error(t(407));y=y()}else{if(y=d(),Kr===null)throw Error(t(349));Fc&30||aR(S,d,y)}F.memoizedState=y;var V={value:y,getSnapshot:d};return F.queue=V,pR(uR.bind(null,S,V,c),[c]),S.flags|=2048,Mg(9,lR.bind(null,S,V,y,d),void 0,null),y},useId:function(){var c=ha(),d=Kr.identifierPrefix;if(Qn){var y=sl,S=rl;y=(S&~(1<<32-ki(S)-1)).toString(32)+y,d=":"+d+"R"+y,y=Pg++,0<y&&(d+="H"+y.toString(32)),d+=":"}else y=NG++,d=":"+d+"r"+y.toString(32)+":";return c.memoizedState=d},unstable_isNewReconciler:!1},_G={readContext:ji,useCallback:xR,useContext:ji,useEffect:bC,useImperativeHandle:wR,useInsertionEffect:gR,useLayoutEffect:mR,useMemo:bR,useReducer:wC,useRef:dR,useState:function(){return wC(Fg)},useDebugValue:vC,useDeferredValue:function(c){var d=Ki();return vR(d,Lr.memoizedState,c)},useTransition:function(){var c=wC(Fg)[0],d=Ki().memoizedState;return[c,d]},useMutableSource:iR,useSyncExternalStore:oR,useId:SR,unstable_isNewReconciler:!1},PG={readContext:ji,useCallback:xR,useContext:ji,useEffect:bC,useImperativeHandle:wR,useInsertionEffect:gR,useLayoutEffect:mR,useMemo:bR,useReducer:xC,useRef:dR,useState:function(){return xC(Fg)},useDebugValue:vC,useDeferredValue:function(c){var d=Ki();return Lr===null?d.memoizedState=c:vR(d,Lr.memoizedState,c)},useTransition:function(){var c=xC(Fg)[0],d=Ki().memoizedState;return[c,d]},useMutableSource:iR,useSyncExternalStore:oR,useId:SR,unstable_isNewReconciler:!1};function No(c,d){if(c&&c.defaultProps){d=E({},d),c=c.defaultProps;for(var y in c)d[y]===void 0&&(d[y]=c[y]);return d}return d}function SC(c,d,y,S){d=c.memoizedState,y=y(S,d),y=y==null?d:E({},d,y),c.memoizedState=y,c.lanes===0&&(c.updateQueue.baseState=y)}var Iw={isMounted:function(c){return(c=c._reactInternals)?fn(c)===c:!1},enqueueSetState:function(c,d,y){c=c._reactInternals;var S=Vs(),F=hu(c),V=ol(S,F);V.payload=d,y!=null&&(V.callback=y),d=lu(c,V,F),d!==null&&(Oo(d,c,F,S),yw(d,c,F))},enqueueReplaceState:function(c,d,y){c=c._reactInternals;var S=Vs(),F=hu(c),V=ol(S,F);V.tag=1,V.payload=d,y!=null&&(V.callback=y),d=lu(c,V,F),d!==null&&(Oo(d,c,F,S),yw(d,c,F))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var y=Vs(),S=hu(c),F=ol(y,S);F.tag=2,d!=null&&(F.callback=d),d=lu(c,F,S),d!==null&&(Oo(d,c,S,y),yw(d,c,S))}};function ER(c,d,y,S,F,V,X){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(S,V,X):d.prototype&&d.prototype.isPureReactComponent?!Cg(y,S)||!Cg(F,V):!0}function AR(c,d,y){var S=!1,F=iu,V=d.contextType;return typeof V=="object"&&V!==null?V=ji(V):(F=oi(d)?Rc:Ss.current,S=d.contextTypes,V=(S=S!=null)?Bh(c,F):iu),d=new d(y,V),c.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=Iw,c.stateNode=d,d._reactInternals=c,S&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=F,c.__reactInternalMemoizedMaskedChildContext=V),d}function TR(c,d,y,S){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(y,S),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(y,S),d.state!==c&&Iw.enqueueReplaceState(d,d.state,null)}function CC(c,d,y,S){var F=c.stateNode;F.props=y,F.state=c.memoizedState,F.refs={},uC(c);var V=d.contextType;typeof V=="object"&&V!==null?F.context=ji(V):(V=oi(d)?Rc:Ss.current,F.context=Bh(c,V)),F.state=c.memoizedState,V=d.getDerivedStateFromProps,typeof V=="function"&&(SC(c,d,V,y),F.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof F.getSnapshotBeforeUpdate=="function"||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(d=F.state,typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount(),d!==F.state&&Iw.enqueueReplaceState(F,F.state,null),ww(c,y,F,S),F.state=c.memoizedState),typeof F.componentDidMount=="function"&&(c.flags|=4194308)}function Kh(c,d){try{var y="",S=d;do y+=J(S),S=S.return;while(S);var F=y}catch(V){F=`
Error generating stack: `+V.message+`
`+V.stack}return{value:c,source:d,stack:F,digest:null}}function kC(c,d,y){return{value:c,source:null,stack:y??null,digest:d??null}}function IC(c,d){try{console.error(d.value)}catch(y){setTimeout(function(){throw y})}}var FG=typeof WeakMap=="function"?WeakMap:Map;function NR(c,d,y){y=ol(-1,y),y.tag=3,y.payload={element:null};var S=d.value;return y.callback=function(){Ow||(Ow=!0,zC=S),IC(c,d)},y}function $R(c,d,y){y=ol(-1,y),y.tag=3;var S=c.type.getDerivedStateFromError;if(typeof S=="function"){var F=d.value;y.payload=function(){return S(F)},y.callback=function(){IC(c,d)}}var V=c.stateNode;return V!==null&&typeof V.componentDidCatch=="function"&&(y.callback=function(){IC(c,d),typeof S!="function"&&(cu===null?cu=new Set([this]):cu.add(this));var X=d.stack;this.componentDidCatch(d.value,{componentStack:X!==null?X:""})}),y}function RR(c,d,y){var S=c.pingCache;if(S===null){S=c.pingCache=new FG;var F=new Set;S.set(d,F)}else F=S.get(d),F===void 0&&(F=new Set,S.set(d,F));F.has(y)||(F.add(y),c=QG.bind(null,c,d,y),d.then(c,c))}function OR(c){do{var d;if((d=c.tag===13)&&(d=c.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return c;c=c.return}while(c!==null);return null}function DR(c,d,y,S,F){return c.mode&1?(c.flags|=65536,c.lanes=F,c):(c===d?c.flags|=65536:(c.flags|=128,y.flags|=131072,y.flags&=-52805,y.tag===1&&(y.alternate===null?y.tag=17:(d=ol(-1,1),d.tag=2,lu(y,d,1))),y.lanes|=1),c)}var MG=k.ReactCurrentOwner,ai=!1;function Us(c,d,y,S){d.child=c===null?Z$(d,null,y,S):Wh(d,c.child,y,S)}function _R(c,d,y,S,F){y=y.render;var V=d.ref;return Hh(d,F),S=mC(c,d,y,S,V,F),y=yC(),c!==null&&!ai?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~F,al(c,d,F)):(Qn&&y&&ZS(d),d.flags|=1,Us(c,d,S,F),d.child)}function PR(c,d,y,S,F){if(c===null){var V=y.type;return typeof V=="function"&&!KC(V)&&V.defaultProps===void 0&&y.compare===null&&y.defaultProps===void 0?(d.tag=15,d.type=V,FR(c,d,V,S,F)):(c=Lw(y.type,null,S,d,d.mode,F),c.ref=d.ref,c.return=d,d.child=c)}if(V=c.child,!(c.lanes&F)){var X=V.memoizedProps;if(y=y.compare,y=y!==null?y:Cg,y(X,S)&&c.ref===d.ref)return al(c,d,F)}return d.flags|=1,c=pu(V,S),c.ref=d.ref,c.return=d,d.child=c}function FR(c,d,y,S,F){if(c!==null){var V=c.memoizedProps;if(Cg(V,S)&&c.ref===d.ref)if(ai=!1,d.pendingProps=S=V,(c.lanes&F)!==0)c.flags&131072&&(ai=!0);else return d.lanes=c.lanes,al(c,d,F)}return EC(c,d,y,S,F)}function MR(c,d,y){var S=d.pendingProps,F=S.children,V=c!==null?c.memoizedState:null;if(S.mode==="hidden")if(!(d.mode&1))d.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ln(Xh,Ai),Ai|=y;else{if(!(y&1073741824))return c=V!==null?V.baseLanes|y:y,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:c,cachePool:null,transitions:null},d.updateQueue=null,Ln(Xh,Ai),Ai|=c,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},S=V!==null?V.baseLanes:y,Ln(Xh,Ai),Ai|=S}else V!==null?(S=V.baseLanes|y,d.memoizedState=null):S=y,Ln(Xh,Ai),Ai|=S;return Us(c,d,F,y),d.child}function LR(c,d){var y=d.ref;(c===null&&y!==null||c!==null&&c.ref!==y)&&(d.flags|=512,d.flags|=2097152)}function EC(c,d,y,S,F){var V=oi(y)?Rc:Ss.current;return V=Bh(d,V),Hh(d,F),y=mC(c,d,y,S,V,F),S=yC(),c!==null&&!ai?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~F,al(c,d,F)):(Qn&&S&&ZS(d),d.flags|=1,Us(c,d,y,F),d.child)}function BR(c,d,y,S,F){if(oi(y)){var V=!0;uw(d)}else V=!1;if(Hh(d,F),d.stateNode===null)Aw(c,d),AR(d,y,S),CC(d,y,S,F),S=!0;else if(c===null){var X=d.stateNode,re=d.memoizedProps;X.props=re;var le=X.context,$e=y.contextType;typeof $e=="object"&&$e!==null?$e=ji($e):($e=oi(y)?Rc:Ss.current,$e=Bh(d,$e));var Ge=y.getDerivedStateFromProps,Qe=typeof Ge=="function"||typeof X.getSnapshotBeforeUpdate=="function";Qe||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(re!==S||le!==$e)&&TR(d,X,S,$e),au=!1;var We=d.memoizedState;X.state=We,ww(d,S,X,F),le=d.memoizedState,re!==S||We!==le||ii.current||au?(typeof Ge=="function"&&(SC(d,y,Ge,S),le=d.memoizedState),(re=au||ER(d,y,re,S,We,le,$e))?(Qe||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount()),typeof X.componentDidMount=="function"&&(d.flags|=4194308)):(typeof X.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=S,d.memoizedState=le),X.props=S,X.state=le,X.context=$e,S=re):(typeof X.componentDidMount=="function"&&(d.flags|=4194308),S=!1)}else{X=d.stateNode,tR(c,d),re=d.memoizedProps,$e=d.type===d.elementType?re:No(d.type,re),X.props=$e,Qe=d.pendingProps,We=X.context,le=y.contextType,typeof le=="object"&&le!==null?le=ji(le):(le=oi(y)?Rc:Ss.current,le=Bh(d,le));var lt=y.getDerivedStateFromProps;(Ge=typeof lt=="function"||typeof X.getSnapshotBeforeUpdate=="function")||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(re!==Qe||We!==le)&&TR(d,X,S,le),au=!1,We=d.memoizedState,X.state=We,ww(d,S,X,F);var pt=d.memoizedState;re!==Qe||We!==pt||ii.current||au?(typeof lt=="function"&&(SC(d,y,lt,S),pt=d.memoizedState),($e=au||ER(d,y,$e,S,We,pt,le)||!1)?(Ge||typeof X.UNSAFE_componentWillUpdate!="function"&&typeof X.componentWillUpdate!="function"||(typeof X.componentWillUpdate=="function"&&X.componentWillUpdate(S,pt,le),typeof X.UNSAFE_componentWillUpdate=="function"&&X.UNSAFE_componentWillUpdate(S,pt,le)),typeof X.componentDidUpdate=="function"&&(d.flags|=4),typeof X.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof X.componentDidUpdate!="function"||re===c.memoizedProps&&We===c.memoizedState||(d.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||re===c.memoizedProps&&We===c.memoizedState||(d.flags|=1024),d.memoizedProps=S,d.memoizedState=pt),X.props=S,X.state=pt,X.context=le,S=$e):(typeof X.componentDidUpdate!="function"||re===c.memoizedProps&&We===c.memoizedState||(d.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||re===c.memoizedProps&&We===c.memoizedState||(d.flags|=1024),S=!1)}return AC(c,d,y,S,V,F)}function AC(c,d,y,S,F,V){LR(c,d);var X=(d.flags&128)!==0;if(!S&&!X)return F&&G$(d,y,!1),al(c,d,V);S=d.stateNode,MG.current=d;var re=X&&typeof y.getDerivedStateFromError!="function"?null:S.render();return d.flags|=1,c!==null&&X?(d.child=Wh(d,c.child,null,V),d.child=Wh(d,null,re,V)):Us(c,d,re,V),d.memoizedState=S.state,F&&G$(d,y,!0),d.child}function zR(c){var d=c.stateNode;d.pendingContext?V$(c,d.pendingContext,d.pendingContext!==d.context):d.context&&V$(c,d.context,!1),cC(c,d.containerInfo)}function UR(c,d,y,S,F){return Vh(),rC(F),d.flags|=256,Us(c,d,y,S),d.child}var TC={dehydrated:null,treeContext:null,retryLane:0};function NC(c){return{baseLanes:c,cachePool:null,transitions:null}}function VR(c,d,y){var S=d.pendingProps,F=er.current,V=!1,X=(d.flags&128)!==0,re;if((re=X)||(re=c!==null&&c.memoizedState===null?!1:(F&2)!==0),re?(V=!0,d.flags&=-129):(c===null||c.memoizedState!==null)&&(F|=1),Ln(er,F&1),c===null)return nC(d),c=d.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?(d.mode&1?c.data==="$!"?d.lanes=8:d.lanes=1073741824:d.lanes=1,null):(X=S.children,c=S.fallback,V?(S=d.mode,V=d.child,X={mode:"hidden",children:X},!(S&1)&&V!==null?(V.childLanes=0,V.pendingProps=X):V=Bw(X,S,0,null),c=Uc(c,S,y,null),V.return=d,c.return=d,V.sibling=c,d.child=V,d.child.memoizedState=NC(y),d.memoizedState=TC,c):$C(d,X));if(F=c.memoizedState,F!==null&&(re=F.dehydrated,re!==null))return LG(c,d,X,S,re,F,y);if(V){V=S.fallback,X=d.mode,F=c.child,re=F.sibling;var le={mode:"hidden",children:S.children};return!(X&1)&&d.child!==F?(S=d.child,S.childLanes=0,S.pendingProps=le,d.deletions=null):(S=pu(F,le),S.subtreeFlags=F.subtreeFlags&14680064),re!==null?V=pu(re,V):(V=Uc(V,X,y,null),V.flags|=2),V.return=d,S.return=d,S.sibling=V,d.child=S,S=V,V=d.child,X=c.child.memoizedState,X=X===null?NC(y):{baseLanes:X.baseLanes|y,cachePool:null,transitions:X.transitions},V.memoizedState=X,V.childLanes=c.childLanes&~y,d.memoizedState=TC,S}return V=c.child,c=V.sibling,S=pu(V,{mode:"visible",children:S.children}),!(d.mode&1)&&(S.lanes=y),S.return=d,S.sibling=null,c!==null&&(y=d.deletions,y===null?(d.deletions=[c],d.flags|=16):y.push(c)),d.child=S,d.memoizedState=null,S}function $C(c,d){return d=Bw({mode:"visible",children:d},c.mode,0,null),d.return=c,c.child=d}function Ew(c,d,y,S){return S!==null&&rC(S),Wh(d,c.child,null,y),c=$C(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function LG(c,d,y,S,F,V,X){if(y)return d.flags&256?(d.flags&=-257,S=kC(Error(t(422))),Ew(c,d,X,S)):d.memoizedState!==null?(d.child=c.child,d.flags|=128,null):(V=S.fallback,F=d.mode,S=Bw({mode:"visible",children:S.children},F,0,null),V=Uc(V,F,X,null),V.flags|=2,S.return=d,V.return=d,S.sibling=V,d.child=S,d.mode&1&&Wh(d,c.child,null,X),d.child.memoizedState=NC(X),d.memoizedState=TC,V);if(!(d.mode&1))return Ew(c,d,X,null);if(F.data==="$!"){if(S=F.nextSibling&&F.nextSibling.dataset,S)var re=S.dgst;return S=re,V=Error(t(419)),S=kC(V,S,void 0),Ew(c,d,X,S)}if(re=(X&c.childLanes)!==0,ai||re){if(S=Kr,S!==null){switch(X&-X){case 4:F=2;break;case 16:F=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:F=32;break;case 536870912:F=268435456;break;default:F=0}F=F&(S.suspendedLanes|X)?0:F,F!==0&&F!==V.retryLane&&(V.retryLane=F,il(c,F),Oo(S,c,F,-1))}return jC(),S=kC(Error(t(421))),Ew(c,d,X,S)}return F.data==="$?"?(d.flags|=128,d.child=c.child,d=YG.bind(null,c),F._reactRetry=d,null):(c=V.treeContext,Ei=ru(F.nextSibling),Ii=d,Qn=!0,To=null,c!==null&&(Gi[Hi++]=rl,Gi[Hi++]=sl,Gi[Hi++]=Oc,rl=c.id,sl=c.overflow,Oc=d),d=$C(d,S.children),d.flags|=4096,d)}function WR(c,d,y){c.lanes|=d;var S=c.alternate;S!==null&&(S.lanes|=d),aC(c.return,d,y)}function RC(c,d,y,S,F){var V=c.memoizedState;V===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:S,tail:y,tailMode:F}:(V.isBackwards=d,V.rendering=null,V.renderingStartTime=0,V.last=S,V.tail=y,V.tailMode=F)}function GR(c,d,y){var S=d.pendingProps,F=S.revealOrder,V=S.tail;if(Us(c,d,S.children,y),S=er.current,S&2)S=S&1|2,d.flags|=128;else{if(c!==null&&c.flags&128)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&WR(c,y,d);else if(c.tag===19)WR(c,y,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}S&=1}if(Ln(er,S),!(d.mode&1))d.memoizedState=null;else switch(F){case"forwards":for(y=d.child,F=null;y!==null;)c=y.alternate,c!==null&&xw(c)===null&&(F=y),y=y.sibling;y=F,y===null?(F=d.child,d.child=null):(F=y.sibling,y.sibling=null),RC(d,!1,F,y,V);break;case"backwards":for(y=null,F=d.child,d.child=null;F!==null;){if(c=F.alternate,c!==null&&xw(c)===null){d.child=F;break}c=F.sibling,F.sibling=y,y=F,F=c}RC(d,!0,y,null,V);break;case"together":RC(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function Aw(c,d){!(d.mode&1)&&c!==null&&(c.alternate=null,d.alternate=null,d.flags|=2)}function al(c,d,y){if(c!==null&&(d.dependencies=c.dependencies),Mc|=d.lanes,!(y&d.childLanes))return null;if(c!==null&&d.child!==c.child)throw Error(t(153));if(d.child!==null){for(c=d.child,y=pu(c,c.pendingProps),d.child=y,y.return=d;c.sibling!==null;)c=c.sibling,y=y.sibling=pu(c,c.pendingProps),y.return=d;y.sibling=null}return d.child}function BG(c,d,y){switch(d.tag){case 3:zR(d),Vh();break;case 5:sR(d);break;case 1:oi(d.type)&&uw(d);break;case 4:cC(d,d.stateNode.containerInfo);break;case 10:var S=d.type._context,F=d.memoizedProps.value;Ln(gw,S._currentValue),S._currentValue=F;break;case 13:if(S=d.memoizedState,S!==null)return S.dehydrated!==null?(Ln(er,er.current&1),d.flags|=128,null):y&d.child.childLanes?VR(c,d,y):(Ln(er,er.current&1),c=al(c,d,y),c!==null?c.sibling:null);Ln(er,er.current&1);break;case 19:if(S=(y&d.childLanes)!==0,c.flags&128){if(S)return GR(c,d,y);d.flags|=128}if(F=d.memoizedState,F!==null&&(F.rendering=null,F.tail=null,F.lastEffect=null),Ln(er,er.current),S)break;return null;case 22:case 23:return d.lanes=0,MR(c,d,y)}return al(c,d,y)}var HR,OC,jR,KR;HR=function(c,d){for(var y=d.child;y!==null;){if(y.tag===5||y.tag===6)c.appendChild(y.stateNode);else if(y.tag!==4&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===d)break;for(;y.sibling===null;){if(y.return===null||y.return===d)return;y=y.return}y.sibling.return=y.return,y=y.sibling}},OC=function(){},jR=function(c,d,y,S){var F=c.memoizedProps;if(F!==S){c=d.stateNode,Pc(fa.current);var V=null;switch(y){case"input":F=ze(c,F),S=ze(c,S),V=[];break;case"select":F=E({},F,{value:void 0}),S=E({},S,{value:void 0}),V=[];break;case"textarea":F=Ue(c,F),S=Ue(c,S),V=[];break;default:typeof F.onClick!="function"&&typeof S.onClick=="function"&&(c.onclick=ow)}Me(y,S);var X;y=null;for($e in F)if(!S.hasOwnProperty($e)&&F.hasOwnProperty($e)&&F[$e]!=null)if($e==="style"){var re=F[$e];for(X in re)re.hasOwnProperty(X)&&(y||(y={}),y[X]="")}else $e!=="dangerouslySetInnerHTML"&&$e!=="children"&&$e!=="suppressContentEditableWarning"&&$e!=="suppressHydrationWarning"&&$e!=="autoFocus"&&(s.hasOwnProperty($e)?V||(V=[]):(V=V||[]).push($e,null));for($e in S){var le=S[$e];if(re=F!=null?F[$e]:void 0,S.hasOwnProperty($e)&&le!==re&&(le!=null||re!=null))if($e==="style")if(re){for(X in re)!re.hasOwnProperty(X)||le&&le.hasOwnProperty(X)||(y||(y={}),y[X]="");for(X in le)le.hasOwnProperty(X)&&re[X]!==le[X]&&(y||(y={}),y[X]=le[X])}else y||(V||(V=[]),V.push($e,y)),y=le;else $e==="dangerouslySetInnerHTML"?(le=le?le.__html:void 0,re=re?re.__html:void 0,le!=null&&re!==le&&(V=V||[]).push($e,le)):$e==="children"?typeof le!="string"&&typeof le!="number"||(V=V||[]).push($e,""+le):$e!=="suppressContentEditableWarning"&&$e!=="suppressHydrationWarning"&&(s.hasOwnProperty($e)?(le!=null&&$e==="onScroll"&&Vn("scroll",c),V||re===le||(V=[])):(V=V||[]).push($e,le))}y&&(V=V||[]).push("style",y);var $e=V;(d.updateQueue=$e)&&(d.flags|=4)}},KR=function(c,d,y,S){y!==S&&(d.flags|=4)};function Lg(c,d){if(!Qn)switch(c.tailMode){case"hidden":d=c.tail;for(var y=null;d!==null;)d.alternate!==null&&(y=d),d=d.sibling;y===null?c.tail=null:y.sibling=null;break;case"collapsed":y=c.tail;for(var S=null;y!==null;)y.alternate!==null&&(S=y),y=y.sibling;S===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:S.sibling=null}}function ks(c){var d=c.alternate!==null&&c.alternate.child===c.child,y=0,S=0;if(d)for(var F=c.child;F!==null;)y|=F.lanes|F.childLanes,S|=F.subtreeFlags&14680064,S|=F.flags&14680064,F.return=c,F=F.sibling;else for(F=c.child;F!==null;)y|=F.lanes|F.childLanes,S|=F.subtreeFlags,S|=F.flags,F.return=c,F=F.sibling;return c.subtreeFlags|=S,c.childLanes=y,d}function zG(c,d,y){var S=d.pendingProps;switch(eC(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ks(d),null;case 1:return oi(d.type)&&lw(),ks(d),null;case 3:return S=d.stateNode,jh(),Wn(ii),Wn(Ss),dC(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(c===null||c.child===null)&&(dw(d)?d.flags|=4:c===null||c.memoizedState.isDehydrated&&!(d.flags&256)||(d.flags|=1024,To!==null&&(WC(To),To=null))),OC(c,d),ks(d),null;case 5:fC(d);var F=Pc(Dg.current);if(y=d.type,c!==null&&d.stateNode!=null)jR(c,d,y,S,F),c.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!S){if(d.stateNode===null)throw Error(t(166));return ks(d),null}if(c=Pc(fa.current),dw(d)){S=d.stateNode,y=d.type;var V=d.memoizedProps;switch(S[ca]=d,S[Tg]=V,c=(d.mode&1)!==0,y){case"dialog":Vn("cancel",S),Vn("close",S);break;case"iframe":case"object":case"embed":Vn("load",S);break;case"video":case"audio":for(F=0;F<Ig.length;F++)Vn(Ig[F],S);break;case"source":Vn("error",S);break;case"img":case"image":case"link":Vn("error",S),Vn("load",S);break;case"details":Vn("toggle",S);break;case"input":Re(S,V),Vn("invalid",S);break;case"select":S._wrapperState={wasMultiple:!!V.multiple},Vn("invalid",S);break;case"textarea":Vt(S,V),Vn("invalid",S)}Me(y,V),F=null;for(var X in V)if(V.hasOwnProperty(X)){var re=V[X];X==="children"?typeof re=="string"?S.textContent!==re&&(V.suppressHydrationWarning!==!0&&iw(S.textContent,re,c),F=["children",re]):typeof re=="number"&&S.textContent!==""+re&&(V.suppressHydrationWarning!==!0&&iw(S.textContent,re,c),F=["children",""+re]):s.hasOwnProperty(X)&&re!=null&&X==="onScroll"&&Vn("scroll",S)}switch(y){case"input":ne(S),Xe(S,V,!0);break;case"textarea":ne(S),St(S);break;case"select":case"option":break;default:typeof V.onClick=="function"&&(S.onclick=ow)}S=F,d.updateQueue=S,S!==null&&(d.flags|=4)}else{X=F.nodeType===9?F:F.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Dn(y)),c==="http://www.w3.org/1999/xhtml"?y==="script"?(c=X.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof S.is=="string"?c=X.createElement(y,{is:S.is}):(c=X.createElement(y),y==="select"&&(X=c,S.multiple?X.multiple=!0:S.size&&(X.size=S.size))):c=X.createElementNS(c,y),c[ca]=d,c[Tg]=S,HR(c,d,!1,!1),d.stateNode=c;e:{switch(X=Ze(y,S),y){case"dialog":Vn("cancel",c),Vn("close",c),F=S;break;case"iframe":case"object":case"embed":Vn("load",c),F=S;break;case"video":case"audio":for(F=0;F<Ig.length;F++)Vn(Ig[F],c);F=S;break;case"source":Vn("error",c),F=S;break;case"img":case"image":case"link":Vn("error",c),Vn("load",c),F=S;break;case"details":Vn("toggle",c),F=S;break;case"input":Re(c,S),F=ze(c,S),Vn("invalid",c);break;case"option":F=S;break;case"select":c._wrapperState={wasMultiple:!!S.multiple},F=E({},S,{value:void 0}),Vn("invalid",c);break;case"textarea":Vt(c,S),F=Ue(c,S),Vn("invalid",c);break;default:F=S}Me(y,F),re=F;for(V in re)if(re.hasOwnProperty(V)){var le=re[V];V==="style"?Ye(c,le):V==="dangerouslySetInnerHTML"?(le=le?le.__html:void 0,le!=null&&G(c,le)):V==="children"?typeof le=="string"?(y!=="textarea"||le!=="")&&Z(c,le):typeof le=="number"&&Z(c,""+le):V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&V!=="autoFocus"&&(s.hasOwnProperty(V)?le!=null&&V==="onScroll"&&Vn("scroll",c):le!=null&&$(c,V,le,X))}switch(y){case"input":ne(c),Xe(c,S,!1);break;case"textarea":ne(c),St(c);break;case"option":S.value!=null&&c.setAttribute("value",""+ge(S.value));break;case"select":c.multiple=!!S.multiple,V=S.value,V!=null?mt(c,!!S.multiple,V,!1):S.defaultValue!=null&&mt(c,!!S.multiple,S.defaultValue,!0);break;default:typeof F.onClick=="function"&&(c.onclick=ow)}switch(y){case"button":case"input":case"select":case"textarea":S=!!S.autoFocus;break e;case"img":S=!0;break e;default:S=!1}}S&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return ks(d),null;case 6:if(c&&d.stateNode!=null)KR(c,d,c.memoizedProps,S);else{if(typeof S!="string"&&d.stateNode===null)throw Error(t(166));if(y=Pc(Dg.current),Pc(fa.current),dw(d)){if(S=d.stateNode,y=d.memoizedProps,S[ca]=d,(V=S.nodeValue!==y)&&(c=Ii,c!==null))switch(c.tag){case 3:iw(S.nodeValue,y,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&iw(S.nodeValue,y,(c.mode&1)!==0)}V&&(d.flags|=4)}else S=(y.nodeType===9?y:y.ownerDocument).createTextNode(S),S[ca]=d,d.stateNode=S}return ks(d),null;case 13:if(Wn(er),S=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Qn&&Ei!==null&&d.mode&1&&!(d.flags&128))Q$(),Vh(),d.flags|=98560,V=!1;else if(V=dw(d),S!==null&&S.dehydrated!==null){if(c===null){if(!V)throw Error(t(318));if(V=d.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(t(317));V[ca]=d}else Vh(),!(d.flags&128)&&(d.memoizedState=null),d.flags|=4;ks(d),V=!1}else To!==null&&(WC(To),To=null),V=!0;if(!V)return d.flags&65536?d:null}return d.flags&128?(d.lanes=y,d):(S=S!==null,S!==(c!==null&&c.memoizedState!==null)&&S&&(d.child.flags|=8192,d.mode&1&&(c===null||er.current&1?Br===0&&(Br=3):jC())),d.updateQueue!==null&&(d.flags|=4),ks(d),null);case 4:return jh(),OC(c,d),c===null&&Eg(d.stateNode.containerInfo),ks(d),null;case 10:return oC(d.type._context),ks(d),null;case 17:return oi(d.type)&&lw(),ks(d),null;case 19:if(Wn(er),V=d.memoizedState,V===null)return ks(d),null;if(S=(d.flags&128)!==0,X=V.rendering,X===null)if(S)Lg(V,!1);else{if(Br!==0||c!==null&&c.flags&128)for(c=d.child;c!==null;){if(X=xw(c),X!==null){for(d.flags|=128,Lg(V,!1),S=X.updateQueue,S!==null&&(d.updateQueue=S,d.flags|=4),d.subtreeFlags=0,S=y,y=d.child;y!==null;)V=y,c=S,V.flags&=14680066,X=V.alternate,X===null?(V.childLanes=0,V.lanes=c,V.child=null,V.subtreeFlags=0,V.memoizedProps=null,V.memoizedState=null,V.updateQueue=null,V.dependencies=null,V.stateNode=null):(V.childLanes=X.childLanes,V.lanes=X.lanes,V.child=X.child,V.subtreeFlags=0,V.deletions=null,V.memoizedProps=X.memoizedProps,V.memoizedState=X.memoizedState,V.updateQueue=X.updateQueue,V.type=X.type,c=X.dependencies,V.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),y=y.sibling;return Ln(er,er.current&1|2),d.child}c=c.sibling}V.tail!==null&&En()>Qh&&(d.flags|=128,S=!0,Lg(V,!1),d.lanes=4194304)}else{if(!S)if(c=xw(X),c!==null){if(d.flags|=128,S=!0,y=c.updateQueue,y!==null&&(d.updateQueue=y,d.flags|=4),Lg(V,!0),V.tail===null&&V.tailMode==="hidden"&&!X.alternate&&!Qn)return ks(d),null}else 2*En()-V.renderingStartTime>Qh&&y!==1073741824&&(d.flags|=128,S=!0,Lg(V,!1),d.lanes=4194304);V.isBackwards?(X.sibling=d.child,d.child=X):(y=V.last,y!==null?y.sibling=X:d.child=X,V.last=X)}return V.tail!==null?(d=V.tail,V.rendering=d,V.tail=d.sibling,V.renderingStartTime=En(),d.sibling=null,y=er.current,Ln(er,S?y&1|2:y&1),d):(ks(d),null);case 22:case 23:return HC(),S=d.memoizedState!==null,c!==null&&c.memoizedState!==null!==S&&(d.flags|=8192),S&&d.mode&1?Ai&1073741824&&(ks(d),d.subtreeFlags&6&&(d.flags|=8192)):ks(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function UG(c,d){switch(eC(d),d.tag){case 1:return oi(d.type)&&lw(),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return jh(),Wn(ii),Wn(Ss),dC(),c=d.flags,c&65536&&!(c&128)?(d.flags=c&-65537|128,d):null;case 5:return fC(d),null;case 13:if(Wn(er),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(t(340));Vh()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return Wn(er),null;case 4:return jh(),null;case 10:return oC(d.type._context),null;case 22:case 23:return HC(),null;case 24:return null;default:return null}}var Tw=!1,Is=!1,VG=typeof WeakSet=="function"?WeakSet:Set,ct=null;function qh(c,d){var y=c.ref;if(y!==null)if(typeof y=="function")try{y(null)}catch(S){or(c,d,S)}else y.current=null}function DC(c,d,y){try{y()}catch(S){or(c,d,S)}}var qR=!1;function WG(c,d){if(HS=me,c=E$(),MS(c)){if("selectionStart"in c)var y={start:c.selectionStart,end:c.selectionEnd};else e:{y=(y=c.ownerDocument)&&y.defaultView||window;var S=y.getSelection&&y.getSelection();if(S&&S.rangeCount!==0){y=S.anchorNode;var F=S.anchorOffset,V=S.focusNode;S=S.focusOffset;try{y.nodeType,V.nodeType}catch{y=null;break e}var X=0,re=-1,le=-1,$e=0,Ge=0,Qe=c,We=null;t:for(;;){for(var lt;Qe!==y||F!==0&&Qe.nodeType!==3||(re=X+F),Qe!==V||S!==0&&Qe.nodeType!==3||(le=X+S),Qe.nodeType===3&&(X+=Qe.nodeValue.length),(lt=Qe.firstChild)!==null;)We=Qe,Qe=lt;for(;;){if(Qe===c)break t;if(We===y&&++$e===F&&(re=X),We===V&&++Ge===S&&(le=X),(lt=Qe.nextSibling)!==null)break;Qe=We,We=Qe.parentNode}Qe=lt}y=re===-1||le===-1?null:{start:re,end:le}}else y=null}y=y||{start:0,end:0}}else y=null;for(jS={focusedElem:c,selectionRange:y},me=!1,ct=d;ct!==null;)if(d=ct,c=d.child,(d.subtreeFlags&1028)!==0&&c!==null)c.return=d,ct=c;else for(;ct!==null;){d=ct;try{var pt=d.alternate;if(d.flags&1024)switch(d.tag){case 0:case 11:case 15:break;case 1:if(pt!==null){var yt=pt.memoizedProps,xr=pt.memoizedState,ve=d.stateNode,de=ve.getSnapshotBeforeUpdate(d.elementType===d.type?yt:No(d.type,yt),xr);ve.__reactInternalSnapshotBeforeUpdate=de}break;case 3:var Ee=d.stateNode.containerInfo;Ee.nodeType===1?Ee.textContent="":Ee.nodeType===9&&Ee.documentElement&&Ee.removeChild(Ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){or(d,d.return,Je)}if(c=d.sibling,c!==null){c.return=d.return,ct=c;break}ct=d.return}return pt=qR,qR=!1,pt}function Bg(c,d,y){var S=d.updateQueue;if(S=S!==null?S.lastEffect:null,S!==null){var F=S=S.next;do{if((F.tag&c)===c){var V=F.destroy;F.destroy=void 0,V!==void 0&&DC(d,y,V)}F=F.next}while(F!==S)}}function Nw(c,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var y=d=d.next;do{if((y.tag&c)===c){var S=y.create;y.destroy=S()}y=y.next}while(y!==d)}}function _C(c){var d=c.ref;if(d!==null){var y=c.stateNode;switch(c.tag){case 5:c=y;break;default:c=y}typeof d=="function"?d(c):d.current=c}}function XR(c){var d=c.alternate;d!==null&&(c.alternate=null,XR(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&(delete d[ca],delete d[Tg],delete d[QS],delete d[IG],delete d[EG])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function QR(c){return c.tag===5||c.tag===3||c.tag===4}function YR(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||QR(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function PC(c,d,y){var S=c.tag;if(S===5||S===6)c=c.stateNode,d?y.nodeType===8?y.parentNode.insertBefore(c,d):y.insertBefore(c,d):(y.nodeType===8?(d=y.parentNode,d.insertBefore(c,y)):(d=y,d.appendChild(c)),y=y._reactRootContainer,y!=null||d.onclick!==null||(d.onclick=ow));else if(S!==4&&(c=c.child,c!==null))for(PC(c,d,y),c=c.sibling;c!==null;)PC(c,d,y),c=c.sibling}function FC(c,d,y){var S=c.tag;if(S===5||S===6)c=c.stateNode,d?y.insertBefore(c,d):y.appendChild(c);else if(S!==4&&(c=c.child,c!==null))for(FC(c,d,y),c=c.sibling;c!==null;)FC(c,d,y),c=c.sibling}var is=null,$o=!1;function uu(c,d,y){for(y=y.child;y!==null;)JR(c,d,y),y=y.sibling}function JR(c,d,y){if(xs&&typeof xs.onCommitFiberUnmount=="function")try{xs.onCommitFiberUnmount(sa,y)}catch{}switch(y.tag){case 5:Is||qh(y,d);case 6:var S=is,F=$o;is=null,uu(c,d,y),is=S,$o=F,is!==null&&($o?(c=is,y=y.stateNode,c.nodeType===8?c.parentNode.removeChild(y):c.removeChild(y)):is.removeChild(y.stateNode));break;case 18:is!==null&&($o?(c=is,y=y.stateNode,c.nodeType===8?XS(c.parentNode,y):c.nodeType===1&&XS(c,y),Nc(c)):XS(is,y.stateNode));break;case 4:S=is,F=$o,is=y.stateNode.containerInfo,$o=!0,uu(c,d,y),is=S,$o=F;break;case 0:case 11:case 14:case 15:if(!Is&&(S=y.updateQueue,S!==null&&(S=S.lastEffect,S!==null))){F=S=S.next;do{var V=F,X=V.destroy;V=V.tag,X!==void 0&&(V&2||V&4)&&DC(y,d,X),F=F.next}while(F!==S)}uu(c,d,y);break;case 1:if(!Is&&(qh(y,d),S=y.stateNode,typeof S.componentWillUnmount=="function"))try{S.props=y.memoizedProps,S.state=y.memoizedState,S.componentWillUnmount()}catch(re){or(y,d,re)}uu(c,d,y);break;case 21:uu(c,d,y);break;case 22:y.mode&1?(Is=(S=Is)||y.memoizedState!==null,uu(c,d,y),Is=S):uu(c,d,y);break;default:uu(c,d,y)}}function ZR(c){var d=c.updateQueue;if(d!==null){c.updateQueue=null;var y=c.stateNode;y===null&&(y=c.stateNode=new VG),d.forEach(function(S){var F=JG.bind(null,c,S);y.has(S)||(y.add(S),S.then(F,F))})}}function Ro(c,d){var y=d.deletions;if(y!==null)for(var S=0;S<y.length;S++){var F=y[S];try{var V=c,X=d,re=X;e:for(;re!==null;){switch(re.tag){case 5:is=re.stateNode,$o=!1;break e;case 3:is=re.stateNode.containerInfo,$o=!0;break e;case 4:is=re.stateNode.containerInfo,$o=!0;break e}re=re.return}if(is===null)throw Error(t(160));JR(V,X,F),is=null,$o=!1;var le=F.alternate;le!==null&&(le.return=null),F.return=null}catch($e){or(F,d,$e)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)eO(d,c),d=d.sibling}function eO(c,d){var y=c.alternate,S=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Ro(d,c),da(c),S&4){try{Bg(3,c,c.return),Nw(3,c)}catch(yt){or(c,c.return,yt)}try{Bg(5,c,c.return)}catch(yt){or(c,c.return,yt)}}break;case 1:Ro(d,c),da(c),S&512&&y!==null&&qh(y,y.return);break;case 5:if(Ro(d,c),da(c),S&512&&y!==null&&qh(y,y.return),c.flags&32){var F=c.stateNode;try{Z(F,"")}catch(yt){or(c,c.return,yt)}}if(S&4&&(F=c.stateNode,F!=null)){var V=c.memoizedProps,X=y!==null?y.memoizedProps:V,re=c.type,le=c.updateQueue;if(c.updateQueue=null,le!==null)try{re==="input"&&V.type==="radio"&&V.name!=null&&Ke(F,V),Ze(re,X);var $e=Ze(re,V);for(X=0;X<le.length;X+=2){var Ge=le[X],Qe=le[X+1];Ge==="style"?Ye(F,Qe):Ge==="dangerouslySetInnerHTML"?G(F,Qe):Ge==="children"?Z(F,Qe):$(F,Ge,Qe,$e)}switch(re){case"input":tt(F,V);break;case"textarea":At(F,V);break;case"select":var We=F._wrapperState.wasMultiple;F._wrapperState.wasMultiple=!!V.multiple;var lt=V.value;lt!=null?mt(F,!!V.multiple,lt,!1):We!==!!V.multiple&&(V.defaultValue!=null?mt(F,!!V.multiple,V.defaultValue,!0):mt(F,!!V.multiple,V.multiple?[]:"",!1))}F[Tg]=V}catch(yt){or(c,c.return,yt)}}break;case 6:if(Ro(d,c),da(c),S&4){if(c.stateNode===null)throw Error(t(162));F=c.stateNode,V=c.memoizedProps;try{F.nodeValue=V}catch(yt){or(c,c.return,yt)}}break;case 3:if(Ro(d,c),da(c),S&4&&y!==null&&y.memoizedState.isDehydrated)try{Nc(d.containerInfo)}catch(yt){or(c,c.return,yt)}break;case 4:Ro(d,c),da(c);break;case 13:Ro(d,c),da(c),F=c.child,F.flags&8192&&(V=F.memoizedState!==null,F.stateNode.isHidden=V,!V||F.alternate!==null&&F.alternate.memoizedState!==null||(BC=En())),S&4&&ZR(c);break;case 22:if(Ge=y!==null&&y.memoizedState!==null,c.mode&1?(Is=($e=Is)||Ge,Ro(d,c),Is=$e):Ro(d,c),da(c),S&8192){if($e=c.memoizedState!==null,(c.stateNode.isHidden=$e)&&!Ge&&c.mode&1)for(ct=c,Ge=c.child;Ge!==null;){for(Qe=ct=Ge;ct!==null;){switch(We=ct,lt=We.child,We.tag){case 0:case 11:case 14:case 15:Bg(4,We,We.return);break;case 1:qh(We,We.return);var pt=We.stateNode;if(typeof pt.componentWillUnmount=="function"){S=We,y=We.return;try{d=S,pt.props=d.memoizedProps,pt.state=d.memoizedState,pt.componentWillUnmount()}catch(yt){or(S,y,yt)}}break;case 5:qh(We,We.return);break;case 22:if(We.memoizedState!==null){rO(Qe);continue}}lt!==null?(lt.return=We,ct=lt):rO(Qe)}Ge=Ge.sibling}e:for(Ge=null,Qe=c;;){if(Qe.tag===5){if(Ge===null){Ge=Qe;try{F=Qe.stateNode,$e?(V=F.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none"):(re=Qe.stateNode,le=Qe.memoizedProps.style,X=le!=null&&le.hasOwnProperty("display")?le.display:null,re.style.display=Ne("display",X))}catch(yt){or(c,c.return,yt)}}}else if(Qe.tag===6){if(Ge===null)try{Qe.stateNode.nodeValue=$e?"":Qe.memoizedProps}catch(yt){or(c,c.return,yt)}}else if((Qe.tag!==22&&Qe.tag!==23||Qe.memoizedState===null||Qe===c)&&Qe.child!==null){Qe.child.return=Qe,Qe=Qe.child;continue}if(Qe===c)break e;for(;Qe.sibling===null;){if(Qe.return===null||Qe.return===c)break e;Ge===Qe&&(Ge=null),Qe=Qe.return}Ge===Qe&&(Ge=null),Qe.sibling.return=Qe.return,Qe=Qe.sibling}}break;case 19:Ro(d,c),da(c),S&4&&ZR(c);break;case 21:break;default:Ro(d,c),da(c)}}function da(c){var d=c.flags;if(d&2){try{e:{for(var y=c.return;y!==null;){if(QR(y)){var S=y;break e}y=y.return}throw Error(t(160))}switch(S.tag){case 5:var F=S.stateNode;S.flags&32&&(Z(F,""),S.flags&=-33);var V=YR(c);FC(c,V,F);break;case 3:case 4:var X=S.stateNode.containerInfo,re=YR(c);PC(c,re,X);break;default:throw Error(t(161))}}catch(le){or(c,c.return,le)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function GG(c,d,y){ct=c,tO(c)}function tO(c,d,y){for(var S=(c.mode&1)!==0;ct!==null;){var F=ct,V=F.child;if(F.tag===22&&S){var X=F.memoizedState!==null||Tw;if(!X){var re=F.alternate,le=re!==null&&re.memoizedState!==null||Is;re=Tw;var $e=Is;if(Tw=X,(Is=le)&&!$e)for(ct=F;ct!==null;)X=ct,le=X.child,X.tag===22&&X.memoizedState!==null?sO(F):le!==null?(le.return=X,ct=le):sO(F);for(;V!==null;)ct=V,tO(V),V=V.sibling;ct=F,Tw=re,Is=$e}nO(c)}else F.subtreeFlags&8772&&V!==null?(V.return=F,ct=V):nO(c)}}function nO(c){for(;ct!==null;){var d=ct;if(d.flags&8772){var y=d.alternate;try{if(d.flags&8772)switch(d.tag){case 0:case 11:case 15:Is||Nw(5,d);break;case 1:var S=d.stateNode;if(d.flags&4&&!Is)if(y===null)S.componentDidMount();else{var F=d.elementType===d.type?y.memoizedProps:No(d.type,y.memoizedProps);S.componentDidUpdate(F,y.memoizedState,S.__reactInternalSnapshotBeforeUpdate)}var V=d.updateQueue;V!==null&&rR(d,V,S);break;case 3:var X=d.updateQueue;if(X!==null){if(y=null,d.child!==null)switch(d.child.tag){case 5:y=d.child.stateNode;break;case 1:y=d.child.stateNode}rR(d,X,y)}break;case 5:var re=d.stateNode;if(y===null&&d.flags&4){y=re;var le=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":le.autoFocus&&y.focus();break;case"img":le.src&&(y.src=le.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var $e=d.alternate;if($e!==null){var Ge=$e.memoizedState;if(Ge!==null){var Qe=Ge.dehydrated;Qe!==null&&Nc(Qe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Is||d.flags&512&&_C(d)}catch(We){or(d,d.return,We)}}if(d===c){ct=null;break}if(y=d.sibling,y!==null){y.return=d.return,ct=y;break}ct=d.return}}function rO(c){for(;ct!==null;){var d=ct;if(d===c){ct=null;break}var y=d.sibling;if(y!==null){y.return=d.return,ct=y;break}ct=d.return}}function sO(c){for(;ct!==null;){var d=ct;try{switch(d.tag){case 0:case 11:case 15:var y=d.return;try{Nw(4,d)}catch(le){or(d,y,le)}break;case 1:var S=d.stateNode;if(typeof S.componentDidMount=="function"){var F=d.return;try{S.componentDidMount()}catch(le){or(d,F,le)}}var V=d.return;try{_C(d)}catch(le){or(d,V,le)}break;case 5:var X=d.return;try{_C(d)}catch(le){or(d,X,le)}}}catch(le){or(d,d.return,le)}if(d===c){ct=null;break}var re=d.sibling;if(re!==null){re.return=d.return,ct=re;break}ct=d.return}}var HG=Math.ceil,$w=k.ReactCurrentDispatcher,MC=k.ReactCurrentOwner,qi=k.ReactCurrentBatchConfig,en=0,Kr=null,Ar=null,os=0,Ai=0,Xh=su(0),Br=0,zg=null,Mc=0,Rw=0,LC=0,Ug=null,li=null,BC=0,Qh=1/0,ll=null,Ow=!1,zC=null,cu=null,Dw=!1,fu=null,_w=0,Vg=0,UC=null,Pw=-1,Fw=0;function Vs(){return en&6?En():Pw!==-1?Pw:Pw=En()}function hu(c){return c.mode&1?en&2&&os!==0?os&-os:TG.transition!==null?(Fw===0&&(Fw=Ky()),Fw):(c=Yt,c!==0||(c=window.event,c=c===void 0?16:yr(c.type)),c):1}function Oo(c,d,y,S){if(50<Vg)throw Vg=0,UC=null,Error(t(185));Ec(c,y,S),(!(en&2)||c!==Kr)&&(c===Kr&&(!(en&2)&&(Rw|=y),Br===4&&du(c,os)),ui(c,S),y===1&&en===0&&!(d.mode&1)&&(Qh=En()+500,cw&&ou()))}function ui(c,d){var y=c.callbackNode;TS(c,d);var S=Ic(c,c===Kr?os:0);if(S===0)y!==null&&ri(y),c.callbackNode=null,c.callbackPriority=0;else if(d=S&-S,c.callbackPriority!==d){if(y!=null&&ri(y),d===1)c.tag===0?AG(oO.bind(null,c)):H$(oO.bind(null,c)),CG(function(){!(en&6)&&ou()}),y=null;else{switch(el(S)){case 1:y=Za;break;case 4:y=Co;break;case 16:y=ra;break;case 536870912:y=Bs;break;default:y=ra}y=pO(y,iO.bind(null,c))}c.callbackPriority=d,c.callbackNode=y}}function iO(c,d){if(Pw=-1,Fw=0,en&6)throw Error(t(327));var y=c.callbackNode;if(Yh()&&c.callbackNode!==y)return null;var S=Ic(c,c===Kr?os:0);if(S===0)return null;if(S&30||S&c.expiredLanes||d)d=Mw(c,S);else{d=S;var F=en;en|=2;var V=lO();(Kr!==c||os!==d)&&(ll=null,Qh=En()+500,Bc(c,d));do try{qG();break}catch(re){aO(c,re)}while(!0);iC(),$w.current=V,en=F,Ar!==null?d=0:(Kr=null,os=0,d=Br)}if(d!==0){if(d===2&&(F=dg(c),F!==0&&(S=F,d=VC(c,F))),d===1)throw y=zg,Bc(c,0),du(c,S),ui(c,En()),y;if(d===6)du(c,S);else{if(F=c.current.alternate,!(S&30)&&!jG(F)&&(d=Mw(c,S),d===2&&(V=dg(c),V!==0&&(S=V,d=VC(c,V))),d===1))throw y=zg,Bc(c,0),du(c,S),ui(c,En()),y;switch(c.finishedWork=F,c.finishedLanes=S,d){case 0:case 1:throw Error(t(345));case 2:zc(c,li,ll);break;case 3:if(du(c,S),(S&130023424)===S&&(d=BC+500-En(),10<d)){if(Ic(c,0)!==0)break;if(F=c.suspendedLanes,(F&S)!==S){Vs(),c.pingedLanes|=c.suspendedLanes&F;break}c.timeoutHandle=qS(zc.bind(null,c,li,ll),d);break}zc(c,li,ll);break;case 4:if(du(c,S),(S&4194240)===S)break;for(d=c.eventTimes,F=-1;0<S;){var X=31-ki(S);V=1<<X,X=d[X],X>F&&(F=X),S&=~V}if(S=F,S=En()-S,S=(120>S?120:480>S?480:1080>S?1080:1920>S?1920:3e3>S?3e3:4320>S?4320:1960*HG(S/1960))-S,10<S){c.timeoutHandle=qS(zc.bind(null,c,li,ll),S);break}zc(c,li,ll);break;case 5:zc(c,li,ll);break;default:throw Error(t(329))}}}return ui(c,En()),c.callbackNode===y?iO.bind(null,c):null}function VC(c,d){var y=Ug;return c.current.memoizedState.isDehydrated&&(Bc(c,d).flags|=256),c=Mw(c,d),c!==2&&(d=li,li=y,d!==null&&WC(d)),c}function WC(c){li===null?li=c:li.push.apply(li,c)}function jG(c){for(var d=c;;){if(d.flags&16384){var y=d.updateQueue;if(y!==null&&(y=y.stores,y!==null))for(var S=0;S<y.length;S++){var F=y[S],V=F.getSnapshot;F=F.value;try{if(!Ao(V(),F))return!1}catch{return!1}}}if(y=d.child,d.subtreeFlags&16384&&y!==null)y.return=d,d=y;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function du(c,d){for(d&=~LC,d&=~Rw,c.suspendedLanes|=d,c.pingedLanes&=~d,c=c.expirationTimes;0<d;){var y=31-ki(d),S=1<<y;c[y]=-1,d&=~S}}function oO(c){if(en&6)throw Error(t(327));Yh();var d=Ic(c,0);if(!(d&1))return ui(c,En()),null;var y=Mw(c,d);if(c.tag!==0&&y===2){var S=dg(c);S!==0&&(d=S,y=VC(c,S))}if(y===1)throw y=zg,Bc(c,0),du(c,d),ui(c,En()),y;if(y===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=d,zc(c,li,ll),ui(c,En()),null}function GC(c,d){var y=en;en|=1;try{return c(d)}finally{en=y,en===0&&(Qh=En()+500,cw&&ou())}}function Lc(c){fu!==null&&fu.tag===0&&!(en&6)&&Yh();var d=en;en|=1;var y=qi.transition,S=Yt;try{if(qi.transition=null,Yt=1,c)return c()}finally{Yt=S,qi.transition=y,en=d,!(en&6)&&ou()}}function HC(){Ai=Xh.current,Wn(Xh)}function Bc(c,d){c.finishedWork=null,c.finishedLanes=0;var y=c.timeoutHandle;if(y!==-1&&(c.timeoutHandle=-1,SG(y)),Ar!==null)for(y=Ar.return;y!==null;){var S=y;switch(eC(S),S.tag){case 1:S=S.type.childContextTypes,S!=null&&lw();break;case 3:jh(),Wn(ii),Wn(Ss),dC();break;case 5:fC(S);break;case 4:jh();break;case 13:Wn(er);break;case 19:Wn(er);break;case 10:oC(S.type._context);break;case 22:case 23:HC()}y=y.return}if(Kr=c,Ar=c=pu(c.current,null),os=Ai=d,Br=0,zg=null,LC=Rw=Mc=0,li=Ug=null,_c!==null){for(d=0;d<_c.length;d++)if(y=_c[d],S=y.interleaved,S!==null){y.interleaved=null;var F=S.next,V=y.pending;if(V!==null){var X=V.next;V.next=F,S.next=X}y.pending=S}_c=null}return c}function aO(c,d){do{var y=Ar;try{if(iC(),bw.current=kw,vw){for(var S=tr.memoizedState;S!==null;){var F=S.queue;F!==null&&(F.pending=null),S=S.next}vw=!1}if(Fc=0,jr=Lr=tr=null,_g=!1,Pg=0,MC.current=null,y===null||y.return===null){Br=1,zg=d,Ar=null;break}e:{var V=c,X=y.return,re=y,le=d;if(d=os,re.flags|=32768,le!==null&&typeof le=="object"&&typeof le.then=="function"){var $e=le,Ge=re,Qe=Ge.tag;if(!(Ge.mode&1)&&(Qe===0||Qe===11||Qe===15)){var We=Ge.alternate;We?(Ge.updateQueue=We.updateQueue,Ge.memoizedState=We.memoizedState,Ge.lanes=We.lanes):(Ge.updateQueue=null,Ge.memoizedState=null)}var lt=OR(X);if(lt!==null){lt.flags&=-257,DR(lt,X,re,V,d),lt.mode&1&&RR(V,$e,d),d=lt,le=$e;var pt=d.updateQueue;if(pt===null){var yt=new Set;yt.add(le),d.updateQueue=yt}else pt.add(le);break e}else{if(!(d&1)){RR(V,$e,d),jC();break e}le=Error(t(426))}}else if(Qn&&re.mode&1){var xr=OR(X);if(xr!==null){!(xr.flags&65536)&&(xr.flags|=256),DR(xr,X,re,V,d),rC(Kh(le,re));break e}}V=le=Kh(le,re),Br!==4&&(Br=2),Ug===null?Ug=[V]:Ug.push(V),V=X;do{switch(V.tag){case 3:V.flags|=65536,d&=-d,V.lanes|=d;var ve=NR(V,le,d);nR(V,ve);break e;case 1:re=le;var de=V.type,Ee=V.stateNode;if(!(V.flags&128)&&(typeof de.getDerivedStateFromError=="function"||Ee!==null&&typeof Ee.componentDidCatch=="function"&&(cu===null||!cu.has(Ee)))){V.flags|=65536,d&=-d,V.lanes|=d;var Je=$R(V,re,d);nR(V,Je);break e}}V=V.return}while(V!==null)}cO(y)}catch(xt){d=xt,Ar===y&&y!==null&&(Ar=y=y.return);continue}break}while(!0)}function lO(){var c=$w.current;return $w.current=kw,c===null?kw:c}function jC(){(Br===0||Br===3||Br===2)&&(Br=4),Kr===null||!(Mc&268435455)&&!(Rw&268435455)||du(Kr,os)}function Mw(c,d){var y=en;en|=2;var S=lO();(Kr!==c||os!==d)&&(ll=null,Bc(c,d));do try{KG();break}catch(F){aO(c,F)}while(!0);if(iC(),en=y,$w.current=S,Ar!==null)throw Error(t(261));return Kr=null,os=0,Br}function KG(){for(;Ar!==null;)uO(Ar)}function qG(){for(;Ar!==null&&!bc();)uO(Ar)}function uO(c){var d=dO(c.alternate,c,Ai);c.memoizedProps=c.pendingProps,d===null?cO(c):Ar=d,MC.current=null}function cO(c){var d=c;do{var y=d.alternate;if(c=d.return,d.flags&32768){if(y=UG(y,d),y!==null){y.flags&=32767,Ar=y;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Br=6,Ar=null;return}}else if(y=zG(y,d,Ai),y!==null){Ar=y;return}if(d=d.sibling,d!==null){Ar=d;return}Ar=d=c}while(d!==null);Br===0&&(Br=5)}function zc(c,d,y){var S=Yt,F=qi.transition;try{qi.transition=null,Yt=1,XG(c,d,y,S)}finally{qi.transition=F,Yt=S}return null}function XG(c,d,y,S){do Yh();while(fu!==null);if(en&6)throw Error(t(327));y=c.finishedWork;var F=c.finishedLanes;if(y===null)return null;if(c.finishedWork=null,c.finishedLanes=0,y===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var V=y.lanes|y.childLanes;if(NS(c,V),c===Kr&&(Ar=Kr=null,os=0),!(y.subtreeFlags&2064)&&!(y.flags&2064)||Dw||(Dw=!0,pO(ra,function(){return Yh(),null})),V=(y.flags&15990)!==0,y.subtreeFlags&15990||V){V=qi.transition,qi.transition=null;var X=Yt;Yt=1;var re=en;en|=4,MC.current=null,WG(c,y),eO(y,c),gG(jS),me=!!HS,jS=HS=null,c.current=y,GG(y),vc(),en=re,Yt=X,qi.transition=V}else c.current=y;if(Dw&&(Dw=!1,fu=c,_w=F),V=c.pendingLanes,V===0&&(cu=null),kc(y.stateNode),ui(c,En()),d!==null)for(S=c.onRecoverableError,y=0;y<d.length;y++)F=d[y],S(F.value,{componentStack:F.stack,digest:F.digest});if(Ow)throw Ow=!1,c=zC,zC=null,c;return _w&1&&c.tag!==0&&Yh(),V=c.pendingLanes,V&1?c===UC?Vg++:(Vg=0,UC=c):Vg=0,ou(),null}function Yh(){if(fu!==null){var c=el(_w),d=qi.transition,y=Yt;try{if(qi.transition=null,Yt=16>c?16:c,fu===null)var S=!1;else{if(c=fu,fu=null,_w=0,en&6)throw Error(t(331));var F=en;for(en|=4,ct=c.current;ct!==null;){var V=ct,X=V.child;if(ct.flags&16){var re=V.deletions;if(re!==null){for(var le=0;le<re.length;le++){var $e=re[le];for(ct=$e;ct!==null;){var Ge=ct;switch(Ge.tag){case 0:case 11:case 15:Bg(8,Ge,V)}var Qe=Ge.child;if(Qe!==null)Qe.return=Ge,ct=Qe;else for(;ct!==null;){Ge=ct;var We=Ge.sibling,lt=Ge.return;if(XR(Ge),Ge===$e){ct=null;break}if(We!==null){We.return=lt,ct=We;break}ct=lt}}}var pt=V.alternate;if(pt!==null){var yt=pt.child;if(yt!==null){pt.child=null;do{var xr=yt.sibling;yt.sibling=null,yt=xr}while(yt!==null)}}ct=V}}if(V.subtreeFlags&2064&&X!==null)X.return=V,ct=X;else e:for(;ct!==null;){if(V=ct,V.flags&2048)switch(V.tag){case 0:case 11:case 15:Bg(9,V,V.return)}var ve=V.sibling;if(ve!==null){ve.return=V.return,ct=ve;break e}ct=V.return}}var de=c.current;for(ct=de;ct!==null;){X=ct;var Ee=X.child;if(X.subtreeFlags&2064&&Ee!==null)Ee.return=X,ct=Ee;else e:for(X=de;ct!==null;){if(re=ct,re.flags&2048)try{switch(re.tag){case 0:case 11:case 15:Nw(9,re)}}catch(xt){or(re,re.return,xt)}if(re===X){ct=null;break e}var Je=re.sibling;if(Je!==null){Je.return=re.return,ct=Je;break e}ct=re.return}}if(en=F,ou(),xs&&typeof xs.onPostCommitFiberRoot=="function")try{xs.onPostCommitFiberRoot(sa,c)}catch{}S=!0}return S}finally{Yt=y,qi.transition=d}}return!1}function fO(c,d,y){d=Kh(y,d),d=NR(c,d,1),c=lu(c,d,1),d=Vs(),c!==null&&(Ec(c,1,d),ui(c,d))}function or(c,d,y){if(c.tag===3)fO(c,c,y);else for(;d!==null;){if(d.tag===3){fO(d,c,y);break}else if(d.tag===1){var S=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(cu===null||!cu.has(S))){c=Kh(y,c),c=$R(d,c,1),d=lu(d,c,1),c=Vs(),d!==null&&(Ec(d,1,c),ui(d,c));break}}d=d.return}}function QG(c,d,y){var S=c.pingCache;S!==null&&S.delete(d),d=Vs(),c.pingedLanes|=c.suspendedLanes&y,Kr===c&&(os&y)===y&&(Br===4||Br===3&&(os&130023424)===os&&500>En()-BC?Bc(c,0):LC|=y),ui(c,d)}function hO(c,d){d===0&&(c.mode&1?(d=ia,ia<<=1,!(ia&130023424)&&(ia=4194304)):d=1);var y=Vs();c=il(c,d),c!==null&&(Ec(c,d,y),ui(c,y))}function YG(c){var d=c.memoizedState,y=0;d!==null&&(y=d.retryLane),hO(c,y)}function JG(c,d){var y=0;switch(c.tag){case 13:var S=c.stateNode,F=c.memoizedState;F!==null&&(y=F.retryLane);break;case 19:S=c.stateNode;break;default:throw Error(t(314))}S!==null&&S.delete(d),hO(c,y)}var dO;dO=function(c,d,y){if(c!==null)if(c.memoizedProps!==d.pendingProps||ii.current)ai=!0;else{if(!(c.lanes&y)&&!(d.flags&128))return ai=!1,BG(c,d,y);ai=!!(c.flags&131072)}else ai=!1,Qn&&d.flags&1048576&&j$(d,hw,d.index);switch(d.lanes=0,d.tag){case 2:var S=d.type;Aw(c,d),c=d.pendingProps;var F=Bh(d,Ss.current);Hh(d,y),F=mC(null,d,S,c,F,y);var V=yC();return d.flags|=1,typeof F=="object"&&F!==null&&typeof F.render=="function"&&F.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,oi(S)?(V=!0,uw(d)):V=!1,d.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,uC(d),F.updater=Iw,d.stateNode=F,F._reactInternals=d,CC(d,S,c,y),d=AC(null,d,S,!0,V,y)):(d.tag=0,Qn&&V&&ZS(d),Us(null,d,F,y),d=d.child),d;case 16:S=d.elementType;e:{switch(Aw(c,d),c=d.pendingProps,F=S._init,S=F(S._payload),d.type=S,F=d.tag=e8(S),c=No(S,c),F){case 0:d=EC(null,d,S,c,y);break e;case 1:d=BR(null,d,S,c,y);break e;case 11:d=_R(null,d,S,c,y);break e;case 14:d=PR(null,d,S,No(S.type,c),y);break e}throw Error(t(306,S,""))}return d;case 0:return S=d.type,F=d.pendingProps,F=d.elementType===S?F:No(S,F),EC(c,d,S,F,y);case 1:return S=d.type,F=d.pendingProps,F=d.elementType===S?F:No(S,F),BR(c,d,S,F,y);case 3:e:{if(zR(d),c===null)throw Error(t(387));S=d.pendingProps,V=d.memoizedState,F=V.element,tR(c,d),ww(d,S,null,y);var X=d.memoizedState;if(S=X.element,V.isDehydrated)if(V={element:S,isDehydrated:!1,cache:X.cache,pendingSuspenseBoundaries:X.pendingSuspenseBoundaries,transitions:X.transitions},d.updateQueue.baseState=V,d.memoizedState=V,d.flags&256){F=Kh(Error(t(423)),d),d=UR(c,d,S,y,F);break e}else if(S!==F){F=Kh(Error(t(424)),d),d=UR(c,d,S,y,F);break e}else for(Ei=ru(d.stateNode.containerInfo.firstChild),Ii=d,Qn=!0,To=null,y=Z$(d,null,S,y),d.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(Vh(),S===F){d=al(c,d,y);break e}Us(c,d,S,y)}d=d.child}return d;case 5:return sR(d),c===null&&nC(d),S=d.type,F=d.pendingProps,V=c!==null?c.memoizedProps:null,X=F.children,KS(S,F)?X=null:V!==null&&KS(S,V)&&(d.flags|=32),LR(c,d),Us(c,d,X,y),d.child;case 6:return c===null&&nC(d),null;case 13:return VR(c,d,y);case 4:return cC(d,d.stateNode.containerInfo),S=d.pendingProps,c===null?d.child=Wh(d,null,S,y):Us(c,d,S,y),d.child;case 11:return S=d.type,F=d.pendingProps,F=d.elementType===S?F:No(S,F),_R(c,d,S,F,y);case 7:return Us(c,d,d.pendingProps,y),d.child;case 8:return Us(c,d,d.pendingProps.children,y),d.child;case 12:return Us(c,d,d.pendingProps.children,y),d.child;case 10:e:{if(S=d.type._context,F=d.pendingProps,V=d.memoizedProps,X=F.value,Ln(gw,S._currentValue),S._currentValue=X,V!==null)if(Ao(V.value,X)){if(V.children===F.children&&!ii.current){d=al(c,d,y);break e}}else for(V=d.child,V!==null&&(V.return=d);V!==null;){var re=V.dependencies;if(re!==null){X=V.child;for(var le=re.firstContext;le!==null;){if(le.context===S){if(V.tag===1){le=ol(-1,y&-y),le.tag=2;var $e=V.updateQueue;if($e!==null){$e=$e.shared;var Ge=$e.pending;Ge===null?le.next=le:(le.next=Ge.next,Ge.next=le),$e.pending=le}}V.lanes|=y,le=V.alternate,le!==null&&(le.lanes|=y),aC(V.return,y,d),re.lanes|=y;break}le=le.next}}else if(V.tag===10)X=V.type===d.type?null:V.child;else if(V.tag===18){if(X=V.return,X===null)throw Error(t(341));X.lanes|=y,re=X.alternate,re!==null&&(re.lanes|=y),aC(X,y,d),X=V.sibling}else X=V.child;if(X!==null)X.return=V;else for(X=V;X!==null;){if(X===d){X=null;break}if(V=X.sibling,V!==null){V.return=X.return,X=V;break}X=X.return}V=X}Us(c,d,F.children,y),d=d.child}return d;case 9:return F=d.type,S=d.pendingProps.children,Hh(d,y),F=ji(F),S=S(F),d.flags|=1,Us(c,d,S,y),d.child;case 14:return S=d.type,F=No(S,d.pendingProps),F=No(S.type,F),PR(c,d,S,F,y);case 15:return FR(c,d,d.type,d.pendingProps,y);case 17:return S=d.type,F=d.pendingProps,F=d.elementType===S?F:No(S,F),Aw(c,d),d.tag=1,oi(S)?(c=!0,uw(d)):c=!1,Hh(d,y),AR(d,S,F),CC(d,S,F,y),AC(null,d,S,!0,c,y);case 19:return GR(c,d,y);case 22:return MR(c,d,y)}throw Error(t(156,d.tag))};function pO(c,d){return Yl(c,d)}function ZG(c,d,y,S){this.tag=c,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xi(c,d,y,S){return new ZG(c,d,y,S)}function KC(c){return c=c.prototype,!(!c||!c.isReactComponent)}function e8(c){if(typeof c=="function")return KC(c)?1:0;if(c!=null){if(c=c.$$typeof,c===v)return 11;if(c===D)return 14}return 2}function pu(c,d){var y=c.alternate;return y===null?(y=Xi(c.tag,d,c.key,c.mode),y.elementType=c.elementType,y.type=c.type,y.stateNode=c.stateNode,y.alternate=c,c.alternate=y):(y.pendingProps=d,y.type=c.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=c.flags&14680064,y.childLanes=c.childLanes,y.lanes=c.lanes,y.child=c.child,y.memoizedProps=c.memoizedProps,y.memoizedState=c.memoizedState,y.updateQueue=c.updateQueue,d=c.dependencies,y.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},y.sibling=c.sibling,y.index=c.index,y.ref=c.ref,y}function Lw(c,d,y,S,F,V){var X=2;if(S=c,typeof c=="function")KC(c)&&(X=1);else if(typeof c=="string")X=5;else e:switch(c){case U:return Uc(y.children,F,V,d);case O:X=8,F|=8;break;case L:return c=Xi(12,y,d,F|2),c.elementType=L,c.lanes=V,c;case A:return c=Xi(13,y,d,F),c.elementType=A,c.lanes=V,c;case M:return c=Xi(19,y,d,F),c.elementType=M,c.lanes=V,c;case j:return Bw(y,F,V,d);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case T:X=10;break e;case I:X=9;break e;case v:X=11;break e;case D:X=14;break e;case B:X=16,S=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return d=Xi(X,y,d,F),d.elementType=c,d.type=S,d.lanes=V,d}function Uc(c,d,y,S){return c=Xi(7,c,S,d),c.lanes=y,c}function Bw(c,d,y,S){return c=Xi(22,c,S,d),c.elementType=j,c.lanes=y,c.stateNode={isHidden:!1},c}function qC(c,d,y){return c=Xi(6,c,null,d),c.lanes=y,c}function XC(c,d,y){return d=Xi(4,c.children!==null?c.children:[],c.key,d),d.lanes=y,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function t8(c,d,y,S,F){this.tag=d,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Th(0),this.expirationTimes=Th(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Th(0),this.identifierPrefix=S,this.onRecoverableError=F,this.mutableSourceEagerHydrationData=null}function QC(c,d,y,S,F,V,X,re,le){return c=new t8(c,d,y,re,le),d===1?(d=1,V===!0&&(d|=8)):d=0,V=Xi(3,null,null,d),c.current=V,V.stateNode=c,V.memoizedState={element:S,isDehydrated:y,cache:null,transitions:null,pendingSuspenseBoundaries:null},uC(V),c}function n8(c,d,y){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_,key:S==null?null:""+S,children:c,containerInfo:d,implementation:y}}function gO(c){if(!c)return iu;c=c._reactInternals;e:{if(fn(c)!==c||c.tag!==1)throw Error(t(170));var d=c;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(oi(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(c.tag===1){var y=c.type;if(oi(y))return W$(c,y,d)}return d}function mO(c,d,y,S,F,V,X,re,le){return c=QC(y,S,!0,c,F,V,X,re,le),c.context=gO(null),y=c.current,S=Vs(),F=hu(y),V=ol(S,F),V.callback=d??null,lu(y,V,F),c.current.lanes=F,Ec(c,F,S),ui(c,S),c}function zw(c,d,y,S){var F=d.current,V=Vs(),X=hu(F);return y=gO(y),d.context===null?d.context=y:d.pendingContext=y,d=ol(V,X),d.payload={element:c},S=S===void 0?null:S,S!==null&&(d.callback=S),c=lu(F,d,X),c!==null&&(Oo(c,F,X,V),yw(c,F,X)),X}function Uw(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function yO(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var y=c.retryLane;c.retryLane=y!==0&&y<d?y:d}}function YC(c,d){yO(c,d),(c=c.alternate)&&yO(c,d)}var wO=typeof reportError=="function"?reportError:function(c){console.error(c)};function JC(c){this._internalRoot=c}Vw.prototype.render=JC.prototype.render=function(c){var d=this._internalRoot;if(d===null)throw Error(t(409));zw(c,d,null,null)},Vw.prototype.unmount=JC.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var d=c.containerInfo;Lc(function(){zw(null,c,null,null)}),d[tl]=null}};function Vw(c){this._internalRoot=c}Vw.prototype.unstable_scheduleHydration=function(c){if(c){var d=Xy();c={blockedOn:null,target:c,priority:d};for(var y=0;y<la.length&&d!==0&&d<la[y].priority;y++);la.splice(y,0,c),y===0&&yg(c)}};function ZC(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function Ww(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function xO(){}function r8(c,d,y,S,F){if(F){if(typeof S=="function"){var V=S;S=function(){var $e=Uw(X);V.call($e)}}var X=mO(d,S,c,0,null,!1,!1,"",xO);return c._reactRootContainer=X,c[tl]=X.current,Eg(c.nodeType===8?c.parentNode:c),Lc(),X}for(;F=c.lastChild;)c.removeChild(F);if(typeof S=="function"){var re=S;S=function(){var $e=Uw(le);re.call($e)}}var le=QC(c,0,!1,null,null,!1,!1,"",xO);return c._reactRootContainer=le,c[tl]=le.current,Eg(c.nodeType===8?c.parentNode:c),Lc(function(){zw(d,le,y,S)}),le}function Gw(c,d,y,S,F){var V=y._reactRootContainer;if(V){var X=V;if(typeof F=="function"){var re=F;F=function(){var le=Uw(X);re.call(le)}}zw(d,X,c,F)}else X=r8(y,d,c,F,S);return Uw(X)}qy=function(c){switch(c.tag){case 3:var d=c.stateNode;if(d.current.memoizedState.isDehydrated){var y=Jl(d.pendingLanes);y!==0&&(Nh(d,y|1),ui(d,En()),!(en&6)&&(Qh=En()+500,ou()))}break;case 13:Lc(function(){var S=il(c,1);if(S!==null){var F=Vs();Oo(S,c,1,F)}}),YC(c,1)}},pg=function(c){if(c.tag===13){var d=il(c,134217728);if(d!==null){var y=Vs();Oo(d,c,134217728,y)}YC(c,134217728)}},ko=function(c){if(c.tag===13){var d=hu(c),y=il(c,d);if(y!==null){var S=Vs();Oo(y,c,d,S)}YC(c,d)}},Xy=function(){return Yt},Qy=function(c,d){var y=Yt;try{return Yt=c,d()}finally{Yt=y}},_t=function(c,d,y){switch(d){case"input":if(tt(c,y),d=y.name,y.type==="radio"&&d!=null){for(y=c;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<y.length;d++){var S=y[d];if(S!==c&&S.form===c.form){var F=aw(S);if(!F)throw Error(t(90));he(S),tt(S,F)}}}break;case"textarea":At(c,y);break;case"select":d=y.value,d!=null&&mt(c,!!y.multiple,d,!1)}},In=GC,Ja=Lc;var s8={usingClientEntryPoint:!1,Events:[Ng,Mh,aw,Ms,kn,GC]},Wg={findFiberByHostInstance:$c,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},i8={bundleType:Wg.bundleType,version:Wg.version,rendererPackageName:Wg.rendererPackageName,rendererConfig:Wg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=Xl(c),c===null?null:c.stateNode},findFiberByHostInstance:Wg.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hw.isDisabled&&Hw.supportsFiber)try{sa=Hw.inject(i8),xs=Hw}catch{}}return ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=s8,ci.createPortal=function(c,d){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ZC(d))throw Error(t(200));return n8(c,d,null,y)},ci.createRoot=function(c,d){if(!ZC(c))throw Error(t(299));var y=!1,S="",F=wO;return d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onRecoverableError!==void 0&&(F=d.onRecoverableError)),d=QC(c,1,!1,null,null,y,!1,S,F),c[tl]=d.current,Eg(c.nodeType===8?c.parentNode:c),new JC(d)},ci.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=Xl(d),c=c===null?null:c.stateNode,c},ci.flushSync=function(c){return Lc(c)},ci.hydrate=function(c,d,y){if(!Ww(d))throw Error(t(200));return Gw(null,c,d,!0,y)},ci.hydrateRoot=function(c,d,y){if(!ZC(c))throw Error(t(405));var S=y!=null&&y.hydratedSources||null,F=!1,V="",X=wO;if(y!=null&&(y.unstable_strictMode===!0&&(F=!0),y.identifierPrefix!==void 0&&(V=y.identifierPrefix),y.onRecoverableError!==void 0&&(X=y.onRecoverableError)),d=mO(d,null,c,1,y??null,F,!1,V,X),c[tl]=d.current,Eg(c),S)for(c=0;c<S.length;c++)y=S[c],F=y._getVersion,F=F(y._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[y,F]:d.mutableSourceEagerHydrationData.push(y,F);return new Vw(d)},ci.render=function(c,d,y){if(!Ww(d))throw Error(t(200));return Gw(null,c,d,!1,y)},ci.unmountComponentAtNode=function(c){if(!Ww(c))throw Error(t(40));return c._reactRootContainer?(Lc(function(){Gw(null,null,c,!1,function(){c._reactRootContainer=null,c[tl]=null})}),!0):!1},ci.unstable_batchedUpdates=GC,ci.unstable_renderSubtreeIntoContainer=function(c,d,y,S){if(!Ww(y))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return Gw(c,d,y,!1,S)},ci.version="18.3.1-next-f1338f8080-20240426",ci}var NO;function m8(){if(NO)return rk.exports;NO=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),rk.exports=g8(),rk.exports}var $O;function y8(){if($O)return Kw;$O=1;var n=m8();return Kw.createRoot=n.createRoot,Kw.hydrateRoot=n.hydrateRoot,Kw}var w8=y8();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x8=1e-7,b8=1e-4;class z3{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class b2{refCount(e){return fi("refCount")}incRef(e){return fi("incRef")}timerAvailable(){return!0}time(e){return fi("time")}read(e){return fi("read")}readSync(e){return fi("readSync")}readToGPU(e,t){return fi("readToGPU")}numDataIds(){return fi("numDataIds")}disposeData(e,t){return fi("disposeData")}write(e,t,r){return fi("write")}move(e,t,r,s,i){return fi("move")}createTensorFromGPUData(e,t,r){return fi("createTensorFromGPUData")}memory(){return fi("memory")}floatPrecision(){return fi("floatPrecision")}epsilon(){return this.floatPrecision()===32?x8:b8}dispose(){return fi("dispose")}}function fi(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v8(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,cd(n,e,t)}function zf(n,e,t){return Math.max(n,Math.min(e,t))}function v2(n){return n%2===0?n:n+1}function cd(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function S8(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function ee(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function S2(n,e,t=""){ee(an(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function U3(n){ee(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function De(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function an(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function xp(n){return n%1===0}function VI(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function Sd(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function RO(n,e=s=>0,t,r){return new Promise((s,i)=>{let o=0;const a=()=>{if(n()){s();return}o++;const l=e(o);if(t!=null&&o>=t){i();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function V3(n,e){let t=1,r=-1;for(let i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(n[i]<0)throw Error(`Shapes can not be < 0. Found ${n[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const s=n.slice();return s[r]=e/t,s}function zt(n,e){const t=e.length;return n=n==null?e.map((r,s)=>s):[].concat(n),ee(n.every(r=>r>=-t&&r<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),ee(n.every(r=>xp(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?t+r:r)}function ac(n,e){const t=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:zt(e,n).sort();let o=0;for(let a=0;a<n.length;++a){if(i!=null){if(i[o]===a&&n[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(i[o]==null||i[o]>a)&&n[a]===1&&(t.push(n[a]),r.push(a)),i[o]<=a&&o++}n[a]!==1&&(t.push(n[a]),r.push(a))}return{newShape:t,keptDims:r}}function hs(n,e){return fr(n,e)}function fr(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function C8(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function k8(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function W3(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function i1(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function I8(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function m0(n){return typeof n=="string"||n instanceof String}function E8(n){return typeof n=="boolean"}function WI(n){return typeof n=="number"}function Hp(n){return Array.isArray(n)?Hp(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":WI(n)?"float32":m0(n)?"string":E8(n)?"bool":"float32"}function GI(n){return!!(n&&n.constructor&&n.call&&n.apply)}function HI(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function vt(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function G3(n,e,t,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)s[o]=t[n+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<i;l++)s[l]=G3(n+l*a,o,t,r)}return s}function Ho(n,e,t=!1){if(n.length===0)return e[0];const r=n.reduce((s,i)=>s*i)*(t?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return G3(0,n,e,t)}function A8(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function C2(n,e){const t=ds(n,e);for(let r=0;r<t.length;r++)t[r]=1;return t}function ds(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function H3(n,e){const t=n.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return Ho(n,new Float32Array(t));if(e==="int32")return Ho(n,new Int32Array(t));if(e==="bool")return Ho(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Vl(n){n.forEach(e=>{ee(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function La(n,e,t){if(e===0)return 0;if(e===1)return n[0];let r=n[n.length-1];for(let s=0;s<n.length-1;++s)r+=t[s]*n[s];return r}function jp(n,e,t){if(e===0)return[];if(e===1)return[n];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(n/t[s]),n-=r[s]*t[s];return r[r.length-1]=n,r}function k2(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OO="tfjsflags";class T8{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=N8,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Te().getBool("IS_TEST")||Te().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];Te().getBool("IS_TEST")||Te().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(k2(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);OO in e&&e[OO].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=R8(s,i)})}}function N8(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>($8(e,r[0],r[1]),r.join("="))),e}function $8(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function R8(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function Te(){return j3}let j3=null;function O8(n){j3=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ok;function K3(){if(ok==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");ok=n}return ok}function D8(){const n=K3();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function I2(n,e){const t=D8();if(t.has(n))return t.get(n);{const r=e();return t.set(n,r),t.get(n)}}const hb="Abs",y0="Acos",w0="Acosh",Kp="Add",E2="AddN",A2="All",T2="Any",db="ArgMax",pb="ArgMin",x0="Asin",b0="Asinh",v0="Atan",S0="Atanh",C0="Atan2",gb="AvgPool",N2="AvgPoolGrad",mb="AvgPool3D",$2="AvgPool3DGrad",yb="BatchMatMul",wb="BatchToSpaceND",R2="Bincount",O2="BitwiseAnd",_8="BroadcastTo",q3="BroadcastArgs",k0="Cast",I0="Ceil",E0="ClipByValue",D2="Complex",xb="ComplexAbs",bb="Concat",vb="Conv2D",_2="Conv2DBackpropFilter",Sb="Conv2DBackpropInput",Cb="Conv3D",P2="Conv3DBackpropFilterV2",F2="Conv3DBackpropInputV2",A0="Cos",T0="Cosh",M2="Cumprod",kb="Cumsum",L2="CropAndResize",B2="DenseBincount",z2="DepthToSpace",Ib="DepthwiseConv2dNative",U2="DepthwiseConv2dNativeBackpropFilter",V2="DepthwiseConv2dNativeBackpropInput",X3="Diag",Eb="Dilation2D",jI="Dilation2DBackpropInput",KI="Dilation2DBackpropFilter",P8="Draw",N0="RealDiv",W2="Einsum",$0="Elu",G2="EluGrad",R0="Erf",Ab="Equal",O0="Exp",Tb="ExpandDims",D0="Expm1",H2="FFT",j2="Fill",K2="FlipLeftRight",_0="Floor",P0="FloorDiv",Nb="FusedBatchNorm",$b="GatherV2",Q3="GatherNd",Rb="Greater",F0="GreaterEqual",M0="Identity",q2="IFFT",X2="Imag",L0="IsFinite",B0="IsInf",z0="IsNan",Ob="LeakyRelu",Db="Less",_b="LessEqual",Y3="LinSpace",U0="Log",V0="Log1p",Pb="LogicalAnd",Fb="LogicalNot",Mb="LogicalOr",F8="LogSoftmax",Lb="LRN",Q2="LRNGrad",Bb="Max",W0="Maximum",zb="MaxPool",Y2="MaxPoolGrad",Ub="MaxPool3D",J2="MaxPool3DGrad",J3="MaxPoolWithArgmax",Vb="Mean",Wb="Min",G0="Minimum",Gb="MirrorPad",H0="Mod",Z3="Multinomial",j0="Multiply",Hb="Neg",jb="NotEqual",Z2="NonMaxSuppressionV3",eA="NonMaxSuppressionV4",tA="NonMaxSuppressionV5",Kb="OnesLike",qb="OneHot",Xb="Pack",Qb="PadV2",K0="Pow",Yb="Prelu",Jb="Prod",eM="RaggedGather",tM="RaggedRange",nM="RaggedTensorToTensor",nA="Range",rA="Real",q0="Reciprocal",X0="Relu",Zb="Reshape",ev="ResizeNearestNeighbor",sA="ResizeNearestNeighborGrad",tv="ResizeBilinear",iA="ResizeBilinearGrad",Q0="Relu6",nv="Reverse",Y0="Round",J0="Rsqrt",rM="ScatterNd",sM="TensorScatterUpdate",iM="SearchSorted",rv="Select",Z0="Selu",sv="Slice",ey="Sin",ty="Sinh",ny="Sign",ry="Sigmoid",sy="Softplus",iy="Sqrt",iv="Sum",ov="SpaceToBatchND",av="SplitV",lv="Softmax",oM="SparseFillEmptyRows",aM="SparseReshape",lM="SparseSegmentMean",uM="SparseSegmentSum",cM="SparseToDense",oy="SquaredDifference",oA="Square",aA="StaticRegexReplace",lA="StridedSlice",fM="StringNGrams",hM="StringSplit",dM="StringToHashBucketFast",ay="Sub",ly="Tan",uy="Tanh",cy="Tile",uA="TopK",cA="Transform",Cd="Transpose",fA="Unique",uv="Unpack",cv="UnsortedSegmentSum",fv="ZerosLike",fy="Step",M8="FromPixels",hA="RotateWithOffset",o1="_FusedMatMul",a1="FusedConv2D",pM="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(...n){Te().getBool("IS_TEST")||Te().getBool("PROD")||console.warn(...n)}function L8(...n){Te().getBool("IS_TEST")||Te().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l1=I2("kernelRegistry",()=>new Map),qI=I2("gradRegistry",()=>new Map);function DO(n,e){const t=mM(n,e);return l1.get(t)}function _O(n){return qI.get(n)}function PO(n){const e=l1.entries(),t=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,o]=s,[a]=i.split("_");a===n&&t.push(o)}return t}function gM(n){const{kernelName:e,backendName:t}=n,r=mM(e,t);l1.has(r)&&Pi(`The kernel '${e}' for backend '${t}' is already registered`),l1.set(r,n)}function B8(n){const{kernelName:e}=n;qI.has(e)&&Te().getBool("DEBUG")&&Pi(`Overriding the gradient for '${e}'`),qI.set(e,n)}function mM(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yM(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var ak,FO;function z8(){if(FO)return ak;FO=1,ak=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(T,I,v){this.low=T|0,this.high=I|0,this.unsigned=!!v}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(T){return(T&&T.__isLong__)===!0}e.isLong=t;var r={},s={};function i(T,I){var v,A,M;return I?(T>>>=0,(M=0<=T&&T<256)&&(A=s[T],A)?A:(v=a(T,(T|0)<0?-1:0,!0),M&&(s[T]=v),v)):(T|=0,(M=-128<=T&&T<128)&&(A=r[T],A)?A:(v=a(T,T<0?-1:0,!1),M&&(r[T]=v),v))}e.fromInt=i;function o(T,I){if(isNaN(T))return I?C:b;if(I){if(T<0)return C;if(T>=m)return U}else{if(T<=-9223372036854776e3)return O;if(T+1>=w)return _}return T<0?o(-T,I).neg():a(T%g|0,T/g|0,I)}e.fromNumber=o;function a(T,I,v){return new e(T,I,v)}e.fromBits=a;var l=Math.pow;function u(T,I,v){if(T.length===0)throw Error("empty string");if(T==="NaN"||T==="Infinity"||T==="+Infinity"||T==="-Infinity")return b;if(typeof I=="number"?(v=I,I=!1):I=!!I,v=v||10,v<2||36<v)throw RangeError("radix");var A;if((A=T.indexOf("-"))>0)throw Error("interior hyphen");if(A===0)return u(T.substring(1),I,v).neg();for(var M=o(l(v,8)),D=b,B=0;B<T.length;B+=8){var j=Math.min(8,T.length-B),W=parseInt(T.substring(B,B+j),v);if(j<8){var P=o(l(v,j));D=D.mul(P).add(o(W))}else D=D.mul(M),D=D.add(o(W))}return D.unsigned=I,D}e.fromString=u;function f(T,I){return typeof T=="number"?o(T,I):typeof T=="string"?u(T,I):a(T.low,T.high,typeof I=="boolean"?I:T.unsigned)}e.fromValue=f;var h=65536,p=1<<24,g=h*h,m=g*g,w=m/2,x=i(p),b=i(0);e.ZERO=b;var C=i(0,!0);e.UZERO=C;var $=i(1);e.ONE=$;var k=i(1,!0);e.UONE=k;var N=i(-1);e.NEG_ONE=N;var _=a(-1,2147483647,!1);e.MAX_VALUE=_;var U=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=U;var O=a(0,-2147483648,!1);e.MIN_VALUE=O;var L=e.prototype;return L.toInt=function(){return this.unsigned?this.low>>>0:this.low},L.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},L.toString=function(I){if(I=I||10,I<2||36<I)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(O)){var v=o(I),A=this.div(v),M=A.mul(v).sub(this);return A.toString(I)+M.toInt().toString(I)}else return"-"+this.neg().toString(I);for(var D=o(l(I,6),this.unsigned),B=this,j="";;){var W=B.div(D),P=B.sub(W.mul(D)).toInt()>>>0,E=P.toString(I);if(B=W,B.isZero())return E+j;for(;E.length<6;)E="0"+E;j=""+E+j}},L.getHighBits=function(){return this.high},L.getHighBitsUnsigned=function(){return this.high>>>0},L.getLowBits=function(){return this.low},L.getLowBitsUnsigned=function(){return this.low>>>0},L.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var I=this.high!=0?this.high:this.low,v=31;v>0&&!(I&1<<v);v--);return this.high!=0?v+33:v+1},L.isZero=function(){return this.high===0&&this.low===0},L.eqz=L.isZero,L.isNegative=function(){return!this.unsigned&&this.high<0},L.isPositive=function(){return this.unsigned||this.high>=0},L.isOdd=function(){return(this.low&1)===1},L.isEven=function(){return(this.low&1)===0},L.equals=function(I){return t(I)||(I=f(I)),this.unsigned!==I.unsigned&&this.high>>>31===1&&I.high>>>31===1?!1:this.high===I.high&&this.low===I.low},L.eq=L.equals,L.notEquals=function(I){return!this.eq(I)},L.neq=L.notEquals,L.ne=L.notEquals,L.lessThan=function(I){return this.comp(I)<0},L.lt=L.lessThan,L.lessThanOrEqual=function(I){return this.comp(I)<=0},L.lte=L.lessThanOrEqual,L.le=L.lessThanOrEqual,L.greaterThan=function(I){return this.comp(I)>0},L.gt=L.greaterThan,L.greaterThanOrEqual=function(I){return this.comp(I)>=0},L.gte=L.greaterThanOrEqual,L.ge=L.greaterThanOrEqual,L.compare=function(I){if(t(I)||(I=f(I)),this.eq(I))return 0;var v=this.isNegative(),A=I.isNegative();return v&&!A?-1:!v&&A?1:this.unsigned?I.high>>>0>this.high>>>0||I.high===this.high&&I.low>>>0>this.low>>>0?-1:1:this.sub(I).isNegative()?-1:1},L.comp=L.compare,L.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add($)},L.neg=L.negate,L.add=function(I){t(I)||(I=f(I));var v=this.high>>>16,A=this.high&65535,M=this.low>>>16,D=this.low&65535,B=I.high>>>16,j=I.high&65535,W=I.low>>>16,P=I.low&65535,E=0,R=0,H=0,K=0;return K+=D+P,H+=K>>>16,K&=65535,H+=M+W,R+=H>>>16,H&=65535,R+=A+j,E+=R>>>16,R&=65535,E+=v+B,E&=65535,a(H<<16|K,E<<16|R,this.unsigned)},L.subtract=function(I){return t(I)||(I=f(I)),this.add(I.neg())},L.sub=L.subtract,L.multiply=function(I){if(this.isZero())return b;if(t(I)||(I=f(I)),n){var v=n.mul(this.low,this.high,I.low,I.high);return a(v,n.get_high(),this.unsigned)}if(I.isZero())return b;if(this.eq(O))return I.isOdd()?O:b;if(I.eq(O))return this.isOdd()?O:b;if(this.isNegative())return I.isNegative()?this.neg().mul(I.neg()):this.neg().mul(I).neg();if(I.isNegative())return this.mul(I.neg()).neg();if(this.lt(x)&&I.lt(x))return o(this.toNumber()*I.toNumber(),this.unsigned);var A=this.high>>>16,M=this.high&65535,D=this.low>>>16,B=this.low&65535,j=I.high>>>16,W=I.high&65535,P=I.low>>>16,E=I.low&65535,R=0,H=0,K=0,Q=0;return Q+=B*E,K+=Q>>>16,Q&=65535,K+=D*E,H+=K>>>16,K&=65535,K+=B*P,H+=K>>>16,K&=65535,H+=M*E,R+=H>>>16,H&=65535,H+=D*P,R+=H>>>16,H&=65535,H+=B*W,R+=H>>>16,H&=65535,R+=A*E+M*P+D*W+B*j,R&=65535,a(K<<16|Q,R<<16|H,this.unsigned)},L.mul=L.multiply,L.divide=function(I){if(t(I)||(I=f(I)),I.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&I.low===-1&&I.high===-1)return this;var v=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,I.low,I.high);return a(v,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?C:b;var A,M,D;if(this.unsigned){if(I.unsigned||(I=I.toUnsigned()),I.gt(this))return C;if(I.gt(this.shru(1)))return k;D=C}else{if(this.eq(O)){if(I.eq($)||I.eq(N))return O;if(I.eq(O))return $;var B=this.shr(1);return A=B.div(I).shl(1),A.eq(b)?I.isNegative()?$:N:(M=this.sub(I.mul(A)),D=A.add(M.div(I)),D)}else if(I.eq(O))return this.unsigned?C:b;if(this.isNegative())return I.isNegative()?this.neg().div(I.neg()):this.neg().div(I).neg();if(I.isNegative())return this.div(I.neg()).neg();D=b}for(M=this;M.gte(I);){A=Math.max(1,Math.floor(M.toNumber()/I.toNumber()));for(var j=Math.ceil(Math.log(A)/Math.LN2),W=j<=48?1:l(2,j-48),P=o(A),E=P.mul(I);E.isNegative()||E.gt(M);)A-=W,P=o(A,this.unsigned),E=P.mul(I);P.isZero()&&(P=$),D=D.add(P),M=M.sub(E)}return D},L.div=L.divide,L.modulo=function(I){if(t(I)||(I=f(I)),n){var v=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,I.low,I.high);return a(v,n.get_high(),this.unsigned)}return this.sub(this.div(I).mul(I))},L.mod=L.modulo,L.rem=L.modulo,L.not=function(){return a(~this.low,~this.high,this.unsigned)},L.and=function(I){return t(I)||(I=f(I)),a(this.low&I.low,this.high&I.high,this.unsigned)},L.or=function(I){return t(I)||(I=f(I)),a(this.low|I.low,this.high|I.high,this.unsigned)},L.xor=function(I){return t(I)||(I=f(I)),a(this.low^I.low,this.high^I.high,this.unsigned)},L.shiftLeft=function(I){return t(I)&&(I=I.toInt()),(I&=63)===0?this:I<32?a(this.low<<I,this.high<<I|this.low>>>32-I,this.unsigned):a(0,this.low<<I-32,this.unsigned)},L.shl=L.shiftLeft,L.shiftRight=function(I){return t(I)&&(I=I.toInt()),(I&=63)===0?this:I<32?a(this.low>>>I|this.high<<32-I,this.high>>I,this.unsigned):a(this.high>>I-32,this.high>=0?0:-1,this.unsigned)},L.shr=L.shiftRight,L.shiftRightUnsigned=function(I){if(t(I)&&(I=I.toInt()),I&=63,I===0)return this;var v=this.high;if(I<32){var A=this.low;return a(A>>>I|v<<32-I,v>>>I,this.unsigned)}else return I===32?a(v,0,this.unsigned):a(v>>>I-32,0,this.unsigned)},L.shru=L.shiftRightUnsigned,L.shr_u=L.shiftRightUnsigned,L.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},L.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},L.toBytes=function(I){return I?this.toBytesLE():this.toBytesBE()},L.toBytesLE=function(){var I=this.high,v=this.low;return[v&255,v>>>8&255,v>>>16&255,v>>>24,I&255,I>>>8&255,I>>>16&255,I>>>24]},L.toBytesBE=function(){var I=this.high,v=this.low;return[I>>>24,I>>>16&255,I>>>8&255,I&255,v>>>24,v>>>16&255,v>>>8&255,v&255]},e.fromBytes=function(I,v,A){return A?e.fromBytesLE(I,v):e.fromBytesBE(I,v)},e.fromBytesLE=function(I,v){return new e(I[0]|I[1]<<8|I[2]<<16|I[3]<<24,I[4]|I[5]<<8|I[6]<<16|I[7]<<24,v)},e.fromBytesBE=function(I,v){return new e(I[4]<<24|I[5]<<16|I[6]<<8|I[7],I[0]<<24|I[1]<<16|I[2]<<8|I[3],v)},ak}var wM=z8();const xM=fb(wM),U8=B3({__proto__:null,default:xM},[wM]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qc=xM||U8;function hv(n){return qc.fromString(n,!0,16)}const bM=hv("c3a5c85c97cb3127"),jc=hv("b492b66fbe98f273"),Rs=hv("9ae16a3b2f90404f");function XI(n){return n.xor(n.shru(47))}function vM(n,e,t){const r=n.slice(e,e+t);return qc.fromBytes(Array.from(r),!0,!0)}function $n(n,e){return vM(n,e,8)}function MO(n,e){return vM(n,e,4)}function Ur(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function Hu(n,e,t=hv("9ddfea08eb382d69")){let r=n.xor(e).mul(t);r=r.xor(r.shru(47));let s=e.xor(r).mul(t);return s=s.xor(s.shru(47)),s=s.mul(t),s}function V8(n,e,t,r,s,i){s=s.add(n),i=Ur(i.add(s).add(r),21);const o=s;return s=s.add(e),s=s.add(t),i=i.add(Ur(s,44)),[s.add(r),i.add(o)]}function qw(n,e,t,r){return V8($n(n,e),$n(n,e+8),$n(n,e+16),$n(n,e+24),t,r)}function W8(n,e=n.length){if(e>=8){const t=Rs.add(e*2),r=$n(n,0).add(Rs),s=$n(n,e-8),i=Ur(s,37).mul(t).add(r),o=Ur(r,25).add(s).mul(t);return Hu(i,o,t)}if(e>=4){const t=Rs.add(e*2),r=MO(n,0);return Hu(r.shl(3).add(e),MO(n,e-4),t)}if(e>0){const t=n[0],r=n[e>>1],s=n[e-1],i=t+(r<<8),o=e+(s<<2);return XI(Rs.mul(i).xor(bM.mul(o))).mul(Rs)}return Rs}function G8(n,e=n.length){const t=Rs.add(e*2),r=$n(n,0).mul(jc),s=$n(n,8),i=$n(n,e-8).mul(t),o=$n(n,e-16).mul(Rs);return Hu(Ur(r.add(s),43).add(Ur(i,30)).add(o),r.add(Ur(s.add(Rs),18)).add(i),t)}function H8(n,e=n.length){const t=Rs.add(e*2),r=$n(n,0).mul(Rs),s=$n(n,8),i=$n(n,e-8).mul(t),o=$n(n,e-16).mul(Rs),a=Ur(r.add(s),43).add(Ur(i,30)).add(o),l=Hu(a,r.add(Ur(s.add(Rs),18)).add(i),t),u=$n(n,16).mul(t),f=$n(n,24),h=a.add($n(n,e-32)).mul(t),p=l.add($n(n,e-24)).mul(t);return Hu(Ur(u.add(f),43).add(Ur(h,30)).add(p),u.add(Ur(f.add(r),18)).add(h),t)}function j8(n,e=n.length){const t=qc.fromNumber(81,!0);if(e<=32)return e<=16?W8(n,e):G8(n,e);if(e<=64)return H8(n,e);let r=t,s=t.mul(jc).add(113),i=XI(s.mul(Rs).add(113)).mul(Rs),o=[qc.UZERO,qc.UZERO],a=[qc.UZERO,qc.UZERO];r=r.mul(Rs).add($n(n,0));let l=0;const u=(e-1>>6)*64,f=u+(e-1&63)-63;do r=Ur(r.add(s).add(o[0]).add($n(n,l+8)),37).mul(jc),s=Ur(s.add(o[1]).add($n(n,l+48)),42).mul(jc),r=r.xor(a[1]),s=s.add(o[0]).add($n(n,l+40)),i=Ur(i.add(a[0]),33).mul(jc),o=qw(n,l,o[1].mul(jc),r.add(a[0])),a=qw(n,l+32,i.add(a[1]),s.add($n(n,l+16))),[i,r]=[r,i],l+=64;while(l!==u);const h=jc.add(i.and(255).shl(1));return l=f,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=Ur(r.add(s).add(o[0]).add($n(n,l+8)),37).mul(h),s=Ur(s.add(o[1]).add($n(n,l+48)),42).mul(h),r=r.xor(a[1].mul(9)),s=s.add(o[0].mul(9).add($n(n,l+40))),i=Ur(i.add(a[0]),33).mul(h),o=qw(n,l,o[1].mul(h),r.add(a[0])),a=qw(n,l+32,i.add(a[1]),s.add($n(n,l+16))),[i,r]=[r,i],Hu(Hu(o[0],a[0],h).add(XI(s).mul(bM)).add(i),Hu(o[1],a[1],h).add(r),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lc(n,e){return e==="string"?ju(n):ch([n],e)}function K8(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function ch(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Uf(n)),Te().getBool("DEBUG")&&C8(n,e),K8(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let r=0;r<t.length;++r)Math.round(n[r])!==0&&(t[r]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Hs(){return Te().platform.now()}function ju(n,e="utf-8"){return e=e||"utf-8",Te().platform.encode(n,e)}function Qu(n,e="utf-8"){return e=e||"utf-8",Te().platform.decode(n,e)}function go(n){return Te().platform.isTypedArray!=null?Te().platform.isTypedArray(n):yM(n)}function Uf(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||k2(n)||n==null||go(n)&&t)e.push(n);else if(Array.isArray(n)||go(n))for(let r=0;r<n.length;++r)Uf(n[r],e,t);else{let r=-1;for(const s of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)Uf(n[s],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q8{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new Q8)}profileKernel(e,t,r){let s;const i=()=>{s=r()};let o;const a=Hs();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const u of s)u.dataSync();o=Promise.resolve({kernelMs:Hs()-a})}if(Te().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const f=s[u];f.data().then(h=>{X8(h,f.dtype,e)})}return{kernelName:e,outputs:s,inputs:t,timeMs:o.then(u=>u.kernelMs),extraInfo:o.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:s,inputs:i,extraInfo:o}=e;r.forEach(a=>{Promise.all([a.data(),s,o]).then(l=>{this.logger.logKernelProfile(t,a,l[0],l[1],i,l[2])})})}}function X8(n,e,t){if(e!=="float32")return!1;for(let r=0;r<n.length;r++){const s=n[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${t}'`),!0}return!1}class Q8{logKernelProfile(e,t,r,s,i,o){const a=typeof s=="number"?Sd(`${s}ms`,9):s.error,l=Sd(e,25),u=t.rank,f=t.size,h=Sd(t.shape.toString(),14);let p="";for(const g in i){const m=i[g];if(m!=null){const w=m.shape||t.shape,x=w.length;p+=`${g}: ${x}D ${x>0?w:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${h}	%c${f}	%c${p}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(n,e,t){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<n.length;l++){const u=n[l],f=u.inputs;for(const h in f){const p=f[h];let g=!1;for(let m=0;m<e.length;m++)if(r[p.id]){u.outputs.forEach(w=>r[w.id]=!0),g=!0,s[u.id]=!0;break}if(g)break}}const i={};i[t.id]=!0;const o={};for(let l=n.length-1;l>=0;l--){const u=n[l],f=u.inputs;for(let h=0;h<u.outputs.length;h++)if(i[u.outputs[h].id]){for(const p in f)i[f[p].id]=!0,o[u.id]=!0;break}}const a=[];for(let l=0;l<n.length;l++){const u=n[l];if(s[u.id]&&o[u.id]){const f={};for(const p in u.inputs){const g=u.inputs[p];r[g.id]&&(f[p]=g)}const h=Object.assign({},u);h.inputs=f,h.outputs=u.outputs,a.push(h)}}return a}function J8(n,e,t,r){for(let s=e.length-1;s>=0;s--){const i=e[s],o=[];if(i.outputs.forEach(l=>{const u=n[l.id];u!=null?o.push(u):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=t(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const f=i.inputs[l];if(!an(u.shape,f.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${f.shape}'`);if(n[f.id]==null)n[f.id]=u;else{const h=n[f.id];n[f.id]=r(h,u),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LO=20,jg=3,lk=7;function Z8(n,e,t,r){const s=vt(e),i=eH(n,e,t,s),o=e.length,a=Nx(n,e,t,s,i),l=["Tensor"];return r&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function eH(n,e,t,r){const s=De(e),i=r[r.length-1],o=new Array(i).fill(0),a=e.length,l=t==="complex64"?lm(n):n;if(a>1)for(let u=0;u<s/i;u++){const f=u*i;for(let h=0;h<i;h++)o[h]=Math.max(o[h],am(l[f+h],0,t).length)}return o}function am(n,e,t){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(lk))} + ${parseFloat(n[1].toFixed(lk))}j`:m0(n)?r=`'${n}'`:t==="bool"?r=SM(n):r=parseFloat(n.toFixed(lk)).toString(),Sd(r,e)}function SM(n){return n===0?"false":"true"}function Nx(n,e,t,r,s,i=!0){const o=t==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(t==="complex64"){const w=lm(n);return[am(w[0],0,t)]}return t==="bool"?[SM(n[0])]:[n[0].toString()]}if(l===1){if(a>LO){const x=jg*o;let b=Array.from(n.slice(0,x)),C=Array.from(n.slice((a-jg)*o,a*o));return t==="complex64"&&(b=lm(b),C=lm(C)),["["+b.map(($,k)=>am($,s[k],t)).join(", ")+", ..., "+C.map(($,k)=>am($,s[a-jg+k],t)).join(", ")+"]"]}return["["+(t==="complex64"?lm(n):Array.from(n)).map((x,b)=>am(x,s[b],t)).join(", ")+"]"]}const u=e.slice(1),f=r.slice(1),h=r[0]*o,p=[];if(a>LO){for(let w=0;w<jg;w++){const x=w*h,b=x+h;p.push(...Nx(n.slice(x,b),u,t,f,s,!1))}p.push("...");for(let w=a-jg;w<a;w++){const x=w*h,b=x+h;p.push(...Nx(n.slice(x,b),u,t,f,s,w===a-1))}}else for(let w=0;w<a;w++){const x=w*h,b=x+h;p.push(...Nx(n.slice(x,b),u,t,f,s,w===a-1))}const g=l===2?",":"";p[0]="["+(a>0?p[0]+g:"");for(let w=1;w<p.length-1;w++)p[w]=" "+p[w]+g;let m=`,
`;for(let w=2;w<l;w++)m+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(i?"":m),p}function lm(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class es{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=De(e),r!=null){const s=r.length;ee(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||fr(t,this.size),this.strides=vt(e)}set(e,...t){t.length===0&&(t=[0]),ee(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const s of e){if(s<0||s>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Uo().makeTensor(this.values,this.shape,this.dtype)}}let Uo=null,fd=null;function tH(n){Uo=n}function nH(n){fd=n}class Tr{constructor(e,t,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=De(e),this.strides=vt(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return fd.buffer(this.shape,this.dtype,e)}bufferSync(){return fd.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Ho(this.shape,e,this.dtype==="complex64")}arraySync(){return Ho(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Uo().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(r=>Qu(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Uo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Uo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Qu(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Uo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Uo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return fd.print(this,e)}clone(){return this.throwIfDisposed(),fd.clone(this)}toString(e=!1){const t=this.dataSync();return Z8(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),fd.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),Uo().makeVariable(this,e,t,r)}}Object.defineProperty(Tr,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function Oe(){return I2("Tensor",()=>Tr)}Oe();class u1 extends Tr{constructor(e,t,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!an(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Uo().disposeTensor(this),this.dataId=e.dataId,Uo().incRef(this,null)}dispose(){Uo().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(u1,Symbol.hasInstance,{value:n=>n instanceof Tr&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var BO;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(BO||(BO={}));var QI;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(QI||(QI={}));var YI;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(YI||(YI={}));var JI;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(JI||(JI={}));var ZI;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(ZI||(ZI={}));const rH={float32:JI,int32:QI,bool:YI,complex64:ZI};function xi(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return rH[n][e]}function dA(n){return xi(n,"int32")}function CM(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function kM(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dr(n,e){if(n.dtype===e.dtype)return[n,e];const t=xi(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function IM(n){const e=[];return EM(n,e,new Set),e}function EM(n,e,t){if(n==null)return;if(n instanceof Tr){e.push(n);return}if(!sH(n))return;const r=n;for(const s in r){const i=r[s];t.has(i)||(t.add(i),EM(i,e,t))}}function sH(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uk(n){return n.kernelName!=null}class zO{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class bp{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new zO}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?(Pi(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new q8(this.backendInstance),!0}setupRegisteredKernels(){PO(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){PO(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(r&&!(r instanceof b2)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(o=>s<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Pi(`Initialization of backend ${e} failed`),Pi(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Pi(`Initialization of backend ${e} failed`),Pi(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),s=r.backend,i=this.readSync(t),o=s.refCount(t);s.disposeData(t,!0),r.backend=e,e.move(t,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=t(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,t,r){e();try{const s=r();return t(),s}catch(s){throw t(),s}}nextTensorId(){return bp.nextTensorId++}nextVariableId(){return bp.nextVariableId++}clone(e){const t=pe.runKernel(M0,{x:e}),r={x:e},s=o=>({x:()=>{const a="float32",l={x:o},u={dtype:a};return pe.runKernel(k0,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[t],s,i,{}),t}runKernel(e,t,r){if(this.backendName==null&&this.backend,!(DO(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const s=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-t-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const s=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=uk(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(uk(e)){const{kernelName:m,inputs:w,attrs:x}=e;this.backendName==null&&this.backend;const b=DO(m,this.backendName);ee(b!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),a=()=>{const C=this.backend.numDataIds();l=b.kernelFunc({inputs:w,attrs:x,backend:this.backend});const $=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,C,$);const k=$.map(N=>N.rank!=null?N:this.makeTensorFromTensorInfo(N));if(s){const N=this.getTensorsForGradient(m,w,k);r=this.saveTensorsForBackwardMode(N)}return k}}else{const{forwardFunc:m}=e,w=x=>{s&&(r=x.map(b=>this.keep(this.clone(b))))};a=()=>{const x=this.backend.numDataIds();l=this.tidy(()=>m(this.backend,w));const b=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,x,b),b}}const{inputs:f,attrs:h}=e,p=uk(e)?null:e.backwardsFunc;let g;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=a():(g=this.profiler.profileKernel(u,f,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),t=g.outputs)}),s&&this.addTapeNode(u,f,t,p,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(f).map(m=>f[m]!=null?f[m].shape:null),outputShapes:t.map(m=>m.shape),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,t,r){const s=_O(e);if(s!=null){const i=s.inputsToSave||[],o=s.outputsToSave||[];let a;s.saveAllInputs?(ee(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(t).map(u=>t[u])):a=i.map(u=>t[u]);const l=r.filter((u,f)=>o[f]);return a.concat(l)}return[]}makeTensor(e,t,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&m0(e[0])&&(i=e.map(l=>ju(l)));const o=s.write(i,t,r),a=new Tr(t,r,o,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(o),u=I8(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,t,r,s){r=r||"float32";const i={dataId:e,shape:t,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:s,dtype:i}=e,o=new Tr(s,i,r,this.nextTensorId());return this.trackTensor(o,t),o}makeVariable(e,t=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new u1(e,t,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*i1(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof u1||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*i1(e.dtype);this.state.numBytes-=r}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,r,s,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:i},l=_O(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=u=>(u=u.map((f,h)=>{if(f==null){const p=r[h],g=ds(p.size,p.dtype);return this.makeTensor(g,p.shape,p.dtype)}return f}),s(u.length>1?u:u[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=IM(e),r=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,t,r,s=!1){if(ee(t.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));ee(i instanceof Tr,()=>"The result y returned by f() must be a tensor.");const o=Y8(this.state.activeTape,t,i);if(!s&&o.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=r??iH(i.shape),J8(a,o,u=>this.tidy(u),oH);const l=t.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const f of u.saved)f.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return ee(GI(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{ee(t.every(a=>a instanceof Tr),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};t.forEach((a,l)=>{s[l]=a});const i=(a,l)=>(r=e(...t,l),ee(r.value instanceof Tr,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),ee(GI(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,l)=>{const u=r.gradFunc(a,l),f=Array.isArray(u)?u:[u];ee(f.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),ee(f.every(p=>p instanceof Tr),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return f.forEach((p,g)=>{h[g]=()=>p}),h};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Hs(),r=await this.backend.time(e);return r.wallMs=Hs()-t,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new zO;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}bp.nextTensorId=0;bp.nextVariableId=0;function iH(n){const e=C2(De(n),"float32");return pe.makeTensor(e,n,"float32")}function AM(){const n=K3();if(n._tfengine==null){const e=new T8(n);n._tfengine=new bp(e)}return O8(n._tfengine.ENV),tH(()=>n._tfengine),n._tfengine}const pe=AM();function oH(n,e){const t={a:n,b:e};return pe.runKernel(Kp,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(){return typeof navigator<"u"&&navigator!=null}function TM(n){if(n||aH()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function NM(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ei=Te();ei.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ei.registerFlag("IS_BROWSER",()=>NM());ei.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ei.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ei.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ei.registerFlag("PROD",()=>!1);ei.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ei.getBool("DEBUG"));ei.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ei.registerFlag("IS_TEST",()=>!1);ei.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ei.getBool("DEBUG"));ei.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ei.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ei.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dv(n,e){let t=n;if(go(n))return e==="string"?[]:[n.length];if(CM(n)){const s=n.channels||"RGBA";return[n.height,n.width*s.length]}else if(kM(n))return[n.buffer.size/(e==null?4:i1(e))];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(t)||go(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&Te().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&$M(n,r,[]),r}function $M(n,e,t){if(t=t||[],!Array.isArray(n)&&!go(n)){ee(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}ee(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),ee(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const r=e.slice(1);for(let s=0;s<n.length;++s)$M(n[s],r,t.concat(s))}function UO(n,e,t,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${r}' must be ${n} tensor, but got ${e} tensor`)}}function oe(n,e,t,r="numeric"){if(n instanceof Oe())return UO(r,n.dtype,e,t),n;let s=Hp(n);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),UO(r,s,e,t),n==null||!go(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const i=dv(n,s);!go(n)&&!Array.isArray(n)&&(n=[n]);const a=s!=="string"?ch(n,s):Uf(n,[],!0);return pe.makeTensor(a,i,s)}function RM(n,e,t,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,o)=>oe(i,`${e}[${o}]`,t,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lH="__op";function xe(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+lH;const s=(...i)=>{pe.startScope(t);try{const o=r(...i);return k2(o)&&console.error("Cannot return a Promise inside of tidy."),pe.endScope(o),o}catch(o){throw pe.endScope(null),o}};return Object.defineProperty(s,"name",{value:t,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uH(n,e){const t=oe(n,"real","complex"),r=oe(e,"imag","complex");S2(t.shape,r.shape,`real and imag shapes, ${t.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:t,imag:r};return pe.runKernel(D2,s)}const Vf=xe({complex_:uH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pv(n,e,t,r){if(r==null)r=Hp(n);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(kM(n)||CM(n)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return pe.backend.createTensorFromGPUData(n,e||t,r)}if(!go(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Vl(e);const s=De(e),i=De(t);ee(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let o=0;o<t.length;++o){const a=t[o],l=o===t.length-1?a!==De(e.slice(o)):!0;ee(t[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!go(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=r!=="string"?ch(n,r):Uf(n,[],!0),pe.makeTensor(n,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nf(n,e,t){const r=dv(n,t);return pv(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c1={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class uc{static join(e){return new uc(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>go(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=t+s.byteLength;this.shards.push({buffer:s,start:t,end:i}),t=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=t-e,i=new ArrayBuffer(s),o=new Uint8Array(i);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],h=e+a-u.start,p=a,m=Math.min(t,u.end)-u.start,w=new Uint8Array(u.buffer,h,m-h);if(o.set(w,p),a+=w.length,t<u.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(s){return e<s.start?-1:e>=s.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=cH(this.shards,t);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function cH(n,e){let t=0,r=n.length;for(;t<=r;){const s=Math.floor((r-t)/2)+t,i=e(n[s]);if(i===0)return s;i<0?r=s:t=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ma(){return pe}function VO(){return pe.memory()}function Ce(n,e){return pe.tidy(n,e)}function Ft(n){IM(n).forEach(t=>t.dispose())}function Ba(n){return pe.keep(n)}function OM(n,e,t=1){return pe.registerBackend(n,e,t)}function fH(){return pe.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vp=4;async function WO(n,e){const t=[],r=[],s=Array.isArray(n)?n.map(o=>o.name):Object.keys(n);for(let o=0;o<s.length;++o){const a=s[o],l=Array.isArray(n)?n[o].tensor:n[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const f=new Promise(async h=>{const p=await l.bytes(),g=p.reduce((x,b)=>x+b.length,0)+vp*p.length,m=new Uint8Array(g);let w=0;for(let x=0;x<p.length;x++){const b=p[x],C=new Uint8Array(new Uint32Array([b.length]).buffer);m.set(C,w),w+=vp,m.set(b,w),w+=b.length}h(m)});r.push(f)}else r.push(l.data());e!=null&&(u.group=e),t.push(u)}const i=await Promise.all(r);return{data:gH(i),specs:t}}function hH(n,e){const t=new uc(n),r={};let s=0;for(const i of e){const o=dH(i,(a,l)=>t.slice(s+a,s+l));r[i.name]=pH(i,t.slice(s,s+o)),s+=o}return r}function dH(n,e){const t=De(n.shape);let r;if("quantization"in n){const s=n.quantization;r=c1[s.dtype]}else if(n.dtype==="string"){let s=0;for(let i=0;i<t;i++)s+=vp+new Uint32Array(e(s,s+vp))[0];return s}else r=c1[n.dtype];return t*r}function pH(n,e){const t=n.name,r=n.dtype,s=n.shape,i=De(s);let o,a=0;if("quantization"in n){const l=n.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${n.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${n.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${n.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=c1[l.dtype],f=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(f.length);for(let h=0;h<f.length;h++){const p=f[h];o[h]=p*l.scale+l.min}}else if(l.dtype==="float16")o=IH()(f);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(f.length);for(let h=0;h<f.length;h++){const p=f[h];o[h]=Math.round(p*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${t}': ${r}`);a+=i*u}else if(r==="string"){const l=De(n.shape);o=[];for(let u=0;u<l;u++){const f=new Uint32Array(e.slice(a,a+vp))[0];a+=vp;const h=new Uint8Array(e.slice(a,a+f));o.push(h),a+=f}}else{const l=c1[r];if(r==="float32")o=new Float32Array(e);else if(r==="int32")o=new Int32Array(e);else if(r==="bool")o=new Uint8Array(e);else if(r==="complex64"){o=new Float32Array(e);const u=new Float32Array(o.length/2),f=new Float32Array(o.length/2);for(let m=0;m<u.length;m++)u[m]=o[m*2],f[m]=o[m*2+1];const h=Nf(u,s,"float32"),p=Nf(f,s,"float32"),g=Vf(h,p);return h.dispose(),p.dispose(),g}else throw new Error(`Unsupported dtype in weight '${t}': ${r}`);a+=i*l}return Nf(o,s,r)}function gH(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return t.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const pA=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function GO(n){return pA?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function mH(n){if(pA)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let r=0,s=e.length;r<s;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function yH(n){if(pA){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t.set([e.charCodeAt(r)],r);return t.buffer}function wH(n){return uc.join(n)}function xH(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(t.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function bH(n,e,t){const r={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(r.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=t}return n.signature!=null&&(r.signature=n.signature),n.userDefinedMetadata!=null&&(r.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(r.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(r.initializerSignature=n.initializerSignature),r}async function vH(n,e){let t,r;return n.weightsManifest!=null&&([t,r]=await e(n.weightsManifest)),bH(n,t,r)}function gA(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:GO(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:GO(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new uc(n.weightData).byteLength}}function HO(n){const e=[];for(const t of n)e.push(...t.weights);return e}function SH(){const n=t=>{let r=t<<13,s=0;for(;!(r&8388608);)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function CH(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function kH(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function IH(){const n=SH(),e=CH(),t=kH();return r=>{const s=new ArrayBuffer(4*r.length),i=new Uint32Array(s);for(let o=0;o<r.length;o++){const a=r[o],l=n[t[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return zr.instance==null&&(zr.instance=new zr),zr.instance}static registerSaveRouter(e){zr.getInstance().saveRouters.push(e)}static registerLoadRouter(e){zr.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return zr.getHandlers(e,"save")}static getLoadHandlers(e,t){return zr.getHandlers(e,"load",t)}static getHandlers(e,t,r){const s=[];return(t==="load"?zr.getInstance().loadRouters:zr.getInstance().saveRouters).forEach(o=>{const a=o(e,r);a!==null&&s.push(a)}),s}}const EH=n=>zr.getSaveHandlers(n),AH=(n,e)=>zr.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eE="tensorflowjs",tE=1,tf="models_store",Vu="model_info_store";function DM(){if(!Te().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function nE(n){const e=n.result;e.createObjectStore(tf,{keyPath:"modelPath"}),e.createObjectStore(Vu,{keyPath:"modelPath"})}class Wf{constructor(e){if(this.indexedDB=DM(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,s)=>{const i=this.indexedDB.open(eE,tE);i.onupgradeneeded=()=>nE(i),i.onsuccess=()=>{const o=i.result;if(t==null){const a=o.transaction(tf,"readonly"),u=a.objectStore(tf).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return o.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=f=>(o.close(),s(u.error)),a.oncomplete=()=>o.close()}else{t.weightData=uc.join(t.weightData);const a=gA(t),l=o.transaction(Vu,"readwrite");let u=l.objectStore(Vu),f;try{f=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(p){return s(p)}let h;f.onsuccess=()=>{h=o.transaction(tf,"readwrite");const p=h.objectStore(tf);let g;try{g=p.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:a})}catch(m){return s(m)}g.onsuccess=()=>r({modelArtifactsInfo:a}),g.onerror=m=>{u=l.objectStore(Vu);const w=u.delete(this.modelPath);w.onsuccess=()=>(o.close(),s(g.error)),w.onerror=x=>(o.close(),s(g.error))}},f.onerror=p=>(o.close(),s(f.error)),l.oncomplete=()=>{h==null?o.close():h.oncomplete=()=>o.close()}}},i.onerror=o=>s(i.error)})}}Wf.URL_SCHEME="indexeddb://";const _M=n=>Te().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Wf.URL_SCHEME)?TH(n.slice(Wf.URL_SCHEME.length)):null;zr.registerSaveRouter(_M);zr.registerLoadRouter(_M);function TH(n){return new Wf(n)}function NH(n){return n.startsWith(Wf.URL_SCHEME)?n.slice(Wf.URL_SCHEME.length):n}class $H{constructor(){this.indexedDB=DM()}async listModels(){return new Promise((e,t)=>{const r=this.indexedDB.open(eE,tE);r.onupgradeneeded=()=>nE(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(Vu,"readonly"),a=i.objectStore(Vu).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),t(a.error)),i.oncomplete=()=>s.close()},r.onerror=s=>t(r.error)})}async removeModel(e){return e=NH(e),new Promise((t,r)=>{const s=this.indexedDB.open(eE,tE);s.onupgradeneeded=()=>nE(s),s.onsuccess=()=>{const i=s.result,o=i.transaction(Vu,"readwrite"),a=o.objectStore(Vu),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const f=a.delete(e),h=()=>{u=i.transaction(tf,"readwrite");const g=u.objectStore(tf).delete(e);g.onsuccess=()=>t(l.result.modelArtifactsInfo),g.onerror=m=>r(l.error)};f.onsuccess=h,f.onerror=p=>(h(),i.close(),r(l.error))}},l.onerror=f=>(i.close(),r(l.error)),o.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nl="/",hd="tensorflowjs_models",PM="info",RH="model_topology",OH="weight_specs",DH="weight_data",_H="model_metadata";function FM(n){return{info:[hd,n,PM].join(Nl),topology:[hd,n,RH].join(Nl),weightSpecs:[hd,n,OH].join(Nl),weightData:[hd,n,DH].join(Nl),modelMetadata:[hd,n,_H].join(Nl)}}function MM(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function PH(n){const e=n.split(Nl);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(Nl)}function FH(n){return n.startsWith(Gf.URL_SCHEME)?n.slice(Gf.URL_SCHEME.length):n}class Gf{constructor(e){if(!Te().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=FM(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=gA(e),i=uc.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,mH(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw MM(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy,a.signature!=null&&(t.signature=a.signature),a.userDefinedMetadata!=null&&(t.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(t.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(t.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(t.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=yH(o),t}}Gf.URL_SCHEME="localstorage://";const LM=n=>Te().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Gf.URL_SCHEME)?MH(n.slice(Gf.URL_SCHEME.length)):null;zr.registerSaveRouter(LM);zr.registerLoadRouter(LM);function MH(n){return new Gf(n)}class LH{constructor(){ee(Te().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),ee(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=hd+Nl,r=Nl+PM;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(t)&&i.endsWith(r)){const o=PH(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=FH(e);const t=FM(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(t.info));return MM(t),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jO="://";class ya{constructor(){this.managers={}}static getInstance(){return ya.instance==null&&(ya.instance=new ya),ya.instance}static registerManager(e,t){ee(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(jO)&&(e=e.slice(0,e.indexOf(jO))),ee(e.length>0,()=>"scheme must not be an empty string.");const r=ya.getInstance();ee(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=t}static getManager(e){const t=ya.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(ya.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BH{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!Te().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return yM(e)}}if(Te().get("IS_BROWSER")){Te().setPlatform("browser",new BH);try{ya.registerManager(Gf.URL_SCHEME,new LH)}catch{}try{ya.registerManager(Wf.URL_SCHEME,new $H)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zH={importFetch:()=>require("node-fetch")};let ck;class UH{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Te().global.fetch!=null?Te().global.fetch(e,t):(ck==null&&(ck=zH.importFetch()),ck(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Te().get("IS_NODE")&&!Te().get("IS_BROWSER")&&Te().setPlatform("node",new UH);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bt(n,e="float32",t){return e=e||"float32",Vl(n),new es(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VH(n,e){const t=oe(n,"x","cast");if(!k8(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:t},s={dtype:e};return pe.runKernel(k0,r,s)}const it=xe({cast_:VH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(n){const t={x:oe(n,"x","clone","string_or_numeric")};return pe.runKernel(M0,t)}const $f=xe({clone_:WH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */AM();const HH={buffer:Bt,cast:it,clone:$f,print:GH};nH(HH);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(n,e){let t=oe(n,"a","add"),r=oe(e,"b","add");[t,r]=dr(t,r);const s={a:t,b:r};return pe.runKernel(Kp,s)}const qe=xe({add_:jH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KH(n,e){let t=oe(n,"a","floorDiv"),r=oe(e,"b","floorDiv");[t,r]=dr(t,r);const s={a:t,b:r};return pe.runKernel(P0,s)}const BM=xe({floorDiv_:KH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qH(n,e){let t=oe(n,"a","div"),r=oe(e,"b","div");if([t,r]=dr(t,r),t.dtype==="int32"&&r.dtype==="int32")return BM(t,r);const s={a:t,b:r},i={};return pe.runKernel(N0,s,i)}const kt=xe({div_:qH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XH(n,e){let t=oe(n,"a","mul"),r=oe(e,"b","mul");[t,r]=dr(t,r);const s={a:t,b:r};return pe.runKernel(j0,s)}const fe=xe({mul_:XH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(n){const e=oe(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return pe.runKernel(xb,t)}else{const t={x:e};return pe.runKernel(hb,t)}}const $s=xe({abs_:QH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YH(n){const t={x:oe(n,"x","acos")};return pe.runKernel(y0,t)}const JH=xe({acos_:YH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZH(n){const t={x:oe(n,"x","acosh")};return pe.runKernel(w0,t)}const ej=xe({acosh_:ZH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tj(n,e=null,t=!1){const s={x:oe(n,"x","all","bool")},i={axis:e,keepDims:t};return pe.runKernel(A2,s,i)}const zM=xe({all_:tj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nj(n,e=null,t=!1){const s={x:oe(n,"x","any","bool")},i={axis:e,keepDims:t};return pe.runKernel(T2,s,i)}const rE=xe({any_:nj});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rj(n,e=0){const r={x:oe(n,"x","argMax")},s={axis:e};return pe.runKernel(db,r,s)}const Rm=xe({argMax_:rj});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sj(n,e=0){const r={x:oe(n,"x","argMin")},s={axis:e};return pe.runKernel(pb,r,s)}const ij=xe({argMin_:sj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oj(n){const t={x:oe(n,"x","asin")};return pe.runKernel(x0,t)}const aj=xe({asin_:oj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lj(n){const t={x:oe(n,"x","asinh")};return pe.runKernel(b0,t)}const uj=xe({asinh_:lj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cj(n){const t={x:oe(n,"x","atan")};return pe.runKernel(v0,t)}const fj=xe({atan_:cj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hj(n,e){let t=oe(n,"a","atan2"),r=oe(e,"b","atan2");[t,r]=dr(t,r);const s={a:t,b:r};return pe.runKernel(C0,s)}const dj=xe({atan2_:hj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pj(n){const t={x:oe(n,"x","atanh")};return pe.runKernel(S0,t)}const gj=xe({atanh_:pj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hy(n,e,t,r,s="NHWC",i){const o=n[3],a=[...e,o],l=Gl(s);return ts(n,a,t,i,r,null,null,l)}function wo(n,e,t,r,s,i,o="channelsLast"){const[a,l]=Om(e);let u;if(o==="channelsLast")u=[a,l,n[3],n[3]];else if(o==="channelsFirst")u=[a,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return ts(n,u,t,r,s,i,!1,o)}function Wl(n,e,t,r,s,i,o="NDHWC"){const[a,l,u]=sE(e);let f,h;if(o==="NDHWC")h="channelsLast",f=[a,l,u,n[4],n[4]];else if(o==="NCDHW")h="channelsFirst",f=[a,l,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return cc(n,f,t,r,s,!1,h,i)}function ts(n,e,t,r,s,i,o=!1,a="channelsLast"){let[l,u,f,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,f,h]=n;else if(a==="channelsFirst")[l,h,u,f]=n;else throw new Error(`Unknown dataFormat ${a}`);const[p,g,,m]=e,[w,x]=Om(t),[b,C]=Om(r),$=kd(p,b),k=kd(g,C),{padInfo:N,outHeight:_,outWidth:U}=wj(s,u,f,w,x,$,k,i,a),O=o?m*h:m;let L;return a==="channelsFirst"?L=[l,O,_,U]:a==="channelsLast"&&(L=[l,_,U,O]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:f,inChannels:h,outHeight:_,outWidth:U,outChannels:O,padInfo:N,strideHeight:w,strideWidth:x,filterHeight:p,filterWidth:g,effectiveFilterHeight:$,effectiveFilterWidth:k,dilationHeight:b,dilationWidth:C,inShape:n,outShape:L,filterShape:e}}function cc(n,e,t,r,s,i=!1,o="channelsLast",a){let[l,u,f,h,p]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,u,f,h,p]=n;else if(o==="channelsFirst")[l,p,u,f,h]=n;else throw new Error(`Unknown dataFormat ${o}`);const[g,m,w,,x]=e,[b,C,$]=sE(t),[k,N,_]=sE(r),U=kd(g,k),O=kd(m,N),L=kd(w,_),{padInfo:T,outDepth:I,outHeight:v,outWidth:A}=xj(s,u,f,h,b,C,$,U,O,L,a),M=i?x*p:x;let D;return o==="channelsFirst"?D=[l,M,I,v,A]:o==="channelsLast"&&(D=[l,I,v,A,M]),{batchSize:l,dataFormat:o,inDepth:u,inHeight:f,inWidth:h,inChannels:p,outDepth:I,outHeight:v,outWidth:A,outChannels:M,padInfo:T,strideDepth:b,strideHeight:C,strideWidth:$,filterDepth:g,filterHeight:m,filterWidth:w,effectiveFilterDepth:U,effectiveFilterHeight:O,effectiveFilterWidth:L,dilationDepth:k,dilationHeight:N,dilationWidth:_,inShape:n,outShape:D,filterShape:e}}function mj(n,e,t,r,s){r==null&&(r=mA(n,e,t));const i=n[0],o=n[1],a=Dm((i-e+2*r)/t+1,s),l=Dm((o-e+2*r)/t+1,s);return[a,l]}function yj(n,e,t,r,s,i){s==null&&(s=mA(n,e[0],r[0]));const o=[0,0,0,t];for(let a=0;a<3;a++)n[a]+2*s>=e[a]&&(o[a]=Dm((n[a]-e[a]+2*s)/r[a]+1,i));return o}function mA(n,e,t,r=1){const s=kd(e,r);return Math.floor((n[0]*(t-1)-t+s)/2)}function Om(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function sE(n){return typeof n=="number"?[n,n,n]:n}function kd(n,e){return e<=1?n:n+(n-1)*(e-1)}function wj(n,e,t,r,s,i,o,a,l){let u,f,h;if(typeof n=="number"){u={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const g=mj([e,t],i,r,n,a);f=g[0],h=g[1]}else if(n==="same"){f=Math.ceil(e/r),h=Math.ceil(t/s);const p=Math.max(0,(f-1)*r+i-e),g=Math.max(0,(h-1)*s+o-t),m=Math.floor(p/2),w=p-m,x=Math.floor(g/2),b=g-x;u={top:m,bottom:w,left:x,right:b,type:"SAME"}}else if(n==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},f=Math.ceil((e-i+1)/r),h=Math.ceil((t-o+1)/s);else if(typeof n=="object"){const p=l==="channelsLast"?n[1][0]:n[2][0],g=l==="channelsLast"?n[1][1]:n[2][1],m=l==="channelsLast"?n[2][0]:n[3][0],w=l==="channelsLast"?n[2][1]:n[3][1];u={top:p,bottom:g,left:m,right:w,type:p===0&&g===0&&m===0&&w===0?"VALID":"EXPLICIT"},f=Dm((e-i+p+g)/r+1,a),h=Dm((t-o+m+w)/s+1,a)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:u,outHeight:f,outWidth:h}}function xj(n,e,t,r,s,i,o,a,l,u,f){let h,p,g,m;if(n==="valid"&&(n=0),typeof n=="number"){h={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const x=yj([e,t,r,1],[a,l,u],1,[s,i,o],n,f);p=x[0],g=x[1],m=x[2]}else if(n==="same"){p=Math.ceil(e/s),g=Math.ceil(t/i),m=Math.ceil(r/o);const w=(p-1)*s+a-e,x=(g-1)*i+l-t,b=(m-1)*o+u-r,C=Math.floor(w/2),$=w-C,k=Math.floor(x/2),N=x-k,_=Math.floor(b/2),U=b-_;h={top:k,bottom:N,left:_,right:U,front:C,back:$,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:h,outDepth:p,outHeight:g,outWidth:m}}function Dm(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function Hf(n){const[e,t,r]=Om(n);return e===1&&t===1&&r===1}function gs(n,e){return Hf(n)||Hf(e)}function jf(n){return Om(n).every(e=>e>0)}function Gl(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function ni(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")ee(xp(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{ee(xp(s),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${s}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bj(n,e){const r={x:oe(n,"x","reshape","string_or_numeric")},s={shape:e};return pe.runKernel(Zb,r,s)}const ye=xe({reshape_:bj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vj(n,e,t,r,s){const i=oe(n,"x","avgPool","float32"),o=1;ee(gs(t,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=ye(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ee(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),ni("avgPool",r,s);const u={x:a},f={filterSize:e,strides:t,pad:r,dimRoundingMode:s};let h=pe.runKernel(gb,u,f);return h=it(h,i.dtype),l?ye(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const yA=xe({avgPool_:vj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sj(n,e,t,r,s,i="NDHWC"){const o=oe(n,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=ye(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ee(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),ee(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),ee(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),ni("avgPool3d",r,s);const u={x:a},f={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i};let h=pe.runKernel(mb,u,f);return h=it(h,a.dtype),l?ye(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Cj=xe({avgPool3d_:Sj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kj(n,e=0){ee(n.length>=1,()=>"Pass at least one tensor to concat");const t=RM(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return $f(t[0]);const r=t,s={axis:e};return pe.runKernel(bb,r,s)}const Zs=xe({concat_:kj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ij(n,e,t=!1,r=!1){let s=oe(n,"a","matMul"),i=oe(e,"b","matMul");[s,i]=dr(s,i);const o={a:s,b:i},a={transposeA:t,transposeB:r};return pe.runKernel(yb,o,a)}const sn=xe({matMul_:Ij});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ej(n){const t={x:oe(n,"x","sigmoid","float32")};return pe.runKernel(ry,t)}const qp=xe({sigmoid_:Ej});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aj(n,e,t){const r=oe(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:t};return pe.runKernel(sv,s,i)}const Rn=xe({slice_:Aj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tj(n){const t={x:oe(n,"x","tanh","float32")};return pe.runKernel(uy,t)}const gv=xe({tanh_:Tj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nj(n,e,t){const r=oe(n,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);ee(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),ee(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),ee(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},o={blockShape:e,crops:t};return pe.runKernel(wb,i,o)}const wA=xe({batchToSpaceND_:Nj});function $j(n){let e;return n.rank===0||n.rank===1?e=ye(n,[1,1,1,n.size]):n.rank===2?e=ye(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=ye(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rj(n,e,t,r,s,i){i==null&&(i=.001);const o=oe(n,"x","batchNorm"),a=oe(e,"mean","batchNorm"),l=oe(t,"variance","batchNorm");let u;s!=null&&(u=oe(s,"scale","batchNorm"));let f;r!=null&&(f=oe(r,"offset","batchNorm")),ee(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ee(f==null||a.rank===f.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ee(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:$j(o),scale:u,offset:f,mean:a,variance:l},g={varianceEpsilon:i},m=pe.runKernel(Nb,p,g);return ye(m,o.shape)}const mv=xe({batchNorm_:Rj});function Oj(n,e,t,r,s,i){const o=oe(n,"x","batchNorm"),a=oe(e,"mean","batchNorm"),l=oe(t,"variance","batchNorm");let u;s!=null&&(u=oe(s,"scale","batchNorm"));let f;return r!=null&&(f=oe(r,"offset","batchNorm")),ee(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),ee(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),ee(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&ee(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),f!=null&&ee(f.rank===2||f.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${f.rank}.`),mv(o,a,l,f,u,i)}const Dj=xe({batchNorm2d_:Oj});function _j(n,e,t,r,s,i){const o=oe(n,"x","batchNorm"),a=oe(e,"mean","batchNorm"),l=oe(t,"variance","batchNorm");let u;s!=null&&(u=oe(s,"scale","batchNorm"));let f;return r!=null&&(f=oe(r,"offset","batchNorm")),ee(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),ee(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),ee(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&ee(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),f!=null&&ee(f.rank===3||f.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${f.rank}.`),mv(o,a,l,f,u,i)}const Pj=xe({batchNorm3d_:_j});function Fj(n,e,t,r,s,i){const o=oe(n,"x","batchNorm"),a=oe(e,"mean","batchNorm"),l=oe(t,"variance","batchNorm");let u;s!=null&&(u=oe(s,"scale","batchNorm"));let f;return r!=null&&(f=oe(r,"offset","batchNorm")),ee(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),ee(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),ee(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&ee(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),f!=null&&ee(f.rank===4||f.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${f.rank}.`),mv(o,a,l,f,u,i)}const Mj=xe({batchNorm4d_:Fj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lj(n,e,t){const r=oe(n,"x","bincount"),s=oe(e,"weights","bincount");ee(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),ee(t>=0,()=>`size must be non-negative, but got ${t}.`),ee(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},o={size:t};return pe.runKernel(R2,i,o)}const Bj=xe({bincount_:Lj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zj(n,e){let t=oe(n,"broadcastTo","x");const r=t.shape;if(Vl(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=ye(t,u)}const s=t.shape,i=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])i[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((u,f)=>u>1?f:-1).filter(u=>u>=0).length===0)return $f(t);const a={x:t},l={reps:i};return pe.runKernel(cy,a,l)}const km=xe({broadcastTo_:zj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uj(n){const t={x:oe(n,"x","ceil","float32")};return pe.runKernel(I0,t)}const Vj=xe({ceil_:Uj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yv(n,e,t){Vl(n),t=t||Hp(e);const r={shape:n,value:e,dtype:t};return pe.runKernel(j2,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wj(n,e,t){const r=oe(n,"x","clipByValue");if(ee(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return yv(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:t};return pe.runKernel(E0,s,i)}const Ui=xe({clipByValue_:Wj});function Gj(n){return Zs(n,0)}const Hj=xe({concat1d_:Gj});function jj(n,e){return Zs(n,e)}const Kj=xe({concat2d_:jj});function qj(n,e){return Zs(n,e)}const Xj=xe({concat3d_:qj});function Qj(n,e){return Zs(n,e)}const Yj=xe({concat4d_:Qj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jj(n,e,t,r,s="NHWC",i=[1,1],o){const a=oe(n,"x","conv2d","float32"),l=oe(e,"filter","conv2d","float32");let u=a,f=!1;a.rank===3&&(f=!0,u=ye(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ee(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),ee(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),ni("conv2d",r,o);const h=s==="NHWC"?u.shape[3]:u.shape[1];ee(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),ee(gs(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),ee(jf(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),ee(jf(t),()=>"Error in conv2D: Strides should be larger than 0.");const p={x:u,filter:l},g={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},m=pe.runKernel(vb,p,g);return f?ye(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Kf=xe({conv2d_:Jj});function Zj(n,e,t,r,s="NWC",i=1,o){const a=oe(n,"x","conv1d"),l=oe(e,"filter","conv1d");let u=a,f=!1;a.rank===2&&(f=!0,u=ye(a,[1,a.shape[0],a.shape[1]])),ee(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),ee(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),ni("conv1d",r,o),ee(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),ee(gs(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),ee(jf(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),ee(jf(t),()=>"Error in conv1D: Stride should be larger than 0."),ee(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const h=ye(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=ye(u,[u.shape[0],1,u.shape[1],u.shape[2]]),x=Kf(p,h,[1,t],r,"NHWC",[1,i],o);return f?ye(x,[x.shape[2],x.shape[3]]):ye(x,[x.shape[0],x.shape[2],x.shape[3]])}const UM=xe({conv1d_:Zj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(n,e,t,r,s,i="NHWC",o){ee(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,l=e,u=!1;e.rank===3&&(u=!0,l=ye(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,n[0],n[1],n[2]]),ee(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),ee(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),ee(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const f=i==="NHWC"?a[3]:a[1],h=i==="NHWC"?l.shape[3]:l.shape[1];ee(f===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${f}) must match input depth for filter ${t.shape[2]}.`),ee(h===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${t.shape[3]}.`),ni("conv2dDerInput",s,o);const p={dy:l,filter:t},g={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,inputShape:a},m=pe.runKernel(Sb,p,g);return u?ye(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const xA=xe({conv2DBackpropInput_:e9});function t9(n,e,t,r,s,i){const o=oe(n,"x","conv2dTranspose"),a=oe(e,"filter","conv2dTranspose");return xA(t,o,a,r,s,"NHWC",i)}const VM=xe({conv2dTranspose_:t9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n9(n,e,t,r,s="NDHWC",i=[1,1,1]){const o=oe(n,"x","conv3d"),a=oe(e,"filter","conv3d");let l=o,u=!1;o.rank===4&&(u=!0,l=ye(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ee(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),ee(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),ee(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),ee(gs(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),ee(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),ee(jf(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),ee(jf(t),()=>"Error in conv3D: Strides should be larger than 0.");const f={x:l,filter:a},h={strides:t,pad:r,dataFormat:s,dilations:i},p=pe.runKernel(Cb,f,h);return u?ye(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const r9=xe({conv3d_:n9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(n,e,t,r,s){ee(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,o=e,a=!1;e.rank===4&&(a=!0,o=ye(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const l=i[4],u=o.shape[4];ee(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),ee(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),ee(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),ee(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),ee(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const f={dy:o,filter:t},h={pad:s,strides:r,inputShape:i},p=pe.runKernel(F2,f,h);return a?ye(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const WM=xe({conv3DBackpropInput_:s9});function i9(n,e,t,r,s){const i=oe(n,"x","conv3dTranspose"),o=oe(e,"filter","conv3dTranspose");return WM(t,i,o,r,s)}const o9=xe({conv3dTranspose_:i9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a9(n){const t={x:oe(n,"x","cos","float32")};return pe.runKernel(A0,t)}const bA=xe({cos_:a9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(n){const t={x:oe(n,"x","cosh","float32")};return pe.runKernel(T0,t)}const GM=xe({cosh_:l9});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u9(n,e=0,t=!1,r=!1){const i={x:oe(n,"x","cumprod")},o={axis:e,exclusive:t,reverse:r};return pe.runKernel(M2,i,o)}const iE=xe({cumprod_:u9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c9(n,e=0,t=!1,r=!1){const i={x:oe(n,"x","cumsum")},o={axis:e,exclusive:t,reverse:r};return pe.runKernel(kb,i,o)}const HM=xe({cumsum_:c9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(n,e,t,r=!1){const s=oe(n,"x","denseBincount"),i=oe(e,"weights","denseBincount");ee(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),ee(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),ee(t>=0,()=>`size must be non-negative, but got ${t}.`),ee(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const o={x:s,weights:i},a={size:t,binaryOutput:r};return pe.runKernel(B2,o,a)}const KO=xe({denseBincount_:f9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(n,e,t="NHWC"){const r=oe(n,"x","depthToSpace","float32"),s=t==="NHWC"?r.shape[1]:r.shape[2],i=t==="NHWC"?r.shape[2]:r.shape[3],o=t==="NHWC"?r.shape[3]:r.shape[1];ee(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),ee(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),ee(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),ee(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:t};return pe.runKernel(z2,a,l)}const d9=xe({depthToSpace_:h9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p9(n,e,t,r,s="NHWC",i=[1,1],o){const a=oe(n,"x","depthwiseConv2d","float32"),l=oe(e,"filter","depthwiseConv2d","float32");let u=a,f=!1;a.rank===3&&(f=!0,u=ye(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ee(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),ee(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const h=s==="NHWC"?u.shape[3]:u.shape[1];ee(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),ni("depthwiseConv2d",r,o);const p={x:u,filter:l},g={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},m=pe.runKernel(Ib,p,g);return f?ye(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const vA=xe({depthwiseConv2d_:p9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(n,e,t,r,s=[1,1],i="NHWC"){const o=oe(n,"x","dilation2d"),a=oe(e,"filter","dilation2d");ee(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),ee(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),ee(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,u=!1;o.rank===3&&(l=ye(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),ee(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const f={x:l,filter:a},h={strides:t,pad:r,dilations:s},p=pe.runKernel(Eb,f,h);return u?ye(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const m9=xe({dilation2d_:g9});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sp(n,e){const t=n.length,r=[];for(let s=0;s<t;s++){const i=t-1-s,o=n[i]||1;(e[e.length-1-s]||1)>1&&o===1&&r.unshift(i)}return r}function Fr(n,e){const t=[];for(let r=0;r<e.length;r++){const s=n[n.length-r-1],i=e.length-r-1,o=e[i];(s==null||s===1&&o>1)&&t.unshift(i)}return t}function Dt(n,e){const t=Math.max(n.length,e.length),r=new Array(t);for(let s=0;s<t;s++){let i=n[n.length-s-1];i==null&&(i=1);let o=e[e.length-s-1];if(o==null&&(o=1),i===1)r[t-s-1]=o;else if(o===1)r[t-s-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(a)}else r[t-s-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y9(n,e){let t=oe(n,"a","equal","string_or_numeric"),r=oe(e,"b","equal","string_or_numeric");[t,r]=dr(t,r),Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(Ab,s)}const ja=xe({equal_:y9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(n,e,t){const r=oe(e,"a","where"),s=oe(t,"b","where"),i=oe(n,"condition","where","bool"),o=Dt(Dt(i.shape,r.shape),s.shape),a=km(i,o),l=km(r,o),u=km(s,o),f={condition:a,t:l,e:u};return pe.runKernel(rv,f)}const Ds=xe({where_:w9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9(n){const t={x:oe(n,"x","zerosLike")};return pe.runKernel(fv,t)}const qt=xe({zerosLike_:x9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9(n,e){let t=oe(n,"a","div"),r=oe(e,"b","div");[t,r]=dr(t,r);const s=kt(t,r),i=qt(s),o=ja(r,i);return Ds(o,i,s)}const v9=xe({divNoNan_:b9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9(n,e){const t=oe(n,"t1","dot"),r=oe(e,"t2","dot");ee((t.rank===1||t.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${r.rank}.`);const s=t.rank===1?t.size:t.shape[1],i=r.rank===1?r.size:r.shape[0];if(ee(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),t.rank===1&&r.rank===1){const o=ye(t,[1,-1]),a=ye(r,[-1,1]),l=sn(o,a);return ye(l,[])}else if(t.rank===1&&r.rank===2){const o=ye(t,[1,-1]),a=ye(r,[r.shape[0],r.shape[1]]),l=sn(o,a);return ye(l,[l.size])}else if(t.rank===2&&r.rank===1){const o=ye(r,[-1,1]),a=sn(t,o);return ye(a,[a.size])}else{const o=ye(r,[r.shape[0],r.shape[1]]);return sn(t,o)}}const C9=xe({dot_:S9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k9(n,...e){const t=e.map((s,i)=>oe(s,`tensors${i}`,"einsum")),r={equation:n};return pe.runKernel(W2,t,r)}const Kg=xe({einsum_:k9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I9(n){const t={x:oe(n,"x","elu","float32")};return pe.runKernel($0,t)}const wv=xe({elu_:I9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9(n){let e=oe(n,"x","erf");ee(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=it(e,"float32"));const t={x:e};return pe.runKernel(R0,t)}const jM=xe({erf_:E9});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SA(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function KM(n,e,t){const r=n.length+e.length,s=[];let i=0,o=0;for(let a=0;a<r;a++)t.indexOf(a)===-1?s.push(n[i++]):s.push(e[o++]);return s}function Gr(n,e){const t=[],r=n.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);const s=e.map(i=>n[i]);return[t,s]}function Ir(n,e){const t=e.map(r=>1);return KM(n,t,e)}function ns(n,e,t){ee(SA(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function Zn(n,e){if(SA(n,e))return null;const t=[];for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(r=>t.push(r)),t}function fc(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function pr(n,e){const t=[];for(let r=e-n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9(n,e=null,t=!1){const s={x:oe(n,"x","max")},i={reductionIndices:e,keepDims:t};return pe.runKernel(Bb,s,i)}const jo=xe({max_:A9});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T9(n,e=null,t=!1){const s={x:oe(n,"x","min")},i={axis:e,keepDims:t};return pe.runKernel(Wb,s,i)}const f1=xe({min_:T9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N9(n,e){let t=oe(n,"base","pow"),r=oe(e,"exp","pow");[t,r]=dr(t,r);const s={a:t,b:r};return pe.runKernel(K0,s)}const qf=xe({pow_:N9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function on(n,e){if((go(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&go(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return pv(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $9(n){const t={x:oe(n,"x","sqrt","float32")};return pe.runKernel(iy,t)}const ps=xe({sqrt_:$9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(n){const e=oe(n,"x","square"),t={};return pe.runKernel("Square",{x:e},t)}const Bn=xe({square_:R9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(n,e=null,t=!1){let r=oe(n,"x","sum");r.dtype==="bool"&&(r=it(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return pe.runKernel(iv,s,i)}const Ct=xe({sum_:O9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(n,e="euclidean",t=null,r=!1){n=oe(n,"x","norm");const s=qM(n,e,t);let i=s.shape;if(r){const o=zt(t,n.shape);i=Ir(s.shape,o)}return ye(s,i)}function qM(n,e,t=null){if(n.rank===0)return $s(n);if(n.rank!==1&&t===null)return qM(ye(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Ct($s(n),t);if(e===1/0)return jo($s(n),t);if(e===-1/0)return f1($s(n),t);if(e==="euclidean"||e===2)return ps(Ct(qf($s(n),on(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return jo(Ct($s(n),t[0]),t[1]-1);if(e===1/0)return jo(Ct($s(n),t[1]),t[0]);if(e===-1/0)return f1(Ct($s(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return ps(Ct(Bn(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const xv=xe({norm_:D9});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9(n,e=null,t=!1){return xv(n,"euclidean",e,t)}const P9=xe({euclideanNorm_:_9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F9(n){const t={x:oe(n,"x","exp")};return pe.runKernel(O0,t)}const Ka=xe({exp_:F9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(n,e=0){const t=oe(n,"x","expandDims","string_or_numeric");ee(e<=t.rank,()=>"Axis must be <= rank of the tensor");const r={input:t},s={dim:e};return pe.runKernel(Tb,r,s)}const js=xe({expandDims_:M9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(n){const t={x:oe(n,"x","expm1")};return pe.runKernel(D0,t)}const B9=xe({expm1_:L9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(n,e){const t=oe(n,"x","tile","string_or_numeric");ee(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const r={x:t},s={reps:e};return pe.runKernel(cy,r,s)}const Go=xe({tile_:z9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(n,e,t,r="float32"){e==null&&(e=n);const s=Bt([n,e],r),i=n<=e?n:e;for(let a=0;a<i;++a)s.set(1,a,a);const o=ye(s.toTensor(),[n,e]);if(t==null)return o;if(t.length===1)return Go(js(o,0),[t[0],1,1]);if(t.length===2)return Go(js(js(o,0),0),[t[0],t[1],1,1]);if(t.length===3)return Go(js(js(js(o,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const XM=xe({eye_:U9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V9(n){const t={x:oe(n,"x","floor","float32")};return pe.runKernel(_0,t)}const bv=xe({floor_:V9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9(n,e,t=0,r=0){const s=oe(n,"x","gather"),i=oe(e,"indices","gather","int32"),o={x:s,indices:i},a={axis:t,batchDims:r};return pe.runKernel($b,o,a)}const CA=xe({gather_:W9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(n,e){let t=oe(n,"a","greater","string_or_numeric"),r=oe(e,"b","greater","string_or_numeric");[t,r]=dr(t,r),Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(Rb,s)}const Vi=xe({greater_:G9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(n,e){let t=oe(n,"a","greaterEqual","string_or_numeric"),r=oe(e,"b","greaterEqual","string_or_numeric");[t,r]=dr(t,r),Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(F0,s)}const fh=xe({greaterEqual_:H9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j9(n){const t={input:oe(n,"input","imag")};return pe.runKernel(X2,t)}const kA=xe({imag_:j9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(n){const t={x:oe(n,"x","isFinite")};return pe.runKernel(L0,t)}const q9=xe({isFinite_:K9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(n){const t={x:oe(n,"x","isInf")};return pe.runKernel(B0,t)}const Q9=xe({isInf_:X9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(n){const t={x:oe(n,"x","isNaN")};return pe.runKernel(z0,t)}const J9=xe({isNaN_:Y9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(n,e=.2){const r={x:oe(n,"x","leakyRelu")},s={alpha:e};return pe.runKernel(Ob,r,s)}const IA=xe({leakyRelu_:Z9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eK(n,e){let t=oe(n,"a","less","string_or_numeric"),r=oe(e,"b","less","string_or_numeric");[t,r]=dr(t,r),Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(Db,s)}const h1=xe({less_:eK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tK(n,e){let t=oe(n,"a","lessEqual","string_or_numeric"),r=oe(e,"b","lessEqual","string_or_numeric");[t,r]=dr(t,r),Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(_b,s)}const Xp=xe({lessEqual_:tK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nK(n,e=5,t=1,r=1,s=.5){const i=oe(n,"x","localResponseNormalization");ee(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),ee(xp(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=ye(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},u={depthRadius:e,bias:t,alpha:r,beta:s},f=pe.runKernel(Lb,l,u);return a?ye(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const rK=xe({localResponseNormalization_:nK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sK(n){const t={x:oe(n,"x","log","float32")};return pe.runKernel(U0,t)}const qa=xe({log_:sK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(n){const t={x:oe(n,"x","log1p")};return pe.runKernel(V0,t)}const QM=xe({log1p_:iK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oK(n,e){ee(GI(n),()=>"The f passed in variableGrads(f) must be a function"),ee(e==null||Array.isArray(e)&&e.every(u=>u instanceof u1),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const u in pe.registeredVariables)e.push(pe.registeredVariables[u])}const r=t?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),ee(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:o,grads:a}=pe.gradients(n,e,null,i);ee(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),ee(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((u,f)=>{a[f]!=null&&(l[u.name]=a[f])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:o,grads:l}}function Cp(n){return pe.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aK(n){const t={x:oe(n,"x","neg")};return pe.runKernel(Hb,t)}const hr=xe({neg_:aK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(n){const t={x:oe(n,"x","softplus")};return pe.runKernel(sy,t)}const dy=xe({softplus_:lK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uK(n){const e=oe(n,"x","logSigmoid");return Cp(r=>({value:hr(dy(hr(r))),gradFunc:o=>fe(o,qp(hr(r)))}))(e)}const cK=xe({logSigmoid_:uK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fK(n,e){let t=oe(n,"a","sub"),r=oe(e,"b","sub");[t,r]=dr(t,r);const s={a:t,b:r};return pe.runKernel(ay,s)}const Tt=xe({sub_:fK});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hK(n,e=-1){const t=oe(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Cp((s,i)=>{const a=jo(s,e,!0),l=Tt(s,a),u=Tt(it(l,"float32"),qa(Ct(Ka(l),e,!0)));return i([u]),{value:u,gradFunc:(h,p)=>{const[g]=p,m=!0,w=Ka(g);return Tt(h,fe(Ct(h,e,m),w))}}})(t)}const YM=xe({logSoftmax_:hK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dK(n,e=null,t=!1){const r=oe(n,"x","logSumExp"),s=zt(e,r.shape),i=jo(r,s,!0),o=Tt(r,i),a=Ka(o),l=Ct(a,s),u=qa(l),f=qe(ye(i,u.shape),u);if(t){const h=Ir(f.shape,s);return ye(f,h)}return f}const JM=xe({logSumExp_:dK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pK(n,e){const t=oe(n,"a","logicalAnd","bool"),r=oe(e,"b","logicalAnd","bool");Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(Pb,s)}const Pl=xe({logicalAnd_:pK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gK(n){const t={x:oe(n,"x","logicalNot","bool")};return pe.runKernel(Fb,t)}const EA=xe({logicalNot_:gK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mK(n,e){const t=oe(n,"a","logicalOr","bool"),r=oe(e,"b","logicalOr","bool");Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(Mb,s)}const ZM=xe({logicalOr_:mK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yK(n,e){const t=oe(n,"a","logicalXor","bool"),r=oe(e,"b","logicalXor","bool");return Dt(t.shape,r.shape),Pl(ZM(n,e),EA(Pl(n,e)))}const wK=xe({logicalXor_:yK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xK(n,e,t,r,s){const i=oe(n,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=ye(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ee(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),ee(gs(t,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),ni("maxPool",r,s);const u={x:a},f={filterSize:e,strides:t,pad:r,dimRoundingMode:s},h=pe.runKernel(zb,u,f);return l?ye(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const AA=xe({maxPool_:xK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bK(n,e=[1,1,1],t,r,s,i="NDHWC"){const o=oe(n,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=ye(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ee(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),ee(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),ni("maxPool3d",r,s);const u={x:a},f={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i},h=pe.runKernel(Ub,u,f);return l?ye(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const vK=xe({maxPool3d_:bK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SK(n,e){let t=oe(n,"a","maximum"),r=oe(e,"b","maximum");[t,r]=dr(t,r),t.dtype==="bool"&&(t=it(t,"int32"),r=it(r,"int32")),Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(W0,s)}const hc=xe({maximum_:SK});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CK(n,e=null,t=!1){const s={x:oe(n,"x","mean")},i={axis:e,keepDims:t};return pe.runKernel(Vb,s,i)}const Cr=xe({mean_:CK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vr(n,e="float32"){if(Vl(n),e==="complex64"){const r=Vr(n,"float32"),s=Vr(n,"float32");return Vf(r,s)}const t=ds(De(n),e);return pe.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dc(n,e="float32"){if(Vl(n),e==="complex64"){const r=dc(n,"float32"),s=Vr(n,"float32");return Vf(r,s)}const t=C2(De(n),e);return pe.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kK(n,e){let t=oe(n,"a","minimum"),r=oe(e,"b","minimum");[t,r]=dr(t,r),t.dtype==="bool"&&(t=it(t,"int32"),r=it(r,"int32")),Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(G0,s)}const _m=xe({minimum_:kK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IK(n,e,t){ee(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const r=oe(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");ee(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=t==="reflect"?1:0;for(let a=0;a<r.rank;a++)ee(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ee(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:t},o={x:r};return pe.runKernel(Gb,o,i)}const EK=xe({mirrorPad_:IK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AK(n,e){let t=oe(n,"a","mod"),r=oe(e,"b","mod");[t,r]=dr(t,r);const s={a:t,b:r};return pe.runKernel(H0,s)}const TK=xe({mod_:AK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NK(n,e=null,t=!1){n=oe(n,"x","moments");const r=zt(e,n.shape),s=Cr(n,r,t);let i=s.shape;t||(i=Ir(s.shape,r));const o=Bn(Tt(it(n,"float32"),ye(s,i))),a=Cr(o,r,t);return{mean:s,variance:a}}const TA=xe({moments_:NK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $K(n,e){let t=oe(n,"a","notEqual","string_or_numeric"),r=oe(e,"b","notEqual","string_or_numeric");[t,r]=dr(t,r),Dt(t.shape,r.shape);const s={a:t,b:r};return pe.runKernel(jb,s)}const d1=xe({notEqual_:$K});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RK(n,e,t=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:oe(n,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:t,offValue:r};return pe.runKernel(qb,o,a)}const eL=xe({oneHot_:RK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OK(n){const t={x:oe(n,"x","onesLike")};return pe.runKernel(Kb,t)}const mo=xe({onesLike_:OK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DK(n,e,t=0){const r=oe(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:t},i={x:r};return pe.runKernel(Qb,i,s)}const NA=xe({pad_:DK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _K(n,e,t){const r=oe(n,"x","spaceToBatchND");ee(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),ee(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),ee(r.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+t[l-1][0]+t[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:t};return pe.runKernel(ov,s,i)}const $A=xe({spaceToBatchND_:_K});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PK(n,e,t,r,s,i,o){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const a=oe(n,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=ye(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ee(gs(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const f=wo(l.shape,e,i,s,r),h=[f.dilationHeight,f.dilationWidth];let p;r==="same"?p=MK([f.filterHeight,f.filterWidth],h):p=[[0,0],[0,0]];const g=h[0]===1&&h[1]===1,[m,w]=FK([f.inHeight,f.inWidth],h,p),x=g?r:"valid",b=g?l:$A(l,h,m),$=(t==="avg"?()=>yA(b,e,i,x,o):()=>AA(b,e,i,x,o))(),k=g?$:wA($,h,w);return u?ye(k,[k.shape[1],k.shape[2],k.shape[3]]):k}function FK(n,e,t){const r=t.map(f=>f[0]),s=t.map(f=>f[1]),i=n.concat(r,s),o=e.map((f,h)=>(f-i[h]%f)%f),a=s.map((f,h)=>f+o[h]),l=e.map((f,h)=>[r[h],a[h]]),u=e.map((f,h)=>[0,o[h]]);return[l,u]}function MK(n,e){const r=n.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),s=r.map(o=>Math.floor(o/2)),i=r.map((o,a)=>o-s[a]);return r.map((o,a)=>[s[a],i[a]])}const LK=xe({pool_:PK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BK(n,e){const t=oe(n,"x","prelu"),r=oe(e,"alpha","prelu"),s={x:t,alpha:r};return pe.runKernel(Yb,s)}const RA=xe({prelu_:BK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zK(n,e=null,t=!1){let r=oe(n,"x","prod");r.dtype==="bool"&&(r=it(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return pe.runKernel(Jb,s,i)}const UK=xe({prod_:zK});var $x={exports:{}},VK=$x.exports,qO;function WK(){return qO||(qO=1,function(n){(function(e,t,r){function s(l){var u=this,f=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=f(" "),u.s1=f(" "),u.s2=f(" "),u.s0-=f(l),u.s0<0&&(u.s0+=1),u.s1-=f(l),u.s1<0&&(u.s1+=1),u.s2-=f(l),u.s2<0&&(u.s2+=1),f=null}function i(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function o(l,u){var f=new s(l),h=u&&u.state,p=f.next;return p.int32=function(){return f.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,h&&(typeof h=="object"&&i(h,f),p.state=function(){return i(f,{})}),p}function a(){var l=4022871197,u=function(f){f=String(f);for(var h=0;h<f.length;h++){l+=f.charCodeAt(h);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return u}t.exports?t.exports=o:this.alea=o})(VK,n)}($x)),$x.exports}var Rx={exports:{}},GK=Rx.exports,XO;function HK(){return XO||(XO=1,function(n){(function(e,t,r){function s(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var f=0;f<u.length+64;f++)l.x^=u.charCodeAt(f)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var u=new s(a),f=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(p+g)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,f&&(typeof f=="object"&&i(f,u),h.state=function(){return i(u,{})}),h}t.exports?t.exports=o:this.xor128=o})(GK,n)}(Rx)),Rx.exports}var Ox={exports:{}},jK=Ox.exports,QO;function KK(){return QO||(QO=1,function(n){(function(e,t,r){function s(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var f=0;f<u.length+64;f++)l.x^=u.charCodeAt(f)|0,f==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var u=new s(a),f=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(p+g)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,f&&(typeof f=="object"&&i(f,u),h.state=function(){return i(u,{})}),h}t.exports?t.exports=o:this.xorwow=o})(jK,n)}(Ox)),Ox.exports}var Dx={exports:{}},qK=Dx.exports,YO;function XK(){return YO||(YO=1,function(n){(function(e,t,r){function s(a){var l=this;l.next=function(){var f=l.x,h=l.i,p,g;return p=f[h],p^=p>>>7,g=p^p<<24,p=f[h+1&7],g^=p^p>>>10,p=f[h+3&7],g^=p^p>>>3,p=f[h+4&7],g^=p^p<<7,p=f[h+7&7],p=p^p<<13,g^=p^p<<9,f[h]=g,l.i=h+1&7,g};function u(f,h){var p,g=[];if(h===(h|0))g[0]=h;else for(h=""+h,p=0;p<h.length;++p)g[p&7]=g[p&7]<<15^h.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],f.x=g,f.i=0,p=256;p>0;--p)f.next()}u(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),f=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(p+g)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,f&&(f.x&&i(f,u),h.state=function(){return i(u,{})}),h}t.exports?t.exports=o:this.xorshift7=o})(qK,n)}(Dx)),Dx.exports}var _x={exports:{}},QK=_x.exports,JO;function YK(){return JO||(JO=1,function(n){(function(e,t,r){function s(a){var l=this;l.next=function(){var f=l.w,h=l.X,p=l.i,g,m;return l.w=f=f+1640531527|0,m=h[p+34&127],g=h[p=p+1&127],m^=m<<13,g^=g<<17,m^=m>>>15,g^=g>>>12,m=h[p]=m^g,l.i=p,m+(f^f>>>16)|0};function u(f,h){var p,g,m,w,x,b=[],C=128;for(h===(h|0)?(g=h,h=null):(h=h+"\0",g=0,C=Math.max(C,h.length)),m=0,w=-32;w<C;++w)h&&(g^=h.charCodeAt((w+32)%h.length)),w===0&&(x=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,w>=0&&(x=x+1640531527|0,p=b[w&127]^=g+x,m=p==0?m+1:0);for(m>=128&&(b[(h&&h.length||0)&127]=-1),m=127,w=4*128;w>0;--w)g=b[m+34&127],p=b[m=m+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,b[m]=g^p;f.w=x,f.X=b,f.i=m}u(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var u=new s(a),f=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(p+g)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,f&&(f.X&&i(f,u),h.state=function(){return i(u,{})}),h}t.exports?t.exports=o:this.xor4096=o})(QK,n)}(_x)),_x.exports}var Px={exports:{}},JK=Px.exports,ZO;function ZK(){return ZO||(ZO=1,function(n){(function(e,t,r){function s(a){var l=this,u="";l.next=function(){var h=l.b,p=l.c,g=l.d,m=l.a;return h=h<<25^h>>>7^p,p=p-g|0,g=g<<24^g>>>8^m,m=m-h|0,l.b=h=h<<20^h>>>12^p,l.c=p=p-g|0,l.d=g<<16^p>>>16^m,l.a=m-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var f=0;f<u.length+20;f++)l.b^=u.charCodeAt(f)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var u=new s(a),f=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var p=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(p+g)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,f&&(typeof f=="object"&&i(f,u),h.state=function(){return i(u,{})}),h}t.exports?t.exports=o:this.tychei=o})(JK,n)}(Px)),Px.exports}var Fx={exports:{}};const eq={},tq=Object.freeze(Object.defineProperty({__proto__:null,default:eq},Symbol.toStringTag,{value:"Module"})),tL=u8(tq);var nq=Fx.exports,eD;function rq(){return eD||(eD=1,function(n){(function(e,t,r){var s=256,i=6,o=52,a="random",l=r.pow(s,i),u=r.pow(2,o),f=u*2,h=s-1,p;function g(k,N,_){var U=[];N=N==!0?{entropy:!0}:N||{};var O=b(x(N.entropy?[k,$(t)]:k??C(),3),U),L=new m(U),T=function(){for(var I=L.g(i),v=l,A=0;I<u;)I=(I+A)*s,v*=s,A=L.g(1);for(;I>=f;)I/=2,v/=2,A>>>=1;return(I+A)/v};return T.int32=function(){return L.g(4)|0},T.quick=function(){return L.g(4)/4294967296},T.double=T,b($(L.S),t),(N.pass||_||function(I,v,A,M){return M&&(M.S&&w(M,L),I.state=function(){return w(L,{})}),A?(r[a]=I,v):I})(T,O,"global"in N?N.global:this==r,N.state)}function m(k){var N,_=k.length,U=this,O=0,L=U.i=U.j=0,T=U.S=[];for(_||(k=[_++]);O<s;)T[O]=O++;for(O=0;O<s;O++)T[O]=T[L=h&L+k[O%_]+(N=T[O])],T[L]=N;(U.g=function(I){for(var v,A=0,M=U.i,D=U.j,B=U.S;I--;)v=B[M=h&M+1],A=A*s+B[h&(B[M]=B[D=h&D+v])+(B[D]=v)];return U.i=M,U.j=D,A})(s)}function w(k,N){return N.i=k.i,N.j=k.j,N.S=k.S.slice(),N}function x(k,N){var _=[],U=typeof k,O;if(N&&U=="object")for(O in k)try{_.push(x(k[O],N-1))}catch{}return _.length?_:U=="string"?k:k+"\0"}function b(k,N){for(var _=k+"",U,O=0;O<_.length;)N[h&O]=h&(U^=N[h&O]*19)+_.charCodeAt(O++);return $(N)}function C(){try{var k;return p&&(k=p.randomBytes)?k=k(s):(k=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(k)),$(k)}catch{var N=e.navigator,_=N&&N.plugins;return[+new Date,e,_,e.screen,$(t)]}}function $(k){return String.fromCharCode.apply(0,k)}if(b(r.random(),t),n.exports){n.exports=g;try{p=tL}catch{}}else r["seed"+a]=g})(typeof self<"u"?self:nq,[],Math)}(Fx)),Fx.exports}var fk,tD;function sq(){if(tD)return fk;tD=1;var n=WK(),e=HK(),t=KK(),r=XK(),s=YK(),i=ZK(),o=rq();return o.alea=n,o.xor128=e,o.xorwow=t,o.xorshift7=r,o.xor4096=s,o.tychei=i,fk=o,fk}var OA=sq();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nL{constructor(e,t,r,s,i){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=OA.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,t,r=!1;for(;!r;){let s,i,o;do s=2*this.random()-1,i=2*this.random()-1,o=s*s+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*s*a,t=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class iq{constructor(e=0,t=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=OA.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(n,e=0,t=1,r,s){if(Vl(n),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new nL(e,t,r,!1,s),o=Bt(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const aq=xe({randomNormal_:oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lq(n,e=0,t=1,r="float32",s){Vl(n);const i=Bt(n,r),o=new iq(e,t,null,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const py=xe({randomUniform_:lq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pm(n,e,t=1,r="float32"){if(t===0)throw new Error("Cannot have a step of zero");const s={start:n,stop:e,step:t,dtype:r};return pe.runKernel(nA,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uq(n){const t={input:oe(n,"input","real")};return pe.runKernel(rA,t)}const p1=xe({real_:uq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cq(n){const t={x:oe(n,"x","reciprocal")};return pe.runKernel(q0,t)}const fq=xe({reciprocal_:cq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hq(n){const t={x:oe(n,"x","relu")};return pe.runKernel(X0,t)}const hh=xe({relu_:hq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(n){const t={x:oe(n,"x","relu6")};return pe.runKernel(Q0,t)}const rL=xe({relu6_:dq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pq(n,e){const r={x:oe(n,"x","reverse")},s={dims:e};return pe.runKernel(nv,r,s)}const Xf=xe({reverse_:pq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gq(n){const t={x:oe(n,"x","round")};return pe.runKernel(Y0,t)}const sL=xe({round_:gq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mq(n){const t={x:oe(n,"x","rsqrt","float32")};return pe.runKernel(J0,t)}const iL=xe({rsqrt_:mq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yq(n){const t={x:oe(n,"x","selu")};return pe.runKernel(Z0,t)}const oL=xe({selu_:yq});function wq(n,e,t,r,s,i=[1,1],o="NHWC"){const a=oe(n,"x","separableConv2d"),l=oe(e,"depthwiseFilter","separableConv2d"),u=oe(t,"pointwiseFilter","separableConv2d");let f=a,h=!1;if(a.rank===3&&(h=!0,f=ye(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ee(f.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${f.rank}.`),ee(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),ee(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),ee(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),ee(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const p=l.shape[2],g=l.shape[3];ee(u.shape[2]===p*g,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*g}, but got ${u.shape[2]}.`);const m=vA(f,l,r,s,o,i),x=Kf(m,u,1,"valid",o);return h?ye(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const aL=xe({separableConv2d_:wq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xq(n){const t={x:oe(n,"x","sign")};return pe.runKernel(ny,t)}const bq=xe({sign_:xq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(n){const t={x:oe(n,"x","sin","float32")};return pe.runKernel(ey,t)}const lL=xe({sin_:vq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(n){const t={x:oe(n,"x","sinh")};return pe.runKernel(ty,t)}const uL=xe({sinh_:Sq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cq(n,e,t){const r=oe(n,"x","slice1d");return ee(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Rn(r,[e],[t])}const DA=xe({slice1d_:Cq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kq(n,e,t){const r=oe(n,"x","slice2d");return ee(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Rn(r,e,t)}const cL=xe({slice2d_:kq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iq(n,e,t){const r=oe(n,"x","slice3d");return ee(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Rn(r,e,t)}const _A=xe({slice3d_:Iq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(n,e,t){const r=oe(n,"x","slice4d");return ee(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Rn(r,e,t)}const g1=xe({slice4d_:Eq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aq(n,e=-1){const t=oe(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const r={logits:t},s={dim:e};return pe.runKernel(lv,r,s)}const PA=xe({softmax_:Aq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tq(n){ee(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return pe.runKernel(H2,e)}const fL=xe({fft_:Tq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nq(n){ee(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return pe.runKernel(q2,e)}const oE=xe({ifft_:Nq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $q(n){const e=n.shape[n.shape.length-1],t=n.size/e;let r;if(e<=2){const s=ye(n,[t,e]);r=oE(s)}else{const s=[t,2*(e-1)],i=ye(p1(n),[t,e]),o=ye(kA(n),[t,e]),a=Xf(Rn(i,[0,1],[t,e-2]),1),l=fe(Xf(Rn(o,[0,1],[t,e-2]),1),on(-1)),u=Zs([i,a],1),f=Zs([o,l],1),h=ye(Vf(u,f),[s[0],s[1]]);r=oE(h)}if(r=p1(r),n.rank===3&&n.shape[0]!==0){const s=r,i=n.shape[0];r=ye(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const Rq=xe({irfft_:$q});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oq(n,e,t=0){const s={x:oe(n,"x","split")},i={numOrSizeSplits:e,axis:t};return pe.runKernel(av,s,i)}const Li=xe({split_:Oq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq(n,e){ee(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const r=n.size/t;let s;if(e!=null&&e<t){const m=n.shape.map(x=>0),w=n.shape.map(x=>x);w[n.shape.length-1]=e,s=Rn(n,m,w),t=e}else if(e!=null&&e>t){const m=n.shape.map(w=>w);m[n.shape.length-1]=e-t,s=Zs([n,Vr(m)],n.shape.length-1),t=e}else s=n;const i=qt(s),o=ye(Vf(s,i),[r,t]),a=fL(o),l=Math.floor(t/2)+1,u=p1(a),f=kA(a),h=Li(u,[l,t-l],u.shape.length-1),p=Li(f,[l,t-l],f.shape.length-1),g=s.shape.slice();return g[s.shape.length-1]=l,ye(Vf(h[0],p[0]),g)}const _q=xe({rfft_:Dq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pq(n,e){let t=oe(n,"a","squaredDifference"),r=oe(e,"b","squaredDifference");[t,r]=dr(t,r),Dt(t.shape,r.shape);const s={a:t,b:r},i={};return pe.runKernel(oy,s,i)}const Fq=xe({squaredDifference_:Pq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mq(n,e){const t=oe(n,"x","squeeze","string_or_numeric");return ye(t,ac(t.shape,e).newShape)}const gy=xe({squeeze_:Mq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(n,e=0){const t=RM(n,"tensors","stack","string_or_numeric");ee(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&ee(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const r=t,s={axis:e};return pe.runKernel(Xb,r,s)}const Fl=xe({stack_:Lq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bq(n,e=0){const r={x:oe(n,"x","step")},s={alpha:e};return pe.runKernel(fy,r,s)}const my=xe({step_:Bq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zq(n,e,t,r,s=0,i=0,o=0,a=0,l=0){const f={x:oe(n,"x","stridedSlice","string_or_numeric")},h={begin:e,end:t,strides:r,beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return pe.runKernel(lA,f,h)}const Uq=xe({stridedSlice_:zq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vq(n){const t={x:oe(n,"x","tan","float32")};return pe.runKernel(ly,t)}const Wq=xe({tan_:Vq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yi(n,e){U3(n);const t=dv(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return pv(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Im(n,e,t){if(U3(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=dv(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return pv(n,e,r,t)}function hL(n,e,t){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${s}.`;if(t.rank<s)throw new Error(i+` update.rank < ${s}. `);if(n.length<r+(t.rank-s))throw new Error(i+` Output shape length < ${r+(t.rank-s)}`);if(t.rank!==s+n.length-r)throw new Error(i+` update.rank != ${s+n.length-r}`);for(let o=0;o<s;++o)if(t.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${t.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<t.rank-s;++o)if(t.shape[o+s]!==n[o+r])throw new Error(i+` updates.shape[${o+s}] (${t.shape[o+s]}) != shape[${o+s}] (${n[o+s]})`)}function Gq(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}hL(t,e,n)}function dh(n,e,t){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=t.length;let o=1;for(let h=s;h<i;++h)o*=t[h];const a=s<1?1:s,l=De(e.shape)/a,u=[...vt(t.slice(0,s)),1],f=De(t);return{sliceRank:s,numUpdates:l,sliceSize:o,strides:u,outputSize:f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hq(n,e=1,t=!0){const r=oe(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},o={k:e,sorted:t},[a,l]=pe.runKernel(uA,i,o);return{values:a,indices:l}}const jq=xe({topk_:Hq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kq(n,e=0,t=1,r,s){if(Vl(n),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new nL(e,t,r,!0,s),o=Bt(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const dL=xe({truncatedNormal_:Kq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qq(n,e=0){const t=oe(n,"x","unique","string_or_numeric");ee(t.rank>0,()=>"The input tensor must be at least 1D");const r={x:t},s={axis:e},[i,o]=pe.runKernel(fA,r,s);return{values:i,indices:o}}const Xq=xe({unique_:qq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qq(n,e,t){const r=oe(n,"x","unsortedSegmentSum"),s=oe(e,"segmentIds","unsortedSegmentSum","int32");ee(xp(t),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},o={numSegments:t};return pe.runKernel(cv,i,o)}const pL=xe({unsortedSegmentSum_:Qq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(n,e=0){const t=oe(n,"x","unstack","string_or_numeric");ee(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const r={value:t},s={axis:e};return pe.runKernel(uv,r,s)}const Qf=xe({unstack_:Yq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jq(n,e=!0,t,r){return pe.makeVariable(n,e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gL(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const r=Bt(n,"int32"),s=Bt([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const o=r.indexToLoc(t[i]),a=i*n.length;s.values.set(o,a)}return s.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zq(n,e,t){const r=oe(n,"x","transpose");if(e==null&&(e=r.shape.map((o,a)=>a).reverse()),ee(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{ee(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?Ce(()=>{let o=p1(r),a=kA(r);return o=pe.runKernel(Cd,{x:o},i),a=pe.runKernel(Cd,{x:a},i),t&&(a=hr(a)),Vf(o,a)}):pe.runKernel(Cd,s,i)}const Kt=xe({transpose_:Zq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e7(n,e){if(e==null)return n.shape.slice();if(an(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let r=0;r<n.shape.length;r++)e[r]==null&&n.shape[r]!=null?t.push(n.shape[r]):t.push(e[r]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t7(n,e,t,r){const s=oe(n,"x","dropout");if(ee(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),ee(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Tr?s.clone():s;const i=e7(s,t),o=1-e,a=kt(bv(qe(py(i,0,1,"float32",r),o)),o);return fe(s,a)}const n7=xe({dropout_:t7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r7(n,e,t,r,s,i="NHWC",o){let a=n;n.rank===3&&(a=ye(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=ye(e,[1,e.shape[0],e.shape[1],e.shape[2]])),ee(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),ee(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),ee(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=i==="NHWC"?a.shape[3]:a.shape[1],f=i==="NHWC"?l.shape[3]:l.shape[1];ee(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),ee(f===t[3],()=>`Error in conv2dDerFilter: depth of dy (${f}) must match output depth for filter (${t[3]}).`),ni("conv2dDerFilter",s,o);const h={x:a,dy:l},p={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,filterShape:t};return pe.runKernel(_2,h,p)}const FA=xe({conv2DBackpropFilter_:r7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MA(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return fe(n,my(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function LA(n,e){let t=e;const r=Fr(n.shape,e.shape);return r.length>0&&(t=Ct(t,r)),ye(t,n.shape)}function BA(n,e,t,r){if(e==="linear")return n;if(e==="relu")return hh(n);if(e==="elu")return wv(n);if(e==="relu6")return rL(n);if(e==="prelu")return RA(n,t);if(e==="leakyrelu")return IA(n,r);if(e==="sigmoid")return qp(n);throw new Error(`Unknown fused activation ${e}.`)}const zA=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s7({x:n,filter:e,strides:t,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:f}){if(l=l||"linear",zA(pe.state.gradientDepth,l)===!1){ee(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let _=Kf(n,e,t,r,s,i,o);return a!=null&&(_=qe(_,a)),BA(_,l,u,f)}const h=oe(n,"x","conv2d","float32"),p=oe(e,"filter","conv2d","float32");let g=h,m=!1;h.rank===3&&(m=!0,g=ye(h,[1,h.shape[0],h.shape[1],h.shape[2]])),ee(g.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${g.rank}.`),ee(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),ni("fused conv2d",r,o);const w=s==="NHWC"?g.shape[3]:g.shape[1];ee(p.shape[2]===w,()=>`Error in conv2d: depth of input (${w}) must match input depth for filter ${p.shape[2]}.`),ee(gs(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const x=ts(g.shape,p.shape,t,i,r,o);let b;a!=null&&(b=oe(a,"bias","fused conv2d"),[b]=dr(b,h),s==="NHWC"?Dt(x.outShape,b.shape):(ee(b.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${b.shape.length}.`),ee(b.shape.length===0||b.shape[0]===x.outChannels||b.shape[0]===1,()=>`Error in fused conv2d: bias shape (${b.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let C;if(u!=null){const _=u.shape;if(ee(_.length<=1||_.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${_.length}.`),_.length===1)ee(_[0]===1||_[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the number of output channels (${x.outChannels}).`);else if(_.length===3)try{Dt(_,x.outShape)}catch{const O=`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(O)}C=oe(u,"prelu weights","fused conv2d")}const $=(_,U)=>{ee(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[O,L,T,I]=U,v=MA(_,T,l);ee(Hf(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const A=xA(L.shape,v,O,t,r),M=FA(L,v,O.shape,t,r),D=[A,M];if(I!=null){const B=LA(I,v);D.push(B)}return D},k={x:g,filter:p,bias:b,preluActivationWeights:C},N={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:f};return a==null?Cp((U,O,L)=>{let T=pe.runKernel(a1,k,N);return L([O,U,T]),m&&(T=ye(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:$}})(g,p):Cp((U,O,L,T)=>{let I=pe.runKernel(a1,k,N);return T([O,U,I,L]),m&&(I=ye(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:$}})(g,p,b)}const i7=xe({fusedConv2d_:s7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o7(n,e,t,r,s,i=[1,1],o){let a=n;n.rank===3&&(a=ye(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=ye(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},f={strides:r,pad:s,dimRoundingMode:o,dilations:i,filterShape:t};return pe.runKernel(U2,u,f)}const a7=xe({depthwiseConv2dNativeBackpropFilter_:o7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(n,e,t,r,s,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=ye(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:t},f={strides:r,pad:s,dimRoundingMode:o,dilations:i,inputShape:n},h=pe.runKernel(V2,u,f);return l?ye(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const u7=xe({depthwiseConv2dNativeBackpropInput_:l7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c7({a:n,b:e,transposeA:t=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(zA(pe.state.gradientDepth,i)===!1){let I=sn(n,e,t,r);return s!=null&&(I=qe(I,s)),BA(I,i,o,a)}let l=oe(n,"a","fused matMul"),u=oe(e,"b","fused matMul");[l,u]=dr(l,u);const f=t?l.shape[l.rank-2]:l.shape[l.rank-1],h=r?u.shape[u.rank-1]:u.shape[u.rank-2],p=t?l.shape[l.rank-1]:l.shape[l.rank-2],g=r?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),w=u.shape.slice(0,-2),x=De(m),b=De(w);ee(f===h,()=>`Error in fused matMul: inner shapes (${f}) and (${h}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${t} and transposeB=${r} must match.`);const $=Dt(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,g]),k=t?ye(l,[x,f,p]):ye(l,[x,p,f]),N=r?ye(u,[b,g,h]):ye(u,[b,h,g]);let _;s!=null&&(_=oe(s,"bias","fused matMul"),[_]=dr(_,l),Dt($,_.shape));let U;o!=null&&(U=oe(o,"prelu weights","fused matMul"));const O=(I,v)=>{const[A,M,D,B]=v,j=MA(ye(I,D.shape),D,i);let W,P;if(!t&&!r?(W=sn(j,M,!1,!0),P=sn(A,j,!0,!1)):!t&&r?(W=sn(j,M,!1,!1),P=sn(j,A,!0,!1)):t&&!r?(W=sn(M,j,!1,!0),P=sn(A,j,!1,!1)):(W=sn(M,j,!0,!0),P=sn(j,A,!0,!0)),s!=null){const E=LA(B,j);return[W,P,E]}else return[W,P]},L={a:k,b:N,bias:_,preluActivationWeights:U},T={transposeA:t,transposeB:r,activation:i,leakyreluAlpha:a};return s==null?Cp((v,A,M)=>{const D=pe.runKernel(o1,L,T);return M([v,A,D]),{value:ye(D,$),gradFunc:O}})(k,N):Cp((v,A,M,D)=>{const B=pe.runKernel(o1,L,T);return D([v,A,B,M]),{value:ye(B,$),gradFunc:O}})(k,N,_)}const nD=xe({fusedMatMul_:c7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f7(n,e,t,r,s="bilinear",i=0){const o=oe(n,"image","cropAndResize"),a=oe(e,"boxes","cropAndResize","float32"),l=oe(t,"boxInd","cropAndResize","int32"),u=a.shape[0];ee(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),ee(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),ee(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),ee(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),ee(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),ee(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const f={image:o,boxes:a,boxInd:l},h={method:s,extrapolationValue:i,cropSize:r};return pe.runKernel(L2,f,h)}const h7=xe({cropAndResize_:f7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(n){const e=oe(n,"image","flipLeftRight","float32");ee(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return pe.runKernel(K2,t,{})}const p7=xe({flipLeftRight_:d7});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g7(n){const e=oe(n,"image","grayscaleToRGB"),t=e.rank-1,r=e.shape[t];ee(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),ee(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,t),s[t]=3,Go(e,s)}const m7=xe({grayscaleToRGB_:g7});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(n){const e=oe(n,"image","RGBToGrayscale"),t=e.rank-1,r=e.shape[t];ee(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),ee(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,i=it(e,"float32"),o=yi([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Kg("ij,j->i",i,o);break;case 3:a=Kg("ijk,k->ij",i,o);break;case 4:a=Kg("ijkl,l->ijk",i,o);break;case 5:a=Kg("ijklm,m->ijkl",i,o);break;case 6:a=Kg("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=js(a,-1),it(a,s)}const w7=xe({rgbToGrayscale_:y7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x7(n,e,t=0,r=.5){const s=oe(n,"image","rotateWithOffset","float32");ee(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},o={radians:e,fillValue:t,center:r};return pe.runKernel(hA,i,o)}const b7=xe({rotateWithOffset_:x7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qp(n,e,t,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=n.shape[0];return t=Math.min(t,o),ee(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),ee(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),ee(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),ee(e.rank===1,()=>"scores must be a 1D tensor"),ee(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),ee(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=oe(n,"boxes","nonMaxSuppression","float32"),o=oe(e,"scores","nonMaxSuppression","float32"),a=Qp(i,o,t,r,s);t=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:t,iouThreshold:r,scoreThreshold:s};return pe.runKernel(Z2,{boxes:i,scores:o},l)}const S7=xe({nonMaxSuppression_:v7});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7(n,e,t){const r=k7(n,e,t),s=r<0?-(r+1):r;n.splice(s,0,e)}function k7(n,e,t){return I7(n,e,t)}function I7(n,e,t){let r=0,s=n.length,i=0,o=!1;for(;r<s;){i=r+(s-r>>>1);const a=t(e,n[i]);a>0?r=i+1:(s=i,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UA(n,e,t,r,s){return GA(n,e,t,r,s,0)}function VA(n,e,t,r,s,i){return GA(n,e,t,r,s,0,!1,i,!0)}function WA(n,e,t,r,s,i){return GA(n,e,t,r,s,i,!0)}function GA(n,e,t,r,s,i,o=!1,a=!1,l=!1){const u=[];for(let x=0;x<e.length;x++)e[x]>s&&u.push({score:e[x],boxIndex:x,suppressBeginIndex:0});u.sort(rD);const f=i>0?-.5/i:0,h=[],p=[];for(;h.length<t&&u.length>0;){const x=u.pop(),{score:b,boxIndex:C,suppressBeginIndex:$}=x;if(b<s)break;let k=!1;for(let N=h.length-1;N>=$;--N){const _=E7(n,C,h[N]);if(_>=r){k=!0;break}if(x.score=x.score*A7(r,f,_),x.score<=s)break}x.suppressBeginIndex=h.length,k||(x.score===b?(h.push(C),p.push(x.score)):x.score>s&&C7(u,x,rD))}const g=h.length,m=t-g;a&&m>0&&(h.push(...new Array(m).fill(0)),p.push(...new Array(m).fill(0)));const w={selectedIndices:h};return o&&(w.selectedScores=p),l&&(w.validOutputs=g),w}function E7(n,e,t){const r=n.subarray(e*4,e*4+4),s=n.subarray(t*4,t*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),f=Math.min(s[1],s[3]),h=Math.max(s[0],s[2]),p=Math.max(s[1],s[3]),g=(a-i)*(l-o),m=(h-u)*(p-f);if(g<=0||m<=0)return 0;const w=Math.max(i,u),x=Math.max(o,f),b=Math.min(a,h),C=Math.min(l,p),$=Math.max(b-w,0)*Math.max(C-x,0);return $/(g+m-$)}function A7(n,e,t){const r=Math.exp(e*t*t);return t<=n?r:0}function rD(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function T7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=oe(n,"boxes","nonMaxSuppressionAsync"),o=oe(e,"scores","nonMaxSuppressionAsync"),a=Qp(i,o,t,r,s);t=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),u=l[0],f=l[1],{selectedIndices:h}=UA(u,f,t,r,s);return i!==n&&i.dispose(),o!==e&&o.dispose(),yi(h,"int32")}const N7=T7;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=oe(n,"boxes","nonMaxSuppression"),a=oe(e,"scores","nonMaxSuppression"),l=Qp(o,a,t,r,s,i);t=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:o,scores:a},f={maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},h=pe.runKernel(tA,u,f);return{selectedIndices:h[0],selectedScores:h[1]}}const R7=xe({nonMaxSuppressionWithScore_:$7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function O7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=oe(n,"boxes","nonMaxSuppressionAsync"),a=oe(e,"scores","nonMaxSuppressionAsync"),l=Qp(o,a,t,r,s,i);t=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([o.data(),a.data()]),f=u[0],h=u[1],{selectedIndices:p,selectedScores:g}=WA(f,h,t,r,s,i);return o!==n&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:yi(p,"int32"),selectedScores:yi(g)}}const D7=O7;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=oe(n,"boxes","nonMaxSuppression"),a=oe(e,"scores","nonMaxSuppression"),l=Qp(o,a,t,r,s,null),u=l.maxOutputSize,f=l.iouThreshold,h=l.scoreThreshold,p={boxes:o,scores:a},g={maxOutputSize:u,iouThreshold:f,scoreThreshold:h,padToMaxOutputSize:i},m=pe.runKernel(eA,p,g);return{selectedIndices:m[0],validOutputs:m[1]}}const P7=xe({nonMaxSuppressionPadded_:_7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function F7(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=oe(n,"boxes","nonMaxSuppressionAsync"),a=oe(e,"scores","nonMaxSuppressionAsync"),l=Qp(o,a,t,r,s,null),u=l.maxOutputSize,f=l.iouThreshold,h=l.scoreThreshold,[p,g]=await Promise.all([o.data(),a.data()]),{selectedIndices:m,validOutputs:w}=VA(p,g,u,f,h,i);return o!==n&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:yi(m,"int32"),validOutputs:on(w,"int32")}}const M7=F7;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7(n,e,t=!1,r=!1){const s=oe(n,"images","resizeBilinear");ee(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),ee(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),ee(r===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=ye(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:t,halfPixelCenters:r,size:e},u=pe.runKernel(tv,a,l);return o?ye(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const mL=xe({resizeBilinear_:L7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7(n,e,t=!1,r=!1){const s=oe(n,"images","resizeNearestNeighbor");ee(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),ee(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),ee(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),ee(r===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=ye(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},l={alignCorners:t,halfPixelCenters:r,size:e},u=pe.runKernel(ev,a,l);return o?ye(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const yL=xe({resizeNearestNeighbor_:B7});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(n,e="binary",t=!1,r=.5){const s=oe(n,"image","threshold"),i=.2989,o=.587,a=.114,l=s.shape[0]*s.shape[1];let u=fe(yi([r]),255),f,h,p,g;if(ee(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),ee(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),ee(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),ee(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[f,h,p]=Li(s,[1,1,1],-1);const x=fe(f,i),b=fe(h,o),C=fe(p,a);g=qe(qe(x,b),C)}else g=n;if(e==="otsu"){const x=Bj(it(sL(g),"int32"),Nf([]),256);u=U7(x,l)}const m=t?Xp(g,u):Vi(g,u);return it(fe(m,255),"int32")}function U7(n,e){let t=yi([-1]),r=yi([0]),s=yi([0]),i,o,a,l,u,f;for(let h=0;h<n.size-1;h++){i=Rn(n,0,h+1),o=Rn(n,h+1),u=kt(Ct(i),e),f=kt(Ct(o),e);const p=Ct(fe(i,Pm(0,i.size)));a=kt(p,Ct(i));const g=yv(o.shape,i.size),m=qe(Pm(0,o.size),g),w=fe(o,m);l=kt(Ct(w),Ct(o));const x=Tt(a,l),b=Tt(a,l),C=fe(u,f);s=fe(fe(C,x),b);const $=Vi(s,r);r=Ds($,s,r),t=Ds($,yi([h]),t)}return t}const V7=xe({threshold_:z7});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W7(n,e,t="nearest",r="constant",s=0,i){const o=oe(n,"image","transform","float32"),a=oe(e,"transforms","transform","float32");ee(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),ee(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),ee(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},u={interpolation:t,fillMode:r,fillValue:s,outputShape:i};return pe.runKernel(cA,l,u)}const G7=xe({transform_:W7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H7(n,e,t){const r=oe(n,"a","bandPart");ee(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,o]=r.shape.slice(-2);let a,l;typeof e=="number"?(ee(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),ee(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=oe(e<0?i:e,"numLower","bandPart")):(ee(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Ds(h1(e,0),i,_m(e,i))),typeof t=="number"?(ee(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),ee(t<=o,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${o}).`),l=oe(t<0?o:t,"numUpper","bandPart")):(ee(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Ds(h1(t,0),o,_m(t,o)));const u=ye(Pm(0,i,1,"int32"),[-1,1]),f=Pm(0,o,1,"int32"),h=Tt(u,f),p=Pl(Xp(h,a),fh(h,hr(l))),g=Vr([i,o],r.dtype);return ye(Fl(Qf(ye(r,[-1,i,o])).map(m=>Ds(p,m,g))),s)}const j7=xe({bandPart_:H7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K7(n){let e;if(Array.isArray(n)){e=!1,ee(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=n[0].shape[0];for(let i=1;i<n.length;++i)ee(n[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${s})`)}else e=!0,n=Li(n,n.shape[0],0).map(s=>gy(s,[0]));ee(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],r=n;for(let s=0;s<n.length;++s)t.push(pe.tidy(()=>{let i=r[s];if(s>0)for(let o=0;o<s;++o){const a=fe(Ct(fe(t[o],i)),t[o]);i=Tt(i,a)}return kt(i,xv(i,"euclidean"))}));return e?Fl(t,0):t}const q7=xe({gramSchmidt_:K7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(n,e=!1){if(ee(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return sD(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,u)=>l*u),r=Qf(ye(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),s=[],i=[];r.forEach(l=>{const[u,f]=sD(l,e);s.push(u),i.push(f)});const o=ye(Fl(s,0),n.shape),a=ye(Fl(i,0),n.shape);return[o,a]}}function sD(n,e=!1){return pe.tidy(()=>{ee(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],r=n.shape[1];let s=XM(t),i=$f(n);const o=Im([[1]],[1,1]);let a=$f(o);const l=t>=r?r:t;for(let u=0;u<l;++u){const f=i,h=a,p=s;[a,i,s]=pe.tidy(()=>{const g=Rn(i,[u,u],[t-u,1]),m=xv(g),w=Rn(i,[u,u],[1,1]),x=Ds(Vi(w,0),Im([[-1]]),Im([[1]])),b=Tt(w,fe(x,m)),C=kt(g,b);C.shape[0]===1?a=$f(o):a=Zs([o,Rn(C,[1,0],[C.shape[0]-1,C.shape[1]])],0);const $=hr(kt(sn(x,b),m)),k=Rn(i,[u,0],[t-u,r]),N=fe($,a),_=Kt(a);if(u===0)i=Tt(k,sn(N,sn(_,k)));else{const L=Tt(k,sn(N,sn(_,k)));i=Zs([Rn(i,[0,0],[u,r]),L],0)}const U=Kt(N),O=Rn(s,[0,u],[t,s.shape[1]-u]);if(u===0)s=Tt(O,sn(sn(O,a),U));else{const L=Tt(O,sn(sn(O,a),U));s=Zs([Rn(s,[0,0],[t,u]),L],1)}return[a,i,s]}),Ft([f,h,p])}return!e&&t>r&&(s=Rn(s,[0,0],[t,r]),i=Rn(i,[0,0],[r,r])),[s,i]})}const Q7=xe({qr_:X7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rl={flipLeftRight:p7,grayscaleToRGB:m7,resizeNearestNeighbor:yL,resizeBilinear:mL,rgbToGrayscale:w7,rotateWithOffset:b7,cropAndResize:h7,nonMaxSuppression:S7,nonMaxSuppressionAsync:N7,nonMaxSuppressionWithScore:R7,nonMaxSuppressionWithScoreAsync:D7,nonMaxSuppressionPadded:P7,nonMaxSuppressionPaddedAsync:M7,threshold:V7,transform:G7},Y7={bandPart:j7,gramSchmidt:q7,qr:Q7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J7=new Map,Z7=new Map;class Yp{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class co{constructor(){this.classNameMap={}}static getMap(){return co.instance==null&&(co.instance=new co),co.instance}static register(e){co.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ve(n,e,t){ee(n.className!=null,()=>"Class being registered does not have the static className property defined."),ee(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),ee(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const r=t,s=e+">"+r;return co.register(n),J7.set(s,n),Z7.set(n,s),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pc extends Yp{minimize(e,t=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Ft(i),t?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return oK(e,t)}dispose(){this.iterations_!=null&&Ft(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:on(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(pc,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wL extends pc{static get className(){return"Adadelta"}constructor(e,t,r=null){super(),this.learningRate=e,this.rho=t,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=pe.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=pe.registeredVariables[r],o=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:Ce(()=>qt(i).variable(o))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:Ce(()=>qt(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;Ce(()=>{const f=qe(fe(l,this.rho),fe(Bn(a),1-this.rho)),h=fe(kt(ps(qe(u,this.epsilon)),ps(qe(l,this.epsilon))),a),p=qe(fe(u,this.rho),fe(Bn(h),1-this.rho));l.assign(f),u.assign(p);const g=qe(fe(h,-this.learningRate),i);i.assign(g)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ft(this.accumulatedGrads.map(e=>e.variable)),Ft(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xL extends pc{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=pe.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:Ce(()=>yv(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const a=this.accumulatedGrads[s].variable;Ce(()=>{const l=qe(a,Bn(o));a.assign(l);const u=qe(fe(kt(o,ps(qe(l,pe.backend.epsilon()))),-this.learningRate),i);i.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ft(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bL extends pc{static get className(){return"Adam"}constructor(e,t,r,s=null){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ce(()=>{this.accBeta1=on(t).variable(),this.accBeta2=on(r).variable()}),s==null&&(this.epsilon=pe.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ce(()=>{const r=Tt(1,this.accBeta1),s=Tt(1,this.accBeta2);t.forEach((i,o)=>{const a=pe.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Ce(()=>qt(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:Ce(()=>qt(a).variable(l))});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const f=this.accumulatedFirstMoment[o].variable,h=this.accumulatedSecondMoment[o].variable,p=qe(fe(f,this.beta1),fe(u,1-this.beta1)),g=qe(fe(h,this.beta2),fe(Bn(u),1-this.beta2)),m=kt(p,r),w=kt(g,s);f.assign(p),h.assign(g);const x=qe(fe(kt(m,qe(ps(w),this.epsilon)),-this.learningRate),a);a.assign(x)}),this.accBeta1.assign(fe(this.accBeta1,this.beta1)),this.accBeta2.assign(fe(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ft(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Ft(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),Ce(()=>{this.accBeta1.assign(qf(this.beta1,this.iterations_+1)),this.accBeta2.assign(qf(this.beta2,this.iterations_+1))});const t=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vL extends pc{static get className(){return"Adamax"}constructor(e,t,r,s=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ce(()=>{this.iteration=on(0).variable(),this.accBeta1=on(t).variable()}),s==null&&(this.epsilon=pe.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ce(()=>{const r=Tt(1,this.accBeta1),s=kt(-this.learningRate,qe(fe(this.iteration,this.decay),1));t.forEach((i,o)=>{const a=pe.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:qt(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:qt(a).variable(l)});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const f=this.accumulatedFirstMoment[o].variable,h=this.accumulatedWeightedInfNorm[o].variable,p=qe(fe(f,this.beta1),fe(u,1-this.beta1)),g=fe(h,this.beta2),m=$s(u),w=hc(g,m);f.assign(p),h.assign(w);const x=qe(fe(kt(s,r),kt(p,qe(w,this.epsilon))),a);a.assign(x)}),this.iteration.assign(qe(this.iteration,1)),this.accBeta1.assign(fe(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ft(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Ft(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HA extends pc{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const o=pe.registeredVariables[r];Ce(()=>{const a=qe(fe(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Ba(on(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SL extends HA{static get className(){return"Momentum"}constructor(e,t,r=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=r,this.accumulations=[],this.m=on(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=pe.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:Ce(()=>qt(i).variable(!1))});const o=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&Ce(()=>{let l;const u=qe(fe(this.m,o),a);this.useNesterov?l=qe(fe(this.c,qe(a,fe(u,this.m))),i):l=qe(fe(this.c,u),i),o.assign(u),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ft(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CL extends pc{static get className(){return"RMSProp"}constructor(e,t=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=pe.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=pe.registeredVariables[r],o=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:Ce(()=>qt(i).variable(o))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:Ce(()=>qt(i).variable(o))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:Ce(()=>qt(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;Ce(()=>{const f=qe(fe(l,this.decay),fe(Bn(a),1-this.decay));if(this.centered){const h=this.accumulatedMeanGrads[s].variable,p=qe(fe(h,this.decay),fe(a,1-this.decay)),g=kt(fe(a,this.learningRate),ps(Tt(f,qe(Bn(p),this.epsilon)))),m=qe(fe(u,this.momentum),g);l.assign(f),h.assign(p),u.assign(m);const w=Tt(i,m);i.assign(w)}else{const h=qe(fe(l,this.decay),fe(Bn(a),1-this.decay)),p=qe(fe(u,this.momentum),kt(fe(a,this.learningRate),ps(qe(h,this.epsilon))));l.assign(h),u.assign(p);const g=Tt(i,p);i.assign(g)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ft(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ft(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Ft(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eX=[wL,xL,bL,vL,SL,CL,HA];function tX(){for(const n of eX)Ve(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iD(n,e,t,r){o(n),t=t??0,r=r??1,a(t,r);let s=0;const i=l=>(l.then(u=>{const f=t+ ++s/n.length*(r-t);return e(f),u}),l);function o(l){ee(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){ee(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),ee(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),ee(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(n.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nX(n,e){e==null&&(e={});const t=e.fetchFunc==null?Te().platform.fetch:e.fetchFunc,r=n.map(h=>t(h,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(r):await iD(r,e.onProgress,0,.5)).map(h=>h.arrayBuffer());return e.onProgress==null?await Promise.all(a):await iD(a,e.onProgress,.5,1)}function rX(n,e){var t;const r=e.fetchFunc==null?Te().platform.fetch:e.fetchFunc;let s=0,i;return(t=e.onProgress)===null||t===void 0||t.call(e,0),new ReadableStream({pull:async o=>{for(var a;s<n.length;){i||(i=(await r(n[s],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await i.read();if(l){s++,i=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,s/n.length);continue}o.enqueue(u);return}o.close()}})}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sX="application/octet-stream",iX="application/json";class jA{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(ee(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Te().platform.fetch,ee(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&ee(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=xH(e,r);if(t.body.append("model.json",new Blob([JSON.stringify(s)],{type:iX}),"model.json"),e.weightData!=null){const o=uc.join(e.weightData);t.body.append("model.weights.bin",new Blob([o],{type:sX}),"model.weights.bin")}const i=await this.fetch(this.path,t);if(i.ok)return{modelArtifactsInfo:gA(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=t.modelTopology,s=t.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return vH(e,t=>this.loadWeights(t))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),r=HO(e.weightsManifest),s=()=>rX(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:s})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=oX(t),i=this.weightPathPrefix||r,o=[],a=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(u)):o.push(i+u+s);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const t=await this.getWeightUrls(e),r=HO(e),s=await nX(t,this.loadOptions);return[r,s]}}jA.URL_SCHEME_REGEX=/^https?:\/\//;function oX(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),r=n.substring(0,e),s=t>e?n.substring(t):"";return[r+"/",s]}function oD(n){return n.match(jA.URL_SCHEME_REGEX)!=null}const kL=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(r=>oD(r)):t=oD(n),t)return IL(n,e)}return null};zr.registerSaveRouter(kL);zr.registerLoadRouter(kL);function IL(n,e){return new jA(n,e)}function aX(n,e){return IL(n,e)}function KA(n,e){const t=n.shape.length,r=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${t}`);if(De(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const s=e.shape,i=s[s.length-1];let o=1;for(let h=0;h<s.length-1;++h)o*=s[h];const a=n.shape,l=s.slice();l.pop();let u=1;for(let h=i;h<t;++h)u*=a[h],l.push(a[h]);const f=[...vt(n.shape).map(h=>h/u),1].slice(0,i);return[l,o,u,f]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aE=-2,lX=-1;function qA(n,e,t){const r=n.shape.length;ee(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),ee(r===t.length,()=>`Error in slice${r}D: Length of size ${t} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)ee(e[s]+t[s]<=n.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+t[s]}) would overflow input.shape[${s}] (${n.shape[s]})`)}function uX(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function XA(n,e,t){const r=[];for(let s=0;s<n.length;s++)r[s]=Math.ceil((e[s]-n[s])/t[s]);return r}function EL(n,e,t,r){const s=[...n];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<t;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function AL(n,e,t){return t<=n?t:t-(e-1)}function TL(n,e){const t=[];for(let r=0;r<n;r++)t.push(e+r);return t}function cX(n,e,t,r,s,i,o,a,l){const u=n.length;let f=new Array(u),h=new Array(u),p=new Array(u);if(e.length&&t>0){const g=e[0],m=t+1;f=NL(o,g,m,r,n),h=$L(a,g,m,s,n),p=EL(i,g,m,n)}else for(let g=0;g<u;g++)f[g]=OL(o,r,i,n,g,l),h[g]=DL(a,s,i,n,g,l),p[g]=RL(i,g,l);return{begin:f,end:h,strides:p}}function NL(n,e,t,r,s){const i=[...s],o=TL(t,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=AL(e,t,a);let u=r[l];n&1<<l&&(u=0),i[a]=u}return i}function $L(n,e,t,r,s){const i=[...s],o=TL(t,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=AL(e,t,a);let u=r[l];n&1<<l&&(u=Number.MAX_SAFE_INTEGER),i[a]=u}for(let a=0;a<i.length;a++){const l=s[a];i[a]<0&&(i[a]+=l),i[a]=zf(0,i[a],s[a])}return i}function RL(n,e,t){let r=n[e];return(t&1<<e||r==null)&&(r=1),r}function OL(n,e,t,r,s,i){let o=e[s];const a=t[s]||1;(n&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),o=zf(0,o,l-1),o}function DL(n,e,t,r,s,i){let o=e[s];const a=t[s]||1;(n&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=r[s];return o<0&&(o+=l),a>0?o=zf(0,o,l):o=zf(-1,o,l-1),o}function QA(n,e,t){let r=t.length;for(let s=0;s<t.length;s++)if(t[s]>1){r=s;break}for(let s=r+1;s<t.length;s++)if(e[s]>0||t[s]!==n[s])return!1;return!0}function YA(n,e){let t=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function vv(n,e,t){let r;const s=n.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(o=>{ee(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return t==null?i=new Array(s).fill(-1):typeof t=="number"?i=[t,...new Array(s-1).fill(-1)]:t.length<s?i=t.concat(new Array(s-t.length).fill(-1)):i=t,i=i.map((o,a)=>o>=0?o:(ee(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),n.shape[a]-r[a])),[r,i]}function JA(n,e,t,r,s,i,o,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let f=!1;const h={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:u.slice(),beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let $=0;$<h.dims;$++)f&&1<<$&a&&h.numAddAxisAfterEllipsis++,1<<$&o&&(f=!0);f||(h.ellipsisMask|=1<<h.dims,h.dims++);const p={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};fX(h,p);let g=!0,m=!0,w=!0;const x=[],b=[];for(let $=0;$<n.length;++$){if(p.strides[$]===0)throw Error(`strides[${$}] must be non-zero`);const k=!!(p.shrinkAxisMask&1<<$),N=n[$];if(N===-1){x.push(k?1:-1);continue}const _=[p.beginMask&1<<$,p.endMask&1<<$],U=[p.strides[$]>0?0:-1,p.strides[$]>0?N:N-1];if(k&&p.strides[$]<=0)throw Error("only stride 1 allowed on non-range indexing.");w=w&&p.strides[$]===1;const O=!!(p.beginMask&1<<$&&p.endMask&1<<$);if(p.beginValid&&p.endValid){if(k){const v=p.begin[$]<0?N+p.begin[$]:p.begin[$];if(p.begin[$]=v,p.end[$]=p.begin[$]+1,v<0||v>=N)throw Error(`slice index ${p.begin[$]} of dimension ${$} out of bounds.`)}else p.begin[$]=aD(p.begin[$],0,p.strides[$],N,_,U),p.end[$]=aD(p.end[$],1,p.strides[$],N,_,U);const I=p.strides[$]===1&&p.begin[$]===0&&p.end[$]===N;g=g&&I,m=m&&($===0&&p.strides[$]===1||I)}else g=g&&p.strides[$]===1&&O,m=m&&($===0&&p.strides[$]===1||O);let L,T=!1;if(p.beginValid&&p.endValid?(L=p.end[$]-p.begin[$],T=!0):k?(L=1,T=!0):O&&N>=0&&(p.strides[$]<0?L=-N:L=N,T=!0),T){let I;L===0||L<0!=p.strides[$]<0?I=0:I=Math.trunc(L/p.strides[$])+(L%p.strides[$]!==0?1:0),x.push(I)}else x.push(-1)}for(let $=0;$<p.finalShapeGatherIndices.length;++$){const k=p.finalShapeGatherIndices[$];k>=0?b.push(x[k]):k===aE&&b.push(1)}return{finalShapeSparse:b.filter(($,k)=>p.finalShapeGatherIndices[k]!==aE),finalShape:b,isIdentity:g,sliceDim0:m,isSimpleSlice:w,begin:p.begin,end:p.end,strides:p.strides}}function fX(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const s=Math.min(e.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<s;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=r}else if(1<<r&n.newAxisMask)e.finalShapeGatherIndices.push(aE),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[r]),n.end!=null&&(e.end[t]=n.end[r]),e.strides[t]=n.strides[r],n.beginMask&1<<r&&(e.beginMask|=1<<t),n.endMask&1<<r&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(lX),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[t]=r,t++}}function aD(n,e,t,r,s,i){if(s[e])return t>0?i[e]:i[e+1&1];{const o=n<0?r+n:n;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const hX=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:qA,computeFlatOffset:YA,computeOutShape:XA,getNormalizedAxes:cX,isSliceContinous:QA,maskToAxes:uX,parseSliceParams:vv,sliceInfo:JA,startForAxis:OL,startIndicesWithElidedDims:NL,stopForAxis:DL,stopIndicesWithElidedDims:$L,stridesForAxis:RL,stridesWithElidedDims:EL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dX{static sgd(e){return new HA(e)}static momentum(e,t,r=!1){return new SL(e,t,r)}static rmsprop(e,t=.9,r=0,s=null,i=!1){return new CL(e,t,r,s,i)}static adam(e=.001,t=.9,r=.999,s=null){return new bL(e,t,r,s)}static adadelta(e=.001,t=.95,r=null){return new wL(e,t,r)}static adamax(e=.002,t=.9,r=.999,s=null,i=0){return new vL(e,t,r,s,i)}static adagrad(e,t=.1){return new xL(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jh=dX;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function _L(){return new Promise(n=>pX(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZA(n,e){const t=n[0].length;n.forEach((s,i)=>{ee(s.length===t,()=>`Error in concat${t}D: rank of tensors[${i}] must be the same as the rank of the rest (${t})`)}),ee(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const r=n[0];n.forEach((s,i)=>{for(let o=0;o<t;o++)ee(o===e||s[o]===r[o],()=>`Error in concat${t}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function za(n,e){const t=n[0].slice();for(let r=1;r<n.length;r++)t[e]+=n[r][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Vo;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Vo||(Vo={}));function PL(n,e,t){let r=new Array;if(t==null&&e==null)return r;if(e==null)for(;r.length<n+t.length;)r.push(-1);else r=e.slice();if(t==null)return r;if(n+t.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${r.length}`);for(let s=1;s<t.length;++s){const i=t[s],o=r[r.length-t.length+s],a=r[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+n}] = ${i} but shape[${s+n}] = ${a}`)}else r[o]=i}return r}function FL(n){const e={FIRST_DIM_SIZE:Vo.FIRST_DIM_SIZE,VALUE_ROWIDS:Vo.VALUE_ROWIDS,ROW_LENGTHS:Vo.ROW_LENGTHS,ROW_SPLITS:Vo.ROW_SPLITS,ROW_LIMITS:Vo.ROW_LIMITS,ROW_STARTS:Vo.ROW_STARTS},t=[];for(const r of n)if(r in e)t.push(e[r]);else break;return t}function ML(n){return n.length===0?0:n[0]===Vo.FIRST_DIM_SIZE?n.length-1:n.length}function LL(n,e){if(n==null||e==null)return;const t=n.length,r=e.length;if(t>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(t,r-1);++s){const i=n[s],o=e[s+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-n.length}] = ${i} but ragged tensor input.flatValues.shape[${s-n.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eT=30;function Sv(n){return n<=eT?n:HI(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tT(n,e,t){const r=t*(typeof n=="number"?n:n[0]),s=e*(typeof n=="number"?n:n[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yy(n,e,t,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(n[0]/t),s=s.concat(n.slice(1));else{s=s.concat(n[0]);const i=e.length;for(let o=0;o<i;++o)s=s.concat([n[o+1]/e[o],e[o]]);s=s.concat(n.slice(i+1))}return s}function wy(n,e,t=!0){const r=[];if(t){r.push(e);for(let s=e+1;s<n;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let o=1;o<n;++o)o>=e*2+1||o%2===1?i.push(o):s.push(o);r.push(...s),r.push(0),r.push(...i)}return r}function xy(n,e,t,r=!0){const s=[];r?s.push(n[0]/t):s.push(n[0]*t);for(let i=1;i<n.length;++i)i<=e.length?r?s.push(e[i-1]*n[i]):s.push(n[i]/e[i-1]):s.push(n[i]);return s}function nT(n,e){const t=[0];for(let r=0;r<e;++r)t.push(n[r][0]);return t}function rT(n,e,t){const r=n.slice(0,1);for(let s=0;s<t;++s)r.push(n[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cv=1.7580993408473768,kv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sT=.3275911,iT=.254829592,oT=-.284496736,aT=1.421413741,lT=-1.453152027,uT=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ml(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function BL(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)e[r/2]=n[r],t[r/2]=n[r+1];return{real:e,imag:t}}function zL(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function UL(n){const e=Math.floor(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function cT(n,e){const t=n[e*2],r=n[e*2+1];return{real:t,imag:r}}function VL(n,e,t,r){n[r*2]=e,n[r*2+1]=t}function WL(n,e){const t=new Float32Array(n/2),r=new Float32Array(n/2);for(let s=0;s<Math.ceil(n/2);s++){const i=(e?2:-2)*Math.PI*(s/n);t[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:t,imag:r}}function GL(n,e,t){const r=(t?2:-2)*Math.PI*(n/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hk="->",gX=/->/g,lD=",",uD="...";function fT(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(gX,"").length)/hk.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${hk}").`);const[r,s]=n.split(hk);ee(r.indexOf(uD)===-1,()=>`The ellipsis notation ("${uD}") is not supported yet.`);const i=r.split(lD),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let p=0;p<s.length;++p){const g=s[p];if(!i.some(m=>m.indexOf(g)!==-1))throw new Error(`Output subscripts contain the label ${g} not present in the input subscripts.`);a.indexOf(g)===-1&&a.push(g)}for(let p=0;p<r.length;++p){const g=r[p];a.indexOf(g)===-1&&g!==lD&&a.push(g)}const l=new Array(i.length);for(let p=0;p<o;++p){if(new Set(i[p].split("")).size!==i[p].length)throw new Error(`Found duplicate axes in input component ${i[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let g=0;g<i[p].length;++g)l[p].push(a.indexOf(i[p][g]))}const u=a.length,f=s.length,h=[];for(let p=f;p<u;++p)h.push(p);return{allDims:a,summedDims:h,idDims:l}}function hT(n,e){let t=new Array(n);t.fill(-1);for(let s=0;s<e.length;++s)t[e[s]]=s;const r=[];for(let s=0;s<n;++s)t[s]===-1&&r.push(s);return t=t.filter(s=>s!==-1),{permutationIndices:t,expandDims:r}}function dT(n,e,t){const r=new Array(n);for(let s=0;s<t.length;++s){const i=t[s].shape;for(let o=0;o<e[s].length;++o)r[e[s][o]]===void 0?r[e[s][o]]=i[o]:ee(r[e[s][o]]===i[o],()=>`Expected dimension ${r[e[s][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function pT(n,e){const t=n,r=[];let s=0;n.length===0&&t.push(-1),s=n.length+1;for(let o=0;o<s;++o)r.push([]);const i=[];for(let o=0;o<t.length;++o){const a=t[o],l=mX(e,a);for(const u of l)i.indexOf(u)===-1&&(r[o].push(u),i.push(u))}return{path:t,steps:r}}function gT(n){return n.every((e,t)=>e===t)}function mX(n,e){const t=[];for(let r=0;r<n.length;++r)(n[r].length===0||n[r].indexOf(e)!==-1||e===-1)&&t.push(r);return t}function mT(n,e,t=0){let r=[];if(typeof e=="number")ee(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(n.shape[t]/e);else{const s=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);ee(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=n.shape[t]-o}ee(n.shape[t]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HL(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function jL(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function KL(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function XL(n,e){return`size ${n} must be non-negative, not ${e}`}function QL(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function YL(n,e){const t=De(n),r=De(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${n} outputShape= ${e}`}function JL(n,e){const t=De(n),r=De(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${r}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lE(){return"segment ids must be >= 0"}function ZL(){return"segment ids are not increasing"}function eB(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function tB(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(n,e){let t=!1,r;for(n<=eT?(r=n,t=!0):r=HI(n,Math.floor(Math.sqrt(n)));!t;)r>e||r===n?t=!0:r=HI(n,r+1);return r}function rB(n,e,t){const r=[],s=n.length;for(let i=0;i<s;i++)i!==e?r.push(n[i]):r.push(t);return r}function yT(n,e,t,r){const s=e.shape.length,i=n.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(t<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${t}).`);for(let h=0;h<r;++h)if(n.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${n.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const o=n.shape[t],a=[];let l=1,u=1,f=1;for(let h=0;h<r;++h)a.push(n.shape[h]),l*=n.shape[h];for(let h=r;h<t;h++)a.push(n.shape[h]),u*=n.shape[h];for(let h=r;h<s;h++)a.push(e.shape[h]);for(let h=t+1;h<i;h++)a.push(n.shape[h]),f*=n.shape[h];return{batchSize:l,sliceSize:f,outerSize:u,dimSize:o,outputShape:a}}const yX=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:yT,computeOutShape:rB,segOpComputeOptimalWindowSize:nB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ll(n){try{return n.map(e=>Qu(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function sB(n){return n.map(e=>ju(e))}const wX=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:iT,ERF_A2:oT,ERF_A3:aT,ERF_A4:lT,ERF_A5:uT,ERF_P:sT,PARALLELIZE_THRESHOLD:eT,get RowPartitionType(){return Vo},SELU_SCALE:kv,SELU_SCALEALPHA:Cv,applyActivation:BA,assertAndGetBroadcastShape:Dt,assertAxesAreInnerMostDims:ns,assertParamsConsistent:ZA,assignToTypedArray:VL,axesAreInnerMostDims:SA,calculateShapes:dh,checkEinsumDimSizes:dT,checkPadOnDimRoundingMode:ni,combineLocations:KM,combineRaggedTensorToTensorShapes:PL,complexWithEvenIndex:zL,complexWithOddIndex:UL,computeConv2DInfo:ts,computeConv3DInfo:cc,computeDefaultPad:mA,computeDilation2DInfo:hy,computeOptimalWindowSize:Sv,computeOutAndReduceShapes:Gr,computeOutShape:za,computePool2DInfo:wo,computePool3DInfo:Wl,convertConv2DDataFormat:Gl,decodeEinsumEquation:fT,eitherStridesOrDilationsAreOne:gs,expandShapeToKeepDim:Ir,exponent:GL,exponents:WL,fromStringArrayToUint8:sB,fromUint8ToStringArray:Ll,getAxesPermutation:Zn,getBroadcastDims:Sp,getComplexWithIndex:cT,getEinsumComputePath:pT,getEinsumPermutation:hT,getFusedBiasGradient:LA,getFusedDyActivation:MA,getImageCenter:tT,getInnerMostAxes:pr,getPermuted:wy,getRaggedRank:ML,getReductionAxes:Fr,getReshaped:yy,getReshapedPermuted:xy,getRowPartitionTypesHelper:FL,getSliceBeginCoords:nT,getSliceSize:rT,getSparseFillEmptyRowsIndicesDenseShapeMismatch:HL,getSparseFillEmptyRowsNegativeIndexErrorMessage:jL,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:KL,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:QL,getSparseReshapeInputOutputMismatchErrorMessage:JL,getSparseReshapeInputOutputMultipleErrorMessage:YL,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:qL,getSparseReshapeNegativeOutputDimErrorMessage:XL,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:tB,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:lE,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:ZL,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:eB,getUndoAxesPermutation:fc,isIdentityPermutation:gT,log:L8,mergeRealAndImagArrays:Ml,prepareAndValidate:KA,prepareSplitSize:mT,segment_util:yX,shouldFuse:zA,slice_util:hX,splitRealAndImagArrays:BL,stridesOrDilationsArePositive:jf,tupleValuesAreOne:Hf,upcastType:xi,validateDefaultValueShape:LL,validateInput:Gq,validateUpdateShape:hL,warn:Pi},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */tX();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iB={kernelName:hb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(n,my(it(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX={kernelName:y0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=Bn(it(t,"float32")),s=ps(Tt(on(1),r));return hr(kt(n,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bX={kernelName:w0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=ps(Tt(Bn(it(t,"float32")),1));return kt(n,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vX={kernelName:Kp,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Dt(t.shape,r.shape);return{a:()=>{let a=n;const l=Fr(t.shape,s);return l.length>0&&(a=Ct(a,l)),ye(a,t.shape)},b:()=>{let a=n;const l=Fr(r.shape,s);return l.length>0&&(a=Ct(a,l)),ye(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX={kernelName:E2,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((r,s)=>{t[s]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CX={kernelName:db,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qt(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kX={kernelName:pb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qt(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX={kernelName:x0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(n,ps(Tt(on(1),Bn(it(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EX={kernelName:b0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=ps(qe(on(1),Bn(it(t,"float32"))));return kt(n,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX={kernelName:C0,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Dt(t.shape,r.shape);return{a:()=>{const a=qe(Bn(t),Bn(r));let l=fe(n,kt(r,a));const u=Fr(t.shape,s);return u.length>0&&(l=Ct(l,u)),ye(l,t.shape)},b:()=>{const a=qe(Bn(t),Bn(r));let l=hr(fe(n,kt(t,a)));const u=Fr(r.shape,s);return u.length>0&&(l=Ct(l,u)),ye(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX={kernelName:v0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(n,qe(Bn(it(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX={kernelName:S0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(n,Tt(on(1),Bn(it(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(n,e,t,r,s,i){const o=oe(n,"dy","avgPool3dGrad"),a=oe(e,"input","avgPool3dGrad");let l=o,u=a,f=!1;a.rank===4&&(f=!0,l=ye(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),u=ye(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),ee(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),ee(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),ni("avgPool3dGrad",s,i);const h={dy:l,input:u},p={filterSize:t,strides:r,pad:s,dimRoundingMode:i},g=pe.runKernel($2,h,p);return f?ye(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const RX=xe({avgPool3dGrad_:$X});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OX={kernelName:mb,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{filterSize:s,strides:i,pad:o,dimRoundingMode:a}=t;return{x:()=>RX(n,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DX(n,e,t,r,s){const i=oe(n,"dy","avgPoolGrad"),o=oe(e,"input","avgPoolGrad");ee(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,u=!1;o.rank===3&&(u=!0,a=ye(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=ye(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ee(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),ee(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const f={dy:l,input:a},h={filterSize:t,strides:r,pad:s},p=pe.runKernel(N2,f,h);return u?ye(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const _X=xe({avgPoolGrad_:DX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX={kernelName:gb,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{filterSize:s,strides:i,pad:o}=t;return{x:()=>_X(n,r,s,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FX={kernelName:yb,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[r,s]=e,{transposeA:i,transposeB:o}=t;return!i&&!o?{a:()=>sn(n,s,!1,!0),b:()=>sn(r,n,!0,!1)}:!i&&o?{a:()=>sn(n,s,!1,!1),b:()=>sn(n,r,!0,!1)}:i&&!o?{a:()=>sn(s,n,!1,!0),b:()=>sn(r,n,!1,!1)}:{a:()=>sn(s,n,!0,!0),b:()=>sn(n,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MX={kernelName:wb,gradFunc:(n,e,t)=>{const{blockShape:r,crops:s}=t;return{x:()=>$A(n,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX={kernelName:_8,gradFunc:(n,e,t)=>{const r=t,s=r.inputShape,i=r.shape,o=Array.from(i);for(let l=s.length-1;l>=0;l--)if(s[l]===i[l])o[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>Ct(n,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BX={kernelName:k0,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zX={kernelName:I0,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UX={kernelName:E0,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=t;return{x:()=>Ds(Pl(fh(r,s),Xp(r,i)),n,qt(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VX={kernelName:xb,inputsToSave:["x"],gradFunc:iB.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WX={kernelName:bb,saveAllInputs:!0,gradFunc:(n,e,t)=>{const r=e.map(l=>l.shape),{axis:s}=t,i=zt(s,e[0].shape)[0],o=r.map(l=>l[i]);return Li(n,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GX={kernelName:vb,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=t;return ee(Hf(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>xA(r.shape,n,s,o,a,l),filter:()=>FA(r,n,s.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HX={kernelName:Sb,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=t;return{dy:()=>Kf(n,s,i,o,a,1,l),filter:()=>FA(n,r,s.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jX(n,e,t,r,s){let i=n;n.rank===4&&(i=ye(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let o=e;o.rank===4&&(o=ye(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),ee(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),ee(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),ee(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),ee(i.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${t[3]}.`),ee(o.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${t[4]}).`);const a={x:i,dy:o},l={strides:r,pad:s,filterShape:t};return pe.runKernel(P2,a,l)}const KX=xe({conv3DBackpropFilter_:jX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qX={kernelName:Cb,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:r,strides:s,pad:i}=t;ee(Hf(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=e;return{x:()=>WM(o.shape,n,a,s,i),filter:()=>KX(o,n,a.shape,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XX={kernelName:A0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(hr(lL(it(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QX={kernelName:T0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(uL(it(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YX={kernelName:kb,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s,exclusive:i,reverse:o}=t;return{x:()=>{const a=Zn([s],r.rank);let l=HM(n,s,i,!o);return a!=null&&(l=Kt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JX={kernelName:Ib,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:o}=t,a=r??[1,1];ee(Hf(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return ee(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),ee(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),ee(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),ee(gs(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),ni("depthwiseConv2d",i,o),{x:()=>u7(l.shape,n,u,s,i,a,o),filter:()=>a7(l,n,u.shape,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZX={kernelName:Eb,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,i={x:r,filter:s,dy:n},o={x:r,filter:s,dy:n};return{x:()=>pe.runKernel(jI,i,t),filter:()=>pe.runKernel(KI,o,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eQ={kernelName:$0,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,r={dy:n,y:t};return{x:()=>pe.runKernel(G2,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tQ={kernelName:R0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,r=fe(Ka(hr(Bn(t))),2/Math.sqrt(Math.PI));return{x:()=>fe(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nQ={kernelName:O0,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rQ={kernelName:Tb,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>ye(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sQ={kernelName:D0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(n,Ka(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iQ={kernelName:_0,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oQ={kernelName:P0,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Dt(t.shape,r.shape);return{a:()=>{const a=kt(n,it(r,"float32")),l=Fr(t.shape,s);return l.length>0?ye(Ct(a,l),t.shape):a},b:()=>{let a=fe(n,it(t,"float32"));const l=Fr(r.shape,s);l.length>0&&(a=ye(Ct(a,l),r.shape));const u=Bn(r);return hr(kt(a,it(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aQ={kernelName:Nb,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:r}=t,[s,i,o,a]=e,l=a??on(1),u=Fr(i.shape,s.shape),f=[];if(i.rank===1){for(let k=0;k<s.shape.length-1;++k)f.push(s.shape[k]);f.push(1)}const h=Tt(s,i),p=fe(n,l),g=iL(qe(o,on(r))),m=fe(fe(fe(g,g),g),on(-.5));return{x:()=>i.rank===1?ye(fe(fe(n,Go(ye(g,[1,1,1,i.shape[0]]),f)),l),s.shape):ye(fe(fe(n,g),l),s.shape),mean:()=>{let k=fe(fe(g,on(-1)),p);return i.rank===1&&(k=Ct(k,u)),ye(k,i.shape)},variance:()=>{let k=fe(fe(m,h),p);return i.rank===1&&(k=Ct(k,u)),ye(k,i.shape)},scale:()=>{const k=fe(h,g);let N=fe(n,k);return i.rank===1&&(N=Ct(N,u)),ye(N,i.shape)},offset:()=>{let k=n;return i.rank===1&&(k=Ct(k,u)),ye(k,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lQ={kernelName:$b,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[r,s]=e,{axis:i,batchDims:o}=t,a=zt(i,r.shape)[0],l=(u,f,h)=>()=>{const p=u.shape,g=f.size,m=p.slice(0,a),w=m.length,x=p.slice(i,p.length).slice(1),b=x.length,C=cD(0,w),$=cD(w+1,w+1+b),k=fD([m,[g],x]),N=ye(h,k),_=ye(f,[g]),U=fD([[w],C,$]),O=Kt(N,U);let L=pL(O,_,u.shape[a]);const T=fc(U);return L=Kt(L,T),L};if(o===1){const u=r.shape[0],f=r.split(u,0);return{x:()=>Fl(f.map((g,m)=>l(g,s.slice(m,1),n.slice(m,1))())).reshape(r.shape),indices:()=>s}}else return{x:l(r,s,n),indices:()=>s}}};function cD(n,e){const t=[];for(let r=n;r<e;++r)t.push(r);return t}function fD(n){const e=[];for(let t=0;t<n.length;++t)for(let r=0;r<n[t].length;++r)e.push(n[t][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uQ={kernelName:F0,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>qt(t),b:()=>qt(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cQ={kernelName:M0,gradFunc:n=>({x:()=>it(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fQ={kernelName:L0,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hQ={kernelName:B0,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dQ={kernelName:z0,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pQ={kernelName:Ob,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{alpha:s}=t,i=Vi(r,0);return{x:()=>Ds(i,n,fe(n,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gQ={kernelName:V0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(n,qe(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mQ={kernelName:U0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(n,it(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yQ={kernelName:F8,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t;return{logits:()=>{const o=Ka(r);return Tt(n,fe(Ct(n,s,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wQ(n,e,t,r=5,s=1,i=1,o=.5){const a={x:n,y:e,dy:t},l={depthRadius:r,bias:s,alpha:i,beta:o};return pe.runKernel(Q2,a,l)}const xQ=xe({localResponseNormalizationBackprop_:wQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bQ={kernelName:Lb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=t;return{x:()=>xQ(r,s,n,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oB(n,e,t,r){return e.rank<t.rank&&(e=ye(e,Ir(e.shape,r))),n.rank<t.rank&&(n=ye(n,Ir(n.shape,r))),{x:()=>fe(n,it(ja(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hD={kernelName:Bb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const r=t,{reductionIndices:s}=r,i=e[0],o=e[1],a=zt(s,i.shape),l=oB(n,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vQ={kernelName:W0,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>fe(n,it(fh(t,r),"float32")),b:()=>fe(n,it(h1(t,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SQ(n,e,t,r,s,i,o){const a=oe(n,"dy","maxPool3dGrad"),l=oe(e,"input","maxPool3dGrad"),u=oe(t,"output","maxPool3dGrad");let f=a,h=l,p=u,g=!1;l.rank===4&&(g=!0,f=ye(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=ye(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=ye(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),ee(f.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${f.rank}.`),ee(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),ee(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),ni("maxPool3dGrad",i,o);const m={dy:f,input:h,output:p},w={filterSize:r,strides:s,pad:i,dimRoundingMode:o},x=pe.runKernel(J2,m,w);return g?ye(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const CQ=xe({maxPool3dGrad_:SQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kQ={kernelName:Ub,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=t;return{x:()=>CQ(n,r,s,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IQ(n,e,t,r,s,i,o){const a=oe(n,"dy","maxPoolGrad"),l=oe(e,"input","maxPoolGrad"),u=oe(t,"output","maxPoolGrad");ee(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),ee(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),ee(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),ni("maxPoolGrad",i,o);const f={dy:a,input:l,output:u},h={filterSize:r,strides:s,pad:i,dimRoundingMode:o};return pe.runKernel(Y2,f,h)}const EQ=xe({maxPoolGrad_:IQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AQ={kernelName:zb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a}=t;return{x:()=>EQ(n,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TQ={kernelName:Vb,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t,i=zt(s,r.shape),a=Gr(r.shape,i)[1],l=De(a);return{x:()=>{const f=r.shape.slice();i.forEach(g=>{f[g]=1});const h=ye(n,f);return kt(fe(h,dc(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NQ={kernelName:Wb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const r=t,{axis:s}=r,[i,o]=e,a=zt(s,i.shape),l=oB(n,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Q={kernelName:G0,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>fe(n,it(Xp(t,r),"float32")),b:()=>fe(n,it(Vi(t,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RQ={kernelName:Gb,inputsToSave:["x"],gradFunc:(n,e,t)=>{const r=e[0],{paddings:s}=t,i=s.map(o=>o[0]);return{x:()=>Rn(n,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OQ={kernelName:H0,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Dt(t.shape,r.shape);return{a:()=>{const a=Fr(t.shape,s);return a.length>0?ye(Ct(n,a),t.shape):n},b:()=>{const a=fe(n,hr(bv(kt(t,r)))),l=Fr(r.shape,s);return l.length>0?ye(Ct(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DQ={kernelName:j0,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Dt(t.shape,r.shape);return{a:()=>{const a=fe(n,it(r,"float32")),l=Fr(t.shape,s);return l.length>0?ye(Ct(a,l),t.shape):a},b:()=>{const a=fe(n,it(t,"float32")),l=Fr(r.shape,s);return l.length>0?ye(Ct(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Q={kernelName:Hb,gradFunc:n=>({x:()=>hr(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PQ={kernelName:qb,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>Vr(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FQ={kernelName:Kb,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MQ={kernelName:Xb,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:r}=t;return Qf(n,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dD={kernelName:Qb,inputsToSave:["x"],gradFunc:(n,e,t)=>{const r=e[0],{paddings:s}=t,i=s.map(o=>o[0]);return{x:()=>Rn(n,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LQ={kernelName:K0,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,r,s]=e,i=t,o=r,a=Dt(i.shape,o.shape);return{a:()=>{const f=it(o,"float32");let h=fe(n,fe(f,qf(i,Tt(f,on(1)))));const p=Fr(i.shape,a);return p.length>0&&(h=Ct(h,p)),ye(h,i.shape)},b:()=>{const f=Vi(i,0),h=Ds(f,qa(i),qt(i));let p=fe(n,fe(s,h));const g=Fr(o.shape,a);return g.length>0&&(p=Ct(p,g)),ye(p,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BQ={kernelName:Yb,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,r]=e,s=Vi(t,0);return{x:()=>Ds(s,n,fe(n,r)),alpha:()=>{let i=Ds(s,qt(n),fe(n,t));const o=Fr(r.shape,n.shape);return o.length>0&&(i=Ct(i,o)),ye(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zQ(n,e,t){const r=n.shape.slice();r[t]=1;const s=ye(e,r),i=iE(n,t,!0,!1),o=iE(n,t,!0,!0),a=fe(i,o);return fe(s,a)}function UQ(n,e,t){const r=n.shape.length,s=r-t.length,i=Zn(t,r);let o=n;i!=null&&(o=Kt(n,i));const a=o.shape.slice(),u=a.splice(r-t.length,t.length).reduce((p,g)=>p*g,1);a.push(u);const f=o.reshape(a);let h=zQ(f,e,s);if(h=h.reshape(o.shape),i!=null){const p=fc(i);h=Kt(h,p)}return h}const VQ={kernelName:Jb,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t;let i=[];return s==null?i=r.shape.map((o,a)=>a):typeof s=="number"?i=[s]:i=s,{x:()=>UQ(r,n,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WQ={kernelName:N0,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Dt(t.shape,r.shape);return{a:()=>{const a=kt(n,it(r,"float32")),l=Fr(t.shape,s);return l.length>0?ye(Ct(a,l),t.shape):a},b:()=>{let a=fe(n,it(t,"float32"));const l=Fr(r.shape,s);l.length>0&&(a=ye(Ct(a,l),r.shape));const u=Bn(r);return hr(kt(a,it(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GQ={kernelName:q0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(n,hr(Bn(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HQ={kernelName:Q0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,r=fe(Xp(t,6),my(t));return{x:()=>fe(n,it(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jQ={kernelName:X0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(n,it(my(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KQ={kernelName:Zb,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>ye(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qQ={kernelName:tv,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[r]=e,s={dy:n,images:r};return{images:()=>pe.runKernel(iA,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XQ={kernelName:ev,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[r]=e,s={dy:n,images:r};return{images:()=>pe.runKernel(sA,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QQ={kernelName:nv,gradFunc:(n,e,t)=>{const{dims:r}=t,s=zt(r,n.shape);return{x:()=>Xf(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YQ={kernelName:Y0,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JQ={kernelName:J0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>hr(kt(n,fe(qf(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZQ={kernelName:rv,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>it(qt(t),"float32"),t:()=>fe(n,it(t,n.dtype)),e:()=>fe(n,it(EA(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eY={kernelName:Z0,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=Vi(t,on(0)),s=on(Cv),i=on(kv),o=fe(n,i),a=fe(fe(n,s),Ka(it(t,"float32")));return Ds(r,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tY={kernelName:ry,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(n,fe(t,Tt(on(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nY={kernelName:ny,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rY={kernelName:ey,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(bA(it(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sY={kernelName:ty,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(GM(it(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iY={kernelName:sv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{begin:s,size:i}=t,o=r.shape,[a,l]=vv(r,s,i),u=[];for(let f=0;f<n.rank;f++)u.push([a[f],o[f]-a[f]-l[f]]);return{x:()=>NA(n,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oY={kernelName:lv,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r]=e,{dim:s}=t,i=!0,o=fe(n,r);return{logits:()=>Tt(o,fe(Ct(o,[s],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aY={kernelName:sy,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(n,qp(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pD={kernelName:ov,gradFunc:(n,e,t)=>{const{blockShape:r,paddings:s}=t;return{x:()=>wA(n,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gD={kernelName:av,gradFunc:(n,e,t)=>{const{axis:r}=t;return{x:()=>Zs(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lY={kernelName:iy,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(n,fe(ps(it(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uY={kernelName:oA,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(n,fe(it(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cY={kernelName:oy,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=on(2);return{a:()=>fe(n,fe(s,Tt(t,r))),b:()=>fe(n,fe(s,Tt(r,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fY={kernelName:fy,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hY={kernelName:ay,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Dt(t.shape,r.shape);return{a:()=>{let a=n;const l=Fr(t.shape,s);return l.length>0&&(a=Ct(a,l)),ye(a,t.shape)},b:()=>{let a=n;const l=Fr(r.shape,s);return l.length>0&&(a=Ct(a,l)),ye(hr(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dY={kernelName:iv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,s=r.shape.slice(),{axis:i}=t;zt(i,r.shape).forEach(u=>{s[u]=1});const a=ye(n,s),l=fe(a,dc(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pY={kernelName:ly,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(n,Bn(bA(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gY={kernelName:uy,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>fe(Tt(on(1),Bn(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mY={kernelName:cy,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{reps:s}=t;return{x:()=>{let o=qt(r);if(r.rank===1)for(let a=0;a<s[0];++a)o=qe(o,Rn(n,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)o=qe(o,Rn(n,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)o=qe(o,Rn(n,[a*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let u=0;u<s[2];++u)for(let f=0;f<s[3];++f)o=qe(o,Rn(n,[a*r.shape[0],l*r.shape[1],u*r.shape[2],f*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yY={kernelName:Cd,gradFunc:(n,e,t)=>{const r=t,{perm:s}=r,i=fc(s);return{x:()=>Kt(n,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY={kernelName:uv,gradFunc:(n,e,t)=>{const r=t,{axis:s}=r;return{value:()=>Fl(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY={kernelName:cv,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>bY(n,t)}}};function bY(n,e){const t=hc(e,qt(e)),r=CA(n,t);let s=fh(e,on(0,"int32"));const i=r.rank-s.rank;for(let a=0;a<i;++a)s=js(s,a+1);s=Pl(s,dc(r.shape,"bool"));const o=qt(r);return Ds(s,r,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vY={kernelName:fv,gradFunc:n=>({x:()=>qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SY=[iB,xX,bX,vX,SX,CX,kX,IX,EX,AX,TX,NX,OX,PX,FX,MX,LX,BX,zX,UX,VX,WX,HX,GX,qX,XX,QX,YX,JX,ZX,WQ,eQ,tQ,nQ,rQ,sQ,oQ,iQ,aQ,lQ,uQ,cQ,fQ,hQ,dQ,pQ,gQ,mQ,yQ,bQ,hD,hD,vQ,kQ,AQ,TQ,NQ,$Q,RQ,OQ,DQ,_Q,PQ,FQ,MQ,dD,dD,LQ,BQ,VQ,GQ,HQ,jQ,KQ,qQ,XQ,QQ,YQ,JQ,ZQ,eY,tY,nY,rY,sY,iY,oY,aY,pD,pD,gD,gD,lY,cY,uY,fY,hY,dY,pY,gY,mY,yY,wY,xY,vY];for(const n of SY)B8(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.abs=function(){return this.throwIfDisposed(),$s(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.acos=function(){return this.throwIfDisposed(),JH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.acosh=function(){return this.throwIfDisposed(),ej(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.add=function(n){return this.throwIfDisposed(),qe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.all=function(n,e){return this.throwIfDisposed(),zM(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.any=function(n,e){return this.throwIfDisposed(),rE(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.argMax=function(n){return this.throwIfDisposed(),Rm(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.argMin=function(n){return this.throwIfDisposed(),ij(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.asScalar=function(){return this.throwIfDisposed(),ee(this.size===1,()=>"The array must have only 1 element."),ye(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.asType=function(n){return this.throwIfDisposed(),it(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.as1D=function(){return this.throwIfDisposed(),ye(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.as2D=function(n,e){return this.throwIfDisposed(),ye(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),ye(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.as4D=function(n,e,t,r){return this.throwIfDisposed(),ye(this,[n,e,t,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.as5D=function(n,e,t,r,s){return this.throwIfDisposed(),ye(this,[n,e,t,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.asin=function(){return this.throwIfDisposed(),aj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.asinh=function(){return this.throwIfDisposed(),uj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.atan=function(){return this.throwIfDisposed(),fj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.atan2=function(n){return this.throwIfDisposed(),dj(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.atanh=function(){return this.throwIfDisposed(),gj(this)};Oe().prototype.avgPool=function(n,e,t,r){return this.throwIfDisposed(),yA(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),wA(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.batchNorm=function(n,e,t,r,s){return this.throwIfDisposed(),mv(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.broadcastTo=function(n){return this.throwIfDisposed(),km(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.cast=function(n){return this.throwIfDisposed(),it(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.ceil=function(){return this.throwIfDisposed(),Vj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),Ui(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof Tr&&(n=[n]),Zs([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.conv1d=function(n,e,t,r,s,i){return this.throwIfDisposed(),UM(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.conv2dTranspose=function(n,e,t,r,s){return this.throwIfDisposed(),VM(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.conv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),Kf(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.cos=function(){return this.throwIfDisposed(),bA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.cosh=function(){return this.throwIfDisposed(),GM(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),iE(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),HM(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),d9(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.depthwiseConv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),vA(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.dilation2d=function(n,e,t,r,s){return this.throwIfDisposed(),m9(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.divNoNan=function(n){return this.throwIfDisposed(),v9(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.div=function(n){return this.throwIfDisposed(),kt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.dot=function(n){return this.throwIfDisposed(),C9(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.elu=function(){return this.throwIfDisposed(),wv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.equal=function(n){return this.throwIfDisposed(),ja(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.erf=function(){return this.throwIfDisposed(),jM(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),P9(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.exp=function(){return this.throwIfDisposed(),Ka(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.expandDims=function(n){return this.throwIfDisposed(),js(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.expm1=function(){return this.throwIfDisposed(),B9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.fft=function(){return this.throwIfDisposed(),fL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.flatten=function(){return this.throwIfDisposed(),ye(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.floor=function(){return this.throwIfDisposed(),bv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.floorDiv=function(n){return this.throwIfDisposed(),BM(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.gather=function(n,e,t){return this.throwIfDisposed(),CA(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.greaterEqual=function(n){return this.throwIfDisposed(),fh(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.greater=function(n){return this.throwIfDisposed(),Vi(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.ifft=function(){return this.throwIfDisposed(),oE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.irfft=function(){return this.throwIfDisposed(),Rq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.isFinite=function(){return this.throwIfDisposed(),q9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.isInf=function(){return this.throwIfDisposed(),Q9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.isNaN=function(){return this.throwIfDisposed(),J9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.leakyRelu=function(n){return this.throwIfDisposed(),IA(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.lessEqual=function(n){return this.throwIfDisposed(),Xp(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.less=function(n){return this.throwIfDisposed(),h1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.localResponseNormalization=function(n,e,t,r){return this.throwIfDisposed(),rK(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.logSigmoid=function(){return this.throwIfDisposed(),cK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.logSoftmax=function(n){return this.throwIfDisposed(),YM(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),JM(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.log=function(){return this.throwIfDisposed(),qa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.log1p=function(){return this.throwIfDisposed(),QM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.logicalAnd=function(n){return this.throwIfDisposed(),Pl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.logicalNot=function(){return this.throwIfDisposed(),EA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.logicalOr=function(n){return this.throwIfDisposed(),ZM(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.logicalXor=function(n){return this.throwIfDisposed(),wK(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),sn(this,n,e,t)};Oe().prototype.maxPool=function(n,e,t,r){return this.throwIfDisposed(),AA(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.max=function(n,e){return this.throwIfDisposed(),jo(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.maximum=function(n){return this.throwIfDisposed(),hc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.mean=function(n,e){return this.throwIfDisposed(),Cr(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.min=function(n,e){return this.throwIfDisposed(),f1(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.minimum=function(n){return this.throwIfDisposed(),_m(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),EK(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.mod=function(n){return this.throwIfDisposed(),TK(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.mul=function(n){return this.throwIfDisposed(),fe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.neg=function(){return this.throwIfDisposed(),hr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.norm=function(n,e,t){return this.throwIfDisposed(),xv(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.notEqual=function(n){return this.throwIfDisposed(),d1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),eL(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.onesLike=function(){return this.throwIfDisposed(),mo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.pad=function(n,e){return this.throwIfDisposed(),NA(this,n,e)};Oe().prototype.pool=function(n,e,t,r,s,i){return this.throwIfDisposed(),LK(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.pow=function(n){return this.throwIfDisposed(),qf(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.prelu=function(n){return this.throwIfDisposed(),RA(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.prod=function(n,e){return this.throwIfDisposed(),UK(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.reciprocal=function(){return this.throwIfDisposed(),fq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.relu=function(){return this.throwIfDisposed(),hh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.relu6=function(){return this.throwIfDisposed(),rL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.reshapeAs=function(n){return this.throwIfDisposed(),ye(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.reshape=function(n){return this.throwIfDisposed(),ye(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),mL(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),yL(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.reverse=function(n){return this.throwIfDisposed(),Xf(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.rfft=function(){return this.throwIfDisposed(),_q(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.round=function(){return this.throwIfDisposed(),sL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.rsqrt=function(){return this.throwIfDisposed(),iL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.selu=function(){return this.throwIfDisposed(),oL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.separableConv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),aL(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.sigmoid=function(){return this.throwIfDisposed(),qp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.sign=function(){return this.throwIfDisposed(),bq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.sin=function(){return this.throwIfDisposed(),lL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.sinh=function(){return this.throwIfDisposed(),uL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.slice=function(n,e){return this.throwIfDisposed(),Rn(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.softmax=function(n){return this.throwIfDisposed(),PA(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.softplus=function(){return this.throwIfDisposed(),dy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),$A(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.split=function(n,e){return this.throwIfDisposed(),Li(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.sqrt=function(){return this.throwIfDisposed(),ps(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.square=function(){return this.throwIfDisposed(),Bn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.squaredDifference=function(n){return this.throwIfDisposed(),Fq(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.squeeze=function(n){return this.throwIfDisposed(),gy(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof Tr?[this,n]:[this,...n];return Fl(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.step=function(n){return this.throwIfDisposed(),my(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.stridedSlice=function(n,e,t,r,s,i,o,a){return this.throwIfDisposed(),Uq(this,n,e,t,r,s,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.sub=function(n){return this.throwIfDisposed(),Tt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.sum=function(n,e){return this.throwIfDisposed(),Ct(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.tan=function(){return this.throwIfDisposed(),Wq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.tanh=function(){return this.throwIfDisposed(),gv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.tile=function(n){return this.throwIfDisposed(),Go(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.toBool=function(){return this.throwIfDisposed(),it(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.toFloat=function(){return this.throwIfDisposed(),it(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.toInt=function(){return this.throwIfDisposed(),it(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.topk=function(n,e){return this.throwIfDisposed(),jq(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.transpose=function(n){return this.throwIfDisposed(),Kt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.unique=function(n){return this.throwIfDisposed(),Xq(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),pL(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.unstack=function(n){return this.throwIfDisposed(),Qf(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.where=function(n,e){return this.throwIfDisposed(),Ds(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Oe().prototype.zerosLike=function(){return this.throwIfDisposed(),qt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ea extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ea.prototype)}}class ho extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ho.prototype)}}class ue extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ue.prototype)}}class Pt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Pt.prototype)}}class wT extends Error{constructor(e){super(e),Object.setPrototypeOf(this,wT.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aB{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yf(n,e){if(Array.isArray(n)){let t=[];for(let r=0;r<e;r++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function Aa(n,e){if(!n)throw new wT(e)}function mD(n,e){let t=0;for(const r of n)r===e&&t++;return t}function Ks(n){return n.length===1?n[0]:n}function pn(n){return Array.isArray(n)?n:[n]}function gl(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Xc(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let Qi={};function xT(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function uE(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>uE(e));else{const e=Object.keys(n);for(const t of e){const r=n[t];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?n[t]=r.value:uE(r))}}}function by(n,e={},t={},r="object",s=!1){if(typeof n=="string"){const i=n;let o;if(i in t)o=t[i];else if(i in Qi)o=Qi[i];else if(o=e[i],o==null)throw new ue(`Unknown ${r}: ${n}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=n;if(i.className==null||i.config==null)throw new ue(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in t?[a,l]=t[o]:o in Qi?[a,l]=Qi.className:o in e&&([a,l]=e[o]),a==null)throw new ue(`Unknown ${r}: ${o}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const g of Object.keys(Qi))u[g]=Qi[g];for(const g of Object.keys(t))u[g]=t[g];const f=i.config;f.customObjects=u;const h=Object.assign({},Qi);for(const g of Object.keys(t))Qi[g]=t[g];uE(i.config);const p=l(a,i.config,t,s);return Qi=Object.assign({},h),p}else{const u=Object.assign({},Qi);for(const h of Object.keys(t))Qi[h]=t[h];const f=new a(i.config);return Qi=Object.assign({},u),f}}}function CY(n,e){return n<e?-1:n>e?1:0}function Xw(n,e){return-1*CY(n,e)}function Ku(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function kY(n){if(n==null)throw new ue(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function ph(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new ue(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function bT(n,e,t=0,r=1/0){return Aa(t>=0),Aa(r>=t),Array.isArray(n)&&n.length>=t&&n.length<=r&&n.every(s=>typeof s===e)}function Wr(n,e){Array.isArray(n)?(ee(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,r)=>Wr(t,`element ${r+1} of ${e}`))):ee(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${lB(n)}.`)}function lB(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>lB(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function IY(n,e,t){let r=t!=null?t():Hs(),s;return(...o)=>{const a=t!=null?t():Hs();return a-r<e||(r=a,s=n(...o)),s}}function uB(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let EY=0;function cB(){return EY++}const Qw={};function Iv(n=""){return n in Qw||(Qw[n]=0),Qw[n]+=1,n+Qw[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const AY=["channelsFirst","channelsLast"],TY=["nearest","bilinear"],NY=["valid","same","causal"],$Y=["max","avg"],RY=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Zh=new Map;function gr(n){ph(AY,"DataFormat",n)}function OY(n){ph(TY,"InterpolationFormat",n)}function Wi(n){ph(NY,"PaddingMode",n)}function fB(n){ph($Y,"PoolMode",n)}const Em=[],yD="/";function Rf(n,e){Em.push(n);try{const t=e();return Em.pop(),t}catch(t){throw Em.pop(),t}}function DY(){return Em.length===0?"":Em.join(yD)+yD}function hB(n){if(!pB(n))throw new Error("Not a valid tensor name: '"+n+"'");return DY()+n}function dB(n){if(!pB(n))throw new Error("Not a valid tensor name: '"+n+"'");Zh.has(n)||Zh.set(n,0);const e=Zh.get(n);if(Zh.set(n,Zh.get(n)+1),e>0){const t=`${n}_${e}`;return Zh.set(t,1),t}else return n}const _Y=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function pB(n){return!!n.match(_Y)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function PY(n){return n===parseInt(n.toString(),10)}function qu(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let r=1;for(let s=e;s<t;++s)r*=n[s];return r}function kp(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const r=n[t];r<e&&(e=r)}return e}function Yu(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const r=n[t];r>e&&(e=r)}return e}function Xo(n,e){if(e<n)throw new ue(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let r=n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let dk;function Or(){return dk==null&&(dk=fH().epsilon()),dk}function Qo(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ua(n,e){return it(n,e)}function vy(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),ye(n,t)}function FY(n,e){return Ce(()=>{if(n.shape.length!==2)throw new ue(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=vy(n,1);return cE(t,[1,e,1])})}function MY(n){const e=[qu(n.shape)];return ye(n,e)}function LY(n){if(n.rank<=1)throw new ue(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],qu(n.shape,1)];return ye(n,e)}function Of(n,e,t){return Ce(()=>{switch(n.rank){case 1:return DA(n,e,t);case 2:return cL(n,[e,0],[t,n.shape[1]]);case 3:return _A(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return g1(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return Rn(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return Rn(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new ue(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function pk(n,e,t){return Ce(()=>{switch(n.rank){case 1:return DA(n,e,t);case 2:return cL(n,[0,e],[n.shape[0],t]);case 3:return _A(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return g1(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new ue(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Yw(n,e,t,r){return Ce(()=>{switch(n.rank){case 1:return DA(n,e,t);case 2:switch(r){case 1:return Of(n,e,t);case 2:return pk(n,e,t);default:throw new ue(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Of(n,e,t);case 2:return _A(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return pk(n,e,t);default:throw new ue(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Of(n,e,t);case 2:return g1(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return g1(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return pk(n,e,t);default:throw new ue(`The axis is not within the rank of the tensor ${r}`)}default:throw new ue(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function vT(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),Zs(n,e)}function wD(n,e){switch(n.rank){case 1:return Hj([n,e]);case 2:return Kj([n,e],0);case 3:return Xj([n,e],0);case 4:return Yj([n,e],0);default:throw new ue(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function cE(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new ue(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return Go(n,e)}function Ev(n,e=0,t=1,r,s){return aq(n,e,t,r,s)}function Va(n,e,t,r){if(n.rank<2||e.rank<2)throw new Pt(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=n.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(s!==i)throw new Pt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return nD({a:n,b:e,transposeA:!1,transposeB:!1,bias:r?fE(n.rank,r,Qo()):null,activation:t});{const s=n.shape.slice(),i=s.pop();n=ye(n,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),u=[...o,a],f=Array.from({length:e.rank},(m,w)=>w===0?e.rank-2:w<=e.rank-2?w-1:w);e=ye(Kt(e,f),[l,-1]);const h=[...s,...u];return ye(nD({a:n,b:e,transposeA:!1,transposeB:!1,bias:r?fE(n.rank,r,Qo()):null,activation:t}),h)}}function gB(n,e,t){return Ce(()=>(Array.isArray(e)?e=yi(e,"int32"):e=it(e,"int32"),CA(n,e,t)))}function Sy(n){return fe(n,n)}function fE(n,e,t){const r=e.shape;if(e.rank!==1&&e.rank!==n)throw new ue(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return r.length===1?ye(e,[1,r[0],1,1,1]):ye(e,[1,r[3],r[0],r[1],r[2]]);if(t==="channelsLast")return r.length===1?ye(e,[1,1,1,1,r[0]]):ye(e,[1].concat(r))}else if(n===4){if(t==="channelsFirst")return r.length===1?ye(e,[1,r[0],1,1]):ye(e,[1,r[2],r[0],r[1]]);if(t==="channelsLast")return r.length===1?ye(e,[1,1,1,r[0]]):ye(e,[1].concat(r))}else if(n===3){if(t==="channelsFirst")return r.length===1?ye(e,[1,r[0],1]):ye(e,[1,r[1],r[0]]);if(t==="channelsLast")return r.length===1?ye(e,[1,1,r[0]]):ye(e,[1].concat(r))}else if(n<3)return e;throw new ue(`Unsupported input rank by biasAdd: ${e.rank}`)}function ea(n,e,t){return Ce(()=>(t==null&&(t=Qo()),gr(t),qe(n,fE(n.rank,e,t))))}function BY(n,e=1){if(e!==1)throw new Pt(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return wv(n)}function zY(n){return Ce(()=>kt(n,qe($s(n),1)))}function mB(n,e,t,r){return Ce(()=>n7(n,e,t,r))}function UY(n){return Ce(()=>{const e=qe(.5,fe(.2,n));return Ui(e,0,1)})}function Cy(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const VY=["fanIn","fanOut","fanAvg"],WY=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GY(n){ph(VY,"FanMode",n)}function HY(n){ph(WY,"Distribution",n)}class xo extends Yp{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}let yB=class extends xo{apply(e,t){return Vr(e,t)}};yB.className="Zeros";Ve(yB);class ST extends xo{apply(e,t){return dc(e,t)}}ST.className="Ones";Ve(ST);class wB extends xo{constructor(e){if(super(),typeof e!="object")throw new ue(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new ue(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return Ce(()=>fe(on(this.value),dc(e,t)))}getConfig(){return{value:this.value}}}wB.className="Constant";Ve(wB);class xB extends xo{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return py(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}xB.className="RandomUniform";Ve(xB);class bB extends xo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Pt(`randomNormal does not support dType ${t}.`);return Ev(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}bB.className="RandomNormal";Ve(bB);class vB extends xo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Pt(`truncatedNormal does not support dType ${t}.`);return dL(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}vB.className="TruncatedNormal";Ve(vB);class SB extends xo{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return Ce(()=>{if(e.length!==2||e[0]!==e[1])throw new ue("Identity matrix initializer can only be used for 2D square matrices.");return fe(this.gain,XM(e[0]))})}getConfig(){return{gain:this.gain}}}SB.className="Identity";Ve(SB);function jY(n,e="channelsLast"){let t,r;if(gr(e),n.length===2)t=n[0],r=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const s=qu(n,2);t=n[1]*s,r=n[0]*s}else if(e==="channelsLast"){const s=qu(n,0,n.length-2);t=n[n.length-2]*s,r=n[n.length-1]*s}}else{const s=qu(n);t=Math.sqrt(s),r=Math.sqrt(s)}return[t,r]}class bi extends xo{constructor(e){if(super(),e.scale<0)throw new ue(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,GY(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,HY(this.distribution),this.seed=e.seed}apply(e,t){const r=jY(e),s=r[0],i=r[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,s):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(s+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Pt(`${this.getClassName()} does not support dType ${t}.`);return dL(e,0,a,t,this.seed)}else{const a=Math.sqrt(3*o);return py(e,-a,a,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}bi.className="VarianceScaling";Ve(bi);class CT extends bi{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return bi.className}}CT.className="GlorotUniform";Ve(CT);class kT extends bi{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return bi.className}}kT.className="GlorotNormal";Ve(kT);class IT extends bi{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return bi.className}}IT.className="HeNormal";Ve(IT);class ET extends bi{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return bi.className}}ET.className="HeUniform";Ve(ET);class AT extends bi{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return bi.className}}AT.className="LeCunNormal";Ve(AT);class TT extends bi{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return bi.className}}TT.className="LeCunUniform";Ve(TT);class CB extends xo{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return Ce(()=>{if(e.length<2)throw new Pt("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const r=De(e.slice(0,-1)),s=e[e.length-1],i=r*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(s,r),Math.min(s,r)],a=Ev(o,0,1,t,this.seed),l=Y7.qr(a,!1);let u=l[0];const h=l[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return u=fe(u,h.sign()),r<s&&(u=u.transpose()),fe(on(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}CB.className="Orthogonal";Ve(CB);const xD={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function bD(n,e={}){return by(n,co.getMap().classNameMap,e,"initializer")}function Jn(n){return xT(n)}function jn(n){if(typeof n=="string"){const e=n in xD?xD[n]:n;if(e==="GlorotNormal")return new kT;if(e==="GlorotUniform")return new CT;if(e==="HeNormal")return new IT;if(e==="HeUniform")return new ET;if(e==="LeCunNormal")return new AT;if(e==="LeCunUniform")return new TT;{const t={};return t.className=e,t.config={},bD(t)}}else return n instanceof xo?n:bD(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hE(n){return Array.isArray(n)&&Array.isArray(n[0])}function m1(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function $t(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new ue(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function Zt(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new ue(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function y1(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vD="Variable";class KY{constructor(e,t="float32",r=vD,s=!0,i=null){this.dtype=t??"float32",this.shape=e.shape,this.id=cB(),r=r??vD,this.originalName=hB(r),this.name=dB(this.originalName),this.trainable_=s,this.constraint=i,this.val=Jq(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),qY(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function qY(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function dE(n){return n.map(e=>e.read())}function NT(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Dr{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Xa{constructor(e,t,r,s,i,o,a){this.dtype=e,this.shape=t,this.sourceLayer=r,this.inputs=s,this.callArgs=i,this.outputTensorIndex=a,this.id=cB(),o!=null&&(this.originalName=hB(o),this.name=dB(this.originalName)),this.rank=t.length}}let XY=0;class Av{constructor(e,t){this.callArgs=t,this.id=XY++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let QY=0;class Ut extends Yp{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=QY++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const r=this.getClassName();t=gl(r)+"_"+Iv(r)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new ho(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new ue(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Ks(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Ks(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Ea(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Ea(`Layer ${this.name} is not connected, no input to return.`);return Ks(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Ea(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Ea(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ks(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=pn(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=pn(this.inputSpec);if(t.length!==r.length)throw new ue(`Layer ${this.name} expects ${r.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let s=0;s<t.length;s++){const i=t[s],o=r[s];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new ue(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new ue(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new ue(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new ue(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const u in o.axes){const f=Number(u),h=o.axes[u],p=f>=0?l[f]:l[l.length+f];if(h!=null&&[h,null].indexOf(p)===-1)throw new ue(`Input ${s} is incompatible with layer ${this.name}: expected axis ${f} of input shape to have value ${h} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const u=o.shape[l],f=i.shape[l];if(u!=null&&f!=null&&u!==f)throw new ue(`Input ${s} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const r=pn(e),s=ZY(e),i=eJ(e);if(s===i)throw new ue("Arguments to apply() must be all SymbolicTensors or all Tensors");return Rf(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of pn(e))o.push(a.shape);this.build(Ks(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,o);const a=pn(o),l=[];for(let u of a)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(o=Ks(l),this.activityRegularizer!=null)throw new Pt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=YY(e),a=this.computeOutputShape(o);let l;const u=JY(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((f,h)=>new Xa(u,f,this,pn(e),t,this.name,h)):l=new Xa(u,a,this,pn(e),t,this.name),this.addInboundNode(e,l,null,null,o,a,t),this._refCount++,this.activityRegularizer!=null)throw new Pt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Ea(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const r=JSON.stringify(t.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new Ea(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new ho(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return y1(this.weights)}build(e){this.built=!0}getWeights(e=!1){return dE(e?this.trainableWeights:this.weights)}setWeights(e){Ce(()=>{const t=this.weights;if(t.length!==e.length)throw new ue(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const r=[],s=dE(t);for(let i=0;i<s.length;++i){const o=s[i],a=t[i],l=e[i];if(!an(o.shape,l.shape))throw new ue(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}NT(r)})}addWeight(e,t,r,s,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new ue(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():jn("zeros"));const u=s.apply(t,r),f=new KY(u,r,e,o,a);return u.dispose(),i!=null&&this.addLoss(()=>i.apply(f.read())),o==null&&(o=!0),o?this._trainableWeights.push(f):this._nonTrainableWeights.push(f),f}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=pn(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,r){if(!this.supportsMasking)return;const s=this.computeMask(e,r),i=pn(t),o=pn(s);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,t,r,s,i,o,a=null){const l=pn(e);t=pn(t),r=pn(r),s=pn(s),i=m1(i),o=m1(o);const u=[],f=[],h=[];for(const p of l)u.push(p.sourceLayer),f.push(p.nodeIndex),h.push(p.tensorIndex);new Av({outboundLayer:this,inboundLayers:u,nodeIndices:f,tensorIndices:h,inputTensors:l,outputTensors:t,inputMasks:r,outputMasks:s,inputShapes:i,outputShapes:o},a);for(let p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function YY(n){n=pn(n);const e=[];for(const t of n)e.push(t.shape);return Ks(e)}function JY(n){return"float32"}function kB(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const r=e.inboundNodes[t];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let i=0;i<r.inboundLayers.length;i++){const o=r.inputTensors[i],a=r.inboundLayers[i],l=r.nodeIndices[i],u=kB(o,a,l);for(const f of u)s.indexOf(f)===-1&&s.push(f)}return s}}}function ZY(n){let e=!0;for(const t of pn(n))if(!(t instanceof Xa)){e=!1;break}return e}function eJ(n){let e=!0;for(const t of pn(n))if(t instanceof Xa){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ky extends Ut{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Iv("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new ue("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new ue("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new ue("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=t,this.dtype=r,this.inputSpec=[{shape:t}];const s=new Xa(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new Av({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new ue(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}ky.className="InputLayer";Ve(ky);function tJ(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new ue("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new ky({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nJ(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return it(e,n.dtype)}catch{throw new ue(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class Wu{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Wu)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=nJ(e,t),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new ue(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Xa){if(this.id2Value[e.id]==null)throw new ue(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new ue(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof Xa){if(this.id2Value[e.id]==null)throw new ue(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new ue(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&Ft(this.id2Mask)}}const w1=new aB,x1=new aB;function rJ(n){w1!=null&&w1.setMaxEntries(n),x1!=null&&x1.setMaxEntries(n)}function um(n,e,t,r){const s=t==null?!1:t.training,i=Array.isArray(n),o=i?n:[n],a=o.map(m=>m.name),l=[],u=e.names();for(const m of a)u.indexOf(m)!==-1?l.push(e.getValue(m)):l.push(null);const f=a.join(",")+"|"+e.names().sort().join(",");let h=w1.get(f),p;if(h==null){const m=sJ(o,e);h=m.sorted,p=m.recipientCounts,w1.put(f,h),x1.put(f,p)}p={},s||Object.assign(p,x1.get(f));const g=new Wu(e);for(let m=0;m<h.length;++m){const w=h[m],x=w.sourceLayer;if(x instanceof ky)continue;const b=[],C=[],$=[];let k=!1;for(const L of w.inputs){const T=g.getValue(L),I=g.getMask(L);b.push(T),C.push(I),I!=null&&(k=!0),s||(p[L.name]--,p[L.name]===0&&!e.hasKey(L)&&a.indexOf(L.name)===-1&&!T.isDisposed&&L.sourceLayer.stateful!==!0&&$.push(T))}k&&(t=t||{},t.mask=C[0]);const N=pn(x.apply(b,t));let _=null;x.supportsMasking&&(_=x.computeMask(b,C));const U=oJ(w),O=Array.isArray(U)?U:[U];for(let L=0;L<O.length;++L){g.hasKey(O[L])||g.add(O[L],N[L],Array.isArray(_)?_[0]:_);const T=a.indexOf(O[L].name);T!==-1&&(l[T]=N[L])}s||Ft($)}return g.disposeMasks(),i?l:l[0]}function sJ(n,e){ee(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],r={};if(n.length===1){const s=SD(n[0],e);t=s.sorted,r=s.recipientMap}else{const s=new Set;for(const i of n){const{sorted:o,recipientMap:a}=SD(i,e);for(const l of o)s.has(l.name)||(t.push(l),s.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(u=>r[l].add(u))}}return{sorted:t,recipientCounts:iJ(r)}}function iJ(n){const e={};for(const t in n)e[t]=n[t].size;return e}function SD(n,e){const t=new Set,r=[],s={};for(const a of e.names())t.add(a);const i=[],o=[];for(i.push(n);i.length>0;){const a=i[i.length-1];if(t.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),r.push(a),t.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const u of a.inputs)s[u.name]==null&&(s[u.name]=new Set),s[u.name].add(a.name),!t.has(u.name)&&i.push(u)}}return{sorted:r,recipientMap:s}}function oJ(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let r=0;r<n.sourceLayer.inboundNodes.length;++r)for(const s of n.sourceLayer.inboundNodes[r].outputTensors)if(s.id===n.id){t=r;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJ=Te();aJ.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,rJ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $T(n,e){return Ce(()=>ps(Ct(fe(n,n),e,!0)))}class Iy extends Yp{getConfig(){return{}}}class IB extends Iy{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ce(()=>{const t=$T(e,this.axis),r=Ui(t,0,this.maxValue);return fe(e,kt(r,qe(Or(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}IB.className="MaxNorm";Ve(IB);class EB extends Iy{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ce(()=>kt(e,qe(Or(),$T(e,this.axis))))}getConfig(){return{axis:this.axis}}}EB.className="UnitNorm";Ve(EB);class AB extends Iy{apply(e){return hh(e)}}AB.className="NonNeg";Ve(AB);class TB extends Iy{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ce(()=>{const t=$T(e,this.axis),r=qe(fe(this.rate,Ui(t,this.minValue,this.maxValue)),fe(1-this.rate,t));return fe(e,kt(r,qe(Or(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}TB.className="MinMaxNorm";Ve(TB);const CD={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function _r(n){return xT(n)}function kD(n,e={}){return by(n,co.getMap().classNameMap,e,"constraint")}function Pr(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in CD?CD[n]:n,config:{}};return kD(t)}else return n instanceof Iy?n:kD(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Vc(n){if(n==null)return;const e=[],t=[],r=[];for(const s in n){const i=n[s];if(typeof i!="number"){const o=i;e.push(o.data()),t.push(s),r.push(o)}}if(e.length>0){const s=await Promise.all(e);for(let i=0;i<s.length;++i)n[t[i]]=s[i][0];Ft(r)}}function NB(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var ID;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(ID||(ID={}));const lJ=125;class Fm{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class uJ{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class cJ extends Fm{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const r=t.size==null?0:t.size;this.seen+=r;for(const s in t){const i=t[s];if(typeof i=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+i*r;else{let o;s in this.totals?o=this.totals[s]:this.totals[s]=0;const a=Ce(()=>qe(this.totals[s],fe(i,r)));this.totals[s]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?t[r]=this.totals[r]/this.seen:Ce(()=>{const s=fe(kt(1,this.seen),this.totals[r]);t[r]=s,this.totals[r].dispose(),Ba(t[r])}))}}class fJ extends Fm{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const r in t)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(t[r])}async syncData(){const e=[],t=[],r=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),t.push(i),r.push(a)}}const s=await Promise.all(e);for(let i=0;i<s.length;++i)this.history[t[i]][r[i]].dispose(),this.history[t[i]][r[i]]=s[i][0]}}class hJ extends Fm{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||_L,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=lJ),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");WI(this.yieldEvery)&&(this.maybeWait=IY(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,r){const s=[];this.yield!=null&&(await Vc(r),s.push(this.yield(e,t,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Vc(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const r=[];this.epochEnd!=null&&(await Vc(t),r.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Vc(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const r=[];this.batchEnd!=null&&(await Vc(t),r.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):WI(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await Vc(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Vc(e),await this.trainEnd(e))}}function $B(n,e){return n==null&&(n={}),n instanceof Fm?[n]:Array.isArray(n)&&n[0]instanceof Fm?n:pn(n).map(r=>new hJ(r,e))}class no{constructor(){}static registerCallbackConstructor(e,t){ee(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),no.checkForDuplicate(t),no.constructors[e]==null&&(no.constructors[e]=[]),no.constructors[e].push(t)}static checkForDuplicate(e){for(const t in no.constructors)no.constructors[+t].forEach(s=>{if(s===e)throw new ue("Duplicate callback constructor.")})}static clear(){no.constructors={}}static createCallbacks(e){const t=[];for(const r in no.constructors){const s=+r;e>=s&&t.push(...no.constructors[s])}return t.map(r=>new r)}}no.constructors={};function RB(n,e,t,r,s,i,o,a,l){const u=new fJ,f=[new cJ,...no.createCallbacks(e)];n!=null&&f.push(...n),f.push(u);const h=new uJ(f);return h.setParams({epochs:t,initialEpoch:r,samples:s,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:h,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wa(n,e={},t=!1){return by(n,co.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function b1(n,e){return Ce(()=>{n.dtype!=="float32"&&(n=it(n,"float32"));const t=Ct(Sy(n),e,!0),r=yv(t.shape,Or()),s=ps(hc(t,r));return kt(n,s)})}function Tv(n,e){return Ce(()=>Cr(Sy(Tt(e,n)),-1))}function RT(n,e){return Ce(()=>Cr($s(Tt(e,n)),-1))}function OT(n,e){return Ce(()=>{const t=Tt(n,e),r=Ui($s(n),Or(),Number.MAX_VALUE),s=$s(kt(t,r));return fe(100,Cr(s,-1))})}function dJ(n,e){return Ce(()=>{const t=Ui(e,Or(),Number.MAX_VALUE),r=qa(qe(1,t)),s=Ui(n,Or(),Number.MAX_VALUE),i=qa(qe(1,s));return Cr(Sy(Tt(r,i)),-1)})}function pJ(n,e){return Ce(()=>{const t=hc(0,Tt(1,fe(n,e)));return Cr(Sy(t),-1)})}function gJ(n,e){return Ce(()=>{const t=hc(0,Tt(1,fe(n,e)));return Cr(t,-1)})}function mJ(n,e){return Ce(()=>{const t=Ct(fe(n,e),-1),r=jo(fe(Tt(1,n),e),-1);return hc(0,qe(1,Tt(r,t)))})}function yJ(n,e){return Ce(()=>{const t=Math.log(2),r=Tt(e,n),s=Tt(qe(r,dy(fe(-2,r))),t);return Cr(s,-1)})}function Mm(n,e,t=!1){return Ce(()=>{if(t)e=PA(e);else{const r=Ct(e,e.shape.length-1,!0);e=kt(e,r)}return e=Ui(e,Or(),1-Or()),hr(Ct(fe(it(n,"float32"),qa(e)),e.shape.length-1))})}function v1(n,e,t=!1){return Ce(()=>{const r=it(bv(MY(n)),"int32");e=Ui(e,Or(),1-Or());const s=e.shape,i=ye(eL(r,s[s.length-1]),s);return Mm(i,e,t)})}function wJ(n,e){if(!an(n.shape,e.shape))throw new ue(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return Ce(()=>{const t=hh(e),r=hr($s(e));return qe(Tt(t,fe(e,n)),QM(Ka(r)))})}function Nv(n,e){return Ce(()=>{let t;return t=Ui(e,Or(),1-Or()),t=qa(kt(t,Tt(1,t))),Cr(wJ(n,t),-1)})}function xJ(n,e){return Ce(()=>{const t=Ui(n,Or(),1),r=Ui(e,Or(),1);return Ct(fe(n,qa(kt(t,r))),-1)})}function bJ(n,e){return Ce(()=>{const t=qa(qe(Or(),e));return Cr(Tt(e,fe(n,t)),-1)})}function OB(n,e){return Ce(()=>{const t=b1(n,-1),r=b1(e,-1),s=fe(t,r);return hr(Ct(s,-1))})}const S1={meanSquaredError:Tv,meanAbsoluteError:RT,meanAbsolutePercentageError:OT,meanSquaredLogarithmicError:dJ,squaredHinge:pJ,hinge:gJ,categoricalHinge:mJ,logcosh:yJ,categoricalCrossentropy:Mm,sparseCategoricalCrossentropy:v1,binaryCrossentropy:Nv,kullbackLeiblerDivergence:xJ,poisson:bJ,cosineProximity:OB};function gk(n){if(typeof n=="string"){if(n in S1)return S1[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new ue(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DB(n,e){return Ce(()=>{const t=fe(.5,mo(e)),r=Ua(Vi(e,t),n.dtype);return Cr(ja(n,r),-1)})}function _B(n,e){return Ce(()=>Ua(ja(Rm(n,-1),Rm(e,-1)),"float32"))}function vJ(n,e){return Ce(()=>it(Ct(Pl(ja(n,1),ja(e,1))),"float32"))}function SJ(n,e){return Ce(()=>it(Ct(Pl(ja(n,0),ja(e,1))),"float32"))}function CJ(n,e){return Ce(()=>{const t=vJ(n,e),r=SJ(n,e),s=qe(t,r);return it(Ds(Vi(s,0),kt(t,s),0),"float32")})}function kJ(n,e){return Nv(n,e)}function IJ(n,e){return n.rank===e.rank&&(n=gy(n,[n.rank-1])),e=Rm(e,-1),e.dtype!==n.dtype&&(e=it(e,n.dtype)),it(ja(n,e),"float32")}const EJ=Tv,AJ=Tv,TJ=RT,NJ=RT,$J=OT,RJ=OT,PB=Mm,OJ=OB,FB=v1,C1={binaryAccuracy:DB,categoricalAccuracy:_B,precision:CJ,categoricalCrossentropy:PB,sparseCategoricalCrossentropy:FB,mse:EJ,MSE:AJ,mae:TJ,MAE:NJ,mape:$J,MAPE:RJ,cosine:OJ};function DJ(n){if(typeof n=="string"&&n in C1)return C1[n];if(typeof n!="string"&&n!=null)return n;throw new ue(`Unknown metric ${n}`)}function Jw(n){if(Aa(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(S1))if(S1[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(C1))if(C1[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _J(n){const e={Adagrad:()=>Jh.adagrad(.01),Adadelta:()=>Jh.adadelta(1,.95,Or()),Adam:()=>Jh.adam(.001,.9,.999,Or()),Adamax:()=>Jh.adamax(.002,.9,.999,Or(),0),RMSProp:()=>Jh.rmsprop(.001,.9,0,Or()),SGD:()=>Jh.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new ue(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ED=1*1024*1024;function AD(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!pE(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const r=JSON.stringify(n);r.length>ED&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${ED}.`)}}function pE(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!pE(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!pE(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function PJ(n,e,t,r=console.log){const s=MJ(n),i=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(f=>Math.floor(e*f)));let o;if(!s){i.push("Receives inputs"),o=[];for(const f in n.nodesByDepth)o.push(...n.nodesByDepth[f])}r("_".repeat(e)),k1(i,t,r),r("=".repeat(e));const a=n.layers;for(let f=0;f<a.length;++f)s?LJ(a[f],t,r):BJ(a[f],t,o,r),r((f===a.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const l=FJ(n),u=y1(n.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}function FJ(n){let e;return n.collectedTrainableWeights!=null?e=y1(n.collectedTrainableWeights):e=y1(n.trainableWeights),e}function MJ(n){let e=!0;const t=[],r=[];for(const s in n.nodesByDepth)t.push(n.nodesByDepth[s]);for(const s of t){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of n.layers){let i=!1;for(const o of s.inboundNodes)if(r.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function k1(n,e,t=console.log){let r="";for(let s=0;s<n.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=n[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);t(r)}function LJ(n,e,t){let r,s;try{s=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const i=n.name,o=n.getClassName(),a=[`${i} (${o})`,s,r,n.countParams().toString()];k1(a,e,t)}function BJ(n,e,t,r){let s,i;try{i=n.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const o=[];for(const h of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(h)===-1))for(let p=0;p<h.inboundLayers.length;++p){const g=h.inboundLayers[p].name,m=h.nodeIndices[p],w=h.tensorIndices[p];o.push(`${g}[${m}][${w}]`)}const a=n.name,l=n.getClassName(),u=o.length===0?"":o[0],f=[`${a} (${l})`,i,s,n.countParams().toString(),u];k1(f,e,r);for(let h=1;h<o.length;++h)k1(["","","","",o[h]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MB(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function I1(n,e){if(n===null)return null;if(typeof n=="string")return Xc(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],r=n.length;for(let s=0;s<r;++s){const i=n[s];MB(e,s,i)?t.push(i):t.push(I1(i,e))}return t}else{const t={};for(const r of Object.keys(n)){const s=n[r];if(r==="name"&&typeof s=="string")t[r]=s;else{const i=Xc(r);t[i]=I1(s,i)}}return t}}function gE(n,e){if(n==null)return null;if(typeof n=="string")return gl(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],r=n.length;for(let s=0;s<r;++s){const i=n[s];MB(e,s,i)?t.push(i):t.push(gE(i,e))}return t}else{const t={};for(const r of Object.keys(n)){const s=n[r],i=gl(r);(r==="name"||r==="className")&&typeof s=="string"?t[i]=s:t[i]=gE(s,r)}return t}}/** @license See the LICENSE file. */const LB="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zJ=n=>{const e=Object.keys(n);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class _o extends Ut{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const C=this.getClassName().toLowerCase();this.name=Iv(C)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Ku(this.inputs).length!==this.inputs.length)throw new ue(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(C=>C.name)}`);Ku(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(C=>C.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const C of this.outputs){const $=C.sourceLayer,k=C.nodeIndex,N=C.tensorIndex;this.outputLayers.push($),this.outputLayersNodeIndices.push(k),this.outputLayersTensorIndices.push(N)}for(const C of this.inputs){const $=C.sourceLayer,k=C.nodeIndex,N=C.tensorIndex;Aa(k===0,"input layer has >1 nodes"),Aa(N===0,"input layer has >1 tensors"),this.inputLayers.push($),this.inputLayersNodeIndices.push(k),this.inputLayersTensorIndices.push(N)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let C=0;C<this.inputLayers.length;C++){const $=this.inputLayers[C];if(!($ instanceof ky))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${C} (0-based) originates from layer type ${$.getClassName()}.`);this.inputNames.push($.name),this.feedInputShapes.push($.batchInputShape),this.feedInputNames.push($.name)}for(const C of this.outputLayers)this.outputNames.push(C.name);this.internalInputShapes=this.inputs.map(C=>C.shape),this.internalOutputShapes=this.outputs.map(C=>C.shape);const t={},r={},s={},i={},o={},a=[],l=(C,$,k,N,_,U)=>{(N==null||_==null||U==null)&&(N=C.sourceLayer,_=C.nodeIndex,U=C.tensorIndex);const O=N.inboundNodes[_];if(k.indexOf(O)!==-1)throw new ho(`The tensor ${C.name} at layer "${N.name}" is part of a cycle.`);if($.indexOf(O)!==-1)return;this.containerNodes.add(_o.nodeKey(N,_)),N.id in o||(o[N.id]=Object.keys(o).length),k.indexOf(O)===-1&&k.push(O);const L=O.inboundLayers.length;for(let T=0;T<L;T++){const I=O.inputTensors[T],v=O.inboundLayers[T],A=O.nodeIndices[T],M=O.tensorIndices[T];l(I,$,k,v,A,M)}for($.push(O);k.indexOf(O)>=0;)k.splice(k.indexOf(O),1);a.push(O)},u=[],f=[];for(const C of this.outputs)l(C,u,f);const h=a.slice().reverse();for(const C of h){r[C.id]=C,C.id in t||(t[C.id]=0);let $=t[C.id];const k=s[C.outboundLayer.id]==null?0:s[C.outboundLayer.id];$=Math.max($,k),s[C.outboundLayer.id]=$,i[C.outboundLayer.id]=C.outboundLayer,t[C.id]=$;for(let N=0;N<C.inboundLayers.length;N++){const _=C.inboundLayers[N],U=C.nodeIndices[N],O=_.inboundNodes[U],L=t[O.id]==null?0:t[O.id];t[O.id]=Math.max($+1,L),r[O.id]=O}}const p={};for(const C in t){const $=t[C];$ in p||(p[$]=[]),p[$].push(r[C])}const g={};for(const C in s){const $=s[C];$ in g||(g[$]=[]),g[$].push(i[C])}let m=Object.keys(g).map(C=>parseInt(C,10)).sort(Xw);this.layers=[];for(const C of m){const $=g[C];$.sort((k,N)=>{const _=o[k.id],U=o[N.id];return _<U?-1:_>U?1:0});for(const k of $)k instanceof _o&&this.internalContainerRefs.push(k),this.layers.push(k)}this.layersByDepth=g,m=Object.keys(p).map(C=>parseInt(C,10)).sort(Xw);const w=this.inputs.slice(),x=[];for(const C of m)for(const $ of p[C]){const k=$.outboundLayer;if(k!=null){for(const N of $.inputTensors)if(w.indexOf(N)===-1)throw new ho(`Graph disconnected: cannot obtain value for tensor ${N} at layer "${k.name}". The following previous layers were accessed without issue: ${x}`);for(const N of $.outputTensors)w.push(N);x.push(k.name)}}this.nodesByDepth=p;const b=this.layers.map(C=>C.name);for(const C of b){const $=b.filter(k=>k===C).length;if($!==1)throw new ho(`The name "${C}" is used ${$} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(b))}this.outboundNodes=[],this.inboundNodes=[],new Av({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(C=>null),outputMasks:this.outputs.map(C=>null),inputShapes:this.inputs.map(C=>C.shape),outputShapes:this.outputs.map(C=>C.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new ue("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const r of this.layers)t.push(...r.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const r={};let s=0;const i=zJ(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,u]of a.weights.entries()){const f=i?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(r[f]!=null)throw new ue(`Duplicate weight name: ${f}`);r[f]=u,s++}const o=[];for(const a in e){let l=a;if(r[a]==null){const u=a.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(r[l]!=null)o.push([r[l],e[a]]);else if(t)throw new ue(`Provided weight data has no target variable: ${a}`);delete r[l]}if(t){const a=[];for(const l in r)a.push(l);if(a.length>0)throw new ue(`${a.length} of ${s} weights are not set: ${a}`)}NT(o)}parseWeights(e){for(const t in Object.keys(e)){const r=t.split("/"),s=["vars","layer_checkpoint_dependencies"],i=r.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!s.includes(o)).join("/");i!==t&&(e[i]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${LB}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const r=gE(this.updatedConfig());return t?JSON.stringify(r):r}call(e,t){return Ce(()=>{e=pn(e);const r=new Wu;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return um(this.outputs,r,t)})}computeMask(e,t){return Ce(()=>{e=pn(e);let r;return t==null?r=Yf(null,e.length):r=pn(t),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const t=m1(e);if(t.length!==this.inputLayers.length)throw new ue(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<t.length;a++){const l=this.inputLayers[a],u=t[a],f=l.name+"_0_0";r[f]=u}const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Xw);if(s.length>1)for(const a of s){const l=this.nodesByDepth[a];for(const u of l){const f=u.outboundLayer;if(this.inputLayers.map(w=>w.id).indexOf(f.id)!==-1)continue;const h=[];for(let w=0;w<u.inboundLayers.length;w++){const x=u.inboundLayers[w],b=u.nodeIndices[w],C=u.tensorIndices[w],$=`${x.name}_${b}_${C}`,k=r[$];h.push(k)}const p=f.computeOutputShape(Ks(h)),g=m1(p),m=f.inboundNodes.indexOf(u);for(let w=0;w<g.length;w++){const x=`${f.name}_${m}_${w}`;r[x]=g[w]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],f=this.outputLayersTensorIndices[a],h=`${l.name}_${u}_${f}`;o.push(h)}for(let a=0;a<o.length;a++){const l=o[a];Aa(l in r),i.push(r[l])}return Ks(i)}runInternalGraph(e,t){t==null&&(t=Yf(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],f=e[l],h=t[l];r[u.id]=[f,h]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Xw);for(const l of s){const u=this.nodesByDepth[l];for(const f of u){const h=f.outboundLayer,p=f.inputTensors,g=f.outputTensors,m=new Array;for(const w of p)w.id in r&&m.push(r[w.id]);if(m.length===p.length){let w={},x,b,C,$;if(f.callArgs!=null&&(w=f.callArgs),m.length===1){const[k,N]=m[0];w.mask==null&&(w.mask=N),C=pn(h.call(k,w)),$=pn(h.computeMask(k,N)),x=[k],b=[N]}else x=m.map(k=>k[0]),b=m.map(k=>k[1]),w.mask==null&&(w.mask=b),C=pn(h.call(x,w)),$=pn(h.computeMask(x,b));if(h.activityRegularizer)throw new Pt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let k=0;k<g.length;++k){const N=g[k],_=C[k],U=$[k];r[N.id]=[_,U]}}}}const i=[],o=[],a=[];for(const l of this.outputs){Aa(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[u,f]=r[l.id];a.push(u.shape),i.push(u),o.push(f)}return[i,o,a]}buildNodeConversionMap(e){const t={};let r;for(const s of this.layers){r=s instanceof _o?1:0;for(let i=0;i<s.inboundNodes.length;i++){const o=_o.nodeKey(s,i);this.containerNodes.has(o)&&(t[o]=r,r+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new ue("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new ue(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new ue(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return Ce(()=>{const e=[];for(const t of this.layers)for(let r=0;r<t.inboundNodes.length;++r){const s=_o.nodeKey(t,r);this.containerNodes.has(s)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),u=[];for(let h=0;h<o.inboundNodes.length;h++){const p=o.inboundNodes[h],g=_o.nodeKey(o,h);let m={};if(this.containerNodes.has(g)){if(p.callArgs)try{JSON.stringify(p.callArgs),m=p.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),m={}}if(p.inboundLayers.length>0){const w=[];for(let x=0;x<p.inboundLayers.length;x++){const b=p.inboundLayers[x],C=p.nodeIndices[x],$=p.tensorIndices[x],k=_o.nodeKey(b,C);let N=t[k];N==null&&(N=0),w.push([b.name,N,$,m])}u.push(w)}}}const f={};f.name=o.name,f.className=a,f.config=l,f.inboundNodes=u,r.push(f)}e.layers=r;const s=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],u=_o.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let f=t[u];f==null&&(f=0);const h=this.inputLayersTensorIndices[o];s.push([a.name,f,h])}e.inputLayers=s;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],u=_o.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let f=t[u];f==null&&(f=0);const h=this.outputLayersTensorIndices[o];i.push([a.name,f,h])}return e.outputLayers=i,e}static fromConfig(e,t,r={},s=!1){const i={},o={};function a(x,b){x.name in o?o[x.name].push(b):o[x.name]=[b]}function l(x,b){const C=[];let $;for(const k of b){const N=k[0],_=k[1],U=k[2];if($=k[3]==null?{}:k[3],!(N in i)){a(x,b);return}const O=i[N];if(O.inboundNodes.length<=_){a(x,b);return}const L=O.inboundNodes[_];C.push(L.outputTensors[U])}C.length>0&&x.apply(Ks(C),$)}function u(x){const b=x.name,C=Wa(x,t.customObjects!=null?t.customObjects:{});C.setFastWeightInitDuringBuild(s),i[b]=C,x.inboundNodes.forEach(k=>{if(!(k instanceof Array))throw new ue(`Corrupted configuration, expected array for nodeData: ${k}`);a(C,k)})}const f=t.name,h=t.layers;for(const x of h)u(x);for(;!kY(o);)for(const x of h){const b=i[x.name];if(b.name in o){const C=o[b.name];delete o[b.name];for(const $ of C)l(b,$)}}const p=[],g=[],m=t.inputLayers;for(const x of m){const b=x[0],C=x[1],$=x[2];Aa(b in i);const N=i[b].inboundNodes[C].outputTensors;p.push(N[$])}const w=t.outputLayers;for(const x of w){const b=x[0],C=x[1],$=x[2];Aa(b in i);const N=i[b].inboundNodes[C].outputTensors;g.push(N[$])}return new e({inputs:p,outputs:g,name:f})}get stateful(){if(this._stateful)throw new ue("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){Ce(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function UJ(n,e,t){const r=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>null);if(r===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==r)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const s=[];return e.forEach(i=>{i in n?s.push(n[i]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${t} must be either an array with ${r} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function BB(n,e){return UJ(n,e,"classWeight")}async function zB(n,e,t,r){if(t!=null){const s=Ce(()=>{if(n.shape.length===1)return $f(n);if(n.shape.length===2){if(n.shape[1]>1)return Rm(n,1);if(n.shape[1]===1)return ye(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await s.data());Ft(s);const o=[];return i.forEach(a=>{if(t[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(t[a])}),yi(o,"float32")}else return null}function VJ(n,e){return fe(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const WJ=32;function UB(n,e){let t,r;const s=e;t=s.xs,r=s.ys,ee(t!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=TD("input",n.inputNames,t),o=TD("output",n.outputNames,r),a=i[0].shape[0];ee(i.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),ee(o.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<i.length;l++)ee(i[l].shape[0]===a,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);for(let l=0;l<o.length;l++)ee(o[l].shape[0]===a,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);return{xs:i,ys:o}}function TD(n,e,t){if(t instanceof Tr)return[t];if(Array.isArray(t))return ee(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const r=[];for(const s of e){if(t[s]==null)throw new ue(`The feature data generated by the dataset lacks the required ${n} key '${s}'.`);r.push(t[s])}return r}}function GJ(n){if(n.length===3)throw new Pt("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function HJ(n,e,t){const r=t.batchesPerEpoch!=null;if(ee(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),ee(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),ee(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),ee(!r||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),ee(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const s=t.validationData!=null;let i,o;if(s)if(ND(t.validationData))ee(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const x=GJ(t.validationData);i=x.xs,o=x.ys}const a=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let u;s?u=l.slice().concat(l.map(x=>"val_"+x)):u=l.slice();const f=$B(t.callbacks,t.yieldEvery),h=t.verbose==null?1:t.verbose,{callbackList:p,history:g}=RB(f,h,t.epochs,null,null,jJ(e,t),null,s,u);p.setModel(n),n.history=g,await p.onTrainBegin(),n.stopTraining_=!1;let m=t.initialEpoch==null?0:t.initialEpoch,w=await e.iterator();for(;m<t.epochs;){const x={};await p.onEpochBegin(m);let b=0,C=0;for(r||(w=await e.iterator());!r||b<t.batchesPerEpoch;){const $=await w.next();if(r&&$.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${b} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if($.value!=null){const{xs:k,ys:N}=UB(n,$.value),_={};_.batch=C,_.size=k[0].shape[0],await p.onBatchBegin(C,_);const U=[];if(t.classWeight!=null){const T=BB(t.classWeight,n.outputNames);for(let I=0;I<T.length;++I)U.push(await zB(N[I],null,T[I]))}const O=k.concat(N).concat(U),L=a(O);Ft(O);for(let T=0;T<l.length;++T){const I=l[T],v=L[T];_[I]=v,Ba(v)}await p.onBatchEnd(C,_),NB(_),C++,b++}if(r?b>=t.batchesPerEpoch:$.done){if(s){let k;ND(t.validationData)?k=pn(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):k=pn(n.evaluate(i,o,{batchSize:t.validationBatchSize==null?WJ:t.validationBatchSize,verbose:0}));for(let N=0;N<n.metricsNames.length;++N)x[`val_${n.metricsNames[N]}`]=k[N]}break}if(n.stopTraining_)break}if(await p.onEpochEnd(m,x),m++,n.stopTraining_)break}return await p.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function jJ(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function ND(n){return typeof n.iterator=="function"}function KJ(n){return typeof n.next=="function"}async function qJ(n,e,t){t=t||{};const r=t.batches!=null,s=n.testFunction;let i=[];if(t.verbose>0)throw new Pt("Verbose mode is not implemented yet.");ee(!r||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const o=KJ(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<t.batches;){const u=await o.next();if(i=Ce(()=>{if(u.value){const{xs:f,ys:h}=UB(n,u.value),p=f.concat(h),g=Ce(()=>s(p));if(Ft(p),l===0)for(let w=0;w<g.length;++w)i.push(on(0));const m=p[0].shape[0];for(let w=0;w<g.length;++w){const x=g[w],b=i[w];i[w]=Ce(()=>qe(i[w],fe(m,x))),l>0&&Ft(b)}Ft(g),a+=m,++l}return i}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<i.length;++u){const f=i[u];i[u]=kt(i[u],a),Ft(f)}return Ks(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mk(n){ee(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function qg(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(r=>Of(r,e,t-e)):Of(n,e,t-e)}function mE(n,e){return Ce(()=>n==null?null:Array.isArray(n)?n.map(t=>mE(t,e)):gB(n,e.dtype==="int32"?e:it(e,"int32")))}function yk(n,e){const t=[];let r=0,s=null;for(;r<n;)s=r+e,s>=n&&(s=n),t.push([r,s]),r=s;return t}function VB(n){const e=[];n instanceof Tr&&(n=[n]);for(let t=0;t<n.length;++t){const r=n[t];if(r.rank===1)e.push(vy(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function Do(n,e){if(n==null)return;const t=[];if(e instanceof Tr)t.push(e.id);else if(Array.isArray(e))e.forEach(s=>t.push(s.id));else if(e!=null)for(const s in e){const i=e[s];t.push(i.id)}const r=[];if(n instanceof Tr)t.indexOf(n.id)===-1&&r.push(n);else if(Array.isArray(n))n.forEach(s=>{t.indexOf(s.id)===-1&&r.push(s)});else if(n!=null)for(const s in n){const i=n[s];t.indexOf(i.id)===-1&&r.push(i)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function XJ(n){return n instanceof Tr}function yE(n){return Array.isArray(n)}function $D(n){return!XJ(n)&&!yE(n)}function RD(n,e,t,r=!0,s=""){if(e==null||e.length===0){if(n!=null){let o=!1;if(yE(n)&&n.length>0)o=!0;else if($D(n)){for(const a in n)if(n.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new ue(`Error when checking model ${s} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(o=>null);let i;if($D(n)){n=n,i=[];for(const o of e){if(n[o]==null)throw new ue(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(n[o])}}else if(yE(n)){if(n=n,n.length!==e.length)throw new ue(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);i=n}else{if(n=n,e.length>1)throw new ue(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);i=[n]}if(i=VB(i),t!=null)for(let o=0;o<e.length;++o){if(t[o]==null)continue;const a=i[o];if(a.shape.length!==t[o].length)throw new ue(`Error when checking ${s}: expected ${e[o]} to have ${t[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<t[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],f=t[o][l];if(f!=null&&f>=0&&u!==f)throw new ue(`${s} expected a batch of elements where each example has shape [${t[o].slice(1,t[o].length)}] (i.e.,tensor shape [*,${t[o].slice(1,t[o].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function QJ(n,e,t){const r=Ku(n.map(i=>i.shape[0]));r.sort();const s=Ku(e.map(i=>i.shape[0]));if(s.sort(),r.length>1)throw new ue(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(i=>i.shape))}`);if(s.length>1)throw new ue(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&s.length>0&&!an(r,s))throw new ue(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function YJ(n,e,t){const r=[Tv,Nv,Mm];for(let s=0;s<n.length;++s){const i=n[s],o=e[s],a=t[s];if(o!=null){if(o===Mm&&i.shape[i.shape.length-1]===1)throw new ue(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){const l=i.shape.slice(1),u=a.slice(1);for(let f=0;f<l.length;++f){const h=l[f],p=u[f];if(p!=null&&h!==p)throw new ue(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function OD(n,e,t,r=!0,s=""){let i;if(Array.isArray(n)){if(n.length!==e.length)throw new ue(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);i=n}else{if(e.length>1)throw new ue(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);i=[n]}if(t!=null)for(let o=0;o<e.length;++o){if(t[o]==null)continue;const a=i[o];if(a.shape.length!==t[o].length)throw new ue(`Error when checking ${s}: expected ${e[o]} to have ${t[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<t[o].length;++l){if(l===0&&!r)continue;const u=a.shape[l],f=t[o][l];if(f!=null&&f!==u)throw new ue(`Error when checking ${s}: expected ${e[o]} to have shape ${JSON.stringify(t[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function JJ(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(r=>t);{const r=[];for(const s of e){let i=t.hasOwnProperty(s)?t[s]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const ZJ="layers-model";class Id extends _o{constructor(e){super(e),this.isTraining=!1}summary(e,t,r=console.log){if(!this.built)throw new ue("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");PJ(this,e,t,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=_J(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof pc))throw new ue("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new ue(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),t.push(gk(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new ue(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(a=>gk(a))}else{const o=gk(e.loss);this.outputs.forEach(a=>{t.push(o)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Rf("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const s=JJ(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};Rf("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=s[o];(u=>{const f="";let h,p,g;for(const m of u){if(typeof m=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(m)!==-1){const x=this.internalOutputShapes[o];x[x.length-1]===1||this.lossFunctions[o]===Nv?["accuracy","acc"].indexOf(m)!==-1?p=DB:["crossentropy","ce"].indexOf(m)!==-1&&(p=kJ):this.lossFunctions[o]===v1?["accuracy","acc"].indexOf(m)!==-1?p=IJ:["crossentropy","ce"].indexOf(m)!==-1&&(p=FB):["accuracy","acc"].indexOf(m)!==-1?p=_B:["crossentropy","ce"].indexOf(m)!==-1&&(p=PB);let b;["accuracy","acc"].indexOf(m)!==-1?b="acc":["crossentropy","ce"].indexOf(m)!==-1&&(b="ce"),g=p,h=f+b}else g=DJ(m),h=f+Jw(m);let w;Rf(h,()=>{w=g}),i(o,h,w)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,r={}){const s=r.batchSize==null?32:r.batchSize;mk(s);const o=this.standardizeUserDataXY(e,t,!0,s);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,s,r.verbose,r.steps);return Ks(u)}finally{Do(o[0],e),Do(o[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),qJ(this,e,t)}checkNumSamples(e,t,r,s="steps"){let i;if(r!=null){if(i=null,t!=null)throw new ue(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new ue(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new ue("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(t),s=r?t:[t],i=this.retrieveSymbolicTensors(s),o=new Wu;if(e instanceof Tr&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new ue(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new ue(`No value is provided for the model's input ${l.name}`);o.add(l,u)}const a=um(i,o);return r?a:a[0]}retrieveSymbolicTensors(e){const t=Yf(null,e.length);let r=e.length;for(const s of this.layers){const i=Array.isArray(s.output)?s.output:[s.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(t[a]=i[l],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw t.forEach((i,o)=>{i==null&&s.push(e[o])}),new ue(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return t}predictLoop(e,t=32,r=!1){return Ce(()=>{const s=this.checkNumSamples(e);if(r)throw new Pt("Verbose predictLoop() is not implemented yet.");const i=yk(s,t),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)Ce(()=>{const u=i[a][0],f=i[a][1],h=qg(e,u,f),p=[];if(Array.isArray(h))for(let m=0;m<h.length;++m)p.push({key:this.inputs[m],value:h[m]});else p.push({key:this.inputs[0],value:h});const g=new Wu(p);return um(this.outputs,g)}).forEach((u,f)=>o[f].push(u));return Ks(o.map(a=>Zs(a,0)))})}predict(e,t={}){const r=VB(e);OD(r,this.inputNames,this.feedInputShapes,!1);try{const s=t.batchSize==null?32:t.batchSize;return mk(s),this.predictLoop(r,s)}finally{Do(r,e)}}predictOnBatch(e){OD(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,r=!0,s){if(this.optimizer_==null)throw new ho("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===v1?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=RD(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=RD(t,this.feedOutputNames,i,!1,"target"),QJ(e,t),YJ(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new ue(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,r,s,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,t,i,o);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(s!=null){const f=BB(s,this.outputNames);u=[];for(let h=0;h<f.length;++h)u.push(await zB(l[h],null,f[h]))}return[a,l,u]}testLoop(e,t,r,s=0,i){return Ce(()=>{const o=this.checkNumSamples(t,r,i,"steps"),a=[];if(s>0)throw new Pt("Verbose mode is not implemented yet.");if(i!=null)throw new Pt("steps mode in testLoop() is not implemented yet");{const l=yk(o,r),u=yi(Xo(0,o));for(let f=0;f<l.length;++f){const h=l[f][0],p=l[f][1],g=Of(u,h,p-h),m=mE(t,g),w=e(m);if(f===0)for(let x=0;x<w.length;++x)a.push(on(0));for(let x=0;x<w.length;++x){const b=w[x];a[x]=qe(a[x],fe(p-h,b))}}for(let f=0;f<a.length;++f)a[f]=kt(a[f],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let r=0;r<e.length;++r){const s=e[r];let i=s;if(mD(e,s)>1){const o=mD(e.slice(0,r),s);i+=`_${o}`}t.push(i)}return t}makeTrainFunction(){return e=>{const t=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const h=[];for(let w=0;w<this.inputs.length;++w)h.push({key:this.inputs[w],value:r[w]});const p=new Wu(h),g=um(this.outputs,p,{training:!0});let m;for(let w=0;w<this.lossFunctions.length;++w){const x=this.lossFunctions[w];let b=x(s[w],g[w]);i[w]!=null&&(b=VJ(b,i[w]));const C=Cr(b);t.push(C),w===0?m=b:m=qe(m,b)}for(let w=0;w<this.metricsTensors.length;++w){let x;if(this.outputs.length>1&&w<this.outputs.length)x=t[w];else{const b=this.metricsTensors[w][0],C=this.metricsTensors[w][1];x=Cr(b(s[C],g[C]))}Ba(x),o.push(x)}return m=Cr(m),this.calculateLosses().forEach(w=>{m=qe(m,w)}),m},l=this.collectedTrainableWeights.map(h=>h.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>Ce(()=>{const t=[];let r;const s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let u=0;u<this.inputs.length;++u)o.push({key:this.inputs[u],value:s[u]});const a=new Wu(o),l=um(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const f=this.lossFunctions[u],h=Cr(f(i[u],l[u]));u===0?r=h:r=qe(r,h),t.push(r)}for(let u=0;u<this.metricsTensors.length;++u){const f=this.metricsTensors[u][0],h=this.metricsTensors[u][1],p=Cr(f(i[h],l[h]));t.push(p)}return t})}async fit(e,t,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,i,o,a,l,u,f,h,p;try{const g=r.batchSize==null?32:r.batchSize;mk(g);const w=await this.standardizeUserData(e,t,r.sampleWeight,r.classWeight,!1,g);s=w[0],i=w[1],p=w[2];let x=!1,b;if(r.validationData!=null&&r.validationData.length>0){if(x=!0,r.validationData.length===2)l=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new Pt("validationData including sample weights is not supported yet."):new ue(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const T=await this.standardizeUserData(l,u,null,null,!0,g);f=T[0],h=T[1],b=f.concat(h)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){x=!0;const L=Math.floor(s[0].shape[0]*(1-r.validationSplit)),T=s[0].shape[0];f=qg(s,L,T),o=s,s=qg(s,0,L),h=qg(i,L,T),a=i,i=qg(i,0,L),b=f.concat(h)}else r.validationSteps!=null&&(x=!0);const C=s.concat(i).concat(p);this.checkTrainableWeightsConsistency();const $=this.makeTrainFunction(),k=this.getDedupedMetricsNames();let N,_;x?(this.makeTestFunction(),N=this.testFunction,_=k.slice().concat(k.map(L=>"val_"+L))):(N=null,b=[],_=k.slice());const U=$B(r.callbacks,r.yieldEvery);return await this.fitLoop($,C,k,g,r.epochs,r.verbose,U,N,b,r.shuffle,_,r.initialEpoch,null,null)}finally{this.isTraining=!1,Do(s,e),Do(i,t),Do(o,e),Do(a,t),Do(f,l),Do(h,u),p!=null&&Ft(p)}}async fitLoop(e,t,r,s,i,o,a,l,u,f,h,p,g,m){s==null&&(s=32),i==null&&(i=1),f==null&&(f=!0),p==null&&(p=0);let w=!1;if(l!=null&&u!=null&&(w=!0),m!=null&&(w=!0,g==null))throw new ue("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const x=this.checkNumSamples(t,s,g,"steps_per_epoch");let b;x!=null&&(b=Xo(0,x)),o==null&&(o=1);const{callbackList:C,history:$}=RB(a,o,i,p,x,g,s,w,h);C.setModel(this),this.history=$,await C.onTrainBegin(),this.stopTraining_=!1;for(let k=p;k<i;++k){await C.onEpochBegin(k);const N={};if(g!=null)throw new Pt("stepsPerEpoch mode is not implemented yet.");{if(f==="batch")throw new Pt("batch shuffling is not implemneted yet");f&&v8(b);const _=yi(b),U=yk(x,s);for(let O=0;O<U.length;++O){const L={};if(await C.onBatchBegin(O,L),Ce(()=>{const T=U[O][0],I=U[O][1],v=Of(_,T,I-T);L.batch=O,L.size=I-T;const A=mE(t,v),M=e(A);for(let D=0;D<r.length;++D){const B=r[D],j=M[D];L[B]=j,Ba(j)}if(O===U.length-1&&w){const D=this.testLoop(l,u,s);for(let B=0;B<r.length;++B){const j=r[B],W=D[B];Ba(W),N["val_"+j]=W}}}),await C.onBatchEnd(O,L),NB(L),this.stopTraining_)break}_.dispose()}if(await C.onEpochEnd(k,N),this.stopTraining_)break}return await C.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return HJ(this,e,t)}async trainOnBatch(e,t){const r=await this.standardizeUserData(e,t),s=r[0],i=r[1],a=this.makeTrainFunction()(s.concat(i)),l=[];for(const u of a){const f=await u.data();l.push(f[0])}return Ft(a),Do(r[0],e),Do(r[1],t),Ks(l)}getNamedWeights(e){const t=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let o=0;o<s.length;++o)r&&!s[o].trainable||t.push({name:s[o].originalName,tensor:i[o]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=VO().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-VO().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=gl(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>gl(t))}else{const t=Object.keys(this.loss);e={};const r=this.loss;for(const s of t)if(typeof r[s]=="string")e[s]=gl(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[gl(Jw(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>gl(Jw(e)));{const e={};for(const t in this.metrics)e[t]=gl(Jw(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=I1(e.optimizer_config),r=Wa(t);let s;if(typeof e.loss=="string")s=Xc(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(o=>Xc(o));else if(e.loss!=null){s={};for(const o in e.loss)s[o]=Xc(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>Xc(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=Xc(e.metrics[o])}this.compile({loss:s,metrics:i,optimizer:r})}async save(e,t){if(typeof e=="string"){const u=EH(e);if(u.length===0)throw new ue(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new ue(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new ue("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await WO(this.getNamedWeights(t)),a={modelTopology:this.toJSON(null,!1),format:ZJ,generatedBy:`TensorFlow.js tfjs-layers v${LB}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:f,specs:h}=await WO(await this.optimizer.getWeights(),u);r.specs.push(...h),r.data=wH([r.data,f])}return this.userDefinedMetadata!=null&&(AD(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){AD(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Id.className="Model";Ve(Id);class WB extends Id{}WB.className="Functional";Ve(WB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function eZ(n,e){if(e==null&&(e={}),typeof n=="string"){const t=AH(n,e);if(t.length===0)t.push(aX(n,e));else if(t.length>1)throw new ue(`Found more than one (${t.length}) load handlers for URL '${n}'`);n=t[0]}return tZ(n,void 0,e)}async function tZ(n,e,t){if(t==null&&(t={}),n.load==null)throw new ue("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await n.load();let s=r.modelTopology;s.model_config!=null&&(s=s.model_config);const i=t.strict==null?!0:t.strict,o=r.weightData!=null&&r.weightSpecs!=null&&i,a=Wa(I1(s),e,o),l=r.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),r.userDefinedMetadata!=null&&a.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new ue("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:u,optimizerWeights:f}=nZ(r.weightData,r.weightSpecs);a.loadWeights(u,i),a.optimizer!=null&&f.length>0&&await a.optimizer.setWeights(f),Ft(u),Ft(f.map(h=>h.tensor))}return a}function nZ(n,e){const t=hH(n,e),r={},s=[];return e.forEach(i=>{i.group==="optimizer"?s.push({name:i.name,tensor:t[i.name]}):r[i.name]=t[i.name]}),{modelWeights:r,optimizerWeights:s}}class Ip extends Id{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Iv("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new ue(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof Ip||e instanceof Id;let r;if(t){if(r=e,r.outputs.length!==1)throw new ue("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new ue("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new ue("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=tJ({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(t)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new ue(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new ue("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=kB(this.outputs[0])}this.inboundNodes=[],new Av({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Yf(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(Zt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Id({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,r=console.log){this.built||this.build(),super.summary(e,t,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,r={}){if(!this.built)throw new ho("The model needs to be compiled before being used.");return this.model.evaluate(e,t,r)}async evaluateDataset(e,t){if(!this.built)throw new ho("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,r={}){if(!this.built)throw new ho("The model needs to be compiled before being used.");return this.model.fit(e,t,r)}async fitDataset(e,t){if(!this.built)throw new ho("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,r={},s=!1){let i,o={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new ue("Legacy serialization format not supported yet.");i=t}else ee(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=t.layers,delete t.layers,o=t;const a=new e(o);if(!(a instanceof Ip))throw new Pt(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const f=Wa(l,void 0,s);s&&f.setFastWeightInitDuringBuild(!0),a.add(f)}return a}set stopTraining(e){if(this.model==null)throw new ue("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new ue("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const r={};r.className=t.getClassName(),r.config=t.getConfig(),e.push(r)}return{name:this.name,layers:e}}}Ip.className="Sequential";Ve(Ip);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rZ(n){return new Ip(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let ms=class extends Yp{getConfig(){return{}}};class GB extends ms{apply(e,t=1){return BY(e,t)}}GB.className="elu";Ve(GB);class HB extends ms{apply(e){return oL(e)}}HB.className="selu";Ve(HB);class jB extends ms{apply(e){return hh(e)}}jB.className="relu";Ve(jB);class KB extends ms{apply(e){return Ce(()=>_m(6,hh(e)))}}KB.className="relu6";Ve(KB);class qB extends ms{apply(e){return e}}qB.className="linear";Ve(qB);class XB extends ms{apply(e){return qp(e)}}XB.className="sigmoid";Ve(XB);class QB extends ms{apply(e){return UY(e)}}QB.className="hardSigmoid";Ve(QB);class YB extends ms{apply(e){return dy(e)}}YB.className="softplus";Ve(YB);class JB extends ms{apply(e){return zY(e)}}JB.className="softsign";Ve(JB);class ZB extends ms{apply(e){return gv(e)}}ZB.className="tanh";Ve(ZB);let DT=class extends ms{apply(e,t=-1){return PA(e,t)}};DT.className="softmax";Ve(DT);class e4 extends ms{apply(e,t=-1){return YM(e,t)}}e4.className="logSoftmax";Ve(e4);class t4 extends ms{apply(e){return Ce(()=>Ce(()=>{const t=Math.sqrt(2),r=fe(.5,qe(1,jM(kt(e,t))));return fe(e,r)}))}}t4.className="gelu";Ve(t4);class n4 extends ms{apply(e){return Ce(()=>fe(.5,fe(e,qe(1,gv(fe(ps(kt(2,Math.PI)),qe(e,fe(.044715,qf(e,3)))))))))}}n4.className="gelu_new";Ve(n4);class r4 extends ms{apply(e){return Ce(()=>fe(e,gv(dy(e))))}}r4.className="mish";Ve(r4);class s4 extends ms{apply(e,t=1){return Ce(()=>fe(qp(fe(e,t)),e))}}s4.className="swish";Ve(s4);function Ju(n){return n.getClassName()}function wk(n,e={}){return by(n,co.getMap().classNameMap,e,"activation")}function Zu(n){if(n==null){const e={};return e.className="linear",e.config={},wk(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},wk(e)}else return n instanceof ms?n:wk(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sZ(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class i4 extends Yp{}class o4 extends i4{constructor(e){super(),sZ(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return Ce(()=>{let t=Vr([1]);return this.hasL1&&(t=qe(t,Ct(fe(this.l1,$s(e))))),this.hasL2&&(t=qe(t,Ct(fe(this.l2,Sy(e))))),ye(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}o4.className="L1L2";Ve(o4);const DD={l1l2:"L1L2"};function Sn(n){return xT(n)}function _D(n,e={}){return by(n,co.getMap().classNameMap,e,"regularizer")}function Kn(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in DD?DD[n]:n,config:{}};return _D(t)}else return n instanceof i4?n:_D(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class a4 extends Ut{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=$t(e);let r=hh(e);return this.maxValue!=null&&(r=Ui(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}a4.className="ReLU";Ve(a4);class l4 extends Ut{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const r=$t(e);return IA(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}l4.className="LeakyReLU";Ve(l4);class u4 extends Ut{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=jn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Kn(e.alphaRegularizer),this.alphaConstraint=Pr(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new ue(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Zt(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)t[s-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new Dr({ndim:e.length,axes:r})],this.built=!0}call(e,t){return e=$t(e),RA(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Jn(this.alphaInitializer),alphaRegularizer:Sn(this.alphaRegularizer),alphaConstraint:_r(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}u4.className="PReLU";Ve(u4);let c4=class extends Ut{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Pt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const r=$t(e);return wv(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};c4.className="ELU";Ve(c4);class f4 extends Ut{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const r=$t(e);return fe(r,it(Vi(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}f4.className="ThresholdedReLU";Ve(f4);class h4 extends Ut{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new DT().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return Ce(()=>{let r=$t(e);const s=t.mask;if(s!=null){const i=fe(Tt(dc(r.shape),it(s,r.dtype)),on(-1e9));r=qe(r,i)}return this.axis instanceof Array?this.axis.length>1?Ka(Tt(r,JM(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}h4.className="Softmax";Ve(h4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ed(n,e,t){if(typeof n=="number")return Yf(n,e);if(n.length!==e)throw new ue(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let r=0;r<e;++r){const s=n[r];if(!PY(s))throw new ue(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${s}`)}return n}function Ko(n,e,t,r,s=1){if(n==null)return n;const i=e+(e-1)*(s-1);let o;return t==="same"?o=n:o=n-i+1,Math.floor((o+r-1)/r)}function Ta(n,e,t,r){if(n==null)return null;if(r==="valid")n=n*e+Yu([t-e,0]);else if(r==="same")n=n*e;else throw new ue(`Unsupport padding mode: ${r}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _T(n,e){return Ce(()=>(gr(e),e==="channelsFirst"?Kt(n,[0,2,3,1]):n))}function d4(n,e){return Ce(()=>(gr(e),e==="channelsFirst"?Kt(n,[0,2,3,4,1]):n))}function iZ(n,e,t,r=1,s="valid",i,o=1){return Ce(()=>{if(i==null&&(i=Qo()),gr(i),n.shape.length!==3)throw new ue(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new ue(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new ue(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(i==="channelsFirst"&&(n=Kt(n,[0,2,1])),s==="causal")throw new Pt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=UM(n,e,r,s==="same"?"same":"valid","NWC",o);return t!=null&&(a=ea(a,t)),a})}function PD(n,e,t,r=[1,1],s="valid",i,o,a=null){return Ce(()=>{if(i==null&&(i=Qo()),gr(i),n.rank!==3&&n.rank!==4)throw new ue(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new ue(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=_T(n,i);if(s==="causal")throw new Pt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=i7({x:l,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:t,activation:a}),i==="channelsFirst"&&(l=Kt(l,[0,3,1,2])),l})}function oZ(n,e,t,r=[1,1,1],s="valid",i,o){return Ce(()=>{if(i==null&&(i=Qo()),gr(i),n.rank!==4&&n.rank!==5)throw new ue(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new ue(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let a=d4(n,i);if(s==="causal")throw new Pt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=r9(a,e,r,s==="same"?"same":"valid","NDHWC",o),t!=null&&(a=ea(a,t)),i==="channelsFirst"&&(a=Kt(a,[0,4,1,2,3])),a})}class $v extends Ut{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",$v.verifyArgs(t),this.rank=e,Wr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Pt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Ed(t.kernelSize,e,"kernelSize"),this.strides=Ed(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,Wi(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,gr(this.dataFormat),this.activation=Zu(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=jn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Pr(t.biasConstraint),this.biasRegularizer=Kn(t.biasRegularizer),this.activityRegularizer=Kn(t.activityRegularizer),this.dilationRate=Ed(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new ue(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new ue(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new ue(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Aa("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!bT(e.kernelSize,"number",1,3))throw new ue(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ju(this.activation),useBias:this.useBias,biasInitializer:Jn(this.biasInitializer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),biasConstraint:_r(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class Jp extends $v{constructor(e,t){super(e,t),this.kernel=null,Jp.verifyArgs(t),this.filters=t.filters,Wr(this.filters,"filters"),this.kernelInitializer=jn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Pr(t.kernelConstraint),this.kernelRegularizer=Kn(t.kernelRegularizer)}build(e){e=Zt(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new ue(`The channel dimension of the input should be defined. Found ${e[t]}`);const r=e[t],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:r}}],this.built=!0}call(e,t){return Ce(()=>{e=$t(e);let r;const s=this.bias==null?null:this.bias.read(),i=uB(this.activation.getClassName());if(i!=null&&this.rank===2)r=PD(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=iZ(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=PD(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=oZ(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Pt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Zt(e);const t=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const o=Ko(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);t.push(o)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(t),s.push(this.filters)):(s.push(this.filters),s=s.concat(t)),s}getConfig(){const e={filters:this.filters,kernelInitializer:Jn(this.kernelInitializer),kernelRegularizer:Sn(this.kernelRegularizer),kernelConstraint:_r(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new ue(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Ey extends Jp{constructor(e){super(2,e),Ey.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!bT(e.kernelSize,"number",1,2))throw new ue(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Ey.className="Conv2D";Ve(Ey);class Ay extends Jp{constructor(e){super(3,e),Ay.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new ue(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Ay.className="Conv3D";Ve(Ay);class p4 extends Ey{constructor(e){if(super(e),this.inputSpec=[new Dr({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new ue(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Zt(e),e.length!==4)throw new ue("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new ue("The channel dimension of the inputs should be defined. Found `None`.");const r=e[t],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Dr({ndim:4,axes:{[t]:r}})],this.built=!0}call(e,t){return Ce(()=>{let r=$t(e);if(r.shape.length!==4)throw new ue(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=s[o],u=s[a],f=this.kernelSize[0],h=this.kernelSize[1],p=this.strides[0],g=this.strides[1],m=Ta(l,p,f,this.padding),w=Ta(u,g,h,this.padding),x=[i,m,w,this.filters];this.dataFormat!=="channelsLast"&&(r=Kt(r,[0,2,3,1]));let b=VM(r,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(b=Kt(b,[0,3,1,2])),this.bias!=null&&(b=ea(b,this.bias.read(),this.dataFormat)),this.activation!=null&&(b=this.activation.apply(b)),b})}computeOutputShape(e){e=Zt(e);const t=e.slice();let r,s,i;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3):(r=3,s=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return t[r]=this.filters,t[s]=Ta(t[s],l,o,this.padding),t[i]=Ta(t[i],u,a,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}p4.className="Conv2DTranspose";Ve(p4);class g4 extends Ay{constructor(e){if(super(e),this.inputSpec=[new Dr({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new ue(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Zt(e),e.length!==5)throw new ue("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new ue("The channel dimension of the inputs should be defined. Found `None`.");const r=e[t],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Dr({ndim:5,axes:{[t]:r}})],this.built=!0}call(e,t){return Ce(()=>{let r=$t(e);if(r.shape.length!==5)throw new ue(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const u=s[l],f=s[o],h=s[a],p=this.kernelSize[0],g=this.kernelSize[1],m=this.kernelSize[2],w=this.strides[0],x=this.strides[1],b=this.strides[2],C=Ta(u,w,p,this.padding),$=Ta(f,x,g,this.padding),k=Ta(h,b,m,this.padding),N=[i,C,$,k,this.filters];this.dataFormat!=="channelsLast"&&(r=Kt(r,[0,2,3,4,1]));let _=o9(r,this.kernel.read(),N,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(_=Kt(_,[0,4,1,2,3])),this.bias!==null&&(_=ea(_,this.bias.read(),this.dataFormat)),this.activation!==null&&(_=this.activation.apply(_)),_})}computeOutputShape(e){e=Zt(e);const t=e.slice();let r,s,i,o;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3,o=4):(r=4,s=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],f=this.strides[0],h=this.strides[1],p=this.strides[2];return t[r]=this.filters,t[s]=Ta(t[s],f,a,this.padding),t[i]=Ta(t[i],h,l,this.padding),t[o]=Ta(t[o],p,u,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}g4.className="Conv3DTranspose";Ve(g4);class m4 extends Jp{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new ue("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new ue("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new ue(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=jn(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Kn(t.depthwiseRegularizer),this.depthwiseConstraint=Pr(t.depthwiseConstraint),this.pointwiseInitializer=jn(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Kn(t.pointwiseRegularizer),this.pointwiseConstraint=Pr(t.pointwiseConstraint)}build(e){if(e=Zt(e),e.length<this.rank+2)throw new ue(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new ue(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const r=e[t],s=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(r*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Dr({ndim:this.rank+2,axes:{[t]:r}})],this.built=!0}call(e,t){return Ce(()=>{e=$t(e);let r;if(this.rank===1)throw new Pt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Kt(e,[0,2,3,1])),r=aL(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=ea(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Kt(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Jn(this.depthwiseInitializer),e.pointwiseInitializer=Jn(this.pointwiseInitializer),e.depthwiseRegularizer=Sn(this.depthwiseRegularizer),e.pointwiseRegularizer=Sn(this.pointwiseRegularizer),e.depthwiseConstraint=_r(this.depthwiseConstraint),e.pointwiseConstraint=_r(this.pointwiseConstraint),e}}m4.className="SeparableConv";class y4 extends m4{constructor(e){super(2,e)}}y4.className="SeparableConv2D";Ve(y4);class Rv extends Jp{constructor(e){super(1,e),Rv.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!bT(e.kernelSize,"number",1,1))throw new ue(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Rv.className="Conv1D";Ve(Rv);class w4 extends Ut{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return Ce(()=>{if(e=$t(e),this.dataFormat==="channelsLast"){const r=Yw(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Yw(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=Yw(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Yw(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}w4.className="Cropping2D";Ve(w4);class x4 extends Ut{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,gr(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,OY(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,r]}else{const t=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],t,r,e[3]]}}call(e,t){return Ce(()=>{let r=$t(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=Kt(r,[0,2,3,1]);const i=this.size[0]*s[2],o=this.size[1]*s[3],a=this.interpolation==="nearest"?Rl.resizeNearestNeighbor(r,[i,o]):Rl.resizeBilinear(r,[i,o]);return Kt(a,[0,3,1,2])}else{const i=this.size[0]*s[1],o=this.size[1]*s[2];return this.interpolation==="nearest"?Rl.resizeNearestNeighbor(r,[i,o]):Rl.resizeBilinear(r,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}x4.className="UpSampling2D";Ve(x4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aZ(n,e,t=[1,1],r="valid",s,i){return Ce(()=>{s==null&&(s=Qo()),gr(s);let o=_T(n,s);if(n.rank!==4)throw new ue(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new ue(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=vA(o,e,t,r==="same"?"same":"valid","NHWC",i),s==="channelsFirst"&&(o=Kt(o,[0,3,1,2])),o})}class b4 extends $v{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=jn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Pr(e.depthwiseConstraint),this.depthwiseRegularizer=Kn(e.depthwiseRegularizer)}build(e){if(e=Zt(e),e.length<4)throw new ue(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new ue(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const r=e[t],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Ce(()=>{e=$t(e);let r=aZ(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=ea(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Zt(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Ko(t,this.kernelSize[0],this.padding,this.strides[0]),o=Ko(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,o]:[e[0],i,o,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Jn(this.depthwiseInitializer),e.depthwiseRegularizer=Sn(this.depthwiseRegularizer),e.depthwiseConstraint=_r(this.depthwiseRegularizer),e}}b4.className="DepthwiseConv2D";Ve(b4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function v4(n,e,t,r){if(Array.isArray(n)){if(e!=null||t!=null)throw new ue("When inputs is an array, neither initialState or constants should be provided");r!=null&&(t=n.slice(n.length-r,n.length),n=n.slice(0,n.length-r)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function s(i){return i==null||Array.isArray(i)?i:[i]}return e=s(e),t=s(t),{inputs:n,initialState:e,constants:t}}function S4(n,e,t,r=!1,s,i,o=!1,a=!1){return Ce(()=>{const l=e.shape.length;if(l<3)throw new ue(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(Xo(2,l));e=Kt(e,u),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=it(it(s,"bool"),"float32"),s.rank===l-1&&(s=js(s,-1)),s=Kt(s,u)),r&&(e=Xf(e,0),s!=null&&(s=Xf(s,0)));const f=[];let h,p=t;const g=e.shape[0],m=Qf(e);let w;s!=null&&(w=Qf(s));for(let b=0;b<g;++b){const C=m[b],$=Ce(()=>n(C,p));if(s==null)h=$[0],p=$[1];else{const k=Ce(()=>{const N=w[b],_=Tt(mo(N),N),U=qe(fe($[0],N),fe(p[0],_)),O=p.map((L,T)=>qe(fe($[1][T],N),fe(L,_)));return{output:U,newStates:O}});h=k.output,p=k.newStates}a&&f.push(h)}let x;return a&&(x=Fl(f,1)),[h,x,p]})}class gc extends Ut{constructor(e){super(e);let t;if(e.cell==null)throw new ue("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new MT({cells:e.cell}):t=e.cell,t.stateSize==null)throw new ue("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Dr({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Xo(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){hE(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const r=t[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const i=[];for(const o of t)i.push([e[0],o]);return[s].concat(i)}else return s}computeMask(e,t){return Ce(()=>{Array.isArray(t)&&(t=t[0]);const r=this.returnSequences?t:null;if(this.returnState){const s=this.states.map(i=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let r=0;r<e;++r)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Pt("Constants support is not implemented in RNN yet.");hE(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Dr({shape:[t,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!an(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new ue(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new Dr({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){Ce(()=>{if(!this.stateful)throw new Ea("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new ue("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Vr([r,s])):this.states_=[Vr([r,this.cell.stateSize])];else if(e==null)Ft(this.states_),this.keptStates!=null&&(Ft(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Vr([r,s])):this.states_[0]=Vr([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ue(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):Ft(this.states_);for(let s=0;s<this.states_.length;++s){const i=e[s],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,a=[r,o];if(!an(i.shape,a))throw new ue(`State ${s} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>Ba(s.clone()))})}apply(e,t){let r=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const i=v4(e,r,s,this.numConstants);e=i.inputs,r=i.initialState,s=i.constants;let o=[],a=[];if(r!=null){t.initialState=r,o=o.concat(r),this.stateSpec=[];for(const u of r)this.stateSpec.push(new Dr({shape:u.shape}));a=a.concat(this.stateSpec)}if(s!=null&&(t.constants=s,o=o.concat(s),this.numConstants=s.length),o[0]instanceof Xa){const u=[e].concat(o),f=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=f;const p=super.apply(u,t);return this.inputSpec=h,p}else return super.apply(e,t)}call(e,t){return Ce(()=>{const r=t==null?null:t.mask,s=t==null?null:t.training;let i=t==null?null:t.initialState;e=$t(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new ue(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:s},u=S4((m,w)=>{const x=this.cell.call([m].concat(w),a);return[x[0],x.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),f=u[0],h=u[1],p=u[2];this.stateful&&this.resetStates(p,s);const g=this.returnSequences?h:f;return this.returnState?[g].concat(p):g})}getInitialState(e){return Ce(()=>{let t=Vr(e.shape);return t=Ct(t,[1,2]),t=vy(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?cE(t,[1,r]):t):this.cell.stateSize>1?[cE(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===gc.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),t)}static fromConfig(e,t,r={}){const s=t.cell,i=Wa(s,r);return new e(Object.assign(t,{cell:i}))}}gc.className="RNN";Ve(gc);class Ov extends Ut{}class PT extends Ov{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Wr(this.units,"units"),this.activation=Zu(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Kn(e.kernelRegularizer),this.recurrentRegularizer=Kn(e.recurrentRegularizer),this.biasRegularizer=Kn(e.biasRegularizer),this.kernelConstraint=Pr(e.kernelConstraint),this.recurrentConstraint=Pr(e.recurrentConstraint),this.biasConstraint=Pr(e.biasConstraint),this.dropout=kp([1,Yu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=kp([1,Yu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Zt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Ce(()=>{if(e=e,e.length!==2)throw new ue(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ec({ones:()=>mo(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ec({ones:()=>mo(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=Va(fe(e,o),this.kernel.read()):i=Va(e,this.kernel.read()),this.bias!=null&&(i=ea(i,this.bias.read())),a!=null&&(r=fe(r,a));let l=qe(i,Va(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Ju(this.activation),useBias:this.useBias,kernelInitializer:Jn(this.kernelInitializer),recurrentInitializer:Jn(this.recurrentInitializer),biasInitializer:Jn(this.biasInitializer),kernelRegularizer:Sn(this.kernelRegularizer),recurrentRegularizer:Sn(this.recurrentRegularizer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),kernelConstraint:_r(this.kernelConstraint),recurrentConstraint:_r(this.recurrentConstraint),biasConstraint:_r(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}PT.className="SimpleRNNCell";Ve(PT);class C4 extends gc{constructor(e){e.cell=new PT(e),super(e)}call(e,t){return Ce(()=>{this.cell.dropoutMask!=null&&(Ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return new e(t)}}C4.className="SimpleRNN";Ve(C4);class FT extends Ov{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new ue("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Wr(this.units,"units"),this.activation=Zu(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Zu(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Kn(e.kernelRegularizer),this.recurrentRegularizer=Kn(e.recurrentRegularizer),this.biasRegularizer=Kn(e.biasRegularizer),this.kernelConstraint=Pr(e.kernelConstraint),this.recurrentConstraint=Pr(e.recurrentConstraint),this.biasConstraint=Pr(e.biasConstraint),this.dropout=kp([1,Yu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=kp([1,Yu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Zt(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Ce(()=>{if(e=e,e.length!==2)throw new ue(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=t.training==null?!1:t.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ec({ones:()=>mo(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ec({ones:()=>mo(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=fe(e,i[0]));let f=Va(e,this.kernel.read());this.useBias&&(f=ea(f,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=fe(s,o[0]));const h=this.recurrentKernel.read(),[p,g]=Li(h,[2*this.units,this.units],h.rank-1),m=Va(s,p),[w,x,b]=Li(f,3,f.rank-1),[C,$]=Li(m,2,m.rank-1);a=this.recurrentActivation.apply(qe(w,C)),l=this.recurrentActivation.apply(qe(x,$));const k=Va(fe(l,s),g);u=this.activation.apply(qe(b,k));const N=qe(fe(a,s),fe(qe(1,hr(a)),u));return[N,N]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Ju(this.activation),recurrentActivation:Ju(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Jn(this.kernelInitializer),recurrentInitializer:Jn(this.recurrentInitializer),biasInitializer:Jn(this.biasInitializer),kernelRegularizer:Sn(this.kernelRegularizer),recurrentRegularizer:Sn(this.recurrentRegularizer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),kernelConstraint:_r(this.kernelConstraint),recurrentConstraint:_r(this.recurrentConstraint),biasConstraint:_r(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}FT.className="GRUCell";Ve(FT);class k4 extends gc{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new FT(e),super(e)}call(e,t){return Ce(()=>{this.cell.dropoutMask!=null&&(Ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}k4.className="GRU";Ve(k4);class Dv extends Ov{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Wr(this.units,"units"),this.activation=Zu(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Zu(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Kn(e.kernelRegularizer),this.recurrentRegularizer=Kn(e.recurrentRegularizer),this.biasRegularizer=Kn(e.biasRegularizer),this.kernelConstraint=Pr(e.kernelConstraint),this.recurrentConstraint=Pr(e.recurrentConstraint),this.biasConstraint=Pr(e.biasConstraint),this.dropout=kp([1,Yu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=kp([1,Yu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=Zt(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;s=new(t=class extends xo{apply(l,u){const f=i.apply([o]),h=new ST().apply([o]),p=i.apply([o*2]);return wD(wD(f,h),p)}},t.className="CustomInit",t)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return Ce(()=>{const r=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new ue(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ec({ones:()=>mo(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ec({ones:()=>mo(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,f,h;0<this.dropout&&this.dropout<1&&(e=fe(e,o[0]));let p=Va(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=fe(s,a[0])),p=qe(p,Va(s,this.recurrentKernel.read())),this.useBias&&(p=ea(p,this.bias.read()));const[g,m,w,x]=Li(p,4,p.rank-1);l=this.recurrentActivation.apply(g),u=this.recurrentActivation.apply(m),f=qe(fe(u,i),fe(l,this.activation.apply(w))),h=this.recurrentActivation.apply(x);const b=fe(h,this.activation.apply(f));return[b,b,f]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Ju(this.activation),recurrentActivation:Ju(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Jn(this.kernelInitializer),recurrentInitializer:Jn(this.recurrentInitializer),biasInitializer:Jn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Sn(this.kernelRegularizer),recurrentRegularizer:Sn(this.recurrentRegularizer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),kernelConstraint:_r(this.kernelConstraint),recurrentConstraint:_r(this.recurrentConstraint),biasConstraint:_r(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}Dv.className="LSTMCell";Ve(Dv);class I4 extends gc{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Dv(e),super(e)}call(e,t){return Ce(()=>{this.cell.dropoutMask!=null&&(Ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}I4.className="LSTM";Ve(I4);class MT extends Ov{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return Ce(()=>{e=e;let r=e.slice(1);const s=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?s.push(r.splice(0,a.stateSize.length)):s.push(r.splice(0,1));s.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=s[a],a===0?o=[e[0]].concat(r):o=[o[0]].concat(r),o=l.call(o,t),i.push(o.slice(1))}r=[];for(const a of i.slice().reverse())r.push(...a);return[o[0]].concat(r)})}build(e){hE(e)&&(e=e[0]),e=e;let t;this.cells.forEach((r,s)=>{Rf(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?t=r.stateSize[0]:t=r.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,t,r={}){const s=[];for(const i of t.cells)s.push(Wa(i,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const r of this.cells)t.push(...r.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return dE(e)}setWeights(e){const t=[];for(const r of this.cells){const s=r.weights.length,i=e.splice(s);for(let o=0;o<r.weights.length;++o)t.push([r.weights[o],i[o]])}NT(t)}}MT.className="StackedRNNCells";Ve(MT);function ec(n){const{ones:e,rate:t,training:r=!1,count:s=1,dropoutFunc:i}=n,o=()=>i!=null?i(e(),t):mB(e(),t),a=()=>Cy(o,e,r);return!s||s<=1?Ba(a().clone()):Array(s).fill(void 0).map(a).map(u=>Ba(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var lZ=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class E4 extends gc{constructor(e){if(e.unroll)throw new Pt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Pt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Dr({ndim:5})]}call(e,t){return Ce(()=>{if(this.cell.dropoutMask!=null&&(Ft(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ft(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new ue("ConvRNN2D cell does not support constants");const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return Ce(()=>{const{stateSize:t}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)],o=Vr(i);return Array.isArray(t)?Array(t.length).fill(o):[o]})}resetStates(e,t=!1){Ce(()=>{if(!this.stateful)throw new Ea("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)];if(r[0]==null)throw new ue("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Vr(i)):this.states_=[Vr(i)];else if(e==null)Ft(this.states_),this.keptStates!=null&&(Ft(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Vr(i)):this.states_[0]=Vr(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ue(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):Ft(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=i;if(!an(l.shape,u))throw new ue(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Ba(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:r,kernelSize:s,padding:i,strides:o,dilationRate:a}=this.cell,l=t==="channelsFirst",u=e[l?3:2],f=e[l?4:3],h=Ko(u,s[0],i,o[0],a[0]),p=Ko(f,s[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[r,h,p]:[h,p,r]]}}E4.className="ConvRNN2D";class LT extends Dv{constructor(e){const{filters:t,kernelSize:r,strides:s,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,Wr(this.filters,"filters"),this.kernelSize=Ed(r,2,"kernelSize"),this.kernelSize.forEach(l=>Wr(l,"kernelSize")),this.strides=Ed(s||1,2,"strides"),this.strides.forEach(l=>Wr(l,"strides")),this.padding=i||"valid",Wi(this.padding),this.dataFormat=o||"channelsLast",gr(this.dataFormat),this.dilationRate=Ed(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Wr(l,"dilationRate"))}build(e){var t;e=Zt(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new ue(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],i=4,o=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,f=this.filters;l=new(t=class extends xo{apply(p,g){const m=u.apply([f]),w=dc([f]),x=u.apply([f*2]);return vT([m,w,x])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return Ce(()=>{if(e.length!==3)throw new ue(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=t.training||!1,s=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ec({ones:()=>mo(s),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(E,R,H)=>!R||!R[H]?E:fe(R[H],E);let f=u(s,l,0),h=u(s,l,1),p=u(s,l,2),g=u(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ec({ones:()=>mo(i),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const m=this.recurrentDropoutMask;let w=u(i,m,0),x=u(i,m,1),b=u(i,m,2),C=u(i,m,3);const $=3,[k,N,_,U]=Li(this.kernel.read(),a,$),[O,L,T,I]=this.useBias?Li(this.bias.read(),a):[null,null,null,null];f=this.inputConv(f,k,O,this.padding),h=this.inputConv(h,N,L,this.padding),p=this.inputConv(p,_,T,this.padding),g=this.inputConv(g,U,I,this.padding);const[v,A,M,D]=Li(this.recurrentKernel.read(),a,$);w=this.recurrentConv(w,v),x=this.recurrentConv(x,A),b=this.recurrentConv(b,M),C=this.recurrentConv(C,D);const B=this.recurrentActivation.apply(qe(f,w)),j=this.recurrentActivation.apply(qe(h,x)),W=qe(fe(j,o),fe(B,this.activation.apply(qe(p,b)))),P=fe(this.recurrentActivation.apply(qe(g,C)),this.activation.apply(W));return[P,P,W]})}getConfig(){const e=super.getConfig(),t=lZ(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),r)}inputConv(e,t,r,s){const i=Kf(e,t,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?ea(i,r,this.dataFormat):i}recurrentConv(e,t){return Kf(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}LT.className="ConvLSTM2DCell";Ve(LT);class A4 extends E4{constructor(e){const t=new LT(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}A4.className="ConvLSTM2D";Ve(A4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class BT extends Ut{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?t[s]:this.noiseShape[s]);return r}call(e,t){return Ce(()=>{this.invokeCallHook(e,t);const r=$t(e);if(0<this.rate&&this.rate<1){const s=t.training==null?!1:t.training,i=this.getNoiseShape(r);return Cy(()=>mB(r,this.rate,i,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}BT.className="Dropout";Ve(BT);class T4 extends BT{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}T4.className="SpatialDropout1D";Ve(T4);class zT extends Ut{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Wr(this.units,"units"),this.activation=Zu(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=jn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=jn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Pr(e.kernelConstraint),this.biasConstraint=Pr(e.biasConstraint),this.kernelRegularizer=Kn(e.kernelRegularizer),this.biasRegularizer=Kn(e.biasRegularizer),this.activityRegularizer=Kn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Zt(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=Zt(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return Ce(()=>{this.invokeCallHook(e,t);const r=$t(e),s=uB(this.activation.getClassName());let i;return s!=null?i=Va(r,this.kernel.read(),s,this.bias?this.bias.read():null):(i=Va(r,this.kernel.read()),this.bias!=null&&(i=ea(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:Ju(this.activation),useBias:this.useBias,kernelInitializer:Jn(this.kernelInitializer),biasInitializer:Jn(this.biasInitializer),kernelRegularizer:Sn(this.kernelRegularizer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),kernelConstraint:_r(this.kernelConstraint),biasConstraint:_r(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}zT.className="Dense";Ve(zT);class UT extends Ut{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Zt(e);for(const t of e.slice(1))if(t==null)throw new ue(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],qu(e,1)]}call(e,t){return Ce(()=>{this.invokeCallHook(e,t);let r=$t(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let i=2;i<r.rank;++i)s.push(i);s.push(1),r=Kt(r,s)}return LY(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}UT.className="Flatten";Ve(UT);class N4 extends Ut{constructor(e){super(e),this.supportsMasking=!0,this.activation=Zu(e.activation)}call(e,t){return Ce(()=>{this.invokeCallHook(e,t);const r=$t(e);return this.activation.apply(r)})}getConfig(){const e={activation:Ju(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}N4.className="Activation";Ve(N4);class $4 extends Ut{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return Ce(()=>(e=$t(e),FY(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}$4.className="RepeatVector";Ve($4);class R4 extends Ut{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const r="Total size of new array must be unchanged.",s=t.slice();let i=1,o=null;for(let l=0;l<s.length;++l){const u=s[l];if(this.isUnknown(u))if(o===null)o=l;else throw new ue("Can only specifiy one unknown dimension.");else i*=u}const a=qu(e);if(o!==null){if(i===0||a%i!==0)throw new ue(r);s[o]=a/i}else if(a!==i)throw new ue(r);return s}computeOutputShape(e){let t=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return Ce(()=>{this.invokeCallHook(e,t);const r=$t(e),s=r.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return ye(r,i)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}R4.className="Reshape";Ve(R4);class O4 extends Ut{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=Xo(1,e.dims.length+1);if(!an(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Dr({ndim:this.dims.length+1})]}computeOutputShape(e){e=Zt(e);const t=e.slice();return this.dims.forEach((r,s)=>{t[s+1]=e[r]}),t}call(e,t){return Kt($t(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}O4.className="Permute";Ve(O4);class D4 extends Ut{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const r=$t(e);return rE(d1(r,this.maskValue),-1)}call(e,t){return Ce(()=>{this.invokeCallHook(e,t);const r=$t(e),o=rE(d1(r,this.maskValue),-1,!0);return fe(r,it(o,r.dtype))})}}D4.className="Masking";Ve(D4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class VT extends Ut{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(pn(e.inputLength))}this.inputDim=e.inputDim,Wr(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Wr(this.outputDim,"outputDim"),this.embeddingsInitializer=jn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Kn(e.embeddingsRegularizer),this.activityRegularizer=Kn(e.activityRegularizer),this.embeddingsConstraint=Pr(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return Ce(()=>this.maskZero?(e=$t(e),d1(e,qt(e))):null)}computeOutputShape(e){if(e=Zt(e),this.inputLength==null)return[...e,this.outputDim];const t=pn(this.inputLength);if(t.length!==e.length-1)throw new ue(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<t.length;++s){const i=t[s],o=e[s+1];if(i!=null&&o!=null&&i!==o)throw new ue(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(t[r]=o),r++}}return[e[0],...t,this.outputDim]}call(e,t){return Ce(()=>{this.invokeCallHook(e,t);let r=$t(e);r.dtype!=="int32"&&(r=Ua(r,"int32"));const s=gB(this.embeddings.read(),ye(r,[r.size]));return ye(s,Zt(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Jn(this.embeddingsInitializer),embeddingsRegularizer:Sn(this.embeddingsRegularizer),activityRegularizer:Sn(this.activityRegularizer),embeddingsConstraint:_r(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}VT.className="Embedding";Ve(VT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gh extends Ut{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Pt}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const r=e.slice(0,e.length-t.length);for(let s=0;s<t.length;++s){const i=e[e.length-t.length+s],o=t[s];if(i==null||o==null||i<0||o<0)r.push(null);else if(i===1)r.push(o);else if(o===1)r.push(i);else{if(i!==o)throw new ue("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Zt(e)]),e=e,e.length<2)throw new ue(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const i of e)i!=null&&i[0]!==null&&t.push(i[0]);if(t=Ku(t),t.length>1)throw new ue(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const s=e.map(i=>i.length);e.indexOf(null)===-1&&Ku(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return Ce(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(i=>i.rank);if(s.indexOf(null)===-1){const i=Yu(s);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=vy(o,1);r.push(o)}return this.mergeFunction(r)}else{let i=!1;for(const l of e){const u=l.rank;if(u==null){const f=l.shape,h=f[0],p=f.slice(1).concat([h]);let g=ye(l,[h].concat(qu(f.slice(1))));g=Kt(g,[1,0]),g=ye(g,p),r.push(g),i=!0}else if(u>1){const f=Xo(1,u).concat([0]);r.push(Kt(l,f)),i=!0}else r.push(l)}let o=this.mergeFunction(r);const a=o.rank;if(i){if(a==null){const l=o.shape,u=l.length,f=l[u-1],h=[f].concat(l.slice(0,l.length-1));o=ye(Kt(ye(o,[-1,f]),[1,0]),h)}else if(a>1){const l=[a-1].concat(Xo(0,a-1));o=Kt(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);t=this.computeElementwiseOpOutputShape(t,i)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=Ku(r),r.length===1?t=r.concat(t):t=[null].concat(t),t}computeMask(e,t){return Ce(()=>{if(t==null)return null;if(!Array.isArray(t))throw new ue("`mask` should be an Array");if(!Array.isArray(e))throw new ue("`inputs` should be an Array");if(t.length!==e.length)throw new ue(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(s=>s==null))return null;t=t.map(s=>s==null?s:js(s,0));let r=t[0];for(let s=1;s<t.length-1;++s)r=Pl(r,t[s]);return r})}}class _4 extends gh{constructor(e){super(e)}mergeFunction(e){return Ce(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=qe(t,e[r]);return t})}}_4.className="Add";Ve(_4);class P4 extends gh{constructor(e){super(e)}mergeFunction(e){return Ce(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=fe(t,e[r]);return t})}}P4.className="Multiply";Ve(P4);class F4 extends gh{constructor(e){super(e)}mergeFunction(e){return Ce(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=qe(t,e[r]);return fe(1/e.length,t)})}}F4.className="Average";Ve(F4);class M4 extends gh{constructor(e){super(e)}mergeFunction(e){return Ce(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=hc(t,e[r]);return t})}}M4.className="Maximum";Ve(M4);class L4 extends gh{constructor(e){super(e)}mergeFunction(e){return Ce(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=_m(t,e[r]);return t})}}L4.className="Minimum";Ve(L4);class B4 extends gh{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new ue("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const s of e)if(s!=null){t=!1;break}if(t)return;const r=[];for(let s=0;s<e.length;++s){const i=e[s].slice();i.splice(this.axis,1);let o=!1;for(const a of r)if(an(a,i)){o=!0;break}o||r.push(i)}if(r.length>1)throw new ue("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Ce(()=>vT(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new ue("A `Concatenate` layer should be called on a list of inputs.");const t=e,r=t[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const i of t.slice(1)){if(r[s]==null||i[s]==null){r[s]=null;break}r[s]+=i[s]}return r}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new ue("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new ue("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new ue(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return Ce(()=>{let r=!0;if(t.forEach(o=>{if(o!=null){r=!1;return}}),r)return null;const s=[];for(let o=0;o<e.length;++o)t[o]==null?s.push(it(mo(e[o]),"bool")):t[o].rank<e[o].rank?s.push(js(t[o],-1)):s.push(t[o]);const i=Zs(s,this.axis);return zM(i,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}B4.className="Concatenate";Ve(B4);function Xg(n,e){for(;n<0;)n+=e;return n}function uZ(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new Pt("batchDot is not implemented for tensors of 4D or higher rank yet");if(ee(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),ee(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new Pt("batchDot is not implemented for complex64-type Tensors yet.");const r=n.shape.length,s=e.shape.length;t==null&&(t=[r-1,s-2]);const i=t;return Ce(()=>{let o;if(r>s){o=r-s;const l=[];for(let u=0;u<o;++u)l.push(1);e=ye(e,e.shape.concat(l))}else if(s>r){o=s-r;const l=[];for(let u=0;u<o;++u)l.push(1);n=ye(n,n.shape.concat(l))}else o=0;let a;if(n.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Ct(fe(n,e),i[0]):a=Ct(fe(Kt(n,[1,0]),e),i[1]);else{const l=i[0]!==n.shape.length-1,u=i[1]===e.shape.length-1;a=sn(n,e,l,u)}if(o>0){let l;r>s?l=r+s-3:l=r-1;const u=[];for(let f=l;f<l+o;++f)u.push(f);a=gy(a,u)}return a.shape.length===1&&(a=js(a,1)),a})}class z4 extends gh{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){ee(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],r=e[1];if(t.length>3||r.length>3)throw new Pt("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,r);if(t[s[0]]!==r[s[1]])throw new ue(`Dimension incompatibility: ${t[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new ue(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,o)=>Xg(i,e[o].shape.length)):s=[Xg(this.axes,t.shape.length),Xg(this.axes,r.shape.length)],this.normalize&&(t=b1(t,s[0]),r=b1(r,s[1])),uZ(t,r,s)}interpretAxes(e,t){let r;return Array.isArray(this.axes)?r=this.axes:r=[Xg(this.axes,e.length),Xg(this.axes,t.length)],r}computeOutputShape(e){ee(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),r=e[1].slice();if(t.length>3||r.length>3)throw new Pt("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,r);t.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const i=t.concat(r);return i.length===1&&i.push(1),i}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}z4.className="Dot";Ve(z4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class U4 extends Ut{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return Ce(()=>{this.invokeCallHook(e,t);const r=$t(e);return Cy(()=>qe(Ev(r.shape,0,this.stddev),r),()=>r,t.training||!1)})}}U4.className="GaussianNoise";Ve(U4);class V4 extends Ut{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return Ce(()=>{this.invokeCallHook(e,t);const r=$t(e);return this.rate>0&&this.rate<1?Cy(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return fe(r,Ev(r.shape,1,i))},()=>r,t.training||!1):r})}}V4.className="GaussianDropout";Ve(V4);class W4 extends Ut{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||$t(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return Ce(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return Cy(()=>{const i=$t(e),a=-1.6732632423543772*1.0507009873554805;let l=fh(py(r),this.rate);l=Ua(l,"float32");const u=((1-this.rate)*(1+this.rate*a**2))**-.5,f=-u*a*this.rate,h=qe(fe(i,l),fe(qe(l,-1),a));return qe(fe(h,u),f)},()=>$t(e),t.training||!1)}return e})}}W4.className="AlphaDropout";Ve(W4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lm(n,e,t,r,s,i=.001){let o;if(n.rank===2)o=Dj(n,e,t,r,s,i);else if(n.rank===3)o=Pj(n,e,t,r,s,i);else if(n.rank===4)o=Mj(n,e,t,r,s,i);else throw new Pt(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return o}function cZ(n,e,t,r,s=.001){return Ce(()=>{const i=TA(n,r),o=i.mean,a=i.variance;return[Lm(n,o,a,t,e,s),o,a]})}function fZ(n,e,t,r,s=.001){return Ce(()=>{const i=TA(n,r),o=i.mean,a=i.variance,l=[];for(const m of Xo(0,n.rank))r.indexOf(m)!==-1?l.push(1):l.push(n.shape[m]);const u=ye(o,l),f=ye(a,l),h=e==null?null:ye(e,l),p=t==null?null:ye(t,l);return[Lm(n,u,f,p,h,s),o,a]})}function hZ(n,e,t,r,s=.001){return an(r.slice().sort(),Xo(0,n.rank-1))?cZ(n,e,t,r,s):fZ(n,e,t,r,s)}class G4 extends Ut{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=jn(e.betaInitializer||"zeros"),this.gammaInitializer=jn(e.gammaInitializer||"ones"),this.movingMeanInitializer=jn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=jn(e.movingVarianceInitializer||"ones"),this.betaConstraint=Pr(e.betaConstraint),this.gammaConstraint=Pr(e.gammaConstraint),this.betaRegularizer=Kn(e.betaRegularizer),this.gammaRegularizer=Kn(e.gammaRegularizer)}build(e){e=Zt(e);const t=this.axis>=0?this.axis:this.axis+e.length,r=e[t];if(r==null)throw new ue(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Dr({ndim:e.length,axes:{[t]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return Ce(()=>{const r=t.training==null?!1:t.training,s=$t(e),i=s.shape,o=i.length,a=Xo(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const u=Yf(1,o);u[l]=i[l];const f=a.slice();f.sort();const h=!an(f,Xo(0,o).slice(0,o-1)),p=()=>{if(h){const C=ye(this.movingMean.read(),u),$=ye(this.movingVariance.read(),u),k=this.center?ye(this.beta.read(),u):null,N=this.scale?ye(this.gamma.read(),u):null;return Lm(s,C,$,k,N,this.epsilon)}else return Lm(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return p();const[g,m,w]=hZ(s,this.gamma.read(),this.beta.read(),a,this.epsilon),x=(C,$,k)=>{Ce(()=>{const N=1-k,_=C.read(),U=fe(Tt(_,$),N);C.write(Tt(_,U))})};return(()=>{x(this.movingMean,m,this.momentum),x(this.movingVariance,w,this.momentum)})(),g})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Jn(this.betaInitializer),gammaInitializer:Jn(this.gammaInitializer),movingMeanInitializer:Jn(this.movingMeanInitializer),movingVarianceInitializer:Jn(this.movingVarianceInitializer),betaRegularizer:Sn(this.betaRegularizer),gammaRegularizer:Sn(this.gammaRegularizer),betaConstraint:_r(this.betaConstraint),gammaConstraint:_r(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}G4.className="BatchNormalization";Ve(G4);class H4 extends Ut{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=jn(e.betaInitializer||"zeros"),this.gammaInitializer=jn(e.gammaInitializer||"ones"),this.betaRegularizer=Kn(e.betaRegularizer),this.gammaRegularizer=Kn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Zt(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=t);for(const i of this.axis)if(i<0||i>=t)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Ku(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,t){const r=$t(e),s=r.shape,i=s.length;return Ce(()=>{let{mean:a,variance:l}=TA(r,this.axis,!0);const u=Yf(1,i);for(const w of this.axis)u[w]=s[w];const f=w=>w!=null&&w.shape.length!==i?ye(w,u):w;let h=this.scale?f(this.gamma.read()):null,p=this.center?f(this.beta.read()):null;const g=[],m=[];for(let w=0;w<i;++w)this.axis.indexOf(w)!==-1?(g.push(s[w]),m.push(1)):(g.push(1),m.push(s[w]));return a=Go(a,g),l=Go(l,g),h!=null&&(h=Go(h,m)),p!=null&&(p=Go(p,m)),Lm(r,a,l,p,h,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Jn(this.betaInitializer),gammaInitializer:Jn(this.gammaInitializer),betaRegularizer:Sn(this.betaRegularizer),gammaRegularizer:Sn(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}H4.className="LayerNormalization";Ve(H4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dZ(n,e,t){return Ce(()=>{if(n.rank!==4)throw new ue(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new ue("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=Qo()),t!=="channelsLast"&&t!=="channelsFirst")throw new ue(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return t==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],NA(n,r)})}class j4 extends Ut{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Qo():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new ue(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,r;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new ue(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new ue(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[t,r]}this.inputSpec=[new Dr({ndim:4})]}computeOutputShape(e){e=Zt(e);let t,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],t,r]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],t,r,e[3]])}call(e,t){return Ce(()=>dZ($t(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}j4.className="ZeroPadding2D";Ve(j4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _v(n,e,t,r,s,i){return Ce(()=>{gr(s),fB(i),Wi(r),t==null&&(t=[1,1]),r==null&&(r="valid"),s==null&&(s=Qo()),i==null&&(i="max"),n=_T(n,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=AA(n,e,t,a):o=yA(n,e,t,a),s==="channelsFirst"&&(o=Kt(o,[0,3,1,2])),o})}function K4(n,e,t,r,s,i){return Ce(()=>{gr(s),fB(i),Wi(r),t==null&&(t=[1,1,1]),r==null&&(r="valid"),s==null&&(s=Qo()),i==null&&(i="max"),n=d4(n,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=vK(n,e,t,a):o=Cj(n,e,t,a),s==="channelsFirst"&&(o=Kt(o,[0,4,1,2,3])),o})}class q4 extends Ut{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new ue(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Wr(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new ue(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Wr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Wi(this.padding),this.inputSpec=[new Dr({ndim:3})]}computeOutputShape(e){e=Zt(e);const t=Ko(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return Ce(()=>{this.invokeCallHook(e,t),e=vy($t(e),2);const r=this.poolingFunction($t(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return gy(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class X4 extends q4{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return gr(i),Wi(s),_v(e,t,r,s,i,"max")}}X4.className="MaxPooling1D";Ve(X4);class Q4 extends q4{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return gr(i),Wi(s),_v(e,t,r,s,i,"avg")}}Q4.className="AveragePooling1D";Ve(Q4);class Y4 extends Ut{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new ue(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Wr(this.poolSize,"poolSize"),Wr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,gr(this.dataFormat),Wi(this.padding),this.inputSpec=[new Dr({ndim:4})]}computeOutputShape(e){e=Zt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Ko(t,this.poolSize[0],this.padding,this.strides[0]),r=Ko(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r]:[e[0],t,r,e[3]]}call(e,t){return Ce(()=>(this.invokeCallHook(e,t),this.poolingFunction($t(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class J4 extends Y4{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return gr(i),Wi(s),_v(e,t,r,s,i,"max")}}J4.className="MaxPooling2D";Ve(J4);class Z4 extends Y4{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return gr(i),Wi(s),_v(e,t,r,s,i,"avg")}}Z4.className="AveragePooling2D";Ve(Z4);class ez extends Ut{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new ue(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Wr(this.poolSize,"poolSize"),Wr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,gr(this.dataFormat),Wi(this.padding),this.inputSpec=[new Dr({ndim:5})]}computeOutputShape(e){e=Zt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Ko(t,this.poolSize[0],this.padding,this.strides[0]),r=Ko(r,this.poolSize[1],this.padding,this.strides[1]),s=Ko(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r,s]:[e[0],t,r,s,e[4]]}call(e,t){return Ce(()=>(this.invokeCallHook(e,t),this.poolingFunction($t(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class tz extends ez{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return gr(i),Wi(s),K4(e,t,r,s,i,"max")}}tz.className="MaxPooling3D";Ve(tz);class nz extends ez{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return gr(i),Wi(s),K4(e,t,r,s,i,"avg")}}nz.className="AveragePooling3D";Ve(nz);class rz extends Ut{constructor(e){super(e),this.inputSpec=[new Dr({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new Pt}}class sz extends rz{constructor(e){super(e||{})}call(e,t){return Ce(()=>{const r=$t(e);return Cr(r,1)})}}sz.className="GlobalAveragePooling1D";Ve(sz);class iz extends rz{constructor(e){super(e||{})}call(e,t){return Ce(()=>{const r=$t(e);return jo(r,1)})}}iz.className="GlobalMaxPooling1D";Ve(iz);class oz extends Ut{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,gr(this.dataFormat),this.inputSpec=[new Dr({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new Pt}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class az extends oz{call(e,t){return Ce(()=>{const r=$t(e);return this.dataFormat==="channelsLast"?Cr(r,[1,2]):Cr(r,[2,3])})}}az.className="GlobalAveragePooling2D";Ve(az);class lz extends oz{call(e,t){return Ce(()=>{const r=$t(e);return this.dataFormat==="channelsLast"?jo(r,[1,2]):jo(r,[2,3])})}}lz.className="GlobalMaxPooling2D";Ve(lz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class uz extends Ut{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,r={}){const s=t.layer,i=Wa(s,r);delete t.layer;const o={layer:i};return Object.assign(o,t),new e(o)}}class cz extends uz{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Zt(e),e.length<3)throw new ue(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Zt(e);const t=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(t),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,t){return Ce(()=>(e=$t(e),S4((o,a)=>[$t(this.layer.call(o,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}cz.className="TimeDistributed";Ve(cz);function pZ(n){ph(RY,"BidirectionalMergeMode",n)}const gZ="concat";class fz extends uz{constructor(e){super(e);const t=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=t,this.forwardLayer=Wa(r),t.goBackwards=t.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=t,this.backwardLayer=Wa(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?gZ:e.mergeMode,pZ(this.mergeMode),e.weights)throw new Pt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,r=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let r,s,i;return this.returnState&&(i=t.slice(1)),r=t[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):Ks(s)}apply(e,t){let r=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const i=v4(e,r,s,this.numConstants);if(e=i.inputs,r=i.initialState,s=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,t);const o=[],a=[];if(r!=null){const u=r.length;if(u%2>0)throw new ue("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push(...r);const f=r.map(h=>new Dr({shape:h.shape}));this.forwardLayer.stateSpec=f.slice(0,u/2),this.backwardLayer.stateSpec=f.slice(u/2),a.push(...f)}if(s!=null)throw new Pt("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof Xa;for(const u of o)if(u instanceof Xa!==l)throw new ue("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(o),f=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=f;const p=super.apply(u,t);return this.inputSpec=h,p}else return super.apply(e,t)}call(e,t){return Ce(()=>{const r=t.initialState;let s,i;if(r==null)s=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{const l=r.slice(0,r.length/2),u=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:u}))}let o;this.returnState&&(Array.isArray(s)&&(o=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=Xf(i,1));let a;return this.mergeMode==="concat"?a=vT([s,i]):this.mergeMode==="sum"?a=qe(s,i):this.mergeMode==="ave"?a=fe(.5,qe(s,i)):this.mergeMode==="mul"?a=fe(s,i):this.mergeMode==null&&(a=[s,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Rf(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Rf(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[t,t]:r=t:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const r=Wa(t.layer);if(delete t.layer,t.numConstants!=null)throw new Pt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=t;return s.layer=r,new e(s)}}fz.className="Bidirectional";Ve(fz);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hz extends Ut{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return Ce(()=>(e=$t(e),e.dtype!=="float32"&&(e=Ua(e,"float32")),qe(fe(e,this.scale),this.offset)))}}hz.className="Rescaling";Ve(hz);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:mZ,cropAndResize:yZ}=Rl;class dz extends Ut{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,r,s,i,o,a,l){return Ce(()=>{let u,f=!1;const h=t/o,p=r/a,g=(s+t)/o,m=(i+r)/a,w=[h,p,g,m],x=[];e.rank===3?(f=!0,u=Fl([e])):u=e;for(let N=0;N<u.shape[0];N++)x.push(w);const b=Nf(x,[x.length,4]),C=Pm(0,x.length,1,"int32"),k=yZ(u,b,C,[s,i],"nearest");return Ua(f?$t(Qf(k)):k,l)})}upsize(e,t,r,s){return Ce(()=>{const i=mZ(e,[t,r]);return Ua(i,s)})}call(e,t){return Ce(()=>{const r=$t(e),s=r.dtype,i=r.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(r,l,u,this.height,this.width,o,a,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Zt(e);const t=e.length-3,r=e.length-2;return e[t]=this.height,e[r]=this.width,e}}dz.className="CenterCrop";Ve(dz);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wZ(n,e,t,r){let s=$t(n);if(s.dtype!=="int32"&&(s=Ua(s,"int32")),e==="int")return s;const i=s.shape;if(s.rank===0&&(s=js(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=js(s,-1)),s.rank>2)throw new ue(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${s.rank}.`);const o=["multiHot","oneHot"].includes(e),a=s;let l;if(typeof r<"u"&&e==="count"?l=KO(a,r,t,o):l=KO(a,[],t,o),e!=="tfIdf")return l;if(r)return fe(l,r);throw new ue("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class pz extends Ut{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=Zt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return Ce(()=>{e=$t(e),e.dtype!=="int32"&&(e=Ua(e,"int32"));let r;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new ue(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);r=$t(t.countWeights)}const s=jo(e),i=f1(e),o=Vi(this.numTokens,s).bufferSync().get(0),a=fh(i,0).bufferSync().get(0);if(!(o&&a))throw new ue(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return wZ(e,this.outputMode,this.numTokens,r)})}}pz.className="CategoryEncoding";Ve(pz);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const xZ=["bilinear","nearest"],FD=new Set(xZ);class gz extends Ut{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(FD.has(e.interpolation))this.interpolation=e.interpolation;else throw new ue(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Zt(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return Ce(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Rl.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Rl.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...FD]} are supported`)})}}gz.className="Resizing";Ve(gz);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class mz{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}mz.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yz extends Ut{constructor(e){super(e),this.randomGenerator=new mz(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}yz.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const bZ=["bilinear","nearest"],MD=new Set(bZ);class wz extends yz{constructor(e){super(e);const{factor:t,interpolation:r="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new ue(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new ue(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new ue(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(MD.has(r))this.interpolation=r;else throw new ue(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Zt(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return Ce(()=>{const r=$t(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=py([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Rl.resizeBilinear(e,o);case"nearest":return Rl.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...MD]} are supported`)}})}}wz.className="RandomWidth";Ve(wz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vZ(n){return new zT(n)}function SZ(n){return new UT(n)}function CZ(n){return new VT(n)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kZ=Te();kZ.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var LD;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(LD||(LD={}));var BD;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(BD||(BD={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var zD;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(zD||(zD={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dt(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&ee(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IZ=gL;class Pv extends b2{nextDataId(){return Pv.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new z3(this,ma())}write(e,t,r){this.firstUse&&(this.firstUse=!1,Te().get("IS_NODE")&&Pi(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,t,r){let s;if(t==="string"&&r!=null&&r.length>0&&m0(r[0])){const i=r.map(o=>ju(o));s=this.write(i,e,t)}else s=this.write(r,e,t);return{dataId:s,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,r,s,i){this.data.set(e,{values:t,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:r}=this.data.get(e);if(t==="complex64"){const s=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return Ml(s,i)}return A8(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(s=>Qu(s));return Bt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Bt(e.shape,e.dtype,t)}makeOutput(e,t,r){return ma().makeTensorFromTensorInfo(this.makeTensorInfo(t,r,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=Hs();return e(),{kernelMs:Hs()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){dt([e],"where");const t=this.readSync(e.dataId);return IZ(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Pv.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const EZ=n=>{const{x:e}=n.inputs,t=n.backend;dt(e,"abs");let r=new Float32Array(De(e.shape));const s=t.data.get(e.dataId).values;return r=xz(s),t.makeOutput(r,e.shape,e.dtype)},AZ={kernelName:hb,backendName:"cpu",kernelFunc:EZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mr(n){return(e,t,r,s,i)=>{const o=Dt(e,t),a=o.length,l=vt(o),u=De(o),f=hs(i,u),h=e.length,p=t.length,g=vt(e),m=vt(t),w=Sp(e,o),x=Sp(t,o);if(w.length+x.length===0)for(let b=0;b<f.length;++b)f[b]=n(r[b%r.length],s[b%s.length]);else for(let b=0;b<f.length;++b){const C=jp(b,a,l),$=C.slice(-h);w.forEach(U=>$[U]=0);const k=La($,h,g),N=C.slice(-p);x.forEach(U=>N[U]=0);const _=La(N,p,m);f[b]=n(r[k],s[_])}return[f,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mi(n){const{inputs:e,backend:t}=n,{real:r,imag:s}=e,i=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,a=t.makeTensorInfo(r.shape,"complex64"),l=t.data.get(a.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(r.shape,"float32",i),imag:t.makeTensorInfo(s.shape,"float32",o)},a}const TZ={kernelName:D2,backendName:"cpu",kernelFunc:mi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E1(n,e,t="float32"){if(t==="complex64"){const s=E1(n,e,"float32"),i=E1(n,e,"float32");return mi({inputs:{real:s,imag:i},backend:n})}const r=ds(De(e),t);return n.makeTensorInfo(e,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qa(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const NZ={kernelName:M0,backendName:"cpu",kernelFunc:Qa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jf(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.data.get(r.dataId).complexTensorInfos.real,i=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,i)}const $Z={kernelName:rA,backendName:"cpu",kernelFunc:Jf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bz(n,e,t,r){if(r==="int32"){const s=Int32Array.from(n);return[e,"int32",s]}if(r==="bool"){const s=ch([0],t),[i,o]=mr((a,l)=>a!==l?1:0)(e,[],n,s,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${t} to ${r}`)}function tc(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return Qa({inputs:{x:s},backend:t});const f=E1(t,s.shape,s.dtype),h=tc({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),p=mi({inputs:{real:h,imag:f},backend:t});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(h),p}if(s.dtype==="complex64"){const f=Jf({inputs:{input:s},backend:t}),h=tc({inputs:{x:f},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(f),h}if(!W3(s.dtype,i)){const f=Qa({inputs:{x:s},backend:t});return{dataId:f.dataId,shape:f.shape,dtype:i}}const o=t.data.get(s.dataId).values,[a,l,u]=bz(o,s.shape,s.dtype,i);return t.makeTensorInfo(a,l,u)}const RZ={kernelName:k0,backendName:"cpu",kernelFunc:tc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mr(n,e,t,r){return t==null?({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;dt([o,a],n);const u=l.data.get(o.dataId).values,f=l.data.get(a.dataId).values,h=o.dtype==="string"?Ll(u):u,p=o.dtype==="string"?Ll(f):f,g=r||o.dtype,[m,w]=e(o.shape,a.shape,h,p,g);return l.makeTensorInfo(w,g,m)}:({inputs:s,backend:i})=>{const{a:o,b:a}=s,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const u=tc({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),f=l.data.get(u.dataId),h=f.complexTensorInfos.real,p=f.complexTensorInfos.imag,g=l.data.get(h.dataId).values,m=l.data.get(p.dataId).values,w=tc({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),x=l.data.get(w.dataId),b=x.complexTensorInfos.real,C=x.complexTensorInfos.imag,$=l.data.get(b.dataId).values,k=l.data.get(C.dataId).values,[N,_,U]=t(o.shape,a.shape,g,m,$,k),O=l.makeTensorInfo(U,"float32",N),L=l.makeTensorInfo(U,"float32",_),T=mi({inputs:{real:O,imag:L},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(w),l.disposeIntermediateTensorInfo(O),l.disposeIntermediateTensorInfo(L),T}else{const u=l.data.get(o.dataId).values,f=l.data.get(a.dataId).values,h=r||o.dtype,[p,g]=e(o.shape,a.shape,u,f,h);return l.makeTensorInfo(g,h,p)}}}function WT(n){return(e,t,r,s,i,o)=>{const a=Dt(e,t),l=De(a),u=a.length,f=vt(a),h=hs("float32",l),p=hs("float32",l),g=Sp(e,a),m=Sp(t,a),w=Ml(r,s),x=Ml(i,o),b=e.length,C=vt(e),$=t.length,k=vt(t);if(g.length+m.length===0)for(let N=0;N<h.length;N++){const _=N%w.length,U=N%x.length,O=n(w[_*2],w[_*2+1],x[U*2],x[U*2+1]);h[N]=O.real,p[N]=O.imag}else for(let N=0;N<h.length;N++){const _=jp(N,u,f),U=_.slice(-b);g.forEach(v=>U[v]=0);const O=La(U,b,C),L=_.slice(-$);m.forEach(v=>L[v]=0);const T=La(L,$,k),I=n(w[O*2],w[O*2+1],x[T*2],x[T*2+1]);h[N]=I.real,p[N]=I.imag}return[h,p,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vz=mr((n,e)=>n+e),OZ=WT((n,e,t,r)=>({real:n+t,imag:e+r})),Ep=Mr(Kp,vz,OZ),DZ={kernelName:Kp,backendName:"cpu",kernelFunc:Ep};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GT(n,e,t,r,s){const i=De(r),o=ds(s,t);for(let a=0;a<n.length;a++){const l=n[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function Sz(n,e,t,r=!1){const s=n.shape[0],i=n.shape[1],o=Bt([s,t],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<i;l++){const u=n.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=t||(r?o.set(1,a,u):e.size>0?o.set(o.get(a,u)+e.get(a,l),a,u):o.set(o.get(a,u)+1,a,u))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cz=mr((n,e)=>n&e),_Z=Mr(O2,Cz),PZ={kernelName:O2,backendName:"cpu",kernelFunc:_Z};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ya(n){return(e,t,r)=>{const s=fr(t,e.length);for(let i=0;i<e.length;++i)s[i]=n(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gn(n,e,t){const r=Ya(e);return mc(n,r,t)}function mc(n,e,t){return({inputs:r,attrs:s,backend:i})=>{const{x:o}=r;dt(o,n);const a=i,l=a.data.get(o.dataId).values;let u;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Ll(l)}else u=l;const f=t||o.dtype,h=e(u,f,s);return a.makeTensorInfo(o.shape,f,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kz=Ya(n=>Math.ceil(n)),FZ=mc(I0,kz),MZ={kernelName:I0,backendName:"cpu",kernelFunc:FZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iz(n,e,t,r){const s=fr(t,De(e));if(r&&t!=="string"){let i=0;n.forEach(o=>{const a=De(o.shape);s.set(o.vals,i),i+=a})}else{let i=0;n.forEach(o=>{const a=t==="string"?Ll(o.vals):o.vals;let l=0;for(let u=0;u<o.shape[0];++u){const f=u*e[1]+i;for(let h=0;h<o.shape[1];++h)s[f+h]=a[l++]}i+=o.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ez=mr((n,e)=>n===e?1:0),Az=Mr(Ab,Ez,null,"bool"),LZ={kernelName:Ab,backendName:"cpu",kernelFunc:Az};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tz=Ya(n=>Math.exp(n)),Nz=mc(O0,Tz,"float32"),BZ={kernelName:O0,backendName:"cpu",kernelFunc:Nz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $z=Ya(n=>Math.expm1(n)),zZ=mc(D0,$z),UZ={kernelName:D0,backendName:"cpu",kernelFunc:zZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rz=Ya(n=>Math.floor(n)),VZ=mc(_0,Rz),WZ={kernelName:_0,backendName:"cpu",kernelFunc:VZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oz=mr((n,e)=>Math.floor(n/e)),GZ=Mr(P0,Oz,null,"int32"),HZ={kernelName:P0,backendName:"cpu",kernelFunc:GZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dz(n,e,t,r,s,i,o,a,l){const u=Bt([r,i],t);for(let f=0;f<r;f++){const h=[];let p=0;for(let g=0;g<s;g++){const m=n[f*s+g];p+=m*o[g],h.push(m)}if(p<0||p>=l/i)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let g=0;g<i;g++)u.values[f*i+g]=e.get(...e.indexToLoc(p*i+g))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _z(n,e,t){const r=Bt(t,n.dtype);for(let s=0;s<r.size;++s){const o=r.indexToLoc(s).slice(),a=o[0],l=o[2],u=e.locToIndex([a,l]);o[2]=e.values[u];const f=n.locToIndex(o);0<=f&&f<n.values.length&&(r.values[s]=n.values[f])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pz=mr((n,e)=>n>e?1:0),jZ=Mr(Rb,Pz,null,"bool"),KZ={kernelName:Rb,backendName:"cpu",kernelFunc:jZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fz=mr((n,e)=>n>=e?1:0),qZ=Mr(F0,Fz,null,"bool"),XZ={kernelName:F0,backendName:"cpu",kernelFunc:qZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mz=mr((n,e)=>n<e?1:0),QZ=Mr(Db,Mz,null,"bool"),YZ={kernelName:Db,backendName:"cpu",kernelFunc:QZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lz=mr((n,e)=>n<=e?1:0),JZ=Mr(_b,Lz,null,"bool"),ZZ={kernelName:_b,backendName:"cpu",kernelFunc:JZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(n,e,t){const r=(e-n)/(t-1),s=ds(t,"float32");s[0]=n;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zz=Ya(n=>Math.log(n)),eee=mc(U0,zz),tee={kernelName:U0,backendName:"cpu",kernelFunc:eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(n,e,t,r){const s=hs(r,De(t));for(let i=0;i<s.length;++i){const o=i*e;let a=n[o];for(let l=0;l<e;++l){const u=n[o+l];(Number.isNaN(u)||u>a)&&(a=u)}s[i]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vz=mr((n,e)=>Math.max(n,e)),nee=Mr(W0,Vz),ree={kernelName:W0,backendName:"cpu",kernelFunc:nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wz=mr((n,e)=>Math.min(n,e)),see=Mr(G0,Wz),iee={kernelName:G0,backendName:"cpu",kernelFunc:see};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HT=mr((n,e)=>n*e),oee=WT((n,e,t,r)=>({real:n*t-e*r,imag:n*r+e*t})),Fv=Mr(j0,HT,oee),aee={kernelName:j0,backendName:"cpu",kernelFunc:Fv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gz(n,e,t){const r=lc(-1,t);return HT([],e,r,n,t)}function lee(n){const{inputs:e,backend:t}=n,{x:r}=e;dt(r,"neg");const s=t.data.get(r.dataId).values,[i,o]=Gz(s,r.shape,r.dtype);return t.makeTensorInfo(o,r.dtype,i)}const uee={kernelName:Hb,backendName:"cpu",kernelFunc:lee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hz=mr((n,e)=>n!==e?1:0),cee=Mr(jb,Hz,null,"bool"),fee={kernelName:jb,backendName:"cpu",kernelFunc:cee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jT(n,e,t,r,s){const i=e.length,o=De(e),a=vt(e),l=vt(s),u=hs(t,De(s));for(let f=0;f<o;++f){const h=jp(f,i,a),p=new Array(h.length);for(let m=0;m<p.length;m++)p[m]=h[r[m]];const g=La(p,i,l);u[g]=n[f]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(n){const{inputs:e,attrs:t,backend:r}=n,{x:s}=e,{perm:i}=t;dt(s,"transpose");const o=s.shape.length,a=new Array(o);for(let h=0;h<a.length;h++)a[h]=s.shape[i[h]];const l=r.data.get(s.dataId).values,u=jT(l,s.shape,s.dtype,i,a);return{dataId:r.write(u,a,s.dtype),shape:a,dtype:s.dtype}}const hee={kernelName:Cd,backendName:"cpu",kernelFunc:ti};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jz(n,e,t,r){const[s,i]=Gr(n,r),o=xi(e,"int32"),a=ds(De(s),o),l=De(i);for(let u=0;u<a.length;++u){const f=u*l;let h=1;for(let p=0;p<l;++p)h*=t[f+p];a[u]=h}return{outVals:a,outShape:s,outDtype:o}}function dee(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;dt(s,"prod");const a=s.shape.length,l=zt(i,s.shape),u=Zn(l,a);let f=l,h=s;const p=[];u!=null&&(h=ti({inputs:{x:s},backend:t,attrs:{perm:u}}),p.push(h),f=pr(f.length,a));const g=t.data.get(h.dataId).values,{outVals:m,outShape:w,outDtype:x}=jz(h.shape,h.dtype,g,f);let b=w;return o&&(b=Ir(w,l)),p.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.makeTensorInfo(b,x,m)}const pee={kernelName:Jb,backendName:"cpu",kernelFunc:dee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gee(n,e,t){n.forEach((r,s)=>{if(r<0||r>=t){const i=jp(s,e.length,vt(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${t})`)}})}function mee(n,e){for(let t=0;t<n.length;++t){const r=n[t],s=t===n.length-1?e:n[t+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function yee(n,e,t,r){const s=[];let i=0;const o=e.length-1+t.length,a=new Array(o).fill(null).map(()=>[0]);mee(t,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const f=e[u+1];for(let h=1;h<l+1;++h)a[u].push(h*f)}for(let u=0;u<n.length;++u){let f=n[u],h=n[u]+1;for(let p=0;p<t.length;++p){const g=t[p],m=p+e.length-1;if(m>=0){const w=a[m],x=w[w.length-1]-g[f];for(let b=f;b<h;++b)a[m].push(g[b+1]+x)}f=g[f],h=g[h]}h!==f&&(s.push([f,h]),i+=h-f)}return{outSplits:a,valueSlices:s,numValues:i}}function wee(n){const e=[];for(let t=0;t<n.length;++t){const r=n[t].length,s=fr("int32",r);e.push(s),n[t].forEach((i,o)=>s[o]=i)}return e}function UD(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let r=e;r<n.length;r++)t[e-1]*=n[r];return t}function xee(n,e,t,r,s,i){const o=UD(e,2)[1],a=UD(i,2)[1];let l=0;for(const u of t)for(let f=u[0];f<u[1];++f){for(let h=0;h<r;++h)s[l*a+h]=n[f*o+h];++l}}function bee(n,e,t,r,s){const i=e.slice();i[0]=s;const o=fr(t,De(i)),a=n.length,l=a===0?0:a/e[0];return xee(n,e,r,l,o,i),[o,i]}function Kz(n,e,t,r,s,i,o,a){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(gee(i,o,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:f,valueSlices:h,numValues:p}=yee(i,o,n,u),g=wee(f),m=bee(t,r,s,h,p);return[g,m[0],m[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VD=2147483647;function qz(n,e,t,r,s,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,u=o.length===0,f=[];a||f.push(e[0]),l||f.push(s[0]),u||f.push(o[0]);for(let x=1;x<f.length;++x)if(f[x]!==f[x-1])throw new Error("starts, limits, and deltas must have the same shape");const h=f.length===0?1:f[0],p=fr("int32",h+1);p[0]=0;for(let x=0;x<h;++x){const b=a?n[0]:n[x],C=l?r[0]:r[x],$=u?i[0]:i[x];if($===0)throw new Error("Requires delta != 0");let k;if($>0&&C<b||$<0&&C>b)k=0;else if(k=Math.ceil(Math.abs((C-b)/$)),k>VD)throw new Error(`Requires ((limit - start) / delta) <= ${VD}`);p[x+1]=p[x]+k}const g=p[h],m=fr(t,g);let w=0;for(let x=0;x<h;++x){const b=p[x+1]-p[x];let C=a?n[0]:n[x];const $=u?i[0]:i[x];for(let k=0;k<b;++k)m[w++]=C,C+=$}return[p,m]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Yi=Vo;class A1{constructor(e,t,r,s,i,o,a,l,u,f){this.shape=e,this.shapeShape=t,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=FL(f),this.raggedRank=ML(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Yi.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Yi.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Yi.VALUE_ROWIDS:return A1.getMaxWidthValueRowID(t);case Yi.ROW_SPLITS:return A1.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Yi[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let r=0;for(let s=0;s<t-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let r=0,s=e[0],i=0;for(let o=1;o<t;++o){const a=e[o];a!==s&&(s=a,i=Math.max(o-r,i),r=o)}return Math.max(t-r,i)}tensorShapeFromTensor(e,t,r=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return GD(e,r)}calculateOutputSize(e){const t=this.valuesShape,r=this.defaultValueShape;LL(r,t);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=PL(this.raggedRank,s,t);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,t,r){const s=Math.min(e,r),i=[];let o=0;for(let a=0;a<s;++a,o+=t)i.push(o);for(let a=s;a<e;++a)i.push(-1);return ee(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,t,r,s){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let u=Math.min(s,l),f=t[a];f===-1&&(u=0);for(let h=0;h<u;++h)o.push(f),f+=r;for(let h=0;h<l-u;++h)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,t,r,s){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let u=t[l];o.push(u);for(let f=1;f<i;++f){const h=e[f];if(h===l)u>=0&&(++a,a<s?u+=r:u=-1);else{if(a=0,l=h,h>=t.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${t.length}`);u=t[h]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,t,r,s){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Yi.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,r,s);case Yi.ROW_SPLITS:if(i.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,r,s);default:throw new Error(`Unsupported partition type: ${Yi[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Yi.FIRST_DIM_SIZE:return e[0];case Yi.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Yi.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Yi[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),r=this.calculateOutputSize(t),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const i=GD(r,!1),o=fr(this.valuesDType,De(i));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(t,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,t,r,s){if(r.length===0)return;const i=this.values,o=r;let a=s.slice();a=a.slice(e+1);const l=De(a),u=t.length;let f=this.defaultValue;if(f.length!==l&&f.length!==1){const m=this.defaultValueShape;Ce(()=>{const w=ye(f,m);f=km(w,a).dataSync()})}let h=0,p=0,g=0;for(let m=0;m<=u;++m){let w=m<u?t[m]:-1;if(w===g){++g;continue}if(p<g){const x=i.subarray(h*l),b=o.subarray(p*l),C=(g-p)*l;WD(b,x,C)}if(m>=u){const x=r.length;w=Math.floor(x/l)}if(w>g)if(this.defaultValue.length===1)o.subarray(g*l,w*l).fill(this.defaultValue[0]),g=w;else for(;w>g;){const x=o.slice(g*l);WD(x,f,l),++g}w<0?(h=m+1,p=g):(h=m,p=g,g=p+1)}}}function WD(n,e,t){for(let r=0;r<t;r++)n[r]=e[r]}function GD(n,e){const t=[];for(let r of n){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}t.push(r)}return t}function Xz(n,e,t,r,s,i,o,a,l,u){return new A1(n,e,t,r,s,i,o,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(n,e,t,r){const s=n===e,i=n<e&&t<0,o=e<n&&t>1;if(s||i||o)return ds(0,r);const a=Math.abs(Math.ceil((e-n)/t)),l=ds(a,r);e<n&&t===1&&(t=-1),l[0]=n;for(let u=1;u<l.length;u++)l[u]=l[u-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yz=Ya(n=>1/Math.sqrt(n)),vee=mc(J0,Yz),See={kernelName:J0,backendName:"cpu",kernelFunc:vee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nf(n,e,t,r,s,i,o,a,l,u){const f=[r/s,s],h=n.values,p=e.values;if(r===0)return Bt(t,e.dtype);const g=l instanceof es?l:Bt(f,e.dtype);typeof l=="string"||typeof l=="number"?g.values.fill(l):typeof l=="boolean"&&g.values.fill(+l);for(let m=0;m<i;m++){const w=[];let x=0;for(let b=0;b<o;b++){const C=h[m*o+b];w.push(C),x+=C*a[b]}if(x<0||x>=r/s)throw new Error(`Invalid indices: ${w} does not index into ${t}`);for(let b=0;b<s;b++)u?g.values[x*s+b]+=p[m*s+b]:g.values[x*s+b]=e.rank===0?p[0]:p[m*s+b]}return g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cee=Ya(n=>1/(1+Math.exp(-n))),Jz=gn(ry,n=>1/(1+Math.exp(-n))),kee={kernelName:ry,backendName:"cpu",kernelFunc:Jz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zz(n,e,t,r,s){const i=QA(r,e,t),o=De(t),a=vt(r);if(i){const h=YA(e,a);return s==="string"?n.slice(h,h+o):n.subarray(h,h+o)}const l=s==="string"?Ll(n):n,u=Bt(r,s,l),f=Bt(t,s);for(let h=0;h<f.size;++h){const p=f.indexToLoc(h),g=p.map((m,w)=>m+e[w]);f.set(u.get(...g),...p)}return s==="string"?sB(f.values):f.values}function Zf(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,size:o}=r;dt(s,"slice");const[a,l]=vv(s,i,o);qA(s,a,l);const u=t.data.get(s.dataId).values,f=Zz(u,a,l,s.shape,s.dtype);return t.makeTensorInfo(l,s.dtype,f)}const Iee={kernelName:sv,backendName:"cpu",kernelFunc:Zf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eU(n,e,t,r,s,i,o){const a=e[0],l=i[0],u=new Array(l),f=new Array(a),h=e[1];if(l===0){if(a!==0)throw new Error(HL(a));const x=fr(t,0),b=fr(s,0);return[x,[0,h],b,u,f]}let p=!0,g=0;const m=new Array(l).fill(0);for(let x=0;x<a;++x){const b=n[x*h];if(b<0)throw new Error(jL(x,b));if(b>=l)throw new Error(KL(x,b,l));++m[b],p=p&&b>=g,g=b}let w=!0;for(let x=0;x<l;++x){const b=m[x]===0;u[x]=b,w=w&&!b,m[x]=Math.max(m[x],1),x>0&&(m[x]+=m[x-1])}if(w&&p){const x=n,b=r;for(let C=0;C<a;++C)f[C]=C;return[x,[a,h],b,u,f]}else{const x=m[l-1],b=fr(t,x*h),C=fr(s,x),$=new Array(l).fill(0);for(let k=0;k<a;++k){const N=n[k*h],_=$[N],U=(N===0?0:m[N-1])+_;$[N]++;for(let O=0;O<h;++O)b[U*h+O]=n[k*h+O];C[U]=r[k],f[k]=U}for(let k=0;k<l;++k)if($[k]===0){const _=k===0?0:m[k-1];b[_*h+0]=k;for(let U=1;U<h;++U)b[_*h+U]=0;C[_]=o}return[b,[x,h],C,u,f]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(n,e,t,r,s){const i=De(r),o=e[0],a=s.length,l=[];let u=1,f=-1;for(let x=0;x<a;++x){const b=s[x];if(b===-1){if(f!==-1)throw new Error(qL(f,x));f=x,l.push(1)}else{if(b<0)throw new Error(XL(x,b));u*=b,l.push(b)}}if(f!==-1){if(u<=0)throw new Error(QL());const x=Math.trunc(i/u);if(u*x!==i)throw new Error(YL(r,l));l[f]=x}if(De(l)!==i)throw new Error(JL(r,l));const p=r.length,g=[];if(p>0){g[p-1]=1;for(let x=p-2;x>=0;--x)g[x]=g[x+1]*r[x+1]}const m=[];if(a>0){m[a-1]=1;for(let x=a-2;x>=0;--x)m[x]=m[x+1]*l[x+1]}const w=fr(t,o*a);for(let x=0;x<o;++x){let b=0;for(let C=0;C<p;++C)b+=n[x*p+C]*g[C];for(let C=0;C<a;++C)w[x*a+C]=Math.trunc(b/m[C]),b%=m[C]}return[w,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KT(n,e,t,r,s,i=!1,o=0){const a=r.length,l=[e[0],n.length/e[0]],u=l[1],h=a>0?s[a-1]+1:0;if(h<0)throw new Error(lE());const p=e.slice();p[0]=h;const g=p.reduce(($,k)=>$*k,1),m=fr(t,g);if(a===0)return h>0&&m.fill(o),[m,p];if(h<=0)throw new Error(lE());let w=0,x=1,b=0,C=s[w];for(;;){let $=0;if(x<a){if($=s[x],C===$){++x;continue}if(C>=$)throw new Error(ZL())}if(C<0||C>=h)throw new Error(eB(C,h));C>b&&m.fill(o,b*u,C*u);for(let k=w;k<x;++k){const N=r[k];if(N<0||N>=l[0])throw new Error(tB(k,r[k],l[0]));for(let _=0;_<u;_++)m[C*u+_]+=n[N*u+_]}if(i)for(let k=0;k<u;k++)m[C*u+k]/=x-w;if(w=x,++x,b=C+1,C=$,x>a)break}return b<h&&m.fill(o,b*u,h*u),[m,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eee=Ya(n=>Math.sqrt(n)),Aee=gn(iy,n=>Math.sqrt(n)),Tee={kernelName:iy,backendName:"cpu",kernelFunc:Aee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nU=mr((n,e)=>{const t=n-e;return t*t}),Nee=Mr(oy,nU),$ee={kernelName:oy,backendName:"cpu",kernelFunc:Nee};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rU=Ya((n,e)=>{const{pattern:t,replaceGlobal:r,rewrite:s}=e;return n.replace(new RegExp(t,r?"g":""),s)}),Ree=mc(aA,rU),Oee={kernelName:aA,backendName:"cpu",kernelFunc:Ree};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sU(n,e,t,r){const s=Bt(n,e.dtype);for(let i=0;i<s.size;i++){const o=s.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*t[l]+r[l];s.set(e.get(...a),...o)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dee{constructor(e,t,r,s,i,o){this.separator=ju(e),this.nGramWidths=t,this.leftPad=ju(r),this.rightPad=ju(s),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,s,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),u=Math.max(0,l-a),f=Math.max(0,l-(i-(a+1))),h=o-(u+f),p=t+(u>0?0:a-l);let g=0;g+=u*this.leftPad.length;for(let C=0;C<h;++C)g+=e[p+C].length;g+=f*this.rightPad.length;const m=u+f+h-1;g+=m*this.separator.length,r[s+a]=new Uint8Array(g);const w=r[s+a];let x=0;const b=C=>C.forEach($=>w[x++]=$);for(let C=0;C<u;++C)b(this.leftPad),b(this.separator);for(let C=0;C<h-1;++C)b(e[p+C]),b(this.separator);if(h>0){b(e[p+h-1]);for(let C=0;C<f;++C)b(this.separator),b(this.rightPad)}else{for(let C=0;C<f-1;++C)b(this.rightPad),b(this.separator);b(this.rightPad)}}}compute(e,t){const r=e.length,s=t.length;if(s>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let f=t[u]>=l;if(f=f&&t[u]<=r,!f)throw new Error(`Invalid split value ${t[u]}, must be in [${l}, ${r}]`);l=t[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=s-1,o=fr("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=i;++u)o[u]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const u=t[l]-t[l-1];let f=0;this.nGramWidths.forEach(h=>{f+=this.getNumNGrams(u,h)}),this.preserveShort&&u>0&&f===0&&(f=1),o[l]=o[l-1]+f}const a=new Array(o[i]);for(let l=0;l<i;++l){const u=t[l];let f=o[l];if(this.nGramWidths.forEach(h=>{const p=t[l+1]-t[l],g=this.getNumNGrams(p,h);this.createNGrams(e,u,a,f,g,h),f+=g}),this.preserveShort&&f===o[l]){const h=t[l+1]-t[l];if(h===0)continue;const p=h+2*this.padWidth;this.createNGrams(e,u,a,f,1,p)}}return[a,o]}}function iU(n,e,t,r,s,i,o,a){return new Dee(t,r,s,i,o,a).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ee(n,e,t,r){if(!n.length)return;if(e.length===0){for(let i=0;i<n.length;++i)r.push(n.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=n.indexOf(i);for(;o!==-1;){const a=n.subarray(0,o);(!t||a.length!==0)&&r.push(a),n=n.subarray(o+1),o=n.indexOf(i)}(!t||n.length!==0)&&r.push(n);return}let s=0;for(let i=0;i<n.length+1;i++)if(i===n.length||e.indexOf(n[i])!==-1){const o=n.subarray(s,i);(!t||o.length!==0)&&r.push(o),s=i+1}}function oU(n,e,t){const r=n.length,s=[];let i=0,o=0;const a=new Array(r);for(let p=0;p<r;++p){const g=s.length;_ee(n[p],e,t,s);const m=s.length-g;a[p]=m,i+=m,o=Math.max(o,m)}const l=fr("int32",i*2),u=new Array(i),f=[r,o];let h=0;for(let p=0;p<r;++p)for(let g=0;g<a[p];++g)l[h*2]=p,l[h*2+1]=g,u[h]=s[h],++h;return[l,u,f]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aU(n,e){const t=fr("int32",n.length);for(let r=0;r<n.length;++r)t[r]=j8(n[r]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lU=mr((n,e)=>n-e),Pee=WT((n,e,t,r)=>({real:n-t,imag:e-r})),qT=Mr(ay,lU,Pee),Fee={kernelName:ay,backendName:"cpu",kernelFunc:qT};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(n,e){const t=new Array(n.rank);for(let s=0;s<t.length;s++)t[s]=n.shape[s]*e[s];const r=Bt(t,n.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),o=new Array(n.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%n.shape[l];const a=n.locToIndex(o);r.values[s]=n.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cm=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function cU(n,e,t=0,r=n.length-1){for(;r>t;){if(r-t>600){const a=r-t+1,l=e-t+1,u=Math.log(a),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(a-f)/a)*Math.sign(l-a/2),p=Math.max(t,Math.floor(e-l*f/a+h)),g=Math.min(r,Math.floor(e+(a-l)*f/a+h));cU(n,e,p,g)}const s=n[e];let i=t,o=r;for(cd(n,t,e),cm(n[r],s)>0&&cd(n,t,r);i<o;){for(cd(n,i,o),i++,o--;cm(n[i],s)<0;)i=i+1;for(;cm(n[o],s)>0;)o=o-1}cm(n[t],s)===0?cd(n,t,o):(o=o+1,cd(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function fU(n,e,t,r,s){const i=e[e.length-1],[o,a]=[n.length/i,i],l=hs(t,o*r),u=hs("int32",o*r);for(let h=0;h<o;h++){const p=h*a,g=n.subarray(p,p+a);let m=new Array(g.length);g.forEach((C,$)=>m[$]={value:C,index:$}),r<m.length&&(cU(m,r),m=m.slice(0,r)),s&&m.sort(cm);const w=h*r,x=l.subarray(w,w+r),b=u.subarray(w,w+r);for(let C=0;C<r;C++)x[C]=m[C].value,b[C]=m[C].index}const f=e.slice();return f[f.length-1]=r,[Bt(f,t,l),Bt(f,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hU(n,e,t,r){const s=zt(e,t)[0],i=[1,t[0],1];for(let m=0;m<s;m++)i[0]*=t[m];i[1]=t[s];for(let m=s+1;m<t.length;m++)i[2]*=t[m];const o=new Map,a=new Int32Array(t[s]),l=new es(i,r,n),u=[],f=i[0]===1&&i[2]===1;for(let m=0;m<t[s];m++){let w;if(f)w=n[m].toString();else{const b=[];for(let C=0;C<i[0];C++)for(let $=0;$<i[2];$++)b.push(l.get(C,m,$));w=b.join(",")}const x=o.get(w);if(x!=null)a[m]=x;else{const b=o.size;o.set(w,b),a[m]=b,u.push(m)}}const h=i.slice();h[1]=o.size;const p=new es(h,r);u.forEach((m,w)=>{for(let x=0;x<i[0];x++)for(let b=0;b<i[2];b++)p.set(l.get(x,m,b),x,w,b)});const g=t.slice();return g[s]=h[1],{outputValues:p.values,outputShape:g,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mee=Object.freeze(Object.defineProperty({__proto__:null,addImpl:vz,bincountImpl:GT,bincountReduceImpl:Sz,bitwiseAndImpl:Cz,castImpl:bz,ceilImpl:kz,concatImpl:Iz,equalImpl:Ez,expImpl:Tz,expm1Impl:$z,floorDivImpl:Oz,floorImpl:Rz,gatherNdImpl:Dz,gatherV2Impl:_z,greaterEqualImpl:Fz,greaterImpl:Pz,lessEqualImpl:Lz,lessImpl:Mz,linSpaceImpl:Bz,logImpl:zz,maxImpl:Uz,maximumImpl:Vz,minimumImpl:Wz,multiplyImpl:HT,negImpl:Gz,notEqualImpl:Hz,prodImpl:jz,raggedGatherImpl:Kz,raggedRangeImpl:qz,raggedTensorToTensorImpl:Xz,rangeImpl:Qz,rsqrtImpl:Yz,scatterImpl:nf,sigmoidImpl:Cee,simpleAbsImpl:xz,sliceImpl:Zz,sparseFillEmptyRowsImpl:eU,sparseReshapeImpl:tU,sparseSegmentReductionImpl:KT,sqrtImpl:Eee,squaredDifferenceImpl:nU,staticRegexReplaceImpl:rU,stridedSliceImpl:sU,stringNGramsImpl:iU,stringSplitImpl:oU,stringToHashBucketFastImpl:aU,subImpl:lU,tileImpl:uU,topKImpl:fU,transposeImpl:jT,uniqueImpl:hU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */OM("cpu",()=>new Pv,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dU=gn($0,n=>n>=0?n:Math.exp(n)-1),Lee={kernelName:$0,backendName:"cpu",kernelFunc:dU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{alpha:i}=r;dt([s],"leakyRelu");const o=De(s.shape),a=t.data.get(s.dataId).values,l=hs("float32",o);for(let u=0;u<a.length;u++)l[u]=a[u]<0?i*a[u]:a[u];return t.makeTensorInfo(s.shape,"float32",l)}const Bee={kernelName:Ob,backendName:"cpu",kernelFunc:pU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zee=mr((n,e)=>n<0?e*n:n);function gU(n){const{inputs:e,backend:t}=n,{x:r,alpha:s}=e;dt([r,s],"prelu");const i=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,[a,l]=zee(r.shape,s.shape,i,o,"float32");return t.makeTensorInfo(l,"float32",a)}const Uee={kernelName:Yb,backendName:"cpu",kernelFunc:gU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mU=gn(X0,n=>Math.max(0,n)),Vee={kernelName:X0,backendName:"cpu",kernelFunc:mU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yU=gn(Q0,n=>Math.min(Math.max(0,n),6)),Wee={kernelName:Q0,backendName:"cpu",kernelFunc:yU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1(n,e,t,r,s){if(t==="linear")return Qa({inputs:{x:e},backend:n});if(t==="relu")return mU({inputs:{x:e},backend:n});if(t==="elu")return dU({inputs:{x:e},backend:n});if(t==="relu6")return yU({inputs:{x:e},backend:n});if(t==="prelu")return gU({inputs:{x:e,alpha:r},backend:n});if(t==="leakyrelu")return pU({inputs:{x:e},backend:n,attrs:{alpha:s}});if(t==="sigmoid")return Jz({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function On(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{shape:i}=r,o=De(s.shape),a=V3(i,o),l=De(a);ee(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),t.incRef(s.dataId);const u=t.data.get(s.dataId);if(u.complexTensorInfos!=null){const f=u.complexTensorInfos.real,h=u.complexTensorInfos.imag;f.shape=a,h.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const Gee={kernelName:Zb,backendName:"cpu",kernelFunc:On};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wU(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;dt([s,i],"matMul");const l=s.shape.length,u=i.shape.length,f=o?s.shape[l-2]:s.shape[l-1],h=a?i.shape[u-1]:i.shape[u-2],p=o?s.shape[l-1]:s.shape[l-2],g=a?i.shape[u-2]:i.shape[u-1],m=s.shape.slice(0,-2),w=i.shape.slice(0,-2),x=De(m),b=De(w),$=Dt(s.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,g]);ee(f===h,()=>`Error in matMul: inner shapes (${f}) and (${h}) of Tensors with shapes ${s.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const k=o?[x,f,p]:[x,p,f],N=a?[b,g,h]:[b,h,g],_=On({inputs:{x:s},backend:t,attrs:{shape:k}}),U=On({inputs:{x:i},backend:t,attrs:{shape:N}}),O=o?_.shape[1]:_.shape[2],L=o?_.shape[2]:_.shape[1],T=a?U.shape[1]:U.shape[2],I=Math.max(x,b),v=t.data.get(_.dataId).values,A=t.data.get(U.dataId).values,M=vt(_.shape),D=vt(U.shape),[B,j,W]=o?[M[0],1,M[1]]:[M[0],M[1],1],[P,E,R]=a?[1,D[1],D[0]]:[D[1],1,D[0]],H=L*T,K=Bt([I,L,T],_.dtype),Q=K.values,J=t.blockSize;for(let ie=0;ie<I;ie++){const ce=ie%x,ge=ie%b;for(let be=0;be<L;be+=J){const Ae=Math.min(be+J,L);for(let ne=0;ne<T;ne+=J){const he=Math.min(ne+J,T);for(let Ie=0;Ie<O;Ie+=J){const ze=Math.min(Ie+J,O);for(let Re=be;Re<Ae;Re++)for(let Ke=ne;Ke<he;Ke++){let tt=0;for(let Xe=Ie;Xe<ze;Xe++){const ot=v[ce*B+Re*j+Xe*W],et=A[Xe*P+Ke*E+ge*R];tt+=ot*et}Q[ie*H+(Re*T+Ke)]+=tt}}}}}return t.disposeIntermediateTensorInfo(_),t.disposeIntermediateTensorInfo(U),t.makeTensorInfo($,K.dtype,K.values)}const Hee={kernelName:yb,backendName:"cpu",kernelFunc:wU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:f,leakyreluAlpha:h}=r;let p,g,m;const w=[];p=wU({inputs:{a:s,b:i},attrs:{transposeA:l,transposeB:u},backend:t}),o&&(g=Ep({inputs:{a:p,b:o},backend:t}),w.push(p),p=g),f&&(m=T1(t,p,f,a,h),w.push(p),p=m);for(const b of w)t.disposeIntermediateTensorInfo(b);return p}const Kee={kernelName:o1,backendName:"cpu",kernelFunc:jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qee=gn(y0,n=>Math.acos(n)),Xee={kernelName:y0,backendName:"cpu",kernelFunc:qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qee=gn(w0,n=>Math.acosh(n)),Yee={kernelName:w0,backendName:"cpu",kernelFunc:Qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(n){const{inputs:e,backend:t}=n,r=e;dt(e,"addN");const s=r.map(a=>t.data.get(a.dataId).values),i=Bt(r[0].shape,r[0].dtype),o=i.values;for(let a=0;a<r.length;a++){const l=s[a];for(let u=0;u<o.length;u++)o[u]+=l[u]}return t.makeTensorInfo(i.shape,i.dtype,i.values)}const Zee={kernelName:E2,backendName:"cpu",kernelFunc:Jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;dt(s,"all");const a=zt(i,s.shape);let l=a;const u=Zn(l,s.shape.length);let f=s;u!=null&&(f=ti({inputs:{x:s},backend:t,attrs:{perm:u}}),l=pr(l.length,s.shape.length)),ns("all",l,f.shape.length);const[h,p]=Gr(f.shape,l),g=De(p),m=ds(De(h),f.dtype),w=t.data.get(f.dataId).values;for(let b=0;b<m.length;++b){const C=b*g;let $=w[C];for(let k=0;k<g;++k){const N=w[C+k];$=$&&N}m[b]=$}u!=null&&t.disposeIntermediateTensorInfo(f);const x=t.makeTensorInfo(h,f.dtype,m);if(o){const b=Ir(h,a),C=On({inputs:{x},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(x),C}return x}const tte={kernelName:A2,backendName:"cpu",kernelFunc:ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;dt(s,"any");const a=zt(i,s.shape);let l=a;const u=Zn(l,s.shape.length);let f=s;u!=null&&(f=ti({inputs:{x:s},backend:t,attrs:{perm:u}}),l=pr(l.length,s.shape.length)),ns("any",l,f.shape.length);const[h,p]=Gr(f.shape,l),g=De(p),m=ds(De(h),f.dtype),w=t.data.get(f.dataId).values;for(let b=0;b<m.length;++b){const C=b*g;let $=w[C];for(let k=0;k<g;++k){const N=w[C+k];$=$||N}m[b]=$}u!=null&&t.disposeIntermediateTensorInfo(f);const x=t.makeTensorInfo(h,f.dtype,m);if(o){const b=Ir(h,a),C=On({inputs:{x},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(x),C}return x}const rte={kernelName:T2,backendName:"cpu",kernelFunc:nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ste(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;dt(s,"argMax");let o=zt(i,s.shape);const a=Zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=ti({inputs:{x:s},backend:t,attrs:{perm:a}}),u.push(l),o=pr(o.length,l.shape.length)),o=[o[0]],ns("argMax",o,l.shape.length);const[f,h]=Gr(l.shape,o),p=De(f),g=ds(p,"int32"),m=De(h),w=t.data.get(l.dataId).values;for(let x=0;x<g.length;++x){const b=x*m;let C=w[b],$=0;for(let k=0;k<m;++k){const N=w[b+k];N>C&&(C=N,$=k)}g[x]=$}return u.forEach(x=>t.disposeIntermediateTensorInfo(x)),t.makeTensorInfo(f,"int32",g)}const ite={kernelName:db,backendName:"cpu",kernelFunc:ste};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;dt(s,"argMin");let o=zt(i,s.shape);const a=Zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=ti({inputs:{x:s},backend:t,attrs:{perm:a}}),u.push(l),o=pr(o.length,l.shape.length)),o=[o[0]],ns("argMin",o,l.shape.length);const[f,h]=Gr(l.shape,o),p=De(f),g=ds(p,"int32"),m=De(h),w=t.data.get(l.dataId).values;for(let x=0;x<g.length;++x){const b=x*m;let C=w[b],$=0;for(let k=0;k<m;++k){const N=w[b+k];N<C&&(C=N,$=k)}g[x]=$}return u.forEach(x=>t.disposeIntermediateTensorInfo(x)),t.makeTensorInfo(f,"int32",g)}const ate={kernelName:pb,backendName:"cpu",kernelFunc:ote};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lte=gn(x0,n=>Math.asin(n)),ute={kernelName:x0,backendName:"cpu",kernelFunc:lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cte=gn(b0,n=>Math.asinh(n)),fte={kernelName:b0,backendName:"cpu",kernelFunc:cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hte=gn(v0,n=>Math.atan(n)),dte={kernelName:v0,backendName:"cpu",kernelFunc:hte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pte=mr((n,e)=>Math.atan2(n,e)),gte=Mr(C0,pte),mte={kernelName:C0,backendName:"cpu",kernelFunc:gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yte=gn(S0,n=>Math.atanh(n)),wte={kernelName:S0,backendName:"cpu",kernelFunc:yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XT(n,e,t,r,s,i){const o=s.strideHeight,a=s.strideWidth,l=s.dilationHeight,u=s.dilationWidth,f=s.effectiveFilterHeight,h=s.effectiveFilterWidth,p=s.padInfo.top,g=s.padInfo.left,m=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=Bt(s.outShape,t),x=w.values,b=s.outShape[1]*s.outShape[2]*s.outShape[3],C=s.outShape[2]*s.outShape[3],$=s.outShape[3];for(let k=0;k<s.batchSize;++k){const N=k*b,_=k*r[0];for(let U=0;U<s.inChannels;++U)for(let O=0;O<s.outHeight;++O){const L=O*o-p,T=Math.max(0,L),I=Math.min(s.inHeight,f+L),v=N+O*C;for(let A=0;A<s.outWidth;++A){const M=A*a-g,D=Math.max(0,M),B=Math.min(s.inWidth,h+M);let j=m,W=0,P=0;for(let R=T;R<I;R+=l){const H=_+R*r[1];for(let K=D;K<B;K+=u){const Q=H+K*r[2],J=n[Q+U];i==="max"&&J>j?j=J:i==="avg"&&(W+=J,P++)}if(isNaN(j))break}const E=v+A*$+U;x[E]=i==="avg"?W/P:j}}}return w}function xU(n,e,t,r,s=!1,i=!1){const o=Bt(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,f=r.dilationWidth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,g=r.padInfo.top,m=r.padInfo.left,w=Bt(e,t,n);for(let x=0;x<r.batchSize;++x)for(let b=0;b<r.inChannels;++b)for(let C=0;C<r.outHeight;++C){const $=C*a-g;let k=$;for(;k<0;)k+=u;const N=Math.min(r.inHeight,h+$);for(let _=0;_<r.outWidth;++_){const U=_*l-m;let O=U;for(;O<0;)O+=f;const L=Math.min(r.inWidth,p+U);let T=Number.NEGATIVE_INFINITY,I=-1;for(let v=k;v<N;v+=u){const A=v-$;for(let M=O;M<L;M+=f){const D=M-U,B=w.get(x,v,M,b);B>T&&(T=B,s?I=i?((x*r.inHeight+v)*r.inWidth+M)*r.inChannels+b:(v*r.inWidth+M)*r.inChannels+b:I=A*p+D)}}o.set(I,x,C,_,b)}}return o}function bU(n,e,t,r,s,i){const o=s.strideDepth,a=s.strideHeight,l=s.strideWidth,u=s.dilationDepth,f=s.dilationHeight,h=s.dilationWidth,p=s.effectiveFilterDepth,g=s.effectiveFilterHeight,m=s.effectiveFilterWidth,w=s.padInfo.front,x=s.padInfo.top,b=s.padInfo.left,C=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,$=Bt(s.outShape,t),k=$.values,N=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],_=s.outShape[2]*s.outShape[3]*s.outShape[4],U=s.outShape[3]*s.outShape[4],O=s.outShape[4];for(let L=0;L<s.batchSize;++L){const T=L*N,I=L*r[0];for(let v=0;v<s.inChannels;++v)for(let A=0;A<s.outDepth;++A){const M=A*o-w;let D=M;for(;D<0;)D+=u;const B=Math.min(s.inDepth,p+M),j=T+A*_;for(let W=0;W<s.outHeight;++W){const P=W*a-x;let E=P;for(;E<0;)E+=f;const R=Math.min(s.inHeight,g+P),H=j+W*U;for(let K=0;K<s.outWidth;++K){const Q=K*l-b;let J=Q;for(;J<0;)J+=h;const ie=Math.min(s.inWidth,m+Q),ce=H+K*O;let ge=C,be=0,Ae=0;for(let he=D;he<B;he+=u){const Ie=I+he*r[1];for(let ze=E;ze<R;ze+=f){const Re=Ie+ze*r[2];for(let Ke=J;Ke<ie;Ke+=h){const tt=Re+Ke*r[3],Xe=n[tt+v];if(i==="max"&&Xe>ge?ge=Xe:i==="avg"&&(be+=Xe,Ae++),isNaN(ge))break}if(isNaN(ge))break}if(isNaN(ge))break}const ne=ce+v;k[ne]=i==="avg"?be/Math.max(Ae,1):ge}}}}return $}function xte(n,e){const t=Bt(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.front,g=e.padInfo.top,m=e.padInfo.left;for(let w=0;w<e.batchSize;++w)for(let x=0;x<e.inChannels;++x)for(let b=0;b<e.outDepth;++b){const C=b*r-p;let $=C;for(;$<0;)$+=o;const k=Math.min(e.inDepth,u+C);for(let N=0;N<e.outHeight;++N){const _=N*s-g;let U=_;for(;U<0;)U+=a;const O=Math.min(e.inHeight,f+_);for(let L=0;L<e.outWidth;++L){const T=L*i-m;let I=T;for(;I<0;)I+=l;const v=Math.min(e.inWidth,h+T);let A=Number.NEGATIVE_INFINITY,M=-1;for(let D=$;D<k;D+=o){const B=D-C;for(let j=U;j<O;j+=a){const W=j-_;for(let P=I;P<v;P+=l){const E=P-T,R=n.get(w,D,j,P,x);R>=A&&(A=R,M=B*f*h+W*f+E)}}}t.set(M,w,b,N,L,x)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;dt(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;ee(gs(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const f=wo(s.shape,i,o,u,a,l);let h;if(f.filterWidth===1&&f.filterHeight===1&&an(f.inShape,f.outShape))h=Qa({inputs:{x:s},backend:t});else{const p=t.data.get(s.dataId).values,g=vt(s.shape),m=XT(p,s.shape,s.dtype,g,f,"avg");h=t.makeTensorInfo(f.outShape,s.dtype,m.values)}return h}const vte={kernelName:gb,backendName:"cpu",kernelFunc:bte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ste(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;dt(s,"avgPool3d");const f=Wl(s.shape,i,o,1,a,l,u),h=t.data.get(s.dataId).values,p=bU(h,s.shape,s.dtype,vt(s.shape),f,"avg");return t.makeTensorInfo(p.shape,"float32",p.values)}const Cte={kernelName:mb,backendName:"cpu",kernelFunc:Ste};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kte(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;dt([s,i],"avgPool3DGrad");const f=Wl(i.shape,o,a,1,l,u),h=f.strideDepth,p=f.strideHeight,g=f.strideWidth,m=f.filterDepth,w=f.filterHeight,x=f.filterWidth,b=f.dilationDepth,C=f.dilationHeight,$=f.dilationWidth,k=f.effectiveFilterDepth,N=f.effectiveFilterHeight,_=f.effectiveFilterWidth,U=k-1-f.padInfo.front,O=_-1-f.padInfo.left,L=N-1-f.padInfo.top,T=Bt(i.shape,"float32"),I=1/(m*w*x),v=t.bufferSync(s);for(let A=0;A<f.batchSize;++A)for(let M=0;M<f.inChannels;++M)for(let D=0;D<f.inDepth;++D)for(let B=0;B<f.inHeight;++B)for(let j=0;j<f.inWidth;++j){const W=D-U,P=B-L,E=j-O;let R=0;for(let H=0;H<k;H+=b){const K=(W+H)/h;if(!(K<0||K>=f.outDepth||Math.floor(K)!==K))for(let Q=0;Q<N;Q+=C){const J=(P+Q)/p;if(!(J<0||J>=f.outHeight||Math.floor(J)!==J))for(let ie=0;ie<_;ie+=$){const ce=(E+ie)/g;if(ce<0||ce>=f.outWidth||Math.floor(ce)!==ce)continue;const ge=v.get(A,K,J,ce,M);R+=ge}}}T.set(R*I,A,D,B,j,M)}return t.makeTensorInfo(T.shape,T.dtype,T.values)}const Ite={kernelName:$2,backendName:"cpu",kernelFunc:kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ete(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,o=i;dt([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,f=wo(o.shape,a,l,1,u),h=f.strideHeight,p=f.strideWidth,g=f.filterHeight,m=f.filterWidth,w=f.dilationHeight,x=f.dilationWidth,b=f.effectiveFilterHeight,C=f.effectiveFilterWidth,$=C-1-f.padInfo.left,k=b-1-f.padInfo.top,N=Bt(o.shape,"float32"),_=1/(g*m),U=t.data.get(s.dataId).values,O=Bt(s.shape,"float32",U);for(let L=0;L<f.batchSize;++L)for(let T=0;T<f.inChannels;++T)for(let I=0;I<f.inHeight;++I)for(let v=0;v<f.inWidth;++v){const A=I-k,M=v-$;let D=0;for(let B=0;B<b;B+=w){const j=(A+B)/h;if(!(j<0||j>=f.outHeight||Math.floor(j)!==j))for(let W=0;W<C;W+=x){const P=(M+W)/p;if(P<0||P>=f.outWidth||Math.floor(P)!==P)continue;const E=O.get(L,j,P,T);D+=E}}N.set(D*_,L,I,v,T)}return t.makeTensorInfo(N.shape,N.dtype,N.values)}const Ate={kernelName:N2,backendName:"cpu",kernelFunc:Ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,scale:i,offset:o,mean:a,variance:l}=e;ee(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ee(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ee(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),dt([s,a,l,i,o],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const f=t.data.get(s.dataId).values,h=t.data.get(a.dataId).values,p=t.data.get(l.dataId).values,g=i?t.data.get(i.dataId).values:new Float32Array([1]),m=o?t.data.get(o.dataId).values:new Float32Array([0]),w=new Float32Array(f.length),x=m.length,b=g.length,C=p.length,$=h.length;let k=0,N=0,_=0,U=0;for(let O=0;O<f.length;++O)w[O]=m[k++]+(f[O]-h[N++])*g[_++]/Math.sqrt(p[U++]+u),k>=x&&(k=0),N>=$&&(N=0),_>=b&&(_=0),U>=C&&(U=0);return t.makeTensorInfo(s.shape,s.dtype,w)}const Nte={kernelName:Nb,backendName:"cpu",kernelFunc:Tte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $te(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,crops:o}=r;dt([s],"batchToSpaceND");const a=i.reduce((b,C)=>b*C),l=yy(s.shape,i,a),u=wy(l.length,i.length),f=xy(s.shape,i,a),h=nT(o,i.length),p=rT(f,o,i.length),g=On({inputs:{x:s},backend:t,attrs:{shape:l}}),m=ti({inputs:{x:g},backend:t,attrs:{perm:u}}),w=On({inputs:{x:m},backend:t,attrs:{shape:f}}),x=Zf({inputs:{x:w},backend:t,attrs:{begin:h,size:p}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(w),x}const Rte={kernelName:wb,backendName:"cpu",kernelFunc:$te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:o}=r,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,u=GT(a,l,i.dtype,i.shape,o);return t.makeTensorInfo([o],i.dtype,u)}const Dte={kernelName:R2,backendName:"cpu",kernelFunc:Ote};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _te(n){const{inputs:e,backend:t}=n,{s0:r,s1:s}=e,i=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,a=Dt(Array.from(i),Array.from(o));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Pte={kernelName:q3,backendName:"cpu",kernelFunc:_te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fte=gn(E0,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),Mte={kernelName:E0,backendName:"cpu",kernelFunc:Fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lte=n=>{const{x:e}=n.inputs,t=n.backend,r=new Float32Array(De(e.shape)),s=t.data.get(e.dataId),i=s.complexTensorInfos.real,o=s.complexTensorInfos.imag,a=t.data.get(i.dataId).values,l=t.data.get(o.dataId).values;for(let u=0;u<a.length;u++){const f=a[u],h=l[u];r[u]=Math.hypot(f,h)}return t.makeOutput(r,e.shape,"float32")},Bte={kernelName:xb,backendName:"cpu",kernelFunc:Lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ap(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.data.get(r.dataId).complexTensorInfos.imag,i=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,i)}const zte={kernelName:X2,backendName:"cpu",kernelFunc:Ap};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tp(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r,i=zt(s,e[0].shape)[0],o=e.map(w=>w.shape);ZA(o,i);let a=za(e.map(w=>w.shape),i);if(De(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(w=>De(w.shape)>0);if(l.length===1)return Qa({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const w=l.map(k=>Jf({inputs:{input:k},backend:t})),x=l.map(k=>Ap({inputs:{input:k},backend:t})),b=Tp({inputs:w,backend:t,attrs:{axis:i}}),C=Tp({inputs:x,backend:t,attrs:{axis:i}}),$=mi({inputs:{real:b,imag:C},backend:t});return w.forEach(k=>t.disposeIntermediateTensorInfo(k)),x.forEach(k=>t.disposeIntermediateTensorInfo(k)),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(C),$}const u=l.map(w=>{const b=[-1,De(w.shape.slice(i))];return On({inputs:{x:w},backend:t,attrs:{shape:b}})}),f=u.map(w=>({vals:t.data.get(w.dataId).values,shape:w.shape}));a=za(u.map(w=>w.shape),1);const h=u[0].shape[0]===1,p=Iz(f,a,e[0].dtype,h),g=za(l.map(w=>w.shape),i),m=t.makeTensorInfo(g,e[0].dtype,p);return u.forEach(w=>t.disposeIntermediateTensorInfo(w)),m}const Ute={kernelName:bb,backendName:"cpu",kernelFunc:Tp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:f}=r;dt([s,i],"conv2d");const h=Gl(l),p=ts(s.shape,i.shape,o,u,a,f,!1,h),g=p.filterHeight,m=p.filterWidth,w=p.dilationHeight,x=p.dilationWidth,b=p.padInfo.left,C=p.padInfo.top,$=p.dataFormat==="channelsLast",k=new es(p.outShape,s.dtype),N=vt(s.shape),_=vt(i.shape),U=N[0],O=$?N[1]:N[2],L=$?N[2]:1,T=$?1:N[1],I=k.strides[0],v=$?k.strides[1]:k.strides[2],A=$?k.strides[2]:1,M=$?1:k.strides[1],D=t.data.get(s.dataId).values,B=t.data.get(i.dataId).values,j=k.values;for(let W=0;W<p.batchSize;++W){const P=W*U,E=W*I;for(let R=0;R<p.outHeight;++R){const H=E+R*v,K=R*p.strideHeight-C;for(let Q=0;Q<g;++Q){const J=K+Q*w;if(J<0||J>=p.inHeight)continue;const ie=Q*_[0],ce=P+J*O;for(let ge=0;ge<p.outWidth;++ge){const be=H+ge*A,Ae=ge*p.strideWidth-b;for(let ne=0;ne<m;++ne){const he=Ae+ne*x;if(he<0||he>=p.inWidth)continue;const Ie=ie+ne*_[1],ze=ce+he*L;let Re=Ie;for(let Ke=0;Ke<p.inChannels;++Ke){const tt=D[ze+Ke*T];for(let Xe=0;Xe<p.outChannels;++Xe)j[be+Xe*M]+=tt*B[Re+Xe];Re+=p.outChannels}}}}}}return t.makeTensorInfo(k.shape,k.dtype,j)}const Vte={kernelName:vb,backendName:"cpu",kernelFunc:vU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:f}=r;dt([s,i],"conv2dBackpropFilter");const h=Gl(l),p=ts(s.shape,f,o,1,a,u,!1,h),{strideHeight:g,strideWidth:m,filterHeight:w,filterWidth:x}=p,b=p.dataFormat==="channelsLast",C=new es(p.filterShape,"float32"),$=p.padInfo.left,k=p.padInfo.top,N=t.data.get(s.dataId).values,_=t.data.get(i.dataId).values,U=new es(s.shape,s.dtype,N),O=new es(i.shape,i.dtype,_);for(let L=0;L<w;++L){const T=Math.max(0,Math.ceil((k-L)/g)),I=Math.min(p.outHeight,(p.inHeight+k-L)/g);for(let v=0;v<x;++v){const A=Math.max(0,Math.ceil(($-v)/m)),M=Math.min(p.outWidth,(p.inWidth+$-v)/m);for(let D=0;D<p.inChannels;++D)for(let B=0;B<p.outChannels;++B){let j=0;for(let W=0;W<p.batchSize;++W)for(let P=T;P<I;++P){const E=L+P*g-k;for(let R=A;R<M;++R){const H=v+R*m-$;b?j+=U.get(W,E,H,D)*O.get(W,P,R,B):j+=U.get(W,D,E,H)*O.get(W,B,P,R)}}C.set(j,L,v,D,B)}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const Gte={kernelName:_2,backendName:"cpu",kernelFunc:Wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:f}=r;dt([s,i],"conv2dBackpropInput");const h=vt(i.shape),p=vt(s.shape);let g=Gl(u);const m=ts(o,i.shape,a,1,l,f,!1,g),w=new es(m.inShape,"float32"),x=w.values,b=t.data.get(s.dataId).values,C=t.data.get(i.dataId).values,[$,k,N]=h,{batchSize:_,filterHeight:U,filterWidth:O,inChannels:L,inHeight:T,inWidth:I,outChannels:v,outHeight:A,outWidth:M,strideHeight:D,strideWidth:B}=m;g=m.dataFormat;const j=U-1-m.padInfo.top,W=O-1-m.padInfo.left,P=g==="channelsLast",E=w.strides[0],R=P?w.strides[1]:w.strides[2],H=P?w.strides[2]:1,K=P?1:w.strides[1],Q=p[0],J=P?p[1]:p[2],ie=P?p[2]:1,ce=P?1:p[1];for(let ge=0;ge<_;++ge)for(let be=0;be<L;++be)for(let Ae=0;Ae<T;++Ae){const ne=Ae-j,he=Math.max(0,Math.ceil(ne/D)),Ie=Math.min(A,(U+ne)/D);for(let ze=0;ze<I;++ze){const Re=ze-W,Ke=Math.max(0,Math.ceil(Re/B)),tt=Math.min(M,(O+Re)/B);let Xe=0;for(let et=he;et<Ie;++et){const mt=et*D-ne;for(let Ue=Ke;Ue<tt;++Ue){const Vt=Ue*B-Re,At=Q*ge+J*et+ie*Ue,St=$*(U-1-mt)+k*(O-1-Vt)+N*be;for(let Dn=0;Dn<v;++Dn){const q=b[At+ce*Dn],z=C[St+Dn];Xe+=q*z}}}const ot=E*ge+R*Ae+H*ze+K*be;x[ot]=Xe}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const jte={kernelName:Sb,backendName:"cpu",kernelFunc:Hte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r;dt([s,i],"conv3d");const u=cc(s.shape,i.shape,o,l,a),{filterDepth:f,filterHeight:h,filterWidth:p,dilationDepth:g,dilationHeight:m,dilationWidth:w,padInfo:x}=u,b=x.front,C=x.left,$=x.top,k=new es(u.outShape,s.dtype),N=t.data.get(s.dataId).values,_=t.data.get(i.dataId).values,U=k.values,O=vt(s.shape),L=vt(i.shape);for(let T=0;T<u.batchSize;++T){const I=T*O[0],v=T*k.strides[0];for(let A=0;A<u.outDepth;++A){const M=v+A*k.strides[1],D=A*u.strideDepth-b;for(let B=0;B<f;++B){const j=D+B*g;if(j<0||j>=u.inDepth)continue;const W=B*L[0],P=I+j*O[1];for(let E=0;E<u.outHeight;++E){const R=M+E*k.strides[2],H=E*u.strideHeight-$;for(let K=0;K<h;++K){const Q=H+K*m;if(Q<0||Q>=u.inHeight)continue;const J=W+K*L[1],ie=P+Q*O[2];for(let ce=0;ce<u.outWidth;++ce){const ge=R+ce*u.outChannels,be=ce*u.strideWidth-C;for(let Ae=0;Ae<p;++Ae){const ne=be+Ae*w;if(ne<0||ne>=u.inWidth)continue;const he=J+Ae*L[2],Ie=ie+ne*u.inChannels;let ze=he;for(let Re=0;Re<u.inChannels;++Re){const Ke=N[Ie+Re];for(let tt=0;tt<u.outChannels;++tt)U[ge+tt]+=Ke*_[ze+tt];ze+=u.outChannels}}}}}}}}return t.makeTensorInfo(k.shape,k.dtype,k.values)}const qte={kernelName:Cb,backendName:"cpu",kernelFunc:Kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xte(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r;dt([s,i],"conv3dBackpropFilterV2");const u=vt(s.shape),f=vt(i.shape),h=cc(s.shape,l,o,1,a),p=h.strideDepth,g=h.strideHeight,m=h.strideWidth,w=h.filterDepth,x=h.filterHeight,b=h.filterWidth,C=new es(h.filterShape,"float32"),$=C.values,[k,N,_,U]=C.strides,O=t.data.get(i.dataId).values,[L,T,I,v]=f,A=t.data.get(s.dataId).values,[M,D,B,j]=u,W=h.padInfo.front,P=h.padInfo.left,E=h.padInfo.top;for(let R=0;R<w;++R){const H=Math.max(0,Math.ceil((W-R)/p)),K=Math.min(h.outDepth,(h.inDepth+W-R)/p),Q=R*k;for(let J=0;J<x;++J){const ie=Math.max(0,Math.ceil((E-J)/g)),ce=Math.min(h.outHeight,(h.inHeight+E-J)/g),ge=J*N+Q;for(let be=0;be<b;++be){const Ae=Math.max(0,Math.ceil((P-be)/m)),ne=Math.min(h.outWidth,(h.inWidth+P-be)/m),he=be*_+ge;for(let Ie=0;Ie<h.inChannels;++Ie){const ze=Ie*U+he;for(let Re=0;Re<h.outChannels;++Re){let Ke=0;for(let tt=0;tt<h.batchSize;++tt){const Xe=tt*M,ot=tt*L;for(let et=H;et<K;++et){const Ue=(R+et*p-W)*D+Xe,Vt=et*T+ot;for(let At=ie;At<ce;++At){const Dn=(J+At*g-E)*B+Ue,q=At*I+Vt;for(let z=Ae;z<ne;++z){const Z=(be+z*m-P)*j+Dn,ae=z*v+q;Ke+=A[Z+Ie]*O[ae+Re]}}}}$[ze+Re]=Ke}}}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const Qte={kernelName:P2,backendName:"cpu",kernelFunc:Xte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r;dt([s],"conv3dBackpropInputV2");const u=vt(s.shape),f=vt(i.shape),h=cc(l,i.shape,a,1,o),p=new es(h.inShape,"float32"),g=p.values,[m,w,x,b]=p.strides,C=t.data.get(s.dataId).values,[$,k,N,_]=u,U=t.data.get(i.dataId).values,[O,L,T,I]=f,{batchSize:v,filterDepth:A,filterHeight:M,filterWidth:D,inChannels:B,inDepth:j,inHeight:W,inWidth:P,outChannels:E,outDepth:R,outHeight:H,outWidth:K,strideDepth:Q,strideHeight:J,strideWidth:ie}=h,ce=A-1-h.padInfo.front,ge=M-1-h.padInfo.top,be=D-1-h.padInfo.left;for(let Ae=0;Ae<v;++Ae)for(let ne=0;ne<B;++ne)for(let he=0;he<j;++he){const Ie=he-ce,ze=Math.max(0,Math.ceil(Ie/Q)),Re=Math.min(R,(A+Ie)/Q);for(let Ke=0;Ke<W;++Ke){const tt=Ke-ge,Xe=Math.max(0,Math.ceil(tt/J)),ot=Math.min(H,(M+tt)/J);for(let et=0;et<P;++et){const mt=et-be,Ue=Math.max(0,Math.ceil(mt/ie)),Vt=Math.min(K,(D+mt)/ie);let At=0;for(let St=ze;St<Re;++St){const Dn=St*Q-Ie;for(let q=Xe;q<ot;++q){const z=q*J-tt;for(let G=Ue;G<Vt;++G){const Z=G*ie-mt,ae=$*Ae+k*St+N*q+_*G,ke=O*(A-1-Dn)+L*(M-1-z)+T*(D-1-Z)+I*ne;for(let Ne=0;Ne<E;++Ne){const Ye=C[ae+Ne],He=U[ke+Ne];At+=Ye*He}}}}g[m*Ae+w*he+x*Ke+b*et+ne]=At}}}return t.makeTensorInfo(p.shape,p.dtype,p.values)}const Jte={kernelName:F2,backendName:"cpu",kernelFunc:Yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zte=gn(A0,n=>Math.cos(n)),ene={kernelName:A0,backendName:"cpu",kernelFunc:Zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tne=gn(T0,n=>Math.cosh(n)),nne={kernelName:T0,backendName:"cpu",kernelFunc:tne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rne(n){const{inputs:e,backend:t,attrs:r}=n,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,[f,h,p,g]=s.shape,m=i.shape[0],[w,x]=a,b=Bt([m,w,x,g],"float32"),C=t.data.get(i.dataId).values,$=t.data.get(o.dataId).values,k=t.data.get(s.dataId).values,N=vt(s.shape),_=vt(b.shape);for(let U=0;U<m;U++){const O=U*4,L=C[O],T=C[O+1],I=C[O+2],v=C[O+3],A=$[U];if(A>=f)continue;const M=w>1?(I-L)*(h-1)/(w-1):0,D=x>1?(v-T)*(p-1)/(x-1):0;for(let B=0;B<w;B++){const j=w>1?L*(h-1)+B*M:.5*(L+I)*(h-1);if(j<0||j>h-1){for(let W=0;W<x;W++)for(let P=0;P<g;P++){const E=P+W*_[2]+B*_[1]+U*_[0];b.values[E]=u}continue}if(l==="bilinear"){const W=Math.floor(j),P=Math.ceil(j),E=j-W;for(let R=0;R<x;R++){const H=x>1?T*(p-1)+R*D:.5*(T+v)*(p-1);if(H<0||H>p-1){for(let ie=0;ie<g;ie++){const ce=ie+R*_[2]+B*_[1]+U*_[0];b.values[ce]=u}continue}const K=Math.floor(H),Q=Math.ceil(H),J=H-K;for(let ie=0;ie<g;ie++){let ce=ie+K*N[2]+W*N[1]+A*N[0];const ge=k[ce];ce=ie+Q*N[2]+W*N[1]+A*N[0];const be=k[ce];ce=ie+K*N[2]+P*N[1]+A*N[0];const Ae=k[ce];ce=ie+Q*N[2]+P*N[1]+A*N[0];const ne=k[ce],he=ge+(be-ge)*J,Ie=Ae+(ne-Ae)*J;ce=ie+R*_[2]+B*_[1]+U*_[0],b.values[ce]=he+(Ie-he)*E}}}else for(let W=0;W<x;++W){const P=x>1?T*(p-1)+W*D:.5*(T+v)*(p-1);if(P<0||P>p-1){for(let H=0;H<g;H++){const K=H+W*_[2]+B*_[1]+U*_[0];b.values[K]=u}continue}const E=Math.round(P),R=Math.round(j);for(let H=0;H<g;H++){const K=H+E*N[2]+R*N[1]+A*N[0],Q=H+W*_[2]+B*_[1]+U*_[0];b.values[Q]=k[K]}}}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const sne={kernelName:L2,backendName:"cpu",kernelFunc:rne};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;dt(s,"cumprod");const l=Zn([i],s.shape.length);let u=s;l!=null&&(u=ti({inputs:{x:s},backend:t,attrs:{perm:l}}));const f=pr(1,s.shape.length)[0];if(f!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${f}`);const h=xi(u.dtype,"int32"),p=C2(De(u.shape),h),g=t.data.get(u.dataId).values,m=u.shape[u.shape.length-1],w=a?(b,C)=>b+m-C-1:(b,C)=>b+C;for(let b=0;b<g.length;b+=m)for(let C=0;C<m;C++){const $=w(b,C);if(C===0)p[$]=o?1:g[$];else{const k=w(b,C-1);p[$]=o?g[k]*p[k]:g[$]*p[k]}}const x=t.makeTensorInfo(u.shape,h,p);if(l!=null){const b=fc(l),C=ti({inputs:{x},backend:t,attrs:{perm:b}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(u),C}return x}const one={kernelName:M2,backendName:"cpu",kernelFunc:ine};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;dt(s,"cumsum");const l=Zn([i],s.shape.length);let u=s;l!=null&&(u=ti({inputs:{x:s},backend:t,attrs:{perm:l}}));const f=pr(1,s.shape.length)[0];if(f!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${f}`);const h=xi(u.dtype,"int32"),p=ds(De(u.shape),h),g=t.data.get(u.dataId).values,m=u.shape[u.shape.length-1],w=a?(b,C)=>b+m-C-1:(b,C)=>b+C;for(let b=0;b<g.length;b+=m)for(let C=0;C<m;C++){const $=w(b,C);if(C===0)p[$]=o?0:g[$];else{const k=w(b,C-1);p[$]=o?g[k]+p[k]:g[$]+p[k]}}const x=t.makeTensorInfo(u.shape,h,p);if(l!=null){const b=fc(l),C=ti({inputs:{x},backend:t,attrs:{perm:b}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(u),C}return x}const lne={kernelName:kb,backendName:"cpu",kernelFunc:ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,f=GT(l,u,i.dtype,i.shape,o);return t.makeTensorInfo([o],i.dtype,f)}else if(s.shape.length===2){const l=t.bufferSync(s),u=t.bufferSync(i),f=Sz(l,u,o,a);return t.makeTensorInfo(f.shape,i.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const cne={kernelName:B2,backendName:"cpu",kernelFunc:une};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockSize:i,dataFormat:o}=r;ee(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=s.shape[0],l=s.shape[1],u=s.shape[2],f=s.shape[3],h=l*i,p=u*i,g=f/(i*i),m=t.data.get(s.dataId).values,w=new Float32Array(a*h*p*g);let x=0;for(let b=0;b<a;++b)for(let C=0;C<h;++C){const $=Math.floor(C/i),k=C%i;for(let N=0;N<p;++N){const _=Math.floor(N/i),U=N%i,O=(k*i+U)*g;for(let L=0;L<g;++L){const I=L+O+f*(_+u*($+l*b));w[x++]=m[I]}}}return t.makeTensorInfo([a,h,p,g],s.dtype,w)}const hne={kernelName:z2,backendName:"cpu",kernelFunc:fne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SU(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;dt([s,i],"depthwiseConv2DNative");const f=vt(s.shape),h=vt(i.shape);let p=l;p==null&&(p=[1,1]),ee(gs(o,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${p}'`);const g=ts(s.shape,i.shape,o,p,a,u,!0),{filterHeight:m,filterWidth:w,dilationHeight:x,dilationWidth:b,padInfo:C}=g,$=C.left,k=C.top,N=g.outChannels/g.inChannels,_=new es(g.outShape,s.dtype),U=t.data.get(s.dataId).values,O=t.data.get(i.dataId).values,L=_.values;for(let T=0;T<g.batchSize;++T){const I=T*f[0],v=T*_.strides[0];for(let A=0;A<g.outHeight;++A){const M=v+A*_.strides[1],D=A*g.strideHeight-k;for(let B=0;B<m;++B){const j=D+B*x;if(j<0||j>=g.inHeight)continue;const W=B*h[0],P=I+j*f[1];for(let E=0;E<g.outWidth;++E){const R=M+E*_.strides[2],H=E*g.strideWidth-$;for(let K=0;K<w;++K){const Q=H+K*b;if(Q<0||Q>=g.inWidth)continue;const J=W+K*h[1],ie=P+Q*g.inChannels;let ce=R,ge=J;for(let be=0;be<g.inChannels;++be){const Ae=U[ie+be];for(let ne=0;ne<N;++ne)L[ce+ne]+=Ae*O[ge+ne];ce+=N,ge+=N}}}}}}return t.makeTensorInfo(_.shape,_.dtype,_.values)}const dne={kernelName:Ib,backendName:"cpu",kernelFunc:SU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:f}=r;dt([s,i],"depthwiseConv2dNativeBackpropFilter");const h=ts(s.shape,f,o,a,l,u,!0),{strideHeight:p,strideWidth:g,filterHeight:m,filterWidth:w}=h,x=new es(h.filterShape,"float32"),b=h.padInfo.left,C=h.padInfo.top,$=h.outChannels/h.inChannels,k=t.data.get(s.dataId).values,N=new es(s.shape,s.dtype,k),_=t.data.get(i.dataId).values,U=new es(i.shape,i.dtype,_);for(let O=0;O<m;++O){const L=Math.max(0,Math.ceil((C-O)/p)),T=Math.min(h.outHeight,(h.inHeight+C-O)/p);for(let I=0;I<w;++I){const v=Math.max(0,Math.ceil((b-I)/g)),A=Math.min(h.outWidth,(h.inWidth+b-I)/g);for(let M=0;M<h.outChannels;++M){const D=Math.trunc(M/$),B=M%$;let j=0;for(let W=0;W<h.batchSize;++W)for(let P=L;P<T;++P){const E=O+P*p-C;for(let R=v;R<A;++R){const H=I+R*g-b;j+=N.get(W,E,H,D)*U.get(W,P,R,M)}}x.set(j,O,I,D,B)}}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}const gne={kernelName:U2,backendName:"cpu",kernelFunc:pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:f}=r;dt([s,i],"depthwiseConv2DNativeBackpropInput");const h=vt(s.shape),p=vt(i.shape),g=ts(f,i.shape,o,a,l,u,!0),m=new es(g.inShape,"float32"),w=m.values,[x,b,C]=m.strides,$=t.data.get(s.dataId).values,[k,N,_]=h,U=t.data.get(i.dataId).values,[O,L,T]=p,{batchSize:I,filterHeight:v,filterWidth:A,inChannels:M,inHeight:D,inWidth:B,outChannels:j,outHeight:W,outWidth:P,strideHeight:E,strideWidth:R}=g,H=v-1-g.padInfo.top,K=A-1-g.padInfo.left,Q=j/M;for(let J=0;J<I;++J)for(let ie=0;ie<M;++ie)for(let ce=0;ce<D;++ce){const ge=ce-H,be=Math.max(0,Math.ceil(ge/E)),Ae=Math.min(W,(v+ge)/E);for(let ne=0;ne<B;++ne){const he=ne-K,Ie=Math.max(0,Math.ceil(he/R)),ze=Math.min(P,(A+he)/R);let Re=0;for(let Ke=be;Ke<Ae;++Ke){const tt=Ke*E-ge;for(let Xe=Ie;Xe<ze;++Xe){const ot=Xe*R-he,et=k*J+N*Ke+_*Xe,mt=O*(v-1-tt)+L*(A-1-ot)+T*ie;for(let Ue=0;Ue<Q;++Ue){const Vt=ie*Q+Ue,At=$[et+Vt],St=U[mt+Ue];Re+=At*St}}}w[x*J+b*ce+C*ne+ie]=Re}}return t.makeTensorInfo(m.shape,m.dtype,m.values)}const yne={kernelName:V2,backendName:"cpu",kernelFunc:mne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(n){const{inputs:e,backend:t}=n,{x:r}=e,s=De(r.shape),i=t.data.get(r.dataId).values,o=Bt([s,s],r.dtype),a=o.values;for(let u=0;u<i.length;u++)a[u*s+u]=i[u];const l=[...r.shape,...r.shape];return t.makeTensorInfo(l,o.dtype,o.values)}const xne={kernelName:X3,backendName:"cpu",kernelFunc:wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bne={kernelName:Eb,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s}=n,{strides:i,pad:o,dilations:a}=t,l=e,u=l.data.get(r.dataId).values,f=r.shape.length,h=l.data.get(s.dataId).values,p=s.shape.length,{batchSize:g,inHeight:m,inWidth:w,inChannels:x,outHeight:b,outWidth:C,padInfo:$,strideHeight:k,strideWidth:N,filterHeight:_,filterWidth:U,dilationHeight:O,dilationWidth:L,outShape:T}=hy(r.shape,s.shape,i,o,"NHWC",a),I=De(T),v=T.length,A=fr(r.dtype,I);for(let D=0;D<g;++D)for(let B=0;B<b;++B){const j=B*k-$.top;for(let W=0;W<C;++W){const P=W*N-$.left;for(let E=0;E<x;++E){let R=Number.MIN_SAFE_INTEGER;for(let K=0;K<_;++K){const Q=j+K*O;if(Q>=0&&Q<m)for(let J=0;J<U;++J){const ie=P+J*L;if(ie>=0&&ie<w){const ce=La([D,Q,ie,E],f,vt(r.shape)),ge=La([K,J,E],p,vt(s.shape)),be=u[ce]+h[ge];be>R&&(R=be)}}}const H=La([D,B,W,E],v,vt(T));A[H]=R}}}return{dataId:l.write(ch(A,r.dtype),T,r.dtype),shape:T,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vne={kernelName:KI,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s,dy:i}=n,{strides:o,pad:a,dilations:l}=t,u=e,f=Ho(r.shape,u.data.get(r.dataId).values),h=Ho(s.shape,u.data.get(s.dataId).values),{batchSize:p,inHeight:g,inWidth:m,inChannels:w,outHeight:x,outWidth:b,padInfo:C,strideHeight:$,strideWidth:k,filterHeight:N,filterWidth:_,dilationHeight:U,dilationWidth:O,outShape:L}=hy(r.shape,s.shape,o,a,"NHWC",l);ee(i.rank===L.length,()=>`Error in ${KI}, dy must have the same rank as output ${L.length}, but got ${i.rank}`);const T=Ho(L,u.data.get(i.dataId).values),I=H3(s.shape,s.dtype);for(let A=0;A<p;++A)for(let M=0;M<x;++M){const D=M*$-C.top;for(let B=0;B<b;++B){const j=B*k-C.left;for(let W=0;W<w;++W){let P=Number.MIN_SAFE_INTEGER,E=0,R=0;for(let H=0;H<N;++H){const K=D+H*U;if(K>=0&&K<g)for(let Q=0;Q<_;++Q){const J=j+Q*O;if(J>=0&&J<m){const ie=f[A][K][J][W]+h[H][Q][W];ie>P&&(P=ie,E=H,R=Q)}}}I[E][R][W]+=T[A][M][B][W]}}}return{dataId:u.write(ch(I,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sne={kernelName:jI,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s,dy:i}=n,{strides:o,pad:a,dilations:l}=t,u=e,f=Ho(r.shape,u.data.get(r.dataId).values),h=Ho(s.shape,u.data.get(s.dataId).values),{batchSize:p,inHeight:g,inWidth:m,inChannels:w,outHeight:x,outWidth:b,padInfo:C,strideHeight:$,strideWidth:k,filterHeight:N,filterWidth:_,dilationHeight:U,dilationWidth:O,outShape:L}=hy(r.shape,s.shape,o,a,"NHWC",l);ee(i.rank===L.length,()=>`Error in ${jI}, dy must have the same rank as output ${L.length}, but got ${i.rank}`);const T=Ho(L,u.data.get(i.dataId).values),I=H3(r.shape,r.dtype);for(let A=0;A<p;++A)for(let M=0;M<x;++M){const D=M*$-C.top;for(let B=0;B<b;++B){const j=B*k-C.left;for(let W=0;W<w;++W){let P=Number.MIN_SAFE_INTEGER,E=D<0?0:D,R=j<0?0:j;for(let H=0;H<N;++H){const K=D+H*U;if(K>=0&&K<g)for(let Q=0;Q<_;++Q){const J=j+Q*O;if(J>=0&&J<m){const ie=f[A][K][J][W]+h[H][Q][W];ie>P&&(P=ie,E=K,R=J)}}}I[A][E][R][W]+=T[A][M][B][W]}}}return{dataId:u.write(ch(I,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cne(n){const{inputs:e,backend:t,attrs:r}=n,{image:s}=e,{canvas:i,options:o}=r,{contextOptions:a,imageOptions:l}=o||{},u=(l==null?void 0:l.alpha)||1,f=(a==null?void 0:a.contextType)||"2d";if(f!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const h=i.getContext(f,(a==null?void 0:a.contextAttributes)||{});if(h==null)throw new Error(`Could not get the context with ${f} type.`);const[p,g]=s.shape.slice(0,2),m=s.shape.length===2?1:s.shape[2],w=t.data.get(s.dataId).values,x=s.dtype==="float32"?255:1,b=new Uint8ClampedArray(g*p*4);for(let $=0;$<p*g;++$){const k=[0,0,0,255*u];for(let _=0;_<m;_++){const U=w[$*m+_];if(s.dtype==="float32"){if(U<0||U>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${U}.`)}else if(s.dtype==="int32"&&(U<0||U>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${U}.`);m===1?(k[0]=U*x,k[1]=U*x,k[2]=U*x):k[_]=U*x}const N=$*4;b[N+0]=Math.round(k[0]),b[N+1]=Math.round(k[1]),b[N+2]=Math.round(k[2]),b[N+3]=Math.round(k[3])}i.width=g,i.height=p;const C=new ImageData(b,g,p);return h.putImageData(C,0,0),s}const kne={kernelName:P8,backendName:"cpu",kernelFunc:Cne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ty(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;dt(s,"sum");let a;s.dtype==="bool"?a=tc({inputs:{x:s},backend:t,attrs:{dtype:"int32"}}):a=Qa({inputs:{x:s},backend:t});const l=a.shape.length,u=zt(i,a.shape),f=Zn(u,l);let h=u,p=a;f!=null&&(p=ti({inputs:{x:a},backend:t,attrs:{perm:f}}),h=pr(h.length,l)),ns("sum",h,p.shape.length);const[g,m]=Gr(p.shape,h),w=xi(p.dtype,"int32");let x=E1(t,g,w);const b=De(m),C=t.data.get(x.dataId).values,$=t.data.get(p.dataId).values;for(let k=0;k<C.length;++k){const N=k*b;let _=0;for(let U=0;U<b;++U)_+=$[N+U];C[k]=_}if(o){const k=Ir(x.shape,u),N=x;x=On({inputs:{x},backend:t,attrs:{shape:k}}),t.disposeIntermediateTensorInfo(N)}return t.disposeIntermediateTensorInfo(a),f!=null&&t.disposeIntermediateTensorInfo(p),x}const Ine={kernelName:iv,backendName:"cpu",kernelFunc:Ty};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(n){const{inputs:e,backend:t,attrs:r}=n,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=fT(s,i.length);dT(o.length,l,i);const{path:u,steps:f}=pT(a,l),h=f.length;let p=null,g=o.length;const m=[];for(let w=0;w<h;++w){for(const x of f[w]){const{permutationIndices:b,expandDims:C}=hT(g,l[x]);let $;gT(b)?$=i[x]:($=ti({inputs:{x:i[x]},backend:t,attrs:{perm:b}}),m.push($));const k=$.shape.slice();for(let N=0;N<C.length;++N)k.splice(C[N],0,1);an($.shape,k)||($=On({inputs:{x:$},backend:t,attrs:{shape:k}}),m.push($)),p===null?p=$:(p=Fv({inputs:{a:$,b:p},backend:t}),m.push(p))}w<h-1&&(u[w]>=0&&(p=Ty({inputs:{x:p},backend:t,attrs:{axis:u[w]-(o.length-g),keepDims:!1}}),m.push(p)),g--)}for(const w of m)w!==p&&t.disposeIntermediateTensorInfo(w);return p}const Ane={kernelName:W2,backendName:"cpu",kernelFunc:Ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(n){const{inputs:e,backend:t}=n,{dy:r,y:s}=e;dt([r,s],"eluGrad");const i=new Float32Array(De(s.shape)),o=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const u=o[l];u>=0?i[l]=a[l]:i[l]=a[l]*(u+1)}return t.makeTensorInfo(s.shape,"float32",i)}const Nne={kernelName:G2,backendName:"cpu",kernelFunc:Tne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ne=sT,Rne=iT,One=oT,Dne=aT,_ne=lT,Pne=uT,Fne=gn(R0,n=>{const e=Math.sign(n),t=Math.abs(n),r=1/(1+$ne*t);return e*(1-((((Pne*r+_ne)*r+Dne)*r+One)*r+Rne)*r*Math.exp(-t*t))}),Mne={kernelName:R0,backendName:"cpu",kernelFunc:Fne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1(n){const{inputs:e,backend:t,attrs:r}=n,{input:s}=e,{dim:i}=r,o=s.shape.length,a=s.shape.slice();let l=i;return i<0&&(ee(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),On({inputs:{x:s},backend:t,attrs:{shape:a}})}const Lne={kernelName:Tb,backendName:"cpu",kernelFunc:N1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bne=mr((n,e)=>n/e),QT=Mr(N0,Bne),wE={kernelName:N0,backendName:"cpu",kernelFunc:QT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(n,e,t){const r=n.shape,s=r[0],i=r[1],o=t.data.get(n.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,u=[s,i],f=De(u),h=hs("float32",f),p=hs("float32",f);for(let x=0;x<s;x++){const b=Zf({inputs:{x:a},backend:t,attrs:{begin:[x,0],size:[1,i]}}),C=Zf({inputs:{x:l},backend:t,attrs:{begin:[x,0],size:[1,i]}}),$=mi({inputs:{real:b,imag:C},backend:t}),{real:k,imag:N}=zne($,e,t),_=Ml(k,N);for(let U=0;U<i;U++){const O=cT(_,U);h[x*i+U]=O.real,p[x*i+U]=O.imag}t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo($)}const g=t.makeTensorInfo(u,"float32",h),m=t.makeTensorInfo(u,"float32",p),w=mi({inputs:{real:g,imag:m},backend:t});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(m),w}function zne(n,e,t){const r=De(n.shape),s=t.data.get(n.dataId),i=t.data.get(s.complexTensorInfos.real.dataId).values,o=t.data.get(s.complexTensorInfos.imag.dataId).values;if(Une(r)){const a=xE(i,o,r,e,t),l=[n.shape[0],n.shape[1]];if(e){const u=t.makeTensorInfo(l,"float32",a.real),f=t.makeTensorInfo(l,"float32",a.imag),h=t.makeTensorInfo([],"float32",lc(r,"float32")),p=Qa({inputs:{x:h},backend:t}),g=wE.kernelFunc({inputs:{a:u,b:h},backend:t}),m=wE.kernelFunc({inputs:{a:f,b:p},backend:t}),w=t.data.get(g.dataId).values,x=t.data.get(m.dataId).values;return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(m),{real:w,imag:x}}return a}else{const a=Ml(i,o),l=Vne(a,r,e);return BL(l)}}function Une(n){return(n&n-1)===0}function xE(n,e,t,r,s){if(t===1)return{real:n,imag:e};const i=Ml(n,e),o=t/2,a=zL(i),l=a.real,u=a.imag,f=[l.length],h=s.makeTensorInfo(f,"float32",l),p=s.makeTensorInfo(f,"float32",u),g=mi({inputs:{real:h,imag:p},backend:s}),m=UL(i),w=m.real,x=m.imag,b=[w.length],C=s.makeTensorInfo(b,"float32",w),$=s.makeTensorInfo(b,"float32",x),k=mi({inputs:{real:C,imag:$},backend:s}),N=xE(l,u,o,r,s),_=N.real,U=N.imag,O=[_.length],L=s.makeTensorInfo(O,"float32",_),T=s.makeTensorInfo(O,"float32",U),I=mi({inputs:{real:L,imag:T},backend:s}),v=xE(w,x,o,r,s),A=v.real,M=v.imag,D=[A.length],B=s.makeTensorInfo(D,"float32",A),j=s.makeTensorInfo(D,"float32",M),W=mi({inputs:{real:B,imag:j},backend:s}),P=WL(t,r),E=[P.real.length],R=s.makeTensorInfo(E,"float32",P.real),H=s.makeTensorInfo(E,"float32",P.imag),K=mi({inputs:{real:R,imag:H},backend:s}),Q=Fv({inputs:{a:K,b:W},backend:s}),J=Ep({inputs:{a:I,b:Q},backend:s}),ie=qT({inputs:{a:I,b:Q},backend:s}),ce=Jf({inputs:{input:J},backend:s}),ge=Jf({inputs:{input:ie},backend:s}),be=Ap({inputs:{input:J},backend:s}),Ae=Ap({inputs:{input:ie},backend:s}),ne=Tp({inputs:[ce,ge],backend:s,attrs:{axis:0}}),he=Tp({inputs:[be,Ae],backend:s,attrs:{axis:0}}),Ie=s.data.get(ne.dataId).values,ze=s.data.get(he.dataId).values;return s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(p),s.disposeIntermediateTensorInfo(g),s.disposeIntermediateTensorInfo(C),s.disposeIntermediateTensorInfo($),s.disposeIntermediateTensorInfo(k),s.disposeIntermediateTensorInfo(L),s.disposeIntermediateTensorInfo(T),s.disposeIntermediateTensorInfo(I),s.disposeIntermediateTensorInfo(B),s.disposeIntermediateTensorInfo(j),s.disposeIntermediateTensorInfo(W),s.disposeIntermediateTensorInfo(R),s.disposeIntermediateTensorInfo(H),s.disposeIntermediateTensorInfo(K),s.disposeIntermediateTensorInfo(Q),s.disposeIntermediateTensorInfo(J),s.disposeIntermediateTensorInfo(ie),s.disposeIntermediateTensorInfo(ce),s.disposeIntermediateTensorInfo(be),s.disposeIntermediateTensorInfo(ge),s.disposeIntermediateTensorInfo(Ae),s.disposeIntermediateTensorInfo(ne),s.disposeIntermediateTensorInfo(he),{real:Ie,imag:ze}}function Vne(n,e,t){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let i=0,o=0;for(let a=0;a<e;a++){const l=GL(s*a,e,t),u=cT(n,a);i+=u.real*l.real-u.imag*l.imag,o+=u.real*l.imag+u.imag*l.real}t&&(i/=e,o/=e),VL(r,i,o,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wne(n){const{inputs:e,backend:t}=n,{input:r}=e,s=De(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=On({inputs:{x:r},backend:t,attrs:{shape:[o,i]}}),l=CU(a,!1,t),u=On({inputs:{x:l},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const Gne={kernelName:H2,backendName:"cpu",kernelFunc:Wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YT(n){const{backend:e,attrs:t}=n,{shape:r,value:s,dtype:i}=t,o=i||Hp(s),a=fr(o,De(r));return jne(a,s,o),e.makeTensorInfo(r,o,a)}const Hne={kernelName:j2,backendName:"cpu",kernelFunc:YT};function jne(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kne={kernelName:K2,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,s=t,i=hs(r.dtype,De(r.shape)),[o,a,l,u]=r.shape,f=s.data.get(r.dataId).values;for(let p=0;p<o;p++){const g=p*l*a*u;for(let m=0;m<a;m++){const w=m*(l*u);for(let x=0;x<l;x++){const b=x*u;for(let C=0;C<u;C++){const $=Math.round(l-x-1),k=g+w+b+C;let N=f[k];if($>=0&&$<l){const _=$*u,U=g+w+_+C;N=f[U]}i[k]=N}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:f,dilations:h,dimRoundingMode:p,activation:g,leakyreluAlpha:m}=r;let w=vU({inputs:{x:s,filter:i},backend:t,attrs:{strides:l,pad:u,dataFormat:f,dilations:h,dimRoundingMode:p}});if(o){const x=w;if(f==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const b=On({inputs:{x:o},backend:t,attrs:{shape:[o.shape[0],1,1]}});w=Ep({inputs:{a:w,b},backend:t}),t.disposeIntermediateTensorInfo(b)}else w=Ep({inputs:{a:w,b:o},backend:t});t.disposeIntermediateTensorInfo(x)}if(g){const x=w;if(f==="NCHW"&&g==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const b=On({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});w=T1(t,w,g,b,m),t.disposeIntermediateTensorInfo(b)}else w=T1(t,w,g,a,m);t.disposeIntermediateTensorInfo(x)}return w}const Xne={kernelName:a1,backendName:"cpu",kernelFunc:qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:f,dilations:h,dimRoundingMode:p,activation:g,leakyreluAlpha:m}=r;let w=SU({inputs:{x:s,filter:i},backend:t,attrs:{strides:l,pad:u,dataFormat:f,dilations:h,dimRoundingMode:p}});if(o){const x=w;w=Ep({inputs:{a:w,b:o},backend:t}),t.disposeIntermediateTensorInfo(x)}if(g){const x=w;w=T1(t,w,g,a,m),t.disposeIntermediateTensorInfo(x)}return w}const Yne={kernelName:pM,backendName:"cpu",kernelFunc:Qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jne(n){const{inputs:e,backend:t}=n,{params:r,indices:s}=e,i=De(r.shape),o=s.shape,a=o[o.length-1],[l,u,f,h]=KA(r,s);if(u===0)return t.makeTensorInfo(l,r.dtype,[]);const p=t.data.get(s.dataId).values,g=t.bufferSync(r),m=Dz(p,g,r.dtype,u,a,f,h,r.shape,i);return t.makeTensorInfo(l,r.dtype,m.values)}const Zne={kernelName:Q3,backendName:"cpu",kernelFunc:Jne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,indices:i}=e,{axis:o,batchDims:a}=r;dt([s,i],"gatherV2");const l=zt(o,s.shape)[0],u=t.data.get(i.dataId).values,f=s.shape[l];for(let k=0;k<u.length;++k){const N=u[k];ee(N<=f-1&&N>=0,()=>`GatherV2: the index value ${N} is not in [0, ${f-1}]`)}let h=a;a==null&&(h=0);const p=De(i.shape),g=yT(s,i,l,h),m=On({inputs:{x:s},backend:t,attrs:{shape:[g.batchSize,g.outerSize,g.dimSize,g.sliceSize]}}),w=On({inputs:{x:i},backend:t,attrs:{shape:[g.batchSize,p/g.batchSize]}}),x=[g.batchSize,g.outerSize,p/g.batchSize,g.sliceSize],b=t.bufferSync(w),C=t.bufferSync(m),$=_z(C,b,x);return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(w),t.makeTensorInfo(g.outputShape,$.dtype,$.values)}const tre={kernelName:$b,backendName:"cpu",kernelFunc:ere};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nre(n){const{inputs:e,backend:t}=n,{input:r}=e,s=De(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=On({inputs:{x:r},backend:t,attrs:{shape:[o,i]}}),l=CU(a,!0,t),u=On({inputs:{x:l},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const rre={kernelName:q2,backendName:"cpu",kernelFunc:nre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sre=gn(L0,n=>Number.isFinite(n)?1:0,"bool"),ire={kernelName:L0,backendName:"cpu",kernelFunc:sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ore=gn(B0,n=>Math.abs(n)===1/0?1:0,"bool"),are={kernelName:B0,backendName:"cpu",kernelFunc:ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lre=gn(z0,n=>Number.isNaN(n)?1:0,"bool"),ure={kernelName:z0,backendName:"cpu",kernelFunc:lre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre(n){const{backend:e,attrs:t}=n,{start:r,stop:s,num:i}=t,o=Bz(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const fre={kernelName:Y3,backendName:"cpu",kernelFunc:cre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hre=gn(V0,n=>Math.log1p(n)),dre={kernelName:V0,backendName:"cpu",kernelFunc:hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pre=mr((n,e)=>n&&e),gre=Mr(Pb,pre,null,"bool"),mre={kernelName:Pb,backendName:"cpu",kernelFunc:gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yre=gn(Fb,n=>n?0:1,"bool"),wre={kernelName:Fb,backendName:"cpu",kernelFunc:yre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xre=mr((n,e)=>n||e),bre=Mr(Mb,xre,null,"bool"),vre={kernelName:Mb,backendName:"cpu",kernelFunc:bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r;dt(s,"LRN");const u=s.shape[3],f=u-1,h=t.data.get(s.dataId).values,p=De(s.shape),g=new Float32Array(p);function m(w){const x=w%u;let b=w-x+Math.max(0,x-i);const C=w-x+Math.min(x+i,f);let $=0;for(;b<=C;b++){const k=h[b];$+=k*k}return $}for(let w=0;w<p;w++){const x=m(w),b=h[w]*Math.pow(o+a*x,-l);g[w]=b}return t.makeTensorInfo(s.shape,s.dtype,g)}const Cre={kernelName:Lb,backendName:"cpu",kernelFunc:Sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:f}=r;dt(o,"LRNGrad");const h=De(o.shape),p=o.shape[3],g=t.data.get(o.dataId).values,m=t.data.get(s.dataId).values,w=t.data.get(i.dataId).values,x=new Float32Array(h),b=h;for(let C=0;C<b;C++){const $=C%p,k=C-$+Math.max(0,$-a),N=C-$+Math.min(p,$+a+1);let _=0;for(let U=k;U<N;U++)_+=Math.pow(m[U],2);_=u*_+l;for(let U=k;U<N;U++){let O=-2*u*f*m[U]*w[C]/_;C===U&&(O+=Math.pow(_,-f)),O*=g[C],x[U]+=O}}return t.makeTensorInfo(o.shape,s.dtype,x)}const Ire={kernelName:Q2,backendName:"cpu",kernelFunc:kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=t;let l=s.shape;const u=l.length,f=zt(i,l);let h=f;const p=Zn(h,u);let g=a.data.get(s.dataId).values;if(p!=null){const k=new Array(u);for(let N=0;N<k.length;N++)k[N]=l[p[N]];g=jT(g,l,s.dtype,p,k),h=pr(h.length,u),l=k}dt(s,"max"),ns("max",h,u);const[m,w]=Gr(l,h),x=De(w),b=Uz(g,x,m,s.dtype),C=a.write(b,m,s.dtype);let $=m;return o&&($=Ir(m,f)),{dataId:C,shape:$,dtype:s.dtype}}const Ere={kernelName:Bb,backendName:"cpu",kernelFunc:kU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Are(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;dt(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;ee(gs(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const f=wo(s.shape,i,o,u,a,l);let h;if(f.filterWidth===1&&f.filterHeight===1&&an(f.inShape,f.outShape))h=Qa({inputs:{x:s},backend:t});else{const p=t.data.get(s.dataId).values,g=vt(s.shape),m=XT(p,s.shape,s.dtype,g,f,"max");h=t.makeTensorInfo(f.outShape,s.dtype,m.values)}return h}const Tre={kernelName:zb,backendName:"cpu",kernelFunc:Are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r;dt(s,"maxPool3d");const f=Wl(s.shape,i,o,1,a,l,u),h=t.data.get(s.dataId).values,p=bU(h,s.shape,s.dtype,vt(s.shape),f,"max");return t.makeTensorInfo(p.shape,"float32",p.values)}const $re={kernelName:Ub,backendName:"cpu",kernelFunc:Nre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:u}=r;dt([s,i],"maxPool3DGrad");const f=Wl(i.shape,o,a,1,l,u),h=t.bufferSync(i),p=xte(h,f),g=f.strideDepth,m=f.strideHeight,w=f.strideWidth,x=f.dilationDepth,b=f.dilationHeight,C=f.dilationWidth,$=f.effectiveFilterDepth,k=f.effectiveFilterHeight,N=f.effectiveFilterWidth,_=$-1-f.padInfo.front,U=N-1-f.padInfo.left,O=k-1-f.padInfo.top,L=Bt(i.shape,"float32"),T=t.bufferSync(s);for(let I=0;I<f.batchSize;++I)for(let v=0;v<f.inChannels;++v)for(let A=0;A<f.inDepth;++A)for(let M=0;M<f.inHeight;++M)for(let D=0;D<f.inWidth;++D){const B=A-_,j=M-O,W=D-U;let P=0;for(let E=0;E<$;E+=x){const R=(B+E)/g;if(!(R<0||R>=f.outDepth||Math.floor(R)!==R))for(let H=0;H<k;H+=b){const K=(j+H)/m;if(!(K<0||K>=f.outHeight||Math.floor(K)!==K))for(let Q=0;Q<N;Q+=C){const J=(W+Q)/w;if(J<0||J>=f.outWidth||Math.floor(J)!==J)continue;const ie=$*k*N-1-p.get(I,R,K,J,v),ce=E*k*N+H*N+Q,ge=ie===ce?1:0;if(ge===0)continue;const be=T.get(I,R,K,J,v);P+=be*ge}}}L.set(P,I,A,M,D,v)}return t.makeTensorInfo(L.shape,L.dtype,L.values)}const Ore={kernelName:J2,backendName:"cpu",kernelFunc:Rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i,output:o}=e,a=i;dt([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:f,dimRoundingMode:h}=r,p=wo(a.shape,l,u,1,f,h),g=t.data.get(a.dataId).values,m=Bt(p.outShape,a.dtype,xU(g,a.shape,a.dtype,p).values),w=p.strideHeight,x=p.strideWidth,b=p.dilationHeight,C=p.dilationWidth,$=p.effectiveFilterHeight,k=p.effectiveFilterWidth,N=k-1-p.padInfo.left,_=$-1-p.padInfo.top,U=Bt(a.shape,"float32"),O=t.data.get(s.dataId).values,L=Bt(s.shape,"float32",O);for(let T=0;T<p.batchSize;++T)for(let I=0;I<p.inChannels;++I)for(let v=0;v<p.inHeight;++v)for(let A=0;A<p.inWidth;++A){const M=v-_,D=A-N;let B=0;for(let j=0;j<$;j+=b){const W=(M+j)/w;if(!(W<0||W>=p.outHeight||Math.floor(W)!==W))for(let P=0;P<k;P+=C){const E=(D+P)/x;if(E<0||E>=p.outWidth||Math.floor(E)!==E)continue;const R=$*k-1-m.get(T,W,E,I),H=j*k+P,K=R===H?1:0;if(K===0)continue;const Q=L.get(T,W,E,I);B+=Q*K}}U.set(B,T,v,A,I)}return t.makeTensorInfo(U.shape,U.dtype,U.values)}const _re={kernelName:Y2,backendName:"cpu",kernelFunc:Dre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pre(n,e,t,r,s){const i=vt(e),o=XT(n,e,t,i,s,"max"),a=xU(n,e,t,s,!0,r);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fre={kernelName:J3,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=t;dt(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,f=wo(r.shape,s,i,[1,1],o),[h,p]=Pre(u,r.shape,r.dtype,a,f),g=l.write(h,f.outShape,r.dtype),m=l.write(p,f.outShape,r.dtype);return[{dataId:g,shape:f.outShape,dtype:r.dtype},{dataId:m,shape:f.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=zt(i,s.shape),u=Gr(s.shape,a)[1],f=De(u),h=[],p=t.makeTensorInfo([],"float32",new Float32Array([f]));h.push(p);const g=tc({inputs:{x:s},backend:t,attrs:{dtype:"float32"}});h.push(g);const m=QT({inputs:{a:g,b:p},backend:t});h.push(m);const w=Ty({inputs:{x:m},backend:t,attrs:{axis:i,keepDims:o}});return h.forEach(x=>t.disposeIntermediateTensorInfo(x)),w}const Lre={kernelName:Vb,backendName:"cpu",kernelFunc:Mre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;dt(s,"min");const a=zt(i,s.shape);let l=a;const u=Zn(l,s.shape.length);let f=s;u!=null&&(f=ti({inputs:{x:s},backend:t,attrs:{perm:u}}),l=pr(l.length,s.shape.length)),ns("min",l,f.shape.length);const[h,p]=Gr(f.shape,l),g=De(p),m=ds(De(h),f.dtype),w=t.data.get(f.dataId).values;for(let b=0;b<m.length;++b){const C=b*g;let $=w[C];for(let k=0;k<g;++k){const N=w[C+k];(Number.isNaN(N)||N<$)&&($=N)}m[b]=$}u!=null&&t.disposeIntermediateTensorInfo(f);const x=t.makeTensorInfo(h,f.dtype,m);if(o){const b=Ir(h,a),C=On({inputs:{x},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(x),C}return x}const zre={kernelName:Wb,backendName:"cpu",kernelFunc:Bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ure(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,mode:o}=r;dt(s,"mirrorPad");const a=i.map(($,k)=>$[0]+s.shape[k]+$[1]),l=i.map($=>$[0]),u=i.map(($,k)=>$[0]+s.shape[k]),f=o==="reflect"?0:1,h=t.data.get(s.dataId).values,p=s.shape.length,g=vt(s.shape),m=De(a),w=a.length,x=vt(a),b=hs(s.dtype,m);for(let $=0;$<m;$++){let k=jp($,w,x);for(let _=0;_<w;_++)k[_]<l[_]?k[_]=l[_]*2-k[_]-f:k[_]>=u[_]&&(k[_]=(u[_]-1)*2-k[_]+f);k=k.map((_,U)=>_-l[U]);const N=La(k,p,g);b[$]=h[N]}return{dataId:t.write(b,a,s.dtype),shape:a,dtype:s.dtype}}const Vre={kernelName:Gb,backendName:"cpu",kernelFunc:Ure};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wre=mr((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e}),Gre=Mr(H0,Wre),Hre={kernelName:H0,backendName:"cpu",kernelFunc:Gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{dim:i}=r,o=s.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=zt([a],s.shape),u=kU({inputs:{x:s},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),f=Ir(u.shape,l),h=On({inputs:{x:u},backend:t,attrs:{shape:f}}),p=qT({inputs:{a:s,b:h},backend:t}),g=Nz({inputs:{x:p},backend:t}),m=Ty({inputs:{x:g},backend:t,attrs:{axis:l,keepDims:!1}}),w=On({inputs:{x:m},backend:t,attrs:{shape:f}}),x=QT({inputs:{a:g,b:w},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(w),x}const jre={kernelName:lv,backendName:"cpu",kernelFunc:IU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r;dt(s,"multinomial");const l=a?s:IU({inputs:{logits:s},backend:t,attrs:{dim:-1}}),u=l.shape[0],f=l.shape[1],h=t.data.get(l.dataId).values,p=[u,i],g=ds(De(p),"int32");for(let m=0;m<u;++m){const w=m*f,x=new Float32Array(f-1);x[0]=h[w];for(let $=1;$<x.length;++$)x[$]=x[$-1]+h[w+$];const b=OA.alea(o.toString()),C=m*i;for(let $=0;$<i;++$){const k=b();g[C+$]=x.length;for(let N=0;N<x.length;N++)if(k<x[N]){g[C+$]=N;break}}}return a||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(p,"int32",g)}const qre={kernelName:Z3,backendName:"cpu",kernelFunc:Kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xre=UA;function Qre(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r;dt(s,"NonMaxSuppression");const u=t.data.get(s.dataId).values,f=t.data.get(i.dataId).values,{selectedIndices:h}=Xre(u,f,o,a,l);return t.makeTensorInfo([h.length],"int32",new Int32Array(h))}const Yre={kernelName:Z2,backendName:"cpu",kernelFunc:Qre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jre=VA;function Zre(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;dt(s,"NonMaxSuppressionPadded");const f=t.data.get(s.dataId).values,h=t.data.get(i.dataId).values,{selectedIndices:p,validOutputs:g}=Jre(f,h,o,a,l,u);return[t.makeTensorInfo([p.length],"int32",new Int32Array(p)),t.makeTensorInfo([],"int32",new Int32Array([g]))]}const ese={kernelName:eA,backendName:"cpu",kernelFunc:Zre};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tse=WA;function nse(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;dt(s,"NonMaxSuppressionWithScore");const f=t.data.get(s.dataId).values,h=t.data.get(i.dataId).values,p=o,g=a,m=l,w=u,{selectedIndices:x,selectedScores:b}=tse(f,h,p,g,m,w);return[t.makeTensorInfo([x.length],"int32",new Int32Array(x)),t.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const rse={kernelName:tA,backendName:"cpu",kernelFunc:nse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sse(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r;dt(s,"oneHot");const u=De(s.shape),f=new Float32Array(u*o);f.fill(l);const h=t.data.get(s.dataId).values;for(let p=0;p<u;++p)h[p]>=0&&h[p]<o&&(f[p*o+h[p]]=a);return t.makeTensorInfo([...s.shape,o],i,f)}const ise={kernelName:qb,backendName:"cpu",kernelFunc:sse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Jf({inputs:{input:r},backend:t}),i=$1({inputs:{x:s},backend:t}),o=Ap({inputs:{input:r},backend:t}),a=$1({inputs:{x:o},backend:t}),l=mi({inputs:{real:i,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return YT({backend:t,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const ose={kernelName:fv,backendName:"cpu",kernelFunc:$1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EU(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Jf({inputs:{input:r},backend:t}),i=EU({inputs:{x:s},backend:t}),o=Ap({inputs:{input:r},backend:t}),a=$1({inputs:{x:o},backend:t}),l=mi({inputs:{real:i,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return YT({backend:t,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const ase={kernelName:Kb,backendName:"cpu",kernelFunc:EU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AU(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r;if(e.length===1)return N1({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(f=>{S2(i,f.shape,"All tensors passed to stack must have matching shapes"),ee(o===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(f=>{const h=N1({inputs:{input:f},backend:t,attrs:{dim:s}});return a.push(h),h}),u=Tp({inputs:l,backend:t,attrs:{axis:s}});return a.forEach(f=>t.disposeIntermediateTensorInfo(f)),u}const lse={kernelName:Xb,backendName:"cpu",kernelFunc:AU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function use(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,constantValue:o}=r;dt(s,"pad");const a=i.map((C,$)=>C[0]+s.shape[$]+C[1]),l=i.map(C=>C[0]),u=t.data.get(s.dataId).values,f=De(s.shape),h=s.shape.length,p=vt(s.shape),g=De(a),m=a.length,w=vt(a),x=hs(s.dtype,g);o!==0&&x.fill(o);for(let C=0;C<f;C++){const k=jp(C,h,p).map((_,U)=>_+l[U]),N=La(k,m,w);x[N]=u[C]}return{dataId:t.write(x,a,s.dtype),shape:a,dtype:s.dtype}}const TU={kernelName:Qb,backendName:"cpu",kernelFunc:use};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cse=mr((n,e)=>Math.pow(n,e)),fse=Mr(K0,cse),hse={kernelName:K0,backendName:"cpu",kernelFunc:fse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dse(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,a=s.map(x=>t.data.get(x.dataId).values),l=s.map(x=>x.shape),u=t.data.get(i.dataId).values,f=t.data.get(o.dataId).values,[h,p,g]=Kz(a,l,u,i.shape,i.dtype,f,o.shape),m=h.map(x=>t.makeTensorInfo([x.length],"int32",x)),w=t.makeTensorInfo(g,i.dtype,p);return m.concat([w])}const pse={kernelName:eM,backendName:"cpu",kernelFunc:dse};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gse(n){const{inputs:e,backend:t}=n,{starts:r,limits:s,deltas:i}=e,o=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,[u,f]=qz(o,r.shape,r.dtype,a,s.shape,l,i.shape),h=t.makeTensorInfo([u.length],"int32",u),p=t.makeTensorInfo([f.length],r.dtype,f);return[h,p]}const mse={kernelName:tM,backendName:"cpu",kernelFunc:gse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(n){const{inputs:e,backend:t,attrs:r}=n,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=t.data.get(s.dataId).values,f=t.data.get(i.dataId).values,h=t.data.get(o.dataId).values,p=a.map(x=>t.data.get(x.dataId).values),g=a.map(x=>x.shape),[m,w]=Xz(u,s.shape,f,i.shape,i.dtype,h,o.shape,p,g,l);return t.makeTensorInfo(m,i.dtype,w)}const wse={kernelName:nM,backendName:"cpu",kernelFunc:yse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xse(n){const{backend:e,attrs:t}=n,{start:r,stop:s,dtype:i,step:o}=t,a=Qz(r,s,o,i);return e.makeTensorInfo([a.length],i,a)}const bse={kernelName:nA,backendName:"cpu",kernelFunc:xse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vse=gn(q0,n=>1/n),Sse={kernelName:q0,backendName:"cpu",kernelFunc:vse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cse(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;dt(s,"resizeBilinear");const l=vt(s.shape),[u,f]=a,[h,p,g,m]=s.shape,w=t.data.get(s.dataId).values,x=new Float32Array(De([h,u,f,m])),b=[i&&u>1?p-1:p,i&&f>1?g-1:g],C=[i&&u>1?u-1:u,i&&f>1?f-1:f];let $=0;const k=b[0]/C[0],N=b[1]/C[1];for(let _=0;_<h;_++)for(let U=0;U<u;U++){let O;o?O=k*(U+.5)-.5:O=k*U;const L=Math.max(0,Math.floor(O)),T=O-L,I=Math.min(p-1,Math.ceil(O)),v=_*l[0]+L*l[1],A=_*l[0]+I*l[1];for(let M=0;M<f;M++){let D;o?D=N*(M+.5)-.5:D=N*M;const B=Math.max(0,Math.floor(D)),j=D-B,W=Math.min(g-1,Math.ceil(D)),P=v+B*l[2],E=A+B*l[2],R=v+W*l[2],H=A+W*l[2];for(let K=0;K<m;K++){const Q=w[P+K],J=w[E+K],ie=w[R+K],ce=w[H+K],ge=Q+(ie-Q)*j,be=J+(ce-J)*j,Ae=ge+(be-ge)*T;x[$++]=Ae}}}return t.makeTensorInfo([h,u,f,m],"float32",x)}const kse={kernelName:tv,backendName:"cpu",kernelFunc:Cse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ise(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:o}=r;dt([i,s],"resizeBilinearGrad");const a=vt(s.shape),[l,u,f,h]=s.shape,[,p,g]=i.shape,m=new Float32Array(l*u*f*h),w=[o&&p>1?u-1:u,o&&g>1?f-1:f],x=[o&&p>1?p-1:p,o&&g>1?g-1:g],b=w[0]/x[0],C=w[1]/x[1],$=t.data.get(i.dataId).values;let k=0;for(let N=0;N<l;N++){const _=N*a[0];for(let U=0;U<p;U++){const O=U*b,L=Math.floor(O),T=Math.min(Math.ceil(O),u-1),I=_+L*a[1],v=_+T*a[1],A=O-L,M=1-A;for(let D=0;D<g;D++){const B=D*C,j=Math.floor(B),W=Math.min(Math.ceil(B),f-1),P=B-j,E=1-P,R=I+j*a[2],H=I+W*a[2],K=v+j*a[2],Q=v+W*a[2],J=M*E,ie=M*P,ce=A*E,ge=A*P;for(let be=0;be<h;be++){const Ae=$[k++];m[R+be]+=Ae*J,m[H+be]+=Ae*ie,m[K+be]+=Ae*ce,m[Q+be]+=Ae*ge}}}}return t.makeTensorInfo([l,f,u,h],"float32",m)}const Ese={kernelName:iA,backendName:"cpu",kernelFunc:Ise};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ase(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;dt(s,"resizeNearestNeighbor");const l=vt(s.shape),[u,f]=a,[h,p,g,m]=s.shape,w=t.data.get(s.dataId).values,x=new Float32Array(h*u*f*m),b=[i&&u>1?p-1:p,i&&f>1?g-1:g],C=[i&&u>1?u-1:u,i&&f>1?f-1:f],$=b[0]/C[0],k=b[1]/C[1];let N=0;for(let _=0;_<h;_++){const U=_*l[0];for(let O=0;O<u;O++){const L=o?$*(O+.5):$*O;let T=Math.min(p-1,i?Math.round(L):Math.floor(L));o&&(T=Math.max(0,T));const I=U+T*l[1];for(let v=0;v<f;v++){const A=o?k*(v+.5):k*v;let M=Math.min(g-1,i?Math.round(A):Math.floor(A));o&&(M=Math.max(0,M));const D=I+M*l[2];for(let B=0;B<m;B++){const j=w[D+B];x[N++]=j}}}}return t.makeTensorInfo([h,u,f,m],s.dtype,x)}const Tse={kernelName:ev,backendName:"cpu",kernelFunc:Ase};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nse(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:o}=r;dt([i,s],"resizeNearestNeighborGrad");const a=vt(s.shape),l=vt(i.shape),[u,f,h,p]=s.shape,[,g,m]=i.shape,w=new Float32Array(u*f*h*p),x=t.data.get(i.dataId).values,b=[o&&g>1?f-1:f,o&&m>1?h-1:h],C=[o&&g>1?g-1:g,o&&m>1?m-1:m],$=b[0]/C[0],k=b[1]/C[1],N=1/$,_=1/k,U=Math.ceil(N)*2+2,O=Math.ceil(_)*2+2;for(let L=0;L<u;L++){const T=L*a[0];for(let I=0;I<f;I++){const v=T+I*a[1],A=Math.floor(I*N),M=Math.floor(A-U/2);for(let D=0;D<h;D++){const B=v+D*a[2],j=Math.floor(D*_),W=Math.floor(j-O/2);for(let P=0;P<p;P++){let E=0;for(let R=0;R<U;R++){const H=R+M;if(H<0||H>=g)continue;const K=T+H*l[1],Q=H*$,J=Math.min(f-1,o?Math.round(Q):Math.floor(Q));if(I===J)for(let ie=0;ie<O;ie++){const ce=ie+W;if(ce<0||ce>=m)continue;const ge=K+ce*l[2],be=ce*k,Ae=Math.min(h-1,o?Math.round(be):Math.floor(be));D===Ae&&(E+=x[ge+P])}}w[B+P]=E}}}}return t.makeTensorInfo(s.shape,s.dtype,w)}const $se={kernelName:sA,backendName:"cpu",kernelFunc:Nse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rse(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dims:i}=r;dt(s,"reverse");const o=s.shape.length,a=zt(i,s.shape);if(o===0)return Qa({inputs:{x:s},backend:t});const l=new es(s.shape,s.dtype),u=t.bufferSync(s);for(let f=0;f<l.size;f++){const h=l.indexToLoc(f),p=h.slice();a.forEach(g=>p[g]=s.shape[g]-1-p[g]),l.set(u.get(...p),...h)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const Ose={kernelName:nv,backendName:"cpu",kernelFunc:Rse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dse={kernelName:hA,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:s,fillValue:i,center:o}=e,a=t,l=hs(r.dtype,De(r.shape)),[u,f,h,p]=r.shape,[g,m]=tT(o,f,h),w=255,x=Math.sin(s),b=Math.cos(s),C=a.data.get(r.dataId).values;for(let k=0;k<u;k++){const N=k*h*f*p;for(let _=0;_<f;_++){const U=_*(h*p);for(let O=0;O<h;O++){const L=O*p;for(let T=0;T<p;T++){const I=[u,_,O,T],v=I[2],A=I[1];let M=(v-g)*b-(A-m)*x,D=(v-g)*x+(A-m)*b;M=Math.round(M+g),D=Math.round(D+m);let B=i;if(typeof i!="number"&&(T===3?B=w:B=i[T]),M>=0&&M<h&&D>=0&&D<f){const W=D*(h*p),P=M*p,E=N+W+P+T;B=C[E]}const j=N+U+L+T;l[j]=B}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _se=gn(Y0,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),Pse={kernelName:Y0,backendName:"cpu",kernelFunc:_se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fse(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:f,outputSize:h}=dh(i,s,o),p=!0,g=t.bufferSync(s),m=t.bufferSync(i),w=nf(g,m,o,h,u,l,a,f,0,p);return t.makeTensorInfo(o,w.dtype,w.values)}const Mse={kernelName:rM,backendName:"cpu",kernelFunc:Fse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lse(n,e){let t=0,r=n.length,s=0;for(;t<r;)s=Math.floor((t+r)/2),n[s]<e?t=s+1:r=s;return r}function Bse(n,e){let t=0,r=n.length,s=0;for(;t<r;)s=Math.floor((t+r)/2),n[s]<=e?t=s+1:r=s;return r}function zse(n,e,t,r,s,i){const o=fr("int32",t*s);for(let a=0;a<t;++a){const l=n.slice(a*r,(a+1)*r),u=a*s;for(let f=0;f<s;++f)o[u+f]=i==="left"?Lse(l,e[f+u]):Bse(l,e[f+u])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Use(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:s,values:i}=e,{side:o}=r,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,u=zse(a,l,s.shape[0],s.shape[1],i.shape[1],o);return t.makeTensorInfo(i.shape,"int32",u)}const Vse={kernelName:iM,backendName:"cpu",kernelFunc:Use};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wse(n){const{inputs:e,backend:t}=n,{condition:r,t:s,e:i}=e;dt([r,s,i],"select");const o=r.shape.length,a=t.data.get(r.dataId).values,l=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,f=xi(s.dtype,i.dtype),h=ds(De(s.shape),f);let p=0;const g=o===0||o>1||s.shape.length===1?1:De(s.shape.slice(1));for(let m=0;m<a.length;m++)for(let w=0;w<g;w++)a[m]===1?h[p++]=l[m]:h[p++]=u[m];return t.makeTensorInfo(s.shape,f,h)}const Gse={kernelName:rv,backendName:"cpu",kernelFunc:Wse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hse=Cv,jse=kv,Kse=gn(Z0,n=>n>=0?jse*n:Hse*(Math.exp(n)-1)),qse={kernelName:Z0,backendName:"cpu",kernelFunc:Kse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xse=gn(ny,n=>n<0?-1:n>0?1:0),Qse={kernelName:ny,backendName:"cpu",kernelFunc:Xse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yse=gn(ey,n=>Math.sin(n)),Jse={kernelName:ey,backendName:"cpu",kernelFunc:Yse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zse=gn(ty,n=>Math.sinh(n)),eie={kernelName:ty,backendName:"cpu",kernelFunc:Zse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tie=11920928955078125e-23,HD=Math.log(tie)+2,nie=gn(sy,n=>{const e=n>-HD,t=n<HD,r=Math.exp(n);let s;return t?s=r:e?s=n:s=Math.log(1+r),s}),rie={kernelName:sy,backendName:"cpu",kernelFunc:nie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,paddings:o}=r;dt([s],"spaceToBatchND");const a=De(i),l=[[0,0]];l.push(...o);for(let _=1+i.length;_<s.shape.length;++_)l.push([0,0]);const u=TU.kernelFunc({inputs:{x:s},backend:t,attrs:{paddings:l,constantValue:0}}),f=yy(u.shape,i,a,!1),h=wy(f.length,i.length,!1),p=xy(u.shape,i,a,!1),w=On({inputs:{x:u},backend:t,attrs:{shape:f}}),C=ti({inputs:{x:w},backend:t,attrs:{perm:h}}),N=On({inputs:{x:C},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(C),N}const iie={kernelName:ov,backendName:"cpu",kernelFunc:sie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oie(n){const{inputs:e,backend:t}=n,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=t.data.get(r.dataId).values,l=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,f=t.data.get(o.dataId).values[0],[h,p,g,m,w]=eU(a,r.shape,r.dtype,l,s.dtype,u,f);return[t.makeTensorInfo(p,r.dtype,h),t.makeTensorInfo([p[0]],s.dtype,g),t.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(x=>Number(x)))),t.makeTensorInfo([w.length],r.dtype,new Int32Array(w))]}const aie={kernelName:oM,backendName:"cpu",kernelFunc:oie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lie(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(t.data.get(s.dataId).values),a=t.data.get(r.dataId).values,l=Array.from(t.data.get(i.dataId).values),[u,f,h]=tU(a,r.shape,r.dtype,o,l);return[t.makeTensorInfo(f,r.dtype,u),t.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const uie={kernelName:aM,backendName:"cpu",kernelFunc:lie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,[u,f]=KT(o,r.shape,r.dtype,a,l,!0);return t.makeTensorInfo(f,r.dtype,u)}const fie={kernelName:lM,backendName:"cpu",kernelFunc:cie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,[u,f]=KT(o,r.shape,r.dtype,a,l);return t.makeTensorInfo(f,r.dtype,u)}const die={kernelName:uM,backendName:"cpu",kernelFunc:hie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:f,strides:h,outputSize:p}=dh(i,s,a),g=!1,m=t.bufferSync(s);let w;switch(i.dtype){case"bool":{const x=t.bufferSync(i),b=!!t.data.get(o.dataId).values[0];w=nf(m,x,a,p,f,u,l,h,b,g);break}case"float32":{const x=t.bufferSync(i),b=t.data.get(o.dataId).values[0];w=nf(m,x,a,p,f,u,l,h,b,g);break}case"int32":{const x=t.bufferSync(i),b=t.data.get(o.dataId).values[0];w=nf(m,x,a,p,f,u,l,h,b,g);break}case"string":{const x=t.bufferSync(i),b=Qu(t.data.get(o.dataId).values[0]);w=nf(m,x,a,p,f,u,l,h,b,g);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return t.makeTensorInfo(a,w.dtype,w.values)}const gie={kernelName:cM,backendName:"cpu",kernelFunc:pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=zt(o,s.shape)[0],l=mT(s,i,a),u=new Array(s.shape.length).fill(0),f=s.shape.slice();return l.map(h=>{const p=[...f];p[a]=h;const g=Zf({inputs:{x:s},backend:t,attrs:{begin:u,size:p}});return u[a]+=h,g})}const yie={kernelName:av,backendName:"cpu",kernelFunc:mie};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wie={kernelName:oA,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,r=e;dt(t,"square");const s=r.data.get(t.dataId).values,i=new Float32Array(s.length);for(let a=0;a<s.length;++a){const l=s[a];i[a]=l*l}return{dataId:r.write(i,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xie=gn(fy,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),bie={kernelName:fy,backendName:"cpu",kernelFunc:xie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:f,newAxisMask:h,shrinkAxisMask:p}=r;dt(s,"stridedSlice");const{finalShapeSparse:g,finalShape:m,isIdentity:w,sliceDim0:x,isSimpleSlice:b,begin:C,end:$,strides:k}=JA(s.shape,i,o,a,l,u,f,h,p);let N;if(w)N=On({inputs:{x:s},backend:t,attrs:{shape:m}});else if(x||b){ee(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const _=XA(C,$,k),U=Zf({inputs:{x:s},backend:t,attrs:{begin:C,size:_}});N=On({inputs:{x:U},backend:t,attrs:{shape:m}}),t.disposeIntermediateTensorInfo(U)}else{const _=t.bufferSync(s),U=sU(g,_,k,C);N=t.makeTensorInfo(m,U.dtype,U.values)}return N}const Sie={kernelName:lA,backendName:"cpu",kernelFunc:vie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cie(n){const{inputs:e,backend:t,attrs:r}=n,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:f,dataSplits:h}=e,p=t.data.get(f.dataId).values,g=t.data.get(h.dataId).values,[m,w]=iU(p,g,s,i,o,a,l,u);return[t.makeTensorInfo([m.length],"string",m),t.makeTensorInfo(h.shape,"int32",w)]}const kie={kernelName:fM,backendName:"cpu",kernelFunc:Cie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iie(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=t.data.get(i.dataId).values,l=t.data.get(o.dataId).values[0],[u,f,h]=oU(a,l,s),p=f.length;return[t.makeTensorInfo([p,2],"int32",u),t.makeTensorInfo([p],"string",f),t.makeTensorInfo([2],"int32",new Int32Array(h))]}const Eie={kernelName:hM,backendName:"cpu",kernelFunc:Iie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=t.data.get(i.dataId).values,a=aU(o,s);return t.makeTensorInfo(i.shape,"int32",a)}const Tie={kernelName:dM,backendName:"cpu",kernelFunc:Aie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nie=gn(ly,n=>Math.tan(n)),$ie={kernelName:ly,backendName:"cpu",kernelFunc:Nie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rie=gn(uy,n=>Math.tanh(n)),Oie={kernelName:uy,backendName:"cpu",kernelFunc:Rie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(n){const{inputs:e,backend:t}=n,{tensor:r,indices:s,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:u,outputSize:f}=dh(i,s,r.shape),h=!1,p=t.bufferSync(s),g=t.bufferSync(i),m=t.bufferSync(r),w=nf(p,g,r.shape,f,l,a,o,u,m,h);return t.makeTensorInfo(r.shape,w.dtype,w.values)}const _ie={kernelName:sM,backendName:"cpu",kernelFunc:Die};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reps:i}=r;dt(s,"tile");const o=uU(t.bufferSync(s),i);return t.makeTensorInfo(o.shape,o.dtype,o.values)}const Fie={kernelName:cy,backendName:"cpu",kernelFunc:Pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{k:i,sorted:o}=r;dt(s,"topk");const a=t.data.get(s.dataId).values,[l,u]=fU(a,s.shape,s.dtype,i,o);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(u.shape,u.dtype,u.values)]}const Lie={kernelName:uA,backendName:"cpu",kernelFunc:Mie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bie(n){const{inputs:e,attrs:t,backend:r}=n,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=t,[f,h,p,g]=s.shape,[m,w]=u??[h,p],x=[f,m,w,g],b=vt(s.shape),C=b[0],$=b[1],k=b[2],N=vt(x),_=N[0],U=N[1],O=N[2],L=hs(s.dtype,De(x));L.fill(l);const T=r.data.get(s.dataId).values,I=r.data.get(i.dataId).values;for(let A=0;A<f;++A){const M=i.shape[0]===1?I:I.subarray(A*8,A*8+8);for(let D=0;D<m;++D)for(let B=0;B<w;++B)for(let j=0;j<g;++j){let W;const P=M[6]*B+M[7]*D+1;if(P===0)continue;const E=(M[0]*B+M[1]*D+M[2])/P,R=(M[3]*B+M[4]*D+M[5])/P,H=jD(E,p,a),K=jD(R,h,a);switch(o){case"nearest":W=Hie(T,h,p,C,$,k,A,K,H,j,l);break;case"bilinear":W=jie(T,h,p,C,$,k,A,K,H,j,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const Q=A*_+D*U+B*O+j;L[Q]=W}return r.makeTensorInfo(x,s.dtype,L)}return{dataId:r.write(L,x,s.dtype),shape:s.shape,dtype:s.dtype}}const zie={kernelName:cA,backendName:"cpu",kernelFunc:Bie};function jD(n,e,t){switch(t){case"reflect":return Uie(n,e);case"wrap":return Vie(n,e);case"nearest":return Gie(n,e);case"constant":default:return Wie(n)}}function Uie(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const r=2*e;t<r&&(t=r*Math.trunc(-t/r)+t),t=t<-e?t+r:-t-1}else if(t>e-1)if(e<=1)t=0;else{const r=2*e;t-=r*Math.trunc(t/r),t>=e&&(t=r-t-1)}return zf(0,t,e-1)}function Vie(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const r=e-1;t+=e*(Math.trunc(-t/r)+1)}else if(t>e-1)if(e<=1)t=0;else{const r=e-1;t-=e*Math.trunc(t/r)}return zf(0,t,e-1)}function Wie(n,e){return n}function Gie(n,e){return zf(0,n,e-1)}function fm(n,e,t,r,s,i,o,a,l,u,f){const h=o*r+a*s+l*i+u;return 0<=a&&a<e&&0<=l&&l<t?n[h]:f}function Hie(n,e,t,r,s,i,o,a,l,u,f){const h=Math.round(a),p=Math.round(l);return fm(n,e,t,r,s,i,o,h,p,u,f)}function jie(n,e,t,r,s,i,o,a,l,u,f){const h=Math.floor(a),p=Math.floor(l),g=h+1,m=p+1,w=(m-l)*fm(n,e,t,r,s,i,o,h,p,u,f)+(l-p)*fm(n,e,t,r,s,i,o,h,m,u,f),x=(m-l)*fm(n,e,t,r,s,i,o,g,p,u,f)+(l-p)*fm(n,e,t,r,s,i,o,g,m,u,f);return(g-a)*w+(a-h)*x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kie(n){const{inputs:e,attrs:t,backend:r}=n,{axis:s}=t,{x:i}=e;dt(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:u}=hU(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const qie={kernelName:fA,backendName:"cpu",kernelFunc:Kie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xie(n){const{inputs:e,backend:t,attrs:r}=n,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s.shape.length,a=s.shape[i],l=new Array(o-1);let u=0;for(let g=0;g<o;g++)g!==i&&(l[u++]=s.shape[g]);const f=new Array(o).fill(0),h=s.shape.slice();h[i]=1;const p=new Array(a);for(let g=0;g<p.length;g++){f[i]=g;const m=Zf({inputs:{x:s},backend:t,attrs:{begin:f,size:h}});p[g]=On({inputs:{x:m},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(m)}return p}const Qie={kernelName:uv,backendName:"cpu",kernelFunc:Xie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,segmentIds:i}=e,{numSegments:o}=r;dt(s,"unsortedSegmentSum");const a=s.shape.length,l=i.shape.length,u=[],f=[],h=a-l;let p=i;for(let m=0;m<h;++m){const w=N1({inputs:{input:p},backend:t,attrs:{dim:m+1}});p=w,f.push(w)}for(let m=0;m<o;++m){const w=lc(m,"int32"),x=t.makeTensorInfo([],"int32",w),b=Az({inputs:{a:x,b:p},backend:t}),C=tc({inputs:{x:b},backend:t,attrs:{dtype:"float32"}}),$=Fv({inputs:{a:C,b:s},backend:t}),k=Ty({inputs:{x:$},backend:t,attrs:{axis:0,keepDims:!1}});u.push(k),f.push(x),f.push(b),f.push(C),f.push($),f.push(k)}const g=AU({inputs:u,backend:t,attrs:{axis:0}});return f.forEach(m=>t.disposeIntermediateTensorInfo(m)),g}const Jie={kernelName:cv,backendName:"cpu",kernelFunc:Yie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zie=[Kee,AZ,Xee,Yee,DZ,Zee,tte,rte,ite,ate,ute,fte,dte,mte,wte,vte,Cte,Ite,Ate,Hee,Nte,Rte,Dte,PZ,Pte,RZ,MZ,Mte,TZ,Bte,Ute,Vte,Gte,jte,qte,Qte,Jte,ene,nne,sne,one,lne,cne,hne,dne,gne,yne,xne,bne,vne,Sne,kne,Ane,Lee,Nne,LZ,Mne,BZ,Lne,UZ,Gne,Hne,Kne,WZ,HZ,Xne,Yne,Zne,tre,KZ,XZ,NZ,rre,zte,ire,are,ure,Bee,YZ,ZZ,fre,tee,dre,mre,wre,vre,Cre,Ire,Ere,ree,Tre,$re,Ore,_re,Fre,Lre,zre,iee,Vre,Hre,qre,aee,uee,Yre,ese,rse,fee,ise,ase,lse,TU,hse,Uee,pee,pse,mse,wse,bse,$Z,wE,Sse,Vee,Wee,Gee,kse,Ese,Tse,$se,Ose,Dse,Pse,See,Mse,Vse,Gse,qse,kee,Qse,Jse,eie,Iee,jre,rie,iie,aie,uie,fie,die,gie,yie,Tee,wie,$ee,Oee,bie,Sie,kie,Eie,Tie,Fee,Ine,$ie,Oie,_ie,Fie,Lie,zie,hee,qie,Qie,Jie,ose];for(const n of Zie)gM(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qc={},Zw={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function eoe(n,e){Qc[n]=e}function Yo(n,e){if(!(n in Qc)||e!=null){const r=noe(n,e);if(r!==null)Qc[n]=r;else return console.log("Could not get context for WebGL version",n),null}const t=Qc[n];return t==null||t.isContextLost()?(delete Qc[n],Yo(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Qc[n])}function toe(n){if(!Te().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function noe(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??toe(n);return t.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Qc[n]},!1),Te().getBool("SOFTWARE_WEBGL_ENABLED")&&(Zw.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Zw)||t.getContext("experimental-webgl",Zw):t.getContext("webgl2",Zw)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Bm;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(Bm||(Bm={}));var Mi;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(Mi||(Mi={}));var Jr;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Jr||(Jr={}));function Ny(n,e){return[e,n]}function roe(n,e){return n*e}function ex(n){const e=De(n),t=Math.ceil(e/4);return VI(t)}function Zp(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function soe(n,e){const[t,r]=Zp(n,e);return t*r*4}function JT(n,e){const t=n;let r,s,i,o,a,l,u,f,h,p;return Te().getNumber("WEBGL_VERSION")===2?(r=t.R32F,s=t.R16F,i=t.RGBA16F,o=t.RGBA32F,a=t.RED,u=4,f=1,h=t.HALF_FLOAT,p=t.FLOAT,l=t.RGBA8):(r=n.RGBA,s=n.RGBA,i=n.RGBA,o=t.RGBA,a=n.RGBA,u=4,f=4,h=e!=null?e.HALF_FLOAT_OES:null,p=n.FLOAT,l=n.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:f,textureTypeHalfFloat:h,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function st(n,e){const t=e();return Te().getBool("DEBUG")&&ioe(n),t}function ioe(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+uoe(n,e))}const ooe=596e-10,aoe=65504;function loe(n){return!!(Te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||ooe<Math.abs(n)&&Math.abs(n)<aoe)}function uoe(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function tx(n,e){return Hl(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function coe(n,e){const t=Hl(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(st(n,()=>n.shaderSource(t,e)),st(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function foe(n,e){const t=Hl(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(st(n,()=>n.shaderSource(t,e)),st(n,()=>n.compileShader(t)),Te().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw NU(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const hoe=/ERROR: [0-9]+:([0-9]+):/g;function NU(n,e){const t=hoe.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const r=+t[1],s=n.split(`
`),i=s.length.toString().length+2,o=s.map((h,p)=>Sd((p+1).toString(),i)+h);let a=0;for(let h=0;h<o.length;h++)a=Math.max(o[h].length,a);const l=o.slice(0,r-1),u=o.slice(r-1,r),f=o.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Sd(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join(`
`))}function doe(n){return Hl(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function poe(n,e){if(st(n,()=>n.linkProgram(e)),!Te().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function xk(n,e){if(st(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function goe(n,e){const t=Hl(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return st(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),st(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function moe(n,e){const t=Hl(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return st(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),st(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function yoe(n){return Hl(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function woe(n,e){const t=Te().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const r=`[${n}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t){const r=`[${n}x${e}]`,s=`[${t}x${t}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function xoe(n){return Hl(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function KD(n,e,t,r,s,i,o){const a=n.getAttribLocation(e,t);return a===-1?!1:(st(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),st(n,()=>n.vertexAttribPointer(a,s,n.FLOAT,!1,i,o)),st(n,()=>n.enableVertexAttribArray(a)),!0)}function boe(n,e,t){Ioe(n,t),st(n,()=>n.activeTexture(n.TEXTURE0+t)),st(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function voe(n,e,t){return Hl(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function Soe(n,e,t){return n.getUniformLocation(e,t)}function Coe(n,e,t,r){st(n,()=>boe(n,e,r)),st(n,()=>n.uniform1i(t,r))}function bk(n,e,t){st(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),st(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function qD(n,e){st(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),st(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function nx(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+koe(n,e))}function koe(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Hl(n,e,t){const r=st(n,()=>e());if(r==null)throw new Error(t);return r}function Ioe(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t){const s=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${s}.`)}}function Np(n,e=2){return De(n.slice(0,n.length-e))}function $p(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function rx(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Np(n),...$p(n)]),e}function Eoe(n,e=!1){let t=Te().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Te().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Te().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=t/2),e&&(t=t*2,r=r*2,n=n.map((a,l)=>l>=n.length-2?v2(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=ac(n).newShape);let s=De(n),i=null;n.length<=1&&s<=t?i=[1,s]:n.length===2&&n[0]<=t&&n[1]<=t?i=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?i=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?i=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?i=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(i=[n[0],n[1]*n[2]*n[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=Np(n);let l=2,u=2;n.length&&([l,u]=$p(n)),s=a*(l/2)*(u/2),i=VI(s).map(f=>f*2)}else i=VI(s);return i}function sx(n){return n%2===0}function R1(n,e){if(n=n.slice(-2),e=e.slice(-2),an(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],r=e[e.length-1];if(t===r||sx(t)&&sx(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&sx(n[0])&&sx(e[0])}let vk,Sk;function Aoe(n){if(vk==null){const e=Yo(n);vk=e.getParameter(e.MAX_TEXTURE_SIZE)}return vk}function Toe(n){if(Sk==null){const e=Yo(n);Sk=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Sk)}function Noe(n){if(n===0)return 0;let e;const t=Yo(n);return po(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:po(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function po(n,e){return n.getExtension(e)!=null}function XD(n){try{if(Yo(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function $oe(n){if(n===0)return!1;const e=Yo(n);if(n===1){if(!po(e,"OES_texture_float"))return!1}else if(!po(e,"EXT_color_buffer_float"))return!1;return bE(e)}function Roe(n){if(n===0)return!1;const e=Yo(n);if(n===1){if(!po(e,"OES_texture_float")||!po(e,"WEBGL_color_buffer_float"))return!1}else{if(po(e,"EXT_color_buffer_float"))return bE(e);const r="EXT_color_buffer_half_float";if(po(e,r)){const s=e.getExtension(r);return Ooe(e,s)}return!1}return bE(e)}function bE(n){const e=JT(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(i),o}function Ooe(n,e){const t=JT(n,e),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(o),a}function Doe(n){return n!==2?!1:Yo(n).fenceSync!=null}function $y(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&ee(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gt=Te();gt.registerFlag("HAS_WEBGL",()=>gt.getNumber("WEBGL_VERSION")>0);gt.registerFlag("WEBGL_VERSION",()=>XD(2)?2:XD(1)?1:0);gt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);gt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>gt.get("WEBGL_VERSION")===2);gt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);gt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);gt.registerFlag("WEBGL_PACK",()=>gt.getBool("HAS_WEBGL"));gt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_CLIP",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_REDUCE",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_LAZILY_UNPACK",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_CONV_IM2COL",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>gt.getBool("WEBGL_PACK"));gt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Aoe(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Toe(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=gt.getNumber("WEBGL_VERSION");return n===0?0:Noe(n)});gt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>gt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!TM());gt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>$oe(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>gt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:gt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));gt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Roe(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Doe(gt.getNumber("WEBGL_VERSION")));gt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>gt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);gt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});gt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>TM()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});gt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);gt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);gt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);gt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);gt.registerFlag("WEBGL_EXP_CONV",()=>!1);gt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>gt.getBool("IS_TEST"));gt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);gt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);gt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);gt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fs(){let n,e,t,r,s,i,o,a,l,u;return Te().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",s="texture",i="outputColor",o="out vec4 outputColor;",a=Te().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",s="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:s,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mh(n,e,t="index"){const r=vt(e);return r.map((s,i)=>{const o=`int ${n[i]} = ${t} / ${s}`,a=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${s}`:`index -= ${n[i]} * ${s}`;return`${o}; ${a};`}).join("")}function Mv(n,e,t="index"){const r=vt(e);return r.map((s,i)=>{const o=`int ${n[i]} = ${t} / outShapeStrides[${i}]`,a=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * outShapeStrides[${i}]`:`index -= ${n[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function _oe(n,e){const t=n.length,r=n.map(i=>`${e}[${i}]`),s=new Array(t-1);s[t-2]=r[t-1];for(let i=t-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function Poe(n,e,t="index"){const r=n.map((i,o)=>o),s=_oe(r,e);return s.map((i,o)=>{const a=`int ${n[o]} = ${t} / ${s[o]}`,l=o===s.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * ${s[o]}`:`index -= ${n[o]} * ${s[o]}`;return`${a}; ${l};`}).join("")}function ZT(n){const e=vt(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function eN(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const $U=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:RU}=wX;function Foe(n,e,t){const r=[];if(n.forEach(g=>{const m=De(g.shapeInfo.logicalShape);if(g.shapeInfo.isUniform?r.push(`uniform float ${g.name}${m>1?`[${m}]`:""};`):(r.push(`uniform sampler2D ${g.name};`),r.push(`uniform int offset${g.name};`)),t.enableShapeUniforms){const{uniformShape:w}=tN(t.packedInputs,g.shapeInfo.logicalShape,g.shapeInfo.texShape);switch(w.length){case 1:r.push(`uniform int ${g.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${g.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${g.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${g.name}Shape;`);break}r.push(`uniform ivec2 ${g.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(g=>{r.push(`uniform ${g.type} ${g.name}${g.arrayIndex?`[${g.arrayIndex}]`:""};`)});const s=r.join(`
`),i=n.map(g=>Moe(g,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),o=e.texShape,a=Fs(),l=zoe(a);let u,f,h=Woe(a);return e.isPacked?(u=Loe(e.logicalShape,o,t.enableShapeUniforms),f=Voe(a)):(u=Boe(e.logicalShape,o,t.enableShapeUniforms),f=Uoe(a)),t.packedInputs&&(h+=Koe),[h,l,f,s,u,i,t.userCode].join(`
`)}function eg(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return iae(n,e);case 1:return aae(n,e);case 2:return uae(n,e);case 3:return fae(n,e);case 4:return dae(n,e);case 5:return pae(n);case 6:return gae(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function OU(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return sae(n);case 1:return oae(n,e);case 2:return lae(n,e);case 3:return cae(n,e);default:return hae(n,e)}}function Moe(n,e,t=!1,r){let s="";t?s+=OU(n,r):s+=eg(n,r);const i=n.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(t?s+=mae(n,e):s+=yae(n,e)),s}function Loe(n,e,t){switch(n.length){case 0:return DU();case 1:return qoe(n,e,t);case 2:return nae(n,e,t);case 3:return Qoe(n,e,t);default:return Joe(n,e,t)}}function Boe(n,e,t){switch(n.length){case 0:return DU();case 1:return Xoe(n,e,t);case 2:return rae(n,e,t);case 3:return Yoe(n,e,t);case 4:return Zoe(n,e,t);case 5:return eae(n,e);case 6:return tae(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function zoe(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function Uoe(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function Voe(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function Woe(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Goe}
    ${Hoe}
    ${joe}
  `}const Goe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Hoe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,joe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Koe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function DU(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function qoe(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Xoe(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Qoe(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[2]/2),i=s*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function Yoe(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Mv(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const r=mh(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Joe(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[n.length-1]/2),i=s*Math.ceil(n[n.length-2]/2);let o=i,a="",l="b, r, c";for(let u=2;u<n.length-1;u++)o*=n[n.length-u-1],a=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+a,l=`b${u}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${n.length}(${l});
    }
  `}function Zoe(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Mv(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const r=mh(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function eae(n,e){const t=mh(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function tae(n,e){const t=mh(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function nae(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(an(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function rae(n,e,t){return an(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function yh(n){return`offset${n}`}function sae(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Fs();return`
    vec4 ${t}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function iae(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${r}() {return ${t};}`;const[s,i]=n.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=yh(t);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${o});
      return sampleTexture(${t}, uv);
    }
  `;const[a,l]=n.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${t}, uv);
    }
  `}function oae(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=n.shapeInfo.texShape,i=Fs();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${t}, uv);
    }
  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${t}, uv);
    }
  `}function aae(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${tg(n)}
      }
    `;const s=n.shapeInfo.texShape,i=s[0],o=s[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=yh(t);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${t}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${a});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${t}, uv);
    }
  `}function lae(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,o=i[0],a=i[1],l=Fs();if(i!=null&&an(t,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],f=Math.ceil(t[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${f}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function uae(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape;if(i!=null&&an(t,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const p=i[0],g=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${g}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=ac(t),l=o;if(l.length<t.length){const p=ng(n,l),g=["row","col"];return`
      ${eg(p,e)}
      float ${s}(int row, int col) {
        return ${s}(${rg(g,a)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${tg(n)}
      }
    `;const u=i[0],f=i[1],h=yh(r);return f===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${f}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${h};
    vec2 uv = uvFromFlat(${u}, ${f}, index);
    return sampleTexture(${r}, uv);
  }
`}function cae(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(t[0]===1){const p=t.slice(1),g=[1,2],m=ng(n,p),w=["b","row","col"];return`
        ${OU(m,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${rg(w,g)});
        }
      `}const a=Fs();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=o[0],u=o[1],f=Math.ceil(t[2]/2),h=f*Math.ceil(t[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${h}, ${f}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function fae(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[1]*t[2],o=t[2],{newShape:a,keptDims:l}=ac(t),u=a;if(u.length<t.length){const w=ng(n,u),x=["row","col","depth"];return`
        ${eg(w,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${rg(x,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${tg(n)}
      }
    `;const f=n.shapeInfo.texShape,h=f[0],p=f[1],g=n.shapeInfo.flatOffset;if(p===i&&g==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${h}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===o&&g==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `;const m=yh(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${m};
        vec2 uv = uvFromFlat(${h}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function hae(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=Fs();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${t}, uv);
    }
  `;const i=n.shapeInfo.logicalShape,o=i.length,a=n.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],f=l[1],h=Math.ceil(i[o-1]/2);let p=h*Math.ceil(i[o-2]/2),g="int b, int row, int col",m=`b * ${p} + (row / 2) * ${h} + (col / 2)`;for(let w=2;w<o-1;w++)g=`int b${w}, `+g,p*=i[o-w-1],m=`b${w} * ${p} + `+m;return`
    vec4 ${r}(${g}) {
      int index = ${m};
      int texR = index / ${f};
      int texC = index - texR * ${f};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}, ${u});
      return ${s.texture2D}(${t}, uv);
    }
  `}function dae(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[3],o=t[2]*i,a=t[1]*o,{newShape:l,keptDims:u}=ac(t);if(l.length<t.length){const C=ng(n,l),$=["row","col","depth","depth2"];return`
      ${eg(C,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${rg($,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${tg(n)}
      }
    `;const f=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,p=h[0],g=h[1],m=`int stride2 = ${r}Shape[3];`,w=`int stride1 = ${r}Shape[2] * stride2;`,x=`int stride0 = ${r}Shape[1] * stride1;`;if(g===a&&f==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${m}
        ${w}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(g===i&&f==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;const b=yh(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${w}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${b});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${p}, ${g}, index + ${b});
      return sampleTexture(${r}, uv);
    }
  `}function pae(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=e[4],i=e[3]*s,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:u}=ac(e);if(l.length<e.length){const w=ng(n,l),x=["row","col","depth","depth2","depth3"];return`
      ${eg(w)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${rg(x,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${s})) +
          depth3;
        ${tg(n)}
      }
    `;const f=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,p=h[0],g=h[1];if(g===a&&f==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(g===s&&f==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;const m=yh(t);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${s} + depth3 + ${m};
      vec2 uv = uvFromFlat(${p}, ${g}, index);
      return sampleTexture(${t}, uv);
    }
  `}function gae(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:s,keptDims:i}=ac(e);if(s.length<e.length){const x=ng(n,s),b=["row","col","depth","depth2","depth3","depth4"];return`
      ${eg(x)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${rg(b,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,u=e[2]*l,f=e[1]*u;if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${f}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${tg(n)}
      }
    `;const h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],m=p[1];if(m===f&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(m===o&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;const w=yh(t);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${f} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${w};
      vec2 uv = uvFromFlat(${g}, ${m}, index);
      return sampleTexture(${t}, uv);
    }
  `}function tg(n){const e=n.name,t=De(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function mae(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",i=n.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=RU(n.shapeInfo.logicalShape,e.logicalShape),l=xn(o),u=o-i;let f;const h=["x","y","z","w","u","v"];i===0?f="":o<2&&a.length>=1?f="coords = 0;":f=a.map(C=>`coords.${h[C+u]} = 0;`).join(`
`);let p="";o<2&&i>0?p="coords":p=n.shapeInfo.logicalShape.map((C,$)=>`coords.${h[$+u]}`).join(", ");let g="return outputValue;";const w=De(n.shapeInfo.logicalShape)===1,b=De(e.logicalShape)===1;if(i===1&&!w&&!b)g=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(w&&!b)o===1?g=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:g=`
        return vec4(outputValue.x);
      `;else if(a.length){const C=i-2,$=i-1;a.indexOf(C)>-1&&a.indexOf($)>-1?g="return vec4(outputValue.x);":a.indexOf(C)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf($)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${f}
      vec4 outputValue = get${r}(${p});
      ${g}
    }
  `}function yae(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,o=n.shapeInfo.texShape,a=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&a===l&&n.shapeInfo.flatOffset==null&&an(o,i))return`
      float ${s}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const u=xn(l),f=RU(n.shapeInfo.logicalShape,e.logicalShape),h=l-a;let p;const g=["x","y","z","w","u","v"];a===0?p="":l<2&&f.length>=1?p="coords = 0;":p=f.map(w=>`coords.${g[w+h]} = 0;`).join(`
`);let m="";return l<2&&a>0?m="coords":m=n.shapeInfo.logicalShape.map((w,x)=>`coords.${g[x+h]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${p}
      return get${r}(${m});
    }
  `}function xn(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function tN(n,e,t){const{newShape:r,keptDims:s}=ac(e),i=e.length,o=n&&i===3&&e[0]===1,a=o?e.slice(1):r,l=!n&&i>1&&!an(e,t)&&r.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function ng(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function rg(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wae(n,e,t,r){const s=t.map((f,h)=>{const p={logicalShape:f.shape,texShape:f.isUniform?null:f.texData.texShape,isUniform:f.isUniform,isPacked:f.isUniform?!1:f.texData.isPacked,flatOffset:null};return f.texData!=null&&f.texData.slice!=null&&f.texData.slice.flatOffset>0&&(p.flatOffset=f.texData.slice.flatOffset),{name:e.variableNames[h],shapeInfo:p}}),i=s.map(f=>f.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=Foe(s,o,e),l=foe(n.gl,a),u=n.createProgram(l);return Te().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:o},_U(n,e,u)))}function _U(n,e,t){const r=[],s=[];let i,o,a,l=null,u=null;u=n.getUniformLocation(t,"NAN",!1),Te().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(t,"INFINITY",!1));const f=!1;for(const h of e.variableNames){const p={name:h,uniform:n.getUniformLocation(t,h,f),offset:n.getUniformLocation(t,`offset${h}`,f)};e.enableShapeUniforms&&(p.shape=n.getUniformLocation(t,`${h}Shape`,f),p.texShape=n.getUniformLocation(t,`${h}TexShape`,f)),r.push(p)}if(e.enableShapeUniforms&&(i=n.getUniformLocation(t,"outShape",f),a=n.getUniformLocation(t,"outShapeStrides",f),o=n.getUniformLocation(t,"outTexShape",f)),e.customUniforms)for(const h of e.customUniforms)s.push(n.getUniformLocation(t,h.name,f));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function QD(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,r)=>{const s=t.logicalShape,i=e[r],o=i.shape;if(!an(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(t.isUniform&&i.isUniform)return;const a=t.texShape,l=i.isUniform?null:i.texData.texShape;if(!an(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function xae(n,e,t,r,s){e.program.enableShapeUniforms||(QD(e.inShapeInfos,t),QD([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):n.setOutputMatrixTexture(i.texture,o[0],o[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),Te().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<t.length;++l){const u=t[l],{uniform:f,offset:h,shape:p,texShape:g}=e.variablesLocations[l];if(p){const{uniformShape:m}=tN(e.program.packedInputs,u.shape,u.texData.texShape);switch(m.length){case 1:n.gl.uniform1iv(p,new Int32Array(m));break;case 2:n.gl.uniform2iv(p,new Int32Array(m));break;case 3:n.gl.uniform3iv(p,new Int32Array(m));break;case 4:n.gl.uniform4iv(p,new Int32Array(m));break}}if(g&&n.gl.uniform2i(g,u.texData.texShape[0],u.texData.texShape[1]),f!=null){if(u.isUniform){if(De(u.shape)<2)n.gl.uniform1f(f,u.uniformValues[0]);else{let m=u.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),n.gl.uniform1fv(f,m)}continue}u.texData.slice!=null&&h!=null&&n.gl.uniform1i(h,u.texData.slice.flatOffset),n.setInputMatrixTexture(u.texData.texture.texture,f,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:n.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:n.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:n.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:n.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=vt(r.shape);switch(r.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],f=e.customUniformLocations[l],h=s[l];if(u.type==="float")n.gl.uniform1fv(f,h);else if(u.type==="vec2")n.gl.uniform2fv(f,h);else if(u.type==="vec3")n.gl.uniform3fv(f,h);else if(u.type==="vec4")n.gl.uniform4fv(f,h);else if(u.type==="int")n.gl.uniform1iv(f,h);else if(u.type==="ivec2")n.gl.uniform2iv(f,h);else if(u.type==="ivec3")n.gl.uniform3iv(f,h);else if(u.type==="ivec4")n.gl.uniform4iv(f,h);else throw Error(`uniform type ${u.type} is not supported yet.`)}n.executeProgram()}function bae(n,e,t){let r="";e.concat(t).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:u,uniformShape:f,keptDims:h}=tN(n.packedInputs,o.shape,l);let p="",g="",m="";if(f.length===1&&n.packedInputs){const N=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${N[0]>1}_${N[1]>1}`}else if(f.length===2&&!n.packedInputs)g=`${f[0]>1}_${f[1]>1}`;else if(f.length>2&&!n.packedInputs){const N=vt(f);m=`${N[0]===l[1]}_${N[N.length-1]===l[1]}`}const w=o.shape.length,x=f.length===2&&an(o.shape,l),b=De(o.shape)===1,C=Sp(o.shape,t.shape),$=!n.packedInputs&&w===t.shape.length&&an(l,t.texData.texShape),k=n.packedInputs||f.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${w}_${$}_${u?h:""}_${f.length}_${b}_${C}_${x}_${p}_${g}_${m}_${k}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${l}_${a}`}});const s=n.userCode;let i=n.constructor.name;return i+="_"+r+"_"+s+`${Te().getNumber("WEBGL_VERSION")}`,i}function ys(n){return Te().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vae{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Bm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Fs();this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Mv(["r","c","d"],e):mh(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Bm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Fs();this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Mv(["r","c","d"],e):mh(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cae{constructor(e){this.variableNames=["A"],this.outTexUsage=Mi.DOWNLOAD;const t=Fs();this.outputShape=e,this.userCode=`
      ${$U}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Mi.DOWNLOAD;const t=Fs();this.outputShape=e,this.userCode=`
      ${$U}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iae={R:0,G:1,B:2,A:3};class YD{constructor(e,t=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Fs();this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const l=r[a];o+=`
          if(offset == ${a}) {
            result = values[${Iae[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?eN():ZT(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${o}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eae{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Fs();this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);let s="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?eN():ZT(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aae(n){const e=Fs(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return coe(n,t)}function Tae(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return goe(n,e)}function Nae(n){const e=new Uint16Array([0,1,2,2,1,3]);return moe(n,e)}function Ry(n,e,t,r,s,i){woe(e,t);const o=yoe(n),a=n.TEXTURE_2D;return st(n,()=>n.bindTexture(a,o)),st(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),st(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),st(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),st(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),Te().getNumber("WEBGL_VERSION")===1?st(n,()=>n.texImage2D(a,0,r,e,t,0,s,i,null)):st(n,()=>n.texStorage2D(a,1,r,e,t)),st(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:o,texShape:[t,e]}}function PU(n){return n.internalFormatFloat}function $ae(n,e,t,r){const[s,i]=Ny(e,t);return Ry(n,s,i,PU(r),r.textureFormatFloat,n.FLOAT)}function FU(n){return n.internalFormatHalfFloat}function Rae(n,e,t,r){const[s,i]=Ny(e,t);return Ry(n,s,i,FU(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function MU(n){return n.downloadTextureFormat}function Oae(n,e,t,r){const[s,i]=Ny(e,t);return Ry(n,s,i,MU(r),n.RGBA,n.UNSIGNED_BYTE)}function LU(n){return n.internalFormatPackedFloat}function Dae(n,e,t,r){const[s,i]=Zp(e,t);return Ry(n,s,i,LU(r),n.RGBA,n.FLOAT)}function BU(n){return n.internalFormatPackedHalfFloat}function _ae(n,e,t,r){const[s,i]=Zp(e,t);return Ry(n,s,i,BU(r),n.RGBA,r.textureTypeHalfFloat)}function Pae(n,e,t){return st(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),KD(n,e,"clipSpacePos",t,3,20,0)&&KD(n,e,"uv",t,2,20,12)}function Fae(n,e,t,r,s,i){st(n,()=>n.bindTexture(n.TEXTURE_2D,e));let o,a,l;s instanceof Uint8Array?(o=new Uint8Array(t*r*4),a=n.UNSIGNED_BYTE,l=n.RGBA):(o=new Float32Array(t*r*4),a=n.FLOAT,l=i.internalFormatPackedFloat),o.set(s),Te().getNumber("WEBGL_VERSION")===2?st(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,r,n.RGBA,a,o)):st(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,r,0,n.RGBA,a,o)),st(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Mae(n,e,t){st(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?Te().getNumber("WEBGL_VERSION")===2?st(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):st(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):Te().getNumber("WEBGL_VERSION")===2?st(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):st(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),st(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Lae(n,e,t,r){const s=n.createBuffer();st(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,s));const a=4*4*e*t;return st(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),st(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),st(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),s}function Bae(n,e,t){const r=n,s=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function zae(n,e,t,r){const[s,i]=Ny(e,t),o=4,a=new Uint8Array(roe(e*t,o));return st(n,()=>n.readPixels(0,0,s,i,r.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Uae(n,e,t,r,s,i,o,a){const l=n,u=new Float32Array(soe(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function Vae(n,e,t){const r=new Float32Array(e*t*4);return st(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ck{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=Te().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,eoe(t,e)):this.gl=Yo(t),e=this.gl,Te().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>st(i,()=>i.createVertexArray()),this.bindVertexArray=o=>st(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>st(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>st(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>st(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>st(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>st(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>st(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Te().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=tx(this.gl,i),po(this.gl,o))this.textureHalfFloatExtension=tx(this.gl,o);else if(Te().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),po(this.gl,s))this.colorBufferHalfFloatExtension=tx(this.gl,s);else if(Te().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",po(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(po(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Tae(this.gl),this.indexBuffer=Nae(this.gl),this.framebuffer=xoe(this.gl),this.textureConfig=JT(this.gl,this.textureHalfFloatExtension)}get debug(){return Te().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;st(e,()=>e.finish()),st(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),st(e,()=>e.deleteFramebuffer(this.framebuffer)),st(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),st(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),st(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),$ae(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),Rae(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),Oae(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),Mae(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,r,s){this.throwIfDisposed(),Fae(this.gl,e,t,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),_ae(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),Dae(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(qD(this.gl,this.framebuffer),this.outputTexture=null),st(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,r){return this.downloadMatrixDriver(e,()=>zae(this.gl,t,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,r,s,i,o){return Uae(this.gl,e,t,r,s,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return Bae(this.gl,e,t)}createBufferFromTexture(e,t,r){this.bindTextureToFrameBuffer(e);const s=Lae(this.gl,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r;if(Te().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=s.clientWaitSync(i,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},t=i}else Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(t,Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:t,isFencePassed:r}}downloadMatrixFromPackedTexture(e,t,r){return this.downloadMatrixDriver(e,()=>Vae(this.gl,t,r))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=Aae(t));const r=doe(t);st(t,()=>t.attachShader(r,this.vertexShader)),st(t,()=>t.attachShader(r,e)),poe(t,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&xk(t,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;st(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Pae(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(st(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&xk(this.gl,this.program),st(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,r=!0){return this.throwIfDisposed(),r?voe(this.gl,e,t):Soe(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),st(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),Coe(this.gl,e,t,r)}setOutputMatrixTexture(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)}setOutputPackedMatrixTexture(e,t,r){this.throwIfDisposed();const[s,i]=Zp(t,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,t,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,t)}setOutputPackedMatrixWriteRegion(e,t,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&xk(this.gl,this.program),nx(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}st(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),st(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=tx(this.gl,Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await RO(()=>this.disposed||this.isQueryAvailable(e,Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=Wae(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:r}=this.itemsToPoll[t];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Te().platform&&(r=Te().platform.setTimeoutCustom.bind(Te().platform)),RO(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),bk(this.gl,e,this.framebuffer),this.debug&&nx(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(bk(this.gl,this.outputTexture,this.framebuffer),this.debug&&nx(this.gl)):qD(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const r=t();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,t,r){this.throwIfDisposed();const s=this.gl;bk(s,e,this.framebuffer),this.debug&&nx(s),this.outputTexture=e,st(s,()=>s.viewport(0,0,t,r)),st(s,()=>s.scissor(0,0,t,r))}setOutputMatrixWriteRegionDriver(e,t,r,s){this.throwIfDisposed(),st(this.gl,()=>this.gl.scissor(e,t,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Wae(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Gae,bincountImpl:zU,bincountReduceImpl:Hae,bitwiseAndImpl:jae,castImpl:Kae,ceilImpl:qae,concatImpl:Xae,equalImpl:Qae,expImpl:Yae,expm1Impl:Jae,floorImpl:Zae,gatherNdImpl:ele,gatherV2Impl:tle,greaterImpl:nle,greaterEqualImpl:rle,lessImpl:sle,lessEqualImpl:ile,linSpaceImpl:ole,logImpl:ale,maxImpl:lle,maximumImpl:ule,minimumImpl:cle,multiplyImpl:fle,negImpl:hle,notEqualImpl:dle,prodImpl:ple,raggedGatherImpl:gle,raggedRangeImpl:mle,raggedTensorToTensorImpl:yle,rangeImpl:wle,rsqrtImpl:xle,scatterImpl:ble,sigmoidImpl:vle,simpleAbsImpl:UU,sliceImpl:Sle,sparseFillEmptyRowsImpl:Cle,sparseReshapeImpl:kle,sparseSegmentReductionImpl:VU,sqrtImpl:Ile,staticRegexReplaceImpl:Ele,stridedSliceImpl:Ale,stringNGramsImpl:Tle,stringSplitImpl:Nle,stringToHashBucketFastImpl:$le,subImpl:Rle,tileImpl:Ole,topKImpl:Dle,transposeImpl:nN,uniqueImpl:_le}=Mee;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WU(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function Os(n,e){return e===1?[n]:WU(n,e)}function Ple(n,e){if(n===1)return"rc";let t="";for(let r=0;r<n;r++)t+=e[r],r<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fle{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=ys(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=Os("rc",this.rank),r=xn(this.rank),s=this.getOutOfBoundsCondition(t),i=this.getSetup(t),o=this.getOutput(t);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let r=this.rank-2;r<this.rank;r++)t+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GU{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${Mle(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?eN():ZT(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function Mle(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Poe(["r","c","d"],"inputShape"):mh(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lle{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,r){const s=ZD(t,r),i=e_(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=JD(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return s===Jr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===Jr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===Jr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===Jr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===Jr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,t,r,s){if(this.freeTextures==null)return;const i=ZD(r,s),o=e_(t,i,s);o in this.freeTextures||(this.freeTextures[o]=[]);const a=JD(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=Te().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[o],f=u&&u.indexOf(e);if(f==null||f<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[f]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Ble(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function JD(n,e,t,r,s){const i=zle(e,r);let o;if(s){const[l,u]=Zp(n[0],n[1]);o=l*u}else{const[l,u]=Ny(n[0],n[1]);o=l*u}const a=Ble(t,i);return o*a}function zle(n,e){switch(n){case Jr.PACKED_2X2_FLOAT32:return LU(e);case Jr.PACKED_2X2_FLOAT16:return BU(e);case Jr.UNPACKED_FLOAT32:return PU(e);case Jr.UNPACKED_FLOAT16:return FU(e);case Jr.PACKED_4X1_UNSIGNED_BYTE:return MU(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function Ule(n){return Te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Jr.PACKED_2X2_FLOAT32:Jr.UNPACKED_FLOAT32:n?Jr.PACKED_2X2_FLOAT16:Jr.UNPACKED_FLOAT16}function ZD(n,e){if(n===Mi.UPLOAD)return Jr.PACKED_2X2_FLOAT32;if(n===Mi.RENDER||n==null)return Ule(e);if(n===Mi.DOWNLOAD||n===Mi.PIXELS)return Jr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function e_(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pa{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const bo="if (isnan(x)) return x;",Vle="return x;",t_="return abs(x);",Wle="return (x >= 0.0) ? x : (exp(x) - 1.0);",Gle=bo+`
  return (x < 0.0) ? 0.0 : x;
`,Hle=bo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ku="return x;",jle="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kle="return x;",qle=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Xle=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Qle=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Yle="return 1.0 / (1.0 + exp(-1.0 * x));";class Gu{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jle{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);const t=e.length,r=Os("rc",t),s=xn(t),i=Ple(t,r),o=r.slice(-2),a=t<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zle=gL,eue=1e-7,tue=1e-4,ix={};function nue(n){return n in ix||(ix[n]={}),ix[n]}const rue=Te().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),sue=600;function iue(){return Te().global.screen==null?1024:Te().global.screen.height*Te().global.screen.width*window.devicePixelRatio*sue/1024/1024}class Lv extends b2{nextDataId(){return Lv.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Te().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof Ck)t=e;else{const r=Yo(Te().getNumber("WEBGL_VERSION"),e);t=new Ck(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Yo(Te().getNumber("WEBGL_VERSION"));t=new Ck(r),this.binaryCache=nue(Te().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Lle(this.gpgpu),this.numMBBeforeWarning=iue(),this.texData=new z3(this,ma())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,r,s,i,o){const a=this.makeTensorInfo(t,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,i]},l.texShape=[s,i];const u=rx(t),f=new YD(u,!1,o),h=this.runWebGLProgram(f,[a],r,[[s,i]]);return h.shape=t,l.texture=null,this.disposeIntermediateTensorInfo(a),h.dataId}write(e,t,r){if((Te().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Te().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:t,dtype:r,values:e,usage:Mi.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,r,s,i){if(Te().getBool("DEBUG")&&this.checkNumericalProblems(t),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:t,usage:Mi.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=t;if(o!=null){let p;l?p=new Gu(a,ku):p=new Pa(a,ku);const g=this.runWebGLProgram(p,[{dataId:e,shape:a,dtype:s}],s),m=this.readSync(g.dataId);return this.disposeIntermediateTensorInfo(g),m}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let f;u&&(f=Hs());let h;if(s==="complex64"){const p=this.readSync(i.real.dataId),g=this.readSync(i.imag.dataId);h=Ml(p,g)}else h=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Hs()-f),this.convertAndCacheOnCPU(e,h)}async read(e){if(this.pendingRead.has(e)){const m=this.pendingRead.get(e);return new Promise(w=>m.push(w))}const t=this.texData.get(e),{values:r,shape:s,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=t;if(i!=null){let m;l?m=new Gu(s,ku):m=new Pa(s,ku);const w=this.runWebGLProgram(m,[{dataId:e,shape:s,dtype:o}],o),x=this.read(w.dataId);return this.disposeIntermediateTensorInfo(w),x}if(r!=null)return this.convertAndCacheOnCPU(e);if(Te().getBool("DEBUG")&&!Te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Te().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,f;if(o!=="complex64"&&Te().get("WEBGL_BUFFER_SUPPORTED")){f=this.decode(e);const m=this.texData.get(f.dataId);u=this.gpgpu.createBufferFromTexture(m.texture.texture,...ex(s))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(o==="complex64"){const m=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),w=m[0],x=m[1];h=Ml(w,x)}else if(u==null)h=this.getValuesFromTexture(e);else{const m=De(s);h=this.gpgpu.downloadFloat32MatrixFromBuffer(u,m)}if(f!=null&&this.disposeIntermediateTensorInfo(f),u!=null){const m=this.gpgpu.gl;st(m,()=>m.deleteBuffer(u))}const p=this.convertAndCacheOnCPU(e,h),g=this.pendingRead.get(e);return this.pendingRead.delete(e),g.forEach(m=>m(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ma().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,t={}){const r=this.texData.get(e),{values:s,shape:i,slice:o,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let g;l?g=new Gu(i,ku):g=new Pa(i,ku);const m=this.runWebGLProgram(g,[{dataId:e,shape:i,dtype:a}],a),w=this.readToGPU(m,t);return this.disposeIntermediateTensorInfo(m),w}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const f=this.decode(e,t.customTexShape),h=ma().makeTensorFromTensorInfo(f),p=this.texData.get(f.dataId);return Object.assign({tensorRef:h},p.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(s=>Qu(s));return Bt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Bt(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const r=e[t];if(!loe(r))throw Te().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:r,isPacked:s}=this.texData.get(e),i=De(t);if(Te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),g=this.texData.get(p.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(g.texture.texture,...ex(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(p),m}const o=Te().getBool("WEBGL_PACK")&&s===!0,a=o?rx(t):t,l=o?new kae(a):new Cae(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),f=this.texData.get(u.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(f.texture.texture,f.texShape[0],f.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),h}timerAvailable(){return Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=Uf(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=Uf(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=S8(l),a.getExtraProfileInfo=()=>l.map((u,f)=>({name:o[f],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Hs(),endMs:null}}endTimer(e){return Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Hs(),e)}async getQueryTime(e){if(Te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:r,texShape:s,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(t,s,i,o)));const f=this.texData.get(e);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=rue){return Te().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&De(r.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Pi("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Zle(e.shape,t)}packedUnaryOp(e,t,r){const s=new Gu(e.shape,t),i=this.compileAndRun(s,[e],r);return ma().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=UU(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(Te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,t_,e.dtype);const t=new Pa(e.shape,t_),r=this.compileAndRun(t,[e]);return ma().makeTensorFromTensorInfo(r)}makeTensorInfo(e,t,r){let s;if(t==="string"&&r!=null&&r.length>0&&m0(r[0])){const i=r.map(o=>ju(o));s=this.write(i,e,t)}else s=this.write(r,e,t);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:t}}makeOutput(e,t,r){return ma().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,r),this)}unpackTensor(e){const t=new Jle(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new Fle(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const r=[Np(e.shape),...$p(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[Np(t),...$p(t)],o=new GU(i,r),a=!0,l=[r],u=this.runWebGLProgram(o,[s],e.dtype,l,a);return{dataId:u.dataId,shape:t,dtype:u.dtype}}decode(e,t){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:o}=r;if(t!=null){const p=De(i),g=t[0]*t[1]*4;ee(p<=g,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=rx(i);let l;s?l=new Sae(a):l=new vae(a);const u=!0,f=[t??ex(a)],h=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,f,u,t);return{dtype:o,shape:i,dataId:h.dataId}}runWebGLProgram(e,t,r,s,i=!1,o){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Bm.DENSE){const b=o??ex(e.outputShape);l.texShape=b.map(C=>C*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),De(a.shape)===0)return l.values=hs(a.dtype,0),a;const u=[],f=t.map(b=>{if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let C=this.texData.get(b.dataId);if(C.texture==null){if(!e.packedInputs&&De(b.shape)<=Te().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:C.values};e.packedInputs&&(C.isPacked=!0,C.shape=b.shape)}if(this.uploadToGPU(b.dataId),!!C.isPacked!=!!e.packedInputs)b=C.isPacked?this.unpackTensor(b):this.packTensor(b),u.push(b),C=this.texData.get(b.dataId);else if(C.isPacked&&!R1(C.shape,b.shape)){const $=b,k=b.shape;b.shape=C.shape,b=this.packedReshape(b,k),u.push(b),C=this.texData.get(b.dataId),$.shape=k}return{shape:b.shape,texData:C,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:l,isUniform:!1},p=bae(e,f,h),g=this.getAndSaveBinary(p,()=>wae(this.gpgpu,e,f,h)),m=this.activeTimers!=null;let w;m&&(w=this.startTimer()),Te().get("ENGINE_COMPILE_ONLY")||xae(this.gpgpu,g,f,h,s),u.forEach(b=>this.disposeIntermediateTensorInfo(b)),m&&(w=this.endTimer(w),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(w)}));const x=Te().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){const b=Hs();b-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=b)}if(!Te().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const b=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),b}return a}compileAndRun(e,t,r,s,i=!1){return r=r||t[0].dtype,this.runWebGLProgram(e,t,r,s,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Te().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ce(()=>{if(!Te().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Te().getBool("DEBUG");Te().set("DEBUG",!1);const t=this.abs(on(1e-8)).dataSync()[0];if(Te().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?eue:tue}uploadToGPU(e){const t=this.texData.get(e),{shape:r,dtype:s,values:i,texture:o,usage:a,isPacked:l}=t;if(o!=null)return;const u=this.activeTimers!=null;let f;u&&(f=Hs());let h=t.texShape;if(h==null&&(h=Eoe(r,l),t.texShape=h),i!=null){const p=rx(r);let g,m=h[1],w=h[0];const x=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!x)&&([m,w]=Zp(h[0],h[1])),l?g=new Eae(p,x):g=new YD(p,x);const b=x?[w,m]:h,C=this.makeTensorInfo(b,s),$=this.texData.get(C.dataId);x?$.usage=Mi.PIXELS:$.usage=Mi.UPLOAD,$.texShape=b,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),m,w,i);const k=[[w,m]],_=this.runWebGLProgram(g,[C],s,k,!0),U=this.texData.get(_.dataId);t.texShape=U.texShape,t.isPacked=U.isPacked,t.usage=U.usage,Te().get("ENGINE_COMPILE_ONLY")?this.disposeData(_.dataId):(t.texture=U.texture,t.values=null,this.texData.delete(_.dataId)),this.disposeIntermediateTensorInfo(C),u&&(this.uploadWaitMs+=Hs()-f)}else{const p=this.acquireTexture(h,a,s,l);t.texture=p}}convertAndCacheOnCPU(e,t){const r=this.texData.get(e),{dtype:s}=r;return t!=null&&(r.values=oue(t,s)),r.values}acquireTexture(e,t,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,s)}computeBytes(e,t){return e[0]*e[1]*i1(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(t),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await _L(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(NU(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=_U(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,t,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:o,channels:a}=e,l=ma().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,t,r,i,o,a);return ma().makeTensorFromDataId(u,t,r,l)}}Lv.nextDataId=0;function oue(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<t.length;++r)t[r]=Math.round(n[r]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */NM()&&OM("webgl",()=>new Lv,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rN=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class eh{constructor(e,t,r){this.variableNames=["A","B"],this.outputShape=Dt(t,r),this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wh=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class sg{constructor(e,t,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Dt(t,r);const i=this.outputShape.length;this.enableShapeUniforms=ys(i);let o="";if(s)if(i===0||De(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${xn(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Os("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vi(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const aue={kernelName:M0,backendName:"webgl",kernelFunc:vi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yc(n){const{inputs:e,backend:t}=n,{real:r,imag:s}=e,i=t.makeTensorInfo(r.shape,"complex64"),o=t.texData.get(i.dataId),a=vi({inputs:{x:r},backend:t}),l=vi({inputs:{x:s},backend:t});return o.complexTensorInfos={real:a,imag:l},i}const lue={kernelName:D2,backendName:"webgl",kernelFunc:yc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HU="return (a < 0.) ? b * a : a;",jU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function uue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{alpha:i}=r,o=t.makeTensorInfo([],"float32",lc(i,"float32")),a=Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sg(jU,s.shape,o.shape):new eh(HU,s.shape,o.shape),l=t.runWebGLProgram(a,[s,o],"float32");return t.disposeIntermediateTensorInfo(o),l}const cue={kernelName:Ob,backendName:"webgl",kernelFunc:uue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KU="return (a < 0.) ? b * a : a;",qU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function fue(n){const{inputs:e,backend:t}=n,{x:r,alpha:s}=e,i=Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sg(qU,r.shape,s.shape):new eh(KU,r.shape,s.shape);return t.runWebGLProgram(i,[r,s],"float32")}const hue={kernelName:Yb,backendName:"webgl",kernelFunc:fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ig="if (isnan(x)) return x;";function Xt({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:r}){return({inputs:s,backend:i})=>{const{x:o}=s,a=i,l=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&t!=null){const h=a.texData.get(o.dataId),p=t(h.values,l);return a.makeTensorInfo(o.shape,l,p)}const u=Te().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let f;return u?f=new Gu(o.shape,e):f=new Pa(o.shape,n),a.runWebGLProgram(f,[o],l)}}function rs({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:u}=o,f=a;if(r&&l.dtype==="complex64"){const m=f.texData.get(l.dataId),w=f.texData.get(u.dataId),[x,b]=[[m.complexTensorInfos.real,w.complexTensorInfos.real],[m.complexTensorInfos.imag,w.complexTensorInfos.imag]].map($=>{const[k,N]=$,_={dataId:k.dataId,dtype:k.dtype,shape:l.shape},U={dataId:N.dataId,dtype:N.dtype,shape:u.shape},O=new eh(n,l.shape,u.shape);return f.runWebGLProgram(O,[_,U],xi(k.dtype,N.dtype))}),C=yc({inputs:{real:x,imag:b},backend:f});return f.disposeIntermediateTensorInfo(x),f.disposeIntermediateTensorInfo(b),C}const h=i||xi(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||f.shouldExecuteOnCPU([l,u]))&&s!=null){const m=f.texData.get(l.dataId).values,w=f.texData.get(u.dataId).values,x=l.dtype==="string"?Ll(m):m,b=l.dtype==="string"?Ll(w):w,[C,$]=s(l.shape,u.shape,x,b,h),k=f.makeTensorInfo($,h),N=f.texData.get(k.dataId);return N.values=C,k}const p=Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let g;return p?g=new sg(e,l.shape,u.shape,t):g=new eh(n,l.shape,u.shape),f.runWebGLProgram(g,[l,u],h)}}function zm(n,e=!1){if(n==="linear")return e?Kle:Vle;if(n==="relu")return e?Xle:Gle;if(n==="elu")return e?qle:Wle;if(n==="relu6")return e?Qle:Hle;if(n==="prelu")return e?qU:KU;if(n==="leakyrelu")return e?jU:HU;if(n==="sigmoid")return e?Yle:jle;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XU{constructor(e,t,r,s=!1,i=!1,o=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=ys(this.outputShape.length);const f=s?e[1]:e[2],h=Math.ceil(f/2),p=s?"i * 2, rc.y":"rc.y, i * 2",g=i?"rc.z, i * 2":"i * 2, rc.z",m=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],w=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",b="";a&&(l?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:x=`vec4 activation(vec4 x) {
          ${a}
        }`,b="result = activation(result);");const C=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let $="rc.x",k="rc.x";e[0]<t[0]?$=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(k=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${$};
        int batchB = ${k};
        for (int i = 0; i < ${h}; i++) {
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${g});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${m[0]} * ${w[0]});
          result += (${m[1]} * ${w[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${C}

        ${b}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n_={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class r_{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Dt(t,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_="return a * b;";function sN(n){const{inputs:e,backend:t}=n,{a:r,b:s}=e,i=xi(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=t.texData.get(r.dataId),l=t.texData.get(s.dataId),u=new r_(n_.REAL,r.shape,s.shape),f=new r_(n_.IMAG,r.shape,s.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],p=t.runWebGLProgram(u,h,"float32"),g=t.runWebGLProgram(f,h,"float32"),m=yc({inputs:{real:p,imag:g},backend:t});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),m}if(t.shouldExecuteOnCPU([r,s])){const a=t.texData.get(r.dataId),l=t.texData.get(s.dataId),[u,f]=fle(r.shape,s.shape,a.values,l.values,i),h=t.makeTensorInfo(f,i),p=t.texData.get(h.dataId);return p.values=u,h}let o;return Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new sg(s_,r.shape,s.shape):o=new eh(s_,r.shape,s.shape),t.runWebGLProgram(o,[r,s],i)}const due={kernelName:j0,backendName:"webgl",kernelFunc:sN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(n,e,t){const r=[Np(n.shape),...$p(n.shape)],s={dtype:n.dtype,shape:r,dataId:n.dataId},i=[Np(e),...$p(e)],o=new GU(i,r),a=!0,l=[r],u=t.runWebGLProgram(o,[s],n.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nt(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{shape:i}=r,o=t,a=De(s.shape),l=V3(i,a),u=De(l);ee(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const f=o.texData.get(s.dataId);return f.isPacked&&!R1(s.shape,l)&&!(f.texture!==null&&R1(f.shape,l))?pue(s,l,o):(o.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const gue={kernelName:Zb,backendName:"webgl",kernelFunc:nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i_{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(t!=null){const h=1/t;u=`sumValue += dot(values * ${xp(h)?h.toPrecision(2):h}, ones);`}let f="";i%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mue{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];let a="0.0",l="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",l="min"):t==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");const f=Math.floor(r/4)*4,h=r%4;let p=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,g="vec4";t==="all"?(a="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,g="bvec4"):t==="any"&&(a="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,g="bvec4");let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${f}; i += 4) {
          int inIdx = inOffset + i;
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${f};
        if (${h===1}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${h===2}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${h===3}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],r=Sv(t);e.push({inSize:t,windowSize:r,outSize:Math.ceil(t/r)})}return e}function xh(n,e,t,r){const s=yue(n.shape);let i=n;for(let o=0;o<s.length;o++){const{inSize:a,windowSize:l,outSize:u}=s[o];let f,h;t==="mean"?f=o===0?new i_({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u},a):new i_({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u}):f=new mue({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u},t),h=i,i=r.runWebGLProgram(f,[i],e),h.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(h)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wue{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[t[o]];this.outputShape=r,this.rank=r.length;const s=xn(this.rank),i=xue(t);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function xue(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<n.length;s++)r[n[s]]=t[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bue{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let f=0;f<r.length;f++)r[f]=e[t[f]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=xn(this.rank),i=WU("rc",this.rank),o=new Array(this.rank);for(let f=0;f<t.length;f++)o[t[f]]=i[f];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bv(n,e,t){const r=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bue(n.shape,e):new wue(n.shape,e);return t.runWebGLProgram(r,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(n,e,t,r){const s=e,i=n.shape.length,o=zt(s,n.shape);let a=o;const l=Zn(a,i),u=l!=null;let f=n;u&&(f=Bv(n,l,r),a=pr(a.length,i)),ns("sum",a,i);const[h,p]=Gr(f.shape,a);let g=h;t&&(g=Ir(h,o));const m=De(p),x=De(n.shape)/m,b=nt({inputs:{x:f},attrs:{shape:[x,m]},backend:r}),C=dA(n.dtype),$=xh(b,C,"sum",r),k=nt({inputs:{x:$},attrs:{shape:g},backend:r});return r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo($),u&&r.disposeIntermediateTensorInfo(f),k}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zv(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r;return vue(s,i,o,t)}const Sue={kernelName:iv,backendName:"webgl",kernelFunc:zv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ps(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{perm:i}=r,o=t,a=s.shape.length,l=new Array(a);for(let f=0;f<l.length;f++)l[f]=s.shape[i[f]];let u;if(o.shouldExecuteOnCPU([s])){const h=o.texData.get(s.dataId).values,p=nN(h,s.shape,s.dtype,i,l);u=o.makeTensorInfo(l,s.dtype);const g=o.texData.get(u.dataId);g.values=p}else u=Bv(s,i,o);return u}const Cue={kernelName:Cd,backendName:"webgl",kernelFunc:Ps};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QU=1e3;function O1({a:n,b:e,transposeA:t,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const u=n.shape.length,f=e.shape.length,h=t?n.shape[u-2]:n.shape[u-1],p=r?e.shape[f-1]:e.shape[f-2],g=t?n.shape[u-1]:n.shape[u-2],m=r?e.shape[f-2]:e.shape[f-1],w=n.shape.slice(0,-2),x=e.shape.slice(0,-2),b=De(w),C=De(x),k=Dt(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([g,m]);ee(h===p,()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${r} must match.`);const N=t?[b,h,g]:[b,g,h],_=r?[C,m,p]:[C,p,m],U=nt({inputs:{x:n},backend:s,attrs:{shape:N}}),O=nt({inputs:{x:e},backend:s,attrs:{shape:_}}),L=[U,O],T=Math.max(b,C),I=t?U.shape[1]:U.shape[2],v=i!=null,A=o!=null,M=l==="leakyrelu",D=l!=null?zm(l,!0):null,B=v||A||M||D!=null;let j;if((g===1||m===1)&&I>QU&&B===!1){let P=U,E=O;t&&(P=Ps({inputs:{x:U},backend:s,attrs:{perm:[0,2,1]}}),L.push(P)),r&&(E=Ps({inputs:{x:O},backend:s,attrs:{perm:[0,2,1]}}),L.push(E));const R=m!==1,H=m===1;let K=P;R&&(K=nt({inputs:{x:P},backend:s,attrs:{shape:[T,I,1]}}),L.push(K));const Q=m===1?2:1;let J=E;H&&(J=nt({inputs:{x:E},backend:s,attrs:{shape:[T,1,I]}}),L.push(J));const ie=sN({inputs:{a:K,b:J},backend:s});j=zv({inputs:{x:ie},backend:s,attrs:{axis:Q,keepDims:!0}}),L.push(ie)}else{const P=xi(n.dtype,e.dtype),E=new XU(N,_,[T,g,m],t,r,v,D,A,M),R=[U,O];if(i!=null&&R.push(i),A&&R.push(o),M){const H=s.makeTensorInfo([],"float32",lc(a,"float32"));R.push(H),L.push(H)}j=s.runWebGLProgram(E,R,P)}const W=nt({inputs:{x:j},backend:s,attrs:{shape:k}});L.push(j);for(const P of L)s.disposeIntermediateTensorInfo(P);return W}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kue(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:f,leakyreluAlpha:h}=r;return O1({a:s,b:i,transposeA:l,transposeB:u,backend:t,bias:o,preluActivationWeights:a,leakyreluAlpha:h,activation:f})}const Iue={kernelName:o1,backendName:"webgl",kernelFunc:kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o_="return abs(x);";function Eue(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=t.texData.get(r.dataId),o=UU(i.values);return t.makeTensorInfo(r.shape,r.dtype,o)}let s;return Te().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Gu(r.shape,o_):s=new Pa(r.shape,o_),t.runWebGLProgram(s,[r],r.dtype)}const Aue={kernelName:hb,backendName:"webgl",kernelFunc:Eue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tue=bo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Nue=Xt({opSnippet:Tue}),$ue={kernelName:y0,backendName:"webgl",kernelFunc:Nue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rue=bo+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Oue=Xt({opSnippet:Rue}),Due={kernelName:w0,backendName:"webgl",kernelFunc:Oue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a_="return a + b;",_ue=rs({opSnippet:a_,packedOpSnippet:a_,supportsComplex:!0,cpuKernelImpl:Gae}),Pue={kernelName:Kp,backendName:"webgl",kernelFunc:_ue};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fue{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mue{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mx(n){const{inputs:e,backend:t}=n,r=e;if(r.length===1)return vi({inputs:{x:r[0]},backend:t});if(r.length>Te().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=Mx({inputs:r.slice(0,l),backend:t}),f=Mx({inputs:r.slice(l),backend:t});return Mx({inputs:[u,f],backend:t})}const s=r.map(l=>l.dtype).reduce((l,u)=>xi(l,u)),i=r.map(l=>l.shape),a=Te().getBool("WEBGL_PACK")?new Mue(r[0].shape,i):new Fue(r[0].shape,i);return t.runWebGLProgram(a,r,s)}const Lue={kernelName:E2,backendName:"webgl",kernelFunc:Mx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=zt(i,s.shape);let u=l;const f=Zn(u,a);let h=s;f!=null&&(h=Ps({inputs:{x:s},backend:t,attrs:{perm:f}}),u=pr(u.length,a)),ns("all",u,a);const[p,g]=Gr(h.shape,u),m=De(g),w=nt({inputs:{x:h},backend:t,attrs:{shape:[-1,m]}}),x=xh(w,w.dtype,"all",t);let b;if(o){const C=Ir(p,l);b=nt({inputs:{x},backend:t,attrs:{shape:C}})}else b=nt({inputs:{x},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),f!=null&&t.disposeIntermediateTensorInfo(h),b}const zue={kernelName:A2,backendName:"webgl",kernelFunc:Bue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=zt(i,s.shape);let u=l;const f=Zn(u,a);let h=s;f!=null&&(h=Ps({inputs:{x:s},backend:t,attrs:{perm:f}}),u=pr(u.length,a)),ns("any",u,a);const[p,g]=Gr(h.shape,u),m=De(g),w=nt({inputs:{x:h},backend:t,attrs:{shape:[-1,m]}}),x=xh(w,w.dtype,"any",t);let b;if(o){const C=Ir(p,l);b=nt({inputs:{x},backend:t,attrs:{shape:C}})}else b=nt({inputs:{x},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),f!=null&&t.disposeIntermediateTensorInfo(h),b}const Vue={kernelName:T2,backendName:"webgl",kernelFunc:Uue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wue{constructor(e,t,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=t==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gue{constructor(e,t,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ee(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=xn(l),f=Os("coords",l);let h,p;if(o===1){p=l+1;const O=xn(p);h=`
        ${O} sourceLocR = ${O}(${f.join()}, 0);
        ++${f[l-1]};
        ${O} sourceLocG = ${O}(${f.join()}, 0);
        ++${f[l-2]};
        ${O} sourceLocA = ${O}(${f.join()}, 0);
        --${f[l-1]};
        ${O} sourceLocB = ${O}(${f.join()}, 0);
        --${f[l-2]};`}else p=l,h=`
        ${u} sourceLocR = coords;
        ++${f[l-1]};
        ${u} sourceLocG = coords;
        ++${f[l-2]};
        ${u} sourceLocA = coords;
        --${f[l-1]};
        ${u} sourceLocB = coords;
        --${f[l-2]};`;const g=["x","y","z","w","u","v"].slice(0,p),m="."+g[p-1],w=g.map(O=>"int "+O),x=Os("sourceLocR",p-1).concat("inIdx.r"),b=Os("sourceLocG",p-1).concat("inIdx.g"),C=Os("sourceLocB",p-1).concat("inIdx.b"),$=Os("sourceLocA",p-1).concat("inIdx.a"),k=r==="max"?"greaterThan":"lessThan",N=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${C.join()}),
                             getBestIndicesAChannel(${$.join()})));`,_=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${b.join()}) : 0.,
            hasNextRow ? getAChannel(${C.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${$.join()}) : 0.)`,U=s?"":`
      float getBestIndicesAChannel(${w.join()}) {
        return getChannel(getBestIndicesA(${g.join()}),
                                          vec2(${g.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${w.join()}) {
        return getChannel(getA(${g.join()}),
                               vec2(${g.slice(-2).join()}));
      }
      ${U}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${f[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${f[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${m}, sourceLocG${m},
          sourceLocB${m}, sourceLocA${m}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${_};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${N}
          vec4 candidate = ${_};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${k}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YU(n,e,t,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const o=Sv(i),a={windowSize:o,inSize:i,batchSize:s,outSize:Math.ceil(i/o)},l=new Wue(a,t,r==null),u=[e];r!=null&&u.push(r);const f=n.runWebGLProgram(l,u,"int32");if(f.shape[1]===1)return f;const h=YU(n,e,t,f);return n.disposeIntermediateTensorInfo(f),h}function JU(n,e,t,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],o=Sv(i),a=new Gue(s,o,t,r==null),l=r==null?[e]:[e,r],u=n.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const f=JU(n,e,t,u);return n.disposeIntermediateTensorInfo(u),f}return u}function ZU(n,e,t,r){const s=[t];if(ns("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!Te().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=n.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=n.unpackTensor(e),i.push(l));const[u,f]=Gr(l.shape,s),h=De(f),p=nt({inputs:{x:l},backend:n,attrs:{shape:[-1,h]}});i.push(p);const g=YU(n,p,r);i.push(g);const m=nt({inputs:{x:g},backend:n,attrs:{shape:u}});return i.forEach(w=>n.disposeIntermediateTensorInfo(w)),m}return JU(n,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;let o=zt(i,s.shape);const a=Zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Ps({inputs:{x:s},backend:t,attrs:{perm:a}}),u.push(l),o=pr(o.length,l.shape.length)),ns("argMax",[o[0]],l.shape.length);const f=ZU(t,l,o[0],"max");return u.forEach(h=>t.disposeIntermediateTensorInfo(h)),f}const jue={kernelName:db,backendName:"webgl",kernelFunc:Hue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;let o=zt(i,s.shape);const a=Zn(o,s.shape.length);let l=s;const u=[];a!=null&&(l=Ps({inputs:{x:s},backend:t,attrs:{perm:a}}),u.push(l),o=pr(o.length,l.shape.length)),ns("argMin",[o[0]],l.shape.length);const f=ZU(t,l,o[0],"min");return u.forEach(h=>t.disposeIntermediateTensorInfo(h)),f}const que={kernelName:pb,backendName:"webgl",kernelFunc:Kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xue=bo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Que=Xt({opSnippet:Xue}),Yue={kernelName:x0,backendName:"webgl",kernelFunc:Que};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jue=bo+"return log(x + sqrt(x * x + 1.0));",Zue=Xt({opSnippet:Jue}),ece={kernelName:b0,backendName:"webgl",kernelFunc:Zue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tce=bo+`
  return atan(x);
`,nce=Xt({opSnippet:tce}),rce={kernelName:v0,backendName:"webgl",kernelFunc:nce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sce=rN+`
  return atan(a, b);
`,ice=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+wh+`
  return result;
`,oce=rs({opSnippet:sce,packedOpSnippet:ice}),ace={kernelName:C0,backendName:"webgl",kernelFunc:oce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lce=bo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,uce=Xt({opSnippet:lce}),cce={kernelName:S0,backendName:"webgl",kernelFunc:uce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Um{constructor(e,t,r,s=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,f=e.dilationWidth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;const w=t==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,b=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let C="0.0";if(w||(C="-1.0 / 1e-20"),r){const O=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${g}, ${m});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${f}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${O} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?x:b:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let k=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(k="avgValue / max(count, 1.0)");const N=Math.floor(o/4)*4,_=o%4,U=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${g}, ${m});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${N}; wC += 4) {
            int xC = xCCorner + wC * ${f};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              getValue(batch, xR, xC + 2 * ${f}, d),
              getValue(batch, xR, xC + 3 * ${f}, d)
            );

            ${U}
          }

          int xC = xCCorner + ${N};
          if (${_===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${U}
          } else if (${_===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              initializationValue,
              initializationValue
            );

            ${U}
          } else if (${_===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              getValue(batch, xR, xC + 2 * ${f}, d),
              initializationValue
            );

            ${U}
          }
        }
        setOutput(${k});
      }
    `}}class iN{constructor(e,t,r,s=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,f=e.dilationDepth,h=e.dilationHeight,p=e.dilationWidth,g=e.effectiveFilterDepth,m=e.effectiveFilterHeight,w=e.effectiveFilterWidth,x=e.padInfo.front,b=e.padInfo.top,C=e.padInfo.left;this.outputShape=e.outShape;const $=t==="avg";let k="0.0";if($||(k="-1.0 / 1e-20"),r){const T=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${x}, ${b}, ${C});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${g};
              wD += ${f}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${m};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${w};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${T} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${m} * ${w} +
                      wR * ${w} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const N="max";let _=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(_="avgValue / max(count, 1.0)");const U=Math.floor(o/4)*4,O=o%4,L=`
      if (${$}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${N}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${x}, ${b}, ${C});
      const float initializationValue = ${k};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${k});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${g};
            wD += ${f}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${U}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${L}
            }

            int xC = xCCorner + ${U};
            if (${O===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${L}
            } else if (${O===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${L}
            } else if (${O===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${L}
            }
          }
        }
        setOutput(${_});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;$y(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;ee(gs(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const f=wo(s.shape,i,o,u,a,l);if(f.filterWidth===1&&f.filterHeight===1&&an(f.inShape,f.outShape))return vi({inputs:{x:s},backend:t});const h=new Um(f,"avg",!1);return t.runWebGLProgram(h,[s],"float32")}const hce={kernelName:gb,backendName:"webgl",kernelFunc:fce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:u}=r,f=[1,1,1],h=Wl(s.shape,i,o,f,a,l,u),p=new iN(h,"avg",!1);return t.runWebGLProgram(p,[s],"float32")}const pce={kernelName:mb,backendName:"webgl",kernelFunc:dce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gce{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,f=l-1-e.padInfo.top,h=u-1-e.padInfo.left,p=1/(t*r);this.userCode=`
      const ivec2 pads = ivec2(${f}, ${h});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class mce{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,f=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,m=h-1-e.padInfo.front,w=p-1-e.padInfo.top,x=g-1-e.padInfo.left,b=1/(t*r*s);this.userCode=`
      const ivec3 pads = ivec3(${m}, ${w}, ${x});
      const float avgMultiplier = float(${b});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${g};
                wC += ${f}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:f}=r,h=[1,1,1],p=Wl(o.shape,a,l,h,u,f),g=new mce(p);return t.runWebGLProgram(g,[s],o.dtype)}const wce={kernelName:$2,backendName:"webgl",kernelFunc:yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xce(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,o=i;$y([s,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,f=wo(o.shape,a,l,1,u),h=new gce(f);return t.runWebGLProgram(h,[s],o.dtype)}const bce={kernelName:N2,backendName:"webgl",kernelFunc:xce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vce(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;return O1({a:s,b:i,transposeA:o,transposeB:a,backend:t})}const Sce={kernelName:yb,backendName:"webgl",kernelFunc:vce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cce{constructor(e,t,r,s,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Dt(e,t),Dt(e,r);let a="0.0";s!=null&&(Dt(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Dt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kce{constructor(e,t,r,s,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Dt(e,t),Dt(e,r);let a="vec4(0.0)";s!=null&&(Dt(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Dt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ice=({inputs:n,backend:e,attrs:t})=>{const{x:r,mean:s,variance:i,offset:o,scale:a}=n;ee(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ee(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ee(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const u=[r,s,i];let f=null;o!=null&&(f=o.shape,u.push(o));let h=null;a!=null&&(h=a.shape,u.push(a));const p=Te().getBool("WEBGL_PACK_NORMALIZATION")?new kce(r.shape,s.shape,i.shape,f,h,l):new Cce(r.shape,s.shape,i.shape,f,h,l);return e.runWebGLProgram(p,u,u[0].dtype)},Ece={kernelName:Nb,backendName:"webgl",kernelFunc:Ice};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ace{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=xn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=Tce(this.rank);let s;const i=e.map((o,a)=>`sourceLoc.${vE[a]} = start[${a}] + coords.${vE[a]};`);s=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const vE=["x","y","z","w","u","v"];function Tce(n){if(n===1)return"sourceLoc";if(n<=6)return vE.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nce{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=xn(this.rank),r=Os("coords",this.rank),s=Os("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${o};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((f,h)=>`start[${h}]`).join()});`:e.map((f,h)=>`${s[h]} = ${r[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(n,e,t,r){const s=r.texData.get(n.dataId),i=r.makeTensorInfo(t,n.dtype),o=r.texData.get(i.dataId);Object.assign(o,s),o.refCount=1,o.shape=t,o.dtype=n.dtype;let a=YA(e,vt(n.shape));s.slice&&(a+=s.slice.flatOffset),o.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||n.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),i}function og(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,size:o}=r,[a,l]=vv(s,i,o);if(qA(s,a,l),De(l)===0)return t.makeTensorInfo(l,s.dtype,[]);if(t.shouldExecuteOnCPU([s])||s.dtype==="string"){const h=t.texData.get(s.dataId),p=Sle(h.values,a,l,s.shape,s.dtype);return t.makeTensorInfo(l,s.dtype,p)}const{isPacked:u}=t.texData.get(s.dataId),f=QA(s.shape,a,l);if(u||!f){const h=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Nce(l):new Ace(l),p=[a];return t.runWebGLProgram(h,[s],s.dtype,p)}return t.uploadToGPU(s.dataId),$ce(s,a,l,t)}const Rce={kernelName:sv,backendName:"webgl",kernelFunc:og};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oce=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,crops:o}=r;ee(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((C,$)=>C*$),l=yy(s.shape,i,a),u=wy(l.length,i.length),f=xy(s.shape,i,a),h=nT(o,i.length),p=rT(f,o,i.length),g=[],m=nt({inputs:{x:s},backend:t,attrs:{shape:l}}),w=Ps({inputs:{x:m},backend:t,attrs:{perm:u}}),x=nt({inputs:{x:w},backend:t,attrs:{shape:f}}),b=og({inputs:{x},backend:t,attrs:{begin:h,size:p}});return g.push(m),g.push(w),g.push(x),g.forEach(C=>t.disposeIntermediateTensorInfo(C)),b},Dce={kernelName:wb,backendName:"webgl",kernelFunc:Oce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:o}=r,a=t.readSync(s.dataId),l=t.readSync(i.dataId),u=zU(a,l,i.dtype,i.shape,o);return t.makeTensorInfo([o],i.dtype,u)}const Pce={kernelName:R2,backendName:"webgl",kernelFunc:_ce};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fce=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Mce=`
  return float(int(a.r) & int(b.r));
`;function Lce(n){const{inputs:e,backend:t}=n,{a:r,b:s}=e,i=Te().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=Te().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([r,s])||o===1){const l=t.texData.get(r.dataId).values,u=t.texData.get(s.dataId).values,[f,h]=jae(r.shape,s.shape,l,u,r.dtype),p=t.makeTensorInfo(h,r.dtype),g=t.texData.get(p.dataId);return g.values=f,p}let a;return i?a=new sg(Fce,r.shape,s.shape,!1):a=new eh(Mce,r.shape,s.shape),t.runWebGLProgram(a,[r,s],r.dtype)}const Bce={kernelName:O2,backendName:"webgl",kernelFunc:Lce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce(n){const{inputs:e,backend:t}=n,{s0:r,s1:s}=e,i=t.readSync(r.dataId),o=t.readSync(s.dataId),a=Dt(Array.from(i),Array.from(o));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Uce={kernelName:q3,backendName:"webgl",kernelFunc:zce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vce="return float(a != b);",eV=rs({opSnippet:Vce,cpuKernelImpl:dle,dtype:"bool"}),Wce={kernelName:jb,backendName:"webgl",kernelFunc:eV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oy(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return vi({inputs:{x:s.complexTensorInfos.real},backend:t})}const Gce={kernelName:rA,backendName:"webgl",kernelFunc:Oy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hce="return float(int(x));";function jce(n,e){const t=new Pa(n.shape,Hce),r=e.runWebGLProgram(t,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SE(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return vi({inputs:{x:s},backend:t});const o=Vr(s.shape),a=SE({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),l=yc({inputs:{real:a,imag:o},backend:t});return o.dispose(),t.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const o=Oy({inputs:{input:s},backend:t}),a=SE({inputs:{x:o},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(o),a}if(!W3(s.dtype,i)){const o=vi({inputs:{x:s},backend:t});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(t.shouldExecuteOnCPU([s])){const o=t.texData.get(s.dataId).values,[a,l,u]=Kae(o,s.shape,s.dtype,i);return t.makeTensorInfo(a,l,u)}if(i==="int32")return jce(s,t);if(i==="bool"){const o=t.makeTensorInfo([],"bool",hs("bool",1)),l=eV({inputs:{a:s,b:o},backend:t});return t.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const Kce={kernelName:k0,backendName:"webgl",kernelFunc:SE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l_="return ceil(x);",qce=Xt({opSnippet:l_,packedOpSnippet:l_,cpuKernelImpl:qae}),Xce={kernelName:I0,backendName:"webgl",kernelFunc:qce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qce{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yce{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{clipValueMin:i,clipValueMax:o}=r;let a;Te().getBool("WEBGL_PACK_CLIP")?a=new Yce(s.shape):a=new Qce(s.shape);const l=[[i],[o]];return t.runWebGLProgram(a,[s],s.dtype,l)}const Zce={kernelName:E0,backendName:"webgl",kernelFunc:Jce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class efe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function tfe(n){const{inputs:e,backend:t}=n,{x:r}=e,s=t.texData.get(r.dataId),i=new efe(r.shape),o=[u_(r,s.complexTensorInfos.real),u_(r,s.complexTensorInfos.imag)];return t.runWebGLProgram(i,o,o[0].dtype)}const nfe={kernelName:xb,backendName:"webgl",kernelFunc:tfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rfe{constructor(e){this.outputShape=[],this.outputShape=za(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let o=1;o<t.length;o++)t[o]=t[o-1]+e[o][1];const r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<t.length;o++){const a=t[o-1];r.push(`else if (yC < ${t[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const s=t.length,i=t[t.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sfe{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=za(e,t);const r=this.outputShape,s=r.length,i=xn(s),o=Os("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((w,x)=>`T${x}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let w=1;w<l.length;w++)l[w]=l[w-1]+e[w][t];const u=a[t],f=a.slice(-2),h=a.join();let p=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${f.join()}));
        }`;for(let w=1;w<l.length;w++){const x=l[w-1];p+=`
        if (${u} < ${l[w]}  && ${u} >= ${l[w-1]}) {
          return getChannel(
            getT${w}(${ox(a,u,x)}),
            vec2(${ox(f,u,x)}));
        }`}const g=l.length,m=l[l.length-1];p+=`
        return getChannel(
          getT${g}(${ox(a,u,m)}),
          vec2(${ox(f,u,m)}));`,this.userCode=`
      float getValue(${a.map(w=>"int "+w)}) {
        ${p}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[s-1]} = ${o[s-1]} + 1;
        if (${o[s-1]} < ${r[s-1]}) {
          result.g = getValue(${o});
        }

        ${o[s-2]} = ${o[s-2]} + 1;
        if (${o[s-2]} < ${r[s-2]}) {
          result.a = getValue(${o});
        }

        ${o[s-1]} = ${o[s-1]} - 1;
        if (${o[s-2]} < ${r[s-2]} &&
            ${o[s-1]} < ${r[s-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function ox(n,e,t){const r=n.indexOf(e);return n.map((i,o)=>o===r?`${i} - ${t}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uv(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return vi({inputs:{x:s.complexTensorInfos.imag},backend:t})}const ife={kernelName:X2,backendName:"webgl",kernelFunc:Uv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hm(n,e,t){const r=n[0].dtype;if(r==="complex64"){const g=n.map(C=>Oy({inputs:{input:C},backend:t})),m=n.map(C=>Uv({inputs:{input:C},backend:t})),w=hm(g,e,t),x=hm(m,e,t),b=yc({inputs:{real:w,imag:x},backend:t});return g.forEach(C=>t.disposeIntermediateTensorInfo(C)),m.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),b}let s=t.shouldExecuteOnCPU(n);if(r==="string"&&(s=!0),s){const g=n.map(k=>{const _=[-1,De(k.shape.slice(e))];return nt({inputs:{x:k},backend:t,attrs:{shape:_}})}),m=g.map(k=>({vals:t.readSync(k.dataId),shape:k.shape})),w=za(g.map(k=>k.shape),1),x=g[0].shape[0]===1,b=Xae(m,w,r,x),C=za(n.map(k=>k.shape),e),$=t.makeTensorInfo(C,r,b);return g.forEach(k=>t.disposeIntermediateTensorInfo(k)),$}const i=n.filter(g=>De(g.shape)>0),o=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const g=o?new Pa(n[0].shape,ku):new Gu(n[0].shape,ku);return t.runWebGLProgram(g,n,r)}const a=Te().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const g=[];for(let w=0;w<i.length;w+=a){const x=i.slice(w,w+a);g.push(hm(x,e,t))}const m=hm(g,e,t);for(const w of g)t.disposeIntermediateTensorInfo(w);return m}if(o){const g=new sfe(i.map(m=>m.shape),e);return t.runWebGLProgram(g,i,r)}const{tensors2D:l,outShape:u}=ofe(i,e,t),f=new rfe(l.map(g=>g.shape)),h=t.runWebGLProgram(f,l,r);l.forEach(g=>t.disposeIntermediateTensorInfo(g));const p=nt({inputs:{x:h},attrs:{shape:u},backend:t});return t.disposeIntermediateTensorInfo(h),p}function ofe(n,e,t){const r=za(n.map(i=>i.shape),e);return{tensors2D:n.map(i=>nt({inputs:{x:i},attrs:{shape:[-1,De(i.shape.slice(e))]},backend:t})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tV(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r,i=zt(s,e[0].shape)[0],o=e.map(u=>u.shape);ZA(o,i);const a=za(e.map(u=>u.shape),i);if(De(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>De(u.shape)>0);return l.length===1?vi({inputs:{x:l[0]},backend:t}):hm(l,i,t)}const afe={kernelName:bb,backendName:"webgl",kernelFunc:tV};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nV{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,f=e.dilationHeight,h=e.dilationWidth,p=e.filterHeight,g=e.filterWidth,m=Math.floor(e.inChannels/4)*4,w=e.inChannels%4,x=e.dataFormat==="channelsLast",b=x?1:2,C=x?2:3,$=x?3:1;let k="",N="";r&&(s?k=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?k=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:k=`
          float activation(float x) {
            ${r}
          }
        `,N="result = activation(result);");const _=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${k}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${$}];

        ivec2 xRCCorner =
            ivec2(coords[${b}], coords[${C}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${f};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${g}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${m}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${w===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${m}) *
                    getW(wR, wC, ${m}, d2);
              } else {
                dotProd +=
                    getX(batch, ${m}, xR, xC) *
                    getW(wR, wC, ${m}, d2);
              }

            } else if (${w===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${w===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2),
                getW(wR, wC, ${m} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1),
                  getX(batch, xR, xC, ${m} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC),
                  getX(batch, ${m} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${_}
        ${N}
        setOutput(result);
      }
    `}}class lfe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,f=e.dilationWidth,h=e.filterDepth,p=e.filterHeight,g=e.filterWidth,m=Math.floor(e.inChannels/4)*4,w=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${t}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${g}; wC++) {
              int xC = xCCorner + wC * ${f};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${m}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${w===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${m}) *
                  getW(wF, wR, wC, ${m}, d2);
              } else if (${w===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${w===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1),
                  getX(batch, xF, xR, xC, ${m} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2),
                  getW(wF, wR, wC, ${m} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rV{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ys(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,f=e.filterWidth,h=f;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<f;x++)p+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;p+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<f;x++)p+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(h+1)/2;x++){const b=x*2;if(p+=`
           xC = xCCorner + ${b*l};
           `,a===1){if(b<f&&(o%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }
               `,l===1&&b>0?p+=`
                 xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                   } else {
                     xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xC${b} = xTexelC${b};
                 `,b+1<f)){const C=o%2===0?v2(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${C};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                     xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${b+1}.zw = vec2(0.0);
                     }
                     xTexelC${b+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                     } else {
                      xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                     }
                     `:p+=`
                     xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                     `):C===1?p+=`
                     xC${b+1} = xTexelC${b};
                     `:p+=`
                     xCOffset = xC + ${C};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                       xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${b+1}.zw = vec2(0.0);
                       }
                       xTexelC${b+1}Ready = 1;
                     }

                     xC${b+1} = xTexelC${b+1};
                     `}}else b<f&&(o%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.0);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
               `,b+1<f&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(
                   xTexelC${b}.xy, xTexelC${b+1}.xy);
               `,b+1<f&&(p+=`
                   xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                 `)));b<f&&(p+=`
             wTexel = getW(r, ${b}, d1, d2);
             dotProd += xC${b}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${b}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,b+1<f&&(p+=`
               wTexel = getW(r, ${b+1}, d1, d2);
               dotProd += xC${b+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${b+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let g="",m="";r&&(s?g=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?g=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:g=`vec4 activation(vec4 x) {
           ${r}
         }`,m="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${g}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${w}
         ${m}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ufe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);const{dataFormat:r}=t,s=Fs(),i=r==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let f=0;f<=1;f++)for(let h=0;h<=1;h++)u+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${f};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${f*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${f*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function sV({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=n.shape,u=r.texData.get(n.dataId),f=t.inChannels,h=l[0]*l[1]*l[2],p=t.outChannels,g=t.dataFormat==="channelsLast",m=!1,w=!1;let x;const b=[];if(i!=null){const k=D1(i.shape,g);k!=null&&(i=nt({inputs:{x:i},backend:r,attrs:{shape:k}}),b.push(i))}if(s!=null){const k=D1(s.shape,g);k!=null&&(s=nt({inputs:{x:s},backend:r,attrs:{shape:k}}),b.push(s))}if(!((h===1||p===1)&&f>QU)&&u.isPacked&&g&&u.texture!=null&&l[2]%2!==0&&an(u.shape.slice(-3),l.slice(-3))){const k=l[0]*l[1]*(l[2]+1),N={dataId:n.dataId,shape:[1,k,t.inChannels],dtype:n.dtype},_=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,ee(R1(u.shape,N.shape),()=>`packed reshape ${u.shape} to ${N.shape} isn't free`);const U=nt({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}});b.push(U);const O=O1({a:N,b:U,backend:r,transposeA:m,transposeB:w,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),L=r.texData.get(O.dataId);ee(L.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=_,L.shape=t.outShape,x=vi({inputs:{x:O},backend:r}),x.shape=t.outShape,b.push(O)}else{const k=t.outHeight*t.outWidth,N=nt({inputs:{x:n},backend:r,attrs:{shape:g?[t.batchSize,k,t.inChannels]:[t.batchSize,t.inChannels,k]}}),_=nt({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}}),U=O1({a:g?N:_,b:g?_:N,transposeA:!g,transposeB:w,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o});x=nt({inputs:{x:U},backend:r,attrs:{shape:t.outShape}}),b.push(N),b.push(_),b.push(U)}for(const k of b)r.disposeIntermediateTensorInfo(k);return x}function iV({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:f,outWidth:h,outHeight:p,dataFormat:g}=t,m=g==="channelsLast",w=l*u*f,x=p*h,b=[t.batchSize,w,x],C=!0,$=!1,k=[];if(i!=null){const W=D1(i.shape,m);W!=null&&(i=nt({inputs:{x:i},backend:r,attrs:{shape:W}}),k.push(i))}if(s!=null){const W=D1(s.shape,m);W!=null&&(s=nt({inputs:{x:s},backend:r,attrs:{shape:W}}),k.push(s))}const N=nt({inputs:{x:e},backend:r,attrs:{shape:[1,w,De(e.shape)/w]}});k.push(N);const _=new ufe(b,t),U=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],O=r.runWebGLProgram(_,[n],"float32",U),L=nt({inputs:{x:O},backend:r,attrs:{shape:b}});k.push(O),k.push(L);const T=s!=null,I=i!=null,v=a==="leakyrelu",A=a?zm(a,!0):null,M=new XU(m?L.shape:N.shape,m?N.shape:L.shape,m?[t.batchSize,x,t.outChannels]:[t.batchSize,t.outChannels,x],C,$,T,A,I,v),D=m?[L,N]:[N,L];if(s&&D.push(s),I&&D.push(i),v){const W=r.makeTensorInfo([],"float32",lc(o,"float32"));D.push(W),k.push(W)}const B=r.runWebGLProgram(M,D,"float32"),j=nt({inputs:{x:B},backend:r,attrs:{shape:t.outShape}});k.push(B);for(const W of k)r.disposeIntermediateTensorInfo(W);return j}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:u,dimRoundingMode:f}=r,h=Gl(l),p=ts(s.shape,i.shape,o,u,a,f,!1,h);let g;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))g=sV({x:s,filter:i,convInfo:p,backend:t});else if(p.strideWidth<=2&&h==="channelsLast"&&Te().getBool("WEBGL_EXP_CONV")){const w=new rV(p),x=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];g=t.runWebGLProgram(w,[s,i],"float32",x)}else if(Te().getBool("WEBGL_CONV_IM2COL"))g=iV({x:s,filter:i,convInfo:p,backend:t});else{const w=new nV(p);g=t.runWebGLProgram(w,[s,i],"float32")}const m=nt({inputs:{x:g},backend:t,attrs:{shape:p.outShape}});return t.disposeIntermediateTensorInfo(g),m}const ffe={kernelName:vb,backendName:"webgl",kernelFunc:cfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hfe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class dfe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,l=r-1-e.padInfo.left,u=o?1:2,f=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${f}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class pfe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class gfe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=t-1-e.padInfo.front,u=r-1-e.padInfo.top,f=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:f}=r,h=Gl(l),p=ts(s.shape,f,o,1,a,u,!1,h),g=new hfe(p);return t.runWebGLProgram(g,[s,i],"float32")}const yfe={kernelName:_2,backendName:"webgl",kernelFunc:mfe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wfe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=ys(this.outputShape.length);const t=e.filterHeight,r=e.filterWidth,s=t-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xfe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:u,dimRoundingMode:f}=r,h=Gl(u),p=ts(o,i.shape,a,1,l,f,!1,h);if(Te().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&h==="channelsLast"){const g=[[p.strideHeight,p.strideWidth]],m=new wfe(p);return t.runWebGLProgram(m,[s,i],"float32",g)}else{const g=new dfe(p);return t.runWebGLProgram(g,[s,i],"float32")}}const bfe={kernelName:Sb,backendName:"webgl",kernelFunc:xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=cc(s.shape,i.shape,o,l,a),f=new lfe(u);return t.runWebGLProgram(f,[s,i],"float32")}const Sfe={kernelName:Cb,backendName:"webgl",kernelFunc:vfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:l}=r,u=cc(s.shape,l,o,1,a),f=new pfe(u);return t.runWebGLProgram(f,[s,i],"float32")}const kfe={kernelName:P2,backendName:"webgl",kernelFunc:Cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:l}=r,u=cc(l,i.shape,a,1,o),f=new gfe(u);return t.runWebGLProgram(f,[s,i],"float32")}const Efe={kernelName:F2,backendName:"webgl",kernelFunc:Ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Afe=ig+`
  return cos(x);
`,Tfe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${wh}
  return result;
`,Nfe=Xt({opSnippet:Afe,packedOpSnippet:Tfe}),$fe={kernelName:A0,backendName:"webgl",kernelFunc:Nfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rfe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Ofe=Xt({opSnippet:Rfe}),Dfe={kernelName:T0,backendName:"webgl",kernelFunc:Ofe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _fe{constructor(e,t,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,u]=e,[f]=t,[h,p]=r;this.outputShape=[f,h,p,u];const g=s==="bilinear"?1:0,[m,w]=[`${a-1}.0`,`${l-1}.0`],[x,b,C]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${m} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${m}`],[$,k,N]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${w} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${w}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${$});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${b};
        float width_scale = ${k};

        float in_y = ${C};
        if( in_y < 0.0 || in_y > ${m} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${N};
        if( in_x < 0.0 || in_x > ${w} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${g} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pfe=n=>{const{inputs:e,backend:t,attrs:r}=n,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:u}=r,f=new _fe(s.shape,i.shape,a,l,u);return t.runWebGLProgram(f,[s,i,o],"float32")},Ffe={kernelName:L2,backendName:"webgl",kernelFunc:Pfe};var Vm;(function(n){n.Prod="*",n.Sum="+"})(Vm||(Vm={}));class c_{constructor(e,t,r,s){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===Vm.Prod?"1.0":"0.0",a=r?o:`getX(${f_(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",f="";r?(u=s?`end != ${l-1}`:"end != 0",f=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",f=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${xn(i)} coords = getOutputCoords();
        int end = ${h_(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${f};
          ${h_(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${f_(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function f_(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function h_(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(n,e,t,r,s,i){const o=e.shape.length,a=Zn([r],o);let l=e;a!=null&&(l=Ps({inputs:{x:e},backend:t,attrs:{perm:a}}));const u=pr(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const f=l.shape[u];let h=vi({inputs:{x:l},backend:t});for(let p=0;p<=Math.ceil(Math.log2(f))-1;p++){const g=new c_(n,l.shape,!1,i),m=[[p]],w=h;h=t.runWebGLProgram(g,[h],h.dtype,m),t.disposeIntermediateTensorInfo(w)}if(s){const p=new c_(n,l.shape,s,i),g=h;h=t.runWebGLProgram(p,[h],h.dtype),t.disposeIntermediateTensorInfo(g)}if(a!=null){const p=fc(a),g=Ps({inputs:{x:h},backend:t,attrs:{perm:p}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(l),g}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return oV(Vm.Prod,s,t,i,o,a)}const Lfe={kernelName:M2,backendName:"webgl",kernelFunc:Mfe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return oV(Vm.Sum,s,t,i,o,a)}const zfe={kernelName:kb,backendName:"webgl",kernelFunc:Bfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ufe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const l=t.readSync(s.dataId),u=t.readSync(i.dataId),f=zU(l,u,i.dtype,i.shape,o);return t.makeTensorInfo([o],i.dtype,f)}else if(s.shape.length===2){const l=t.bufferSync(s),u=t.bufferSync(i),f=Hae(l,u,o,a);return t.makeTensorInfo(f.shape,i.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Vfe={kernelName:B2,backendName:"webgl",kernelFunc:Ufe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wfe{constructor(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockSize:i,dataFormat:o}=r,a=s.shape[0],l=o==="NHWC"?s.shape[1]:s.shape[2],u=o==="NHWC"?s.shape[2]:s.shape[3],f=o==="NHWC"?s.shape[3]:s.shape[1],h=l*i,p=u*i,g=f/(i*i),m=o==="NHWC"?[a,h,p,g]:[a,g,h,p],w=new Wfe(m,i,o);return t.runWebGLProgram(w,[s],s.dtype)}const Hfe={kernelName:z2,backendName:"webgl",kernelFunc:Gfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aV{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ys(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",f="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,f="result = activation(result);");const h=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lV{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ys(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=h;let g=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<h;b++)g+=`
          vec4 xTexelC${b*2};
          int xTexelC${b*2}Ready;
          vec4 xTexelC${b*2+1};
          int xTexelC${b*2+1}Ready;
          vec4 xC${b};`;g+=`
    for (int r = 0; r < ${f}; r++) {
      `;for(let b=0;b<h;b++)g+=`
          xTexelC${b*2} = vec4(0.0);
          xTexelC${b*2}Ready = 0;
          xTexelC${b*2+1} = vec4(0.0);
          xTexelC${b*2+1}Ready = 0;
          xC${b} = vec4(0.0);`;g+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let b=0;b<(p+1)/2;b++){const C=b*2;if(g+=`
          xC = xCCorner + ${C*u};
          `,l===1){if(C<h&&(a%2===1?(g+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }
              `,u===1&&C>0?g+=`
                xC${C} = vec4(xTexelC${C-2}.zw, xTexelC${C}.xy);
                `:g+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${C} = vec4(previous.zw, xTexelC${C}.xy);
                  } else {
                    xC${C} = vec4(0.0, 0.0, xTexelC${C}.xy);
                  }
                  `):g+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xC${C} = xTexelC${C};
                `,C+1<h)){const $=a%2===0?v2(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(g+=`
                  xCOffset = xC + imod(pads[1], 2) + ${$};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                    xTexelC${C+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${C+1}.zw = vec2(0.0);
                    }
                    xTexelC${C+1}Ready = 1;
                  }
                  `,u>1?g+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${C+1} = vec4(previous.zw, xTexelC${C+1}.xy);
                    } else {
                     xC${C+1} = vec4(0.0, 0.0, xTexelC${C+1}.xy);
                    }
                    `:g+=`
                    xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.xy);
                    `):$===1?g+=`
                    xC${C+1} = xTexelC${C};
                    `:g+=`
                    xCOffset = xC + ${$};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                      xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${C+1}.zw = vec2(0.0);
                      }
                      xTexelC${C+1}Ready = 1;
                    }

                    xC${C+1} = xTexelC${C+1};
                    `}}else C<h&&(a%2===1?(g+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.0);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
              `,C+1<h&&(g+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${C+1} = vec4(xTexelC${C+1}.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(
                  xTexelC${C}.xy, xTexelC${C+1}.xy);
              `,C+1<h&&(g+=`
                  xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
                `)));C<h&&(g+=`
            wTexel = getW(r, ${C}, d1, q);
            dotProd += xC${C} * vec4(wTexel.xz, wTexel.xz);
          `,C+1<h&&(g+=`
              wTexel = getW(r, ${C+1}, d1, q);
              dotProd += xC${C+1} * vec4(wTexel.xz, wTexel.xz);
            `))}g+=`
    }
  `,g+=`
      }
    `;let m="",w="";r&&(s?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:m=`vec4 activation(vec4 x) {
          ${r}
        }`,w="result = activation(result);");const x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${m}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${g}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${w}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:u}=r;let f=l;f==null&&(f=[1,1]),ee(gs(o,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${f}'`);const h=ts(s.shape,i.shape,o,f,a,u,!0);let p;Te().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?p=new lV(h):p=new aV(h);const g=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return t.runWebGLProgram(p,[s,i],"float32",g)}const Kfe={kernelName:Ib,backendName:"webgl",kernelFunc:jfe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qfe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Xfe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,filterShape:f}=r,h=ts(s.shape,f,o,a,l,u,!0),p=new qfe(h);return t.runWebGLProgram(p,[s,i],"float32")}const Yfe={kernelName:U2,backendName:"webgl",kernelFunc:Qfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jfe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:u,inputShape:f}=r,h=ts(f,i.shape,o,a,l,u,!0),p=new Xfe(h);return t.runWebGLProgram(p,[s,i],"float32")}const Zfe={kernelName:V2,backendName:"webgl",kernelFunc:Jfe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ehe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function the(n){const{inputs:e,backend:t}=n,{x:r}=e,s=[...r.shape,...r.shape],i=De(r.shape),o=nt({inputs:{x:r},backend:t,attrs:{shape:[i]}}),a=new ehe(i),l=t.runWebGLProgram(a,[o],o.dtype),u=nt({inputs:{x:l},backend:t,attrs:{shape:s}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),u}const nhe={kernelName:X3,backendName:"webgl",kernelFunc:the};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rhe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:r,padInfo:s,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:f}=e,{top:h,left:p}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${h}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${f};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function she(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:o,pad:a,dilations:l}=r,u=hy(s.shape,i.shape,o,a,"NHWC",l);let f;const h=new rhe(u);f=t.runWebGLProgram(h,[s,i],"float32");const p=nt({inputs:{x:f},backend:t,attrs:{shape:u.outShape}});return t.disposeIntermediateTensorInfo(f),p}const ihe={kernelName:Eb,backendName:"webgl",kernelFunc:she};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ohe(n){const{inputs:e,backend:t,attrs:r}=n,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:l}=fT(s,i.length);dT(o.length,l,i);const{path:u,steps:f}=pT(a,l),h=f.length;let p=null,g=o.length;const m=[];for(let w=0;w<h;++w){for(const x of f[w]){const{permutationIndices:b,expandDims:C}=hT(g,l[x]);let $;gT(b)?$=i[x]:($=Ps({inputs:{x:i[x]},backend:t,attrs:{perm:b}}),m.push($));const k=$.shape.slice();for(let N=0;N<C.length;++N)k.splice(C[N],0,1);an($.shape,k)||($=nt({inputs:{x:$},backend:t,attrs:{shape:k}}),m.push($)),p===null?p=$:(p=sN({inputs:{a:$,b:p},backend:t}),m.push(p))}w<h-1&&(u[w]>=0&&(p=zv({inputs:{x:p},backend:t,attrs:{axis:u[w]-(o.length-g),keepDims:!1}}),m.push(p)),g--)}for(const w of m)w!==p&&t.disposeIntermediateTensorInfo(w);return p}const ahe={kernelName:W2,backendName:"webgl",kernelFunc:ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe="return (x >= 0.0) ? x : (exp(x) - 1.0);",uhe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,che=Xt({opSnippet:lhe,packedOpSnippet:uhe}),fhe={kernelName:$0,backendName:"webgl",kernelFunc:che};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hhe="return (b >= 0.0) ? a : a * (b + 1.0);",dhe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,phe=n=>{const{inputs:e,backend:t}=n,{dy:r,y:s}=e,i=Te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sg(dhe,r.shape,s.shape):new eh(hhe,r.shape,s.shape);return t.runWebGLProgram(i,[r,s],r.dtype)},ghe={kernelName:G2,backendName:"webgl",kernelFunc:phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mhe=`
  return vec4(equal(a, b));
`,yhe="return float(a == b);",whe=rs({opSnippet:yhe,packedOpSnippet:mhe,dtype:"bool",cpuKernelImpl:Qae}),xhe={kernelName:Ab,backendName:"webgl",kernelFunc:whe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bhe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${sT};
  float a1 = ${iT};
  float a2 = ${oT};
  float a3 = ${aT};
  float a4 = ${lT};
  float a5 = ${uT};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,vhe=Xt({opSnippet:bhe}),She={kernelName:R0,backendName:"webgl",kernelFunc:vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Che=ig+`
  return exp(x);
`,khe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,uV=Xt({opSnippet:Che,packedOpSnippet:khe,cpuKernelImpl:Yae,dtype:"float32"}),Ihe={kernelName:O0,backendName:"webgl",kernelFunc:uV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CE(n){const{inputs:e,attrs:t,backend:r}=n,{dim:s}=t,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=s;return s<0&&(ee(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+s+1),a.splice(l,0,1),nt({inputs:{x:i},backend:r,attrs:{shape:a}})}const Ehe={kernelName:Tb,backendName:"webgl",kernelFunc:CE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d_="return exp(x) - 1.0;",Ahe=Xt({opSnippet:d_,packedOpSnippet:d_,cpuKernelImpl:Jae}),The={kernelName:D0,backendName:"webgl",kernelFunc:Ahe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p_{constructor(e,t,r){this.variableNames=["real","imag"];const s=t[1];this.outputShape=t;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cV(n,e,t){const r=t.texData.get(n.dataId),s=De(n.shape),i=n.shape[n.shape.length-1],o=s/i,a=nt({inputs:{x:n},backend:t,attrs:{shape:[o,i]}}),l=a.shape,u=new p_("real",l,e),f=new p_("imag",l,e),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=t.runWebGLProgram(u,h,"float32"),g=t.runWebGLProgram(f,h,"float32"),m=yc({inputs:{real:p,imag:g},backend:t});t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g);const w=nt({inputs:{x:m},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(m),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nhe(n){const{inputs:e,backend:t}=n,{input:r}=e;return cV(r,!1,t)}const $he={kernelName:H2,backendName:"webgl",kernelFunc:Nhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rhe{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dy(n){const{backend:e,attrs:t}=n,{shape:r,value:s}=t;let{dtype:i}=t;if(i=i||Hp(s),i==="string"){const o=fr(i,De(r));return o.fill(s),e.makeTensorInfo(r,i,o)}else{const o=new Rhe(r,s),a=[[s]];return e.runWebGLProgram(o,[],i,a)}}const Ohe={kernelName:j2,backendName:"webgl",kernelFunc:Dy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dhe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _he={kernelName:K2,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,r=e,s=new Dhe(t.shape);return r.runWebGLProgram(s,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_="return floor(x);",Phe=Xt({opSnippet:g_,packedOpSnippet:g_,cpuKernelImpl:Zae}),Fhe={kernelName:_0,backendName:"webgl",kernelFunc:Phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mhe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Lhe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Bhe=rs({opSnippet:Mhe,packedOpSnippet:Lhe,dtype:"int32"}),zhe={kernelName:P0,backendName:"webgl",kernelFunc:Bhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uhe{constructor(e){this.variableNames=["A"];const t=Fs(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vhe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=Fs(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Whe={kernelName:M8,backendName:"webgl",kernelFunc:Ghe};let ed,kk=Te().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Ghe(n){const{inputs:e,backend:t,attrs:r}=n;let{pixels:s}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],f=[u,l],h=[u,l,i];if(a||o){const w=Te().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(ed==null||w!==kk)&&(kk=w,ed=document.createElement("canvas").getContext("2d",{willReadFrequently:kk})),ed.canvas.width=l,ed.canvas.height=u,ed.drawImage(s,0,0,l,u),s=ed.canvas}const p=t.makeTensorInfo(f,"int32");t.texData.get(p.dataId).usage=Mi.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(p.dataId),s);const g=Te().getBool("WEBGL_PACK")?new Vhe(h):new Uhe(h),m=t.runWebGLProgram(g,[p],"int32");return t.disposeData(p.dataId),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:f,dilations:h,dimRoundingMode:p,activation:g,leakyreluAlpha:m}=r,w=Gl(f),x=ts(s.shape,i.shape,l,h,u,p,!1,w);let b;const C=[],$=o!=null,k=a!=null,N=g==="leakyrelu",_=()=>{const O=[s,i],L=(T,I)=>{if(I==="NCHW"&&T.shape.length===1&&T.shape[0]!==1){const v=nt({inputs:{x:T},backend:t,attrs:{shape:[T.shape[0],1,1]}});return C.push(v),v}return T};if($&&O.push(L(o,f)),k&&O.push(L(a,f)),N){const T=t.makeTensorInfo([],"float32",lc(m,"float32"));O.push(T),C.push(T)}return O};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))b=sV({x:s,filter:i,convInfo:x,backend:t,bias:o,activation:g,preluActivationWeights:a,leakyreluAlpha:m});else if(x.strideWidth<=2&&w==="channelsLast"&&Te().getBool("WEBGL_EXP_CONV")){const O=g?zm(g,!0):null,L=new rV(x,$,O,k,N),T=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],I=_();b=t.runWebGLProgram(L,I,"float32",T)}else if(Te().getBool("WEBGL_CONV_IM2COL"))b=iV({x:s,filter:i,convInfo:x,backend:t,bias:o,activation:g,preluActivationWeights:a,leakyreluAlpha:m});else{const O=g?zm(g,!1):null,L=new nV(x,$,O,k,N),T=_();b=t.runWebGLProgram(L,T,"float32")}const U=nt({inputs:{x:b},backend:t,attrs:{shape:x.outShape}});return C.push(b),C.forEach(O=>t.disposeIntermediateTensorInfo(O)),U}const jhe={kernelName:a1,backendName:"webgl",kernelFunc:Hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Khe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:f,dimRoundingMode:h,activation:p,leakyreluAlpha:g}=r,m=[];let w=f;w==null&&(w=[1,1]),ee(gs(l,w),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${w}'`);const x=ts(s.shape,i.shape,l,w,u,h,!0),b=Te().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,C=p?zm(p,b):null,$=[s,i],k=o!=null,N=a!=null,_=p==="leakyrelu";if(k&&$.push(o),N&&$.push(a),_){const T=t.makeTensorInfo([],"float32",lc(g,"float32"));$.push(T),m.push(T)}let U;b?U=new lV(x,k,C,N,_):U=new aV(x,k,C,N,_);const O=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],L=t.runWebGLProgram(U,$,"float32",O);return m.forEach(T=>t.disposeIntermediateTensorInfo(T)),L}const qhe={kernelName:pM,backendName:"webgl",kernelFunc:Khe};class Xhe{constructor(e,t,r,s){this.sliceDim=e,this.strides=t,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=xn(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qhe(n){const{inputs:e,backend:t}=n,{params:r,indices:s}=e,i=s.shape,o=i[i.length-1],a=De(r.shape),[l,u,f,h]=KA(r,s),p=nt({inputs:{x:s},backend:t,attrs:{shape:[u,o]}}),g=nt({inputs:{x:r},backend:t,attrs:{shape:[De(r.shape)/f,f]}});if(t.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const b=t.readSync(s.dataId),C=t.bufferSync(r),$=ele(b,C,r.dtype,u,o,f,h,r.shape,a);return t.makeTensorInfo(l,r.dtype,$.values)}const m=new Xhe(o,h,[u,f],r.shape),w=t.runWebGLProgram(m,[g,p],g.dtype),x=nt({inputs:{x:w},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(w),x}const Yhe={kernelName:Q3,backendName:"webgl",kernelFunc:Qhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jhe{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const r=xn(this.rank),s=Zhe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function Zhe(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<n.length;s++)s===2?r.push("index"):r.push(`${t[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fV(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,indices:i}=e,{axis:o,batchDims:a}=r,l=zt(o,s.shape)[0];if(Te().get("DEBUG")){const C=t.readSync(i.dataId),$=s.shape[l];for(let k=0;k<C.length;++k){const N=C[k];ee(N<=$-1&&N>=0,()=>`GatherV2: the index value ${N} is not in [0, ${$-1}]`)}}const u=yT(s,i,l,a),f=De(i.shape),h=[],p=nt({inputs:{x:s},backend:t,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),g=nt({inputs:{x:i},backend:t,attrs:{shape:[u.batchSize,f/u.batchSize]}});h.push(p),h.push(g);const m=[u.batchSize,u.outerSize,f/u.batchSize,u.sliceSize];if(t.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const C=t.bufferSync(g),$=t.bufferSync(p),k=tle($,C,m);return h.forEach(N=>t.disposeIntermediateTensorInfo(N)),t.makeTensorInfo(u.outputShape,k.dtype,k.values)}const w=new Jhe(p.shape,m),x=t.runWebGLProgram(w,[p,g],p.dtype);h.push(x);const b=nt({inputs:{x},backend:t,attrs:{shape:u.outputShape}});return h.forEach(C=>t.disposeIntermediateTensorInfo(C)),b}const ede={kernelName:$b,backendName:"webgl",kernelFunc:fV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tde="return float(a > b);",nde=`
  return vec4(greaterThan(a, b));
`,rde=rs({opSnippet:tde,packedOpSnippet:nde,cpuKernelImpl:nle,dtype:"bool"}),sde={kernelName:Rb,backendName:"webgl",kernelFunc:rde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ide="return float(a >= b);",ode=`
  return vec4(greaterThanEqual(a, b));
`,ade=rs({opSnippet:ide,packedOpSnippet:ode,dtype:"bool",cpuKernelImpl:rle}),lde={kernelName:F0,backendName:"webgl",kernelFunc:ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ude(n){const{inputs:e,backend:t}=n,{input:r}=e;return cV(r,!0,t)}const cde={kernelName:q2,backendName:"webgl",kernelFunc:ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fde="return float(!isnan(x) && !isinf(x));",hde=Xt({opSnippet:fde,dtype:"bool"}),dde={kernelName:L0,backendName:"webgl",kernelFunc:hde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pde="return float(isinf(x));",gde=Xt({opSnippet:pde,dtype:"bool"}),mde={kernelName:B0,backendName:"webgl",kernelFunc:gde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yde="return float(isnan(x));",wde=Xt({opSnippet:yde,dtype:"bool"}),xde={kernelName:z0,backendName:"webgl",kernelFunc:wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bde="return float(a < b);",vde=`
  return vec4(lessThan(a, b));
`,Sde=rs({opSnippet:bde,packedOpSnippet:vde,cpuKernelImpl:sle,dtype:"bool"}),Cde={kernelName:Db,backendName:"webgl",kernelFunc:Sde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kde="return float(a <= b);",Ide=`
  return vec4(lessThanEqual(a, b));
`,Ede=rs({opSnippet:kde,packedOpSnippet:Ide,cpuKernelImpl:ile,dtype:"bool"}),Ade={kernelName:_b,backendName:"webgl",kernelFunc:Ede};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tde(n){const{backend:e,attrs:t}=n,{start:r,stop:s,num:i}=t,o=ole(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const Nde={kernelName:Y3,backendName:"webgl",kernelFunc:Tde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $de=ig+`
  return x < 0.0 ? 0./0. : log(x);
`,Rde=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Ode=Xt({opSnippet:$de,packedOpSnippet:Rde,cpuKernelImpl:ale}),Dde={kernelName:U0,backendName:"webgl",kernelFunc:Ode};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _de=ig+`
  return log(1.0 + x);
`,Pde=Xt({opSnippet:_de}),Fde={kernelName:V0,backendName:"webgl",kernelFunc:Pde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mde="return float(a >= 1.0 && b >= 1.0);",Lde=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Bde=rs({opSnippet:Mde,packedOpSnippet:Lde,dtype:"bool"}),zde={kernelName:Pb,backendName:"webgl",kernelFunc:Bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ude="return float(!(x >= 1.0));",Vde=Xt({opSnippet:Ude}),Wde={kernelName:Fb,backendName:"webgl",kernelFunc:Vde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gde="return float(a >= 1.0 || b >= 1.0);",Hde=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,jde=rs({opSnippet:Gde,packedOpSnippet:Hde,dtype:"bool"}),Kde={kernelName:Mb,backendName:"webgl",kernelFunc:jde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qde{constructor(e,t,r,s,i){this.variableNames=["x"],this.outputShape=[];const o=t,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xde{constructor(e,t,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=t,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qde=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=r,u=Te().getBool("WEBGL_PACK_NORMALIZATION")?new Xde(s.shape,i,o,a,l):new qde(s.shape,i,o,a,l);return t.runWebGLProgram(u,[s],s.dtype)},Yde={kernelName:Lb,backendName:"webgl",kernelFunc:Qde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jde{constructor(e,t,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zde=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:u,beta:f}=r,h=new Jde(s.shape,a,l,u,f);return t.runWebGLProgram(h,[s,i,o],s.dtype)},epe={kernelName:Q2,backendName:"webgl",kernelFunc:Zde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpe(n,e,t,r){const s=De(e),o=De(n.shape)/s,a=nt({inputs:{x:n},attrs:{shape:[o,s]},backend:r}),l=xh(a,n.dtype,"max",r),u=nt({inputs:{x:l},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=s.shape.length,l=zt(i,s.shape);let u=l;const f=Zn(u,a),h=f!=null,p=t.shouldExecuteOnCPU([s]);let g=s;if(h){if(p){const $=t.texData.get(g.dataId).values,k=new Array(a);for(let U=0;U<k.length;U++)k[U]=s.shape[f[U]];const N=nN($,s.shape,s.dtype,f,k);g=t.makeTensorInfo(k,s.dtype);const _=t.texData.get(g.dataId);_.values=N}else g=Bv(s,f,t);u=pr(u.length,a)}ns("max",u,a);const[m,w]=Gr(g.shape,u);let x=m;o&&(x=Ir(m,l));let b;if(p){const $=t.texData.get(g.dataId).values,k=lle($,De(w),x,s.dtype);b=t.makeTensorInfo(x,s.dtype);const N=t.texData.get(b.dataId);N.values=k}else b=tpe(g,w,x,t);return h&&t.disposeIntermediateTensorInfo(g),b}const npe={kernelName:Bb,backendName:"webgl",kernelFunc:hV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rpe=rN+`
  return max(a, b);
`,spe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+wh+`
  return result;
`,ipe=rs({opSnippet:rpe,packedOpSnippet:spe,cpuKernelImpl:ule}),ope={kernelName:W0,backendName:"webgl",kernelFunc:ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ape(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;$y(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=r,u=1;ee(gs(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const f=wo(s.shape,i,o,u,a,l);if(f.filterWidth===1&&f.filterHeight===1&&an(f.inShape,f.outShape))return vi({inputs:{x:s},backend:t});const h=new Um(f,"max",!1);return t.runWebGLProgram(h,[s],s.dtype)}const lpe={kernelName:zb,backendName:"webgl",kernelFunc:ape};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function upe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:u}=r,f=[1,1,1],h=Wl(s.shape,i,o,f,a,u,l),p=new iN(h,"max",!1);return t.runWebGLProgram(p,[s],s.dtype)}const cpe={kernelName:Ub,backendName:"webgl",kernelFunc:upe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fpe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class hpe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=l-1-e.padInfo.front,p=u-1-e.padInfo.top,g=f-1-e.padInfo.left,m=l*u*f-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${p}, ${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${m} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${f} +
                  wR * ${f} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,o=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:f}=r,h=[1,1,1],p=Wl(o.shape,a,l,h,u,f),g=new iN(p,"max",!0),m=t.runWebGLProgram(g,[o],o.dtype),w=new hpe(p),x=t.runWebGLProgram(w,[s,m],o.dtype);return t.disposeIntermediateTensorInfo(m),x}const ppe={kernelName:J2,backendName:"webgl",kernelFunc:dpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gpe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i,output:o}=e,a=i;$y([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:f,dimRoundingMode:h}=r,p=wo(a.shape,l,u,1,f,h),g=!0,m=new Um(p,"max",g),w=t.runWebGLProgram(m,[a],a.dtype),x=new fpe(p),b=t.runWebGLProgram(x,[s,w],a.dtype);return t.disposeIntermediateTensorInfo(w),b}const mpe={kernelName:Y2,backendName:"webgl",kernelFunc:gpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ype(n,e,t,r){let s=new Um(t,"max",!1);const i=r.runWebGLProgram(s,[n],"float32");s=new Um(t,"max",!0,!0,e);const o=r.runWebGLProgram(s,[n],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wpe={kernelName:J3,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,l=t;ee(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];ee(gs(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const f=wo(r.shape,s,i,u,o),[h,p]=ype(r,a,f,l);return[h,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpe(n,e,t,r){const s=De(e),o=De(n.shape)/s,a=nt({inputs:{x:n},attrs:{shape:[o,s]},backend:r}),l=xh(a,"float32","mean",r),u=nt({inputs:{x:l},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bpe={kernelName:Vb,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{keepDims:s,axis:i}=e,o=t,a=r.shape.length,l=zt(i,r.shape);let u=l;const f=Zn(u,a),h=f!=null,p=o.shouldExecuteOnCPU([r]),g=[];let m=r;if(h){if(p){const k=o.texData.get(m.dataId).values,N=new Array(a);for(let O=0;O<N.length;O++)N[O]=r.shape[f[O]];const _=nN(k,r.shape,r.dtype,f,N);m=o.makeTensorInfo(N,r.dtype);const U=o.texData.get(m.dataId);U.values=_}else m=Bv(r,f,o);g.push(m),u=pr(u.length,a)}ns("sum",u,a);const[w,x]=Gr(m.shape,u);let b=w;s&&(b=Ir(w,l));const C=xpe(m,x,b,o);for(const $ of g)o.disposeIntermediateTensorInfo($);return C}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vpe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=zt(i,s.shape);let u=l;const f=Zn(u,a);let h=s;f!=null&&(h=Ps({inputs:{x:s},backend:t,attrs:{perm:f}}),u=pr(u.length,s.shape.length)),ns("min",u,a);const[p,g]=Gr(h.shape,u),m=De(g),w=nt({inputs:{x:h},backend:t,attrs:{shape:[-1,m]}}),x=xh(w,w.dtype,"min",t);let b;if(o){const C=Ir(p,l);b=nt({inputs:{x},backend:t,attrs:{shape:C}})}else b=nt({inputs:{x},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),f!=null&&t.disposeIntermediateTensorInfo(h),b}const Spe={kernelName:Wb,backendName:"webgl",kernelFunc:vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpe=rN+`
  return min(a, b);
`,kpe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+wh+`
  return result;
`,Ipe=rs({opSnippet:Cpe,packedOpSnippet:kpe,cpuKernelImpl:cle}),Epe={kernelName:G0,backendName:"webgl",kernelFunc:Ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ape{constructor(e,t,r){this.variableNames=["x"],this.outputShape=t.map((f,h)=>f[0]+e[h]+f[1]);const s=e.length,i=xn(s),o=t.map(f=>f[0]).join(","),a=t.map((f,h)=>f[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tpe{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((m,w)=>m[0]+e[w]+m[1]);const s=e.length,i=xn(s),o=t.map(m=>m[0]).join(","),a=t.map((m,w)=>m[0]+e[w]).join(","),l=Os("rc",s),u=Os("source",s),f=`${l[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${u.slice(-2).join()})`,p=r==="reflect"?0:1;let g="";if(s===1){const m=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;g=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${h});
        ${l[s-1]} += 1;
        if(${f}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${h});
        }
      `}else{const m=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;g=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${h});
        ${l[s-1]} += 1;
        if(${f}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${h});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${m}
          result[2] = getChannel(getX(${u.join()}), ${h});
          ${l[s-1]} += 1;
          if(${f}) {
            ${m}
            result[3] = getChannel(getX(${u.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npe=({inputs:n,backend:e,attrs:t})=>{const{x:r}=n,{paddings:s,mode:i}=t,o=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Tpe(r.shape,s,i):new Ape(r.shape,s,i);return e.runWebGLProgram(o,[r],r.dtype)},$pe={kernelName:Gb,backendName:"webgl",kernelFunc:Npe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rpe=`if (b == 0.0) return NAN;
  return mod(a, b);`,Ope=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+wh+`
  return result;
`,Dpe=rs({opSnippet:Rpe,packedOpSnippet:Ope}),_pe={kernelName:H0,backendName:"webgl",kernelFunc:Dpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ppe{constructor(e,t,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fpe=`
if (a == b) {
  return 1.0;
};
return a / b;`,Mpe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,dV=rs({opSnippet:Fpe,packedOpSnippet:Mpe,checkOutOfBounds:!0}),Lpe={kernelName:N0,backendName:"webgl",kernelFunc:dV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m_="return a - b;",pV=rs({opSnippet:m_,packedOpSnippet:m_,supportsComplex:!0,cpuKernelImpl:Rle}),Bpe={kernelName:ay,backendName:"webgl",kernelFunc:pV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gV(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{dim:i}=r,o=zt([i],s.shape),a=hV({inputs:{x:s},backend:t,attrs:{reductionIndices:o,keepDims:!1}}),l=Ir(a.shape,o),u=nt({inputs:{x:a},backend:t,attrs:{shape:l}}),f=pV({inputs:{a:s,b:u},backend:t}),h=uV({inputs:{x:f},backend:t}),p=zv({inputs:{x:h},backend:t,attrs:{axis:o,keepDims:!1}}),g=nt({inputs:{x:p},backend:t,attrs:{shape:l}}),m=dV({inputs:{a:h,b:g},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),m}const zpe={kernelName:lv,backendName:"webgl",kernelFunc:gV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Upe(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r,l=a?s:gV({inputs:{logits:s},backend:t,attrs:{dim:s.shape.length-1}}),u=l.shape[0],f=l.shape[1],h=new Ppe(u,f,i),p=[[o]],g=t.runWebGLProgram(h,[l],"int32",p);return a||t.disposeIntermediateTensorInfo(l),g}const Vpe={kernelName:Z3,backendName:"webgl",kernelFunc:Upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wpe=bo+`
  return -x;
`,Gpe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Hpe(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])){const i=t.texData.get(r.dataId),[o,a]=hle(i.values,r.shape,r.dtype);return t.makeTensorInfo(a,r.dtype,o)}let s;return Te().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Gu(r.shape,Gpe):s=new Pa(r.shape,Wpe),t.runWebGLProgram(s,[r],r.dtype)}const jpe={kernelName:Hb,backendName:"webgl",kernelFunc:Hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kpe=UA;function qpe(n){Pi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=r,u=t.readSync(s.dataId),f=t.readSync(i.dataId),{selectedIndices:h}=Kpe(u,f,o,a,l);return t.makeTensorInfo([h.length],"int32",new Int32Array(h))}const Xpe={kernelName:Z2,backendName:"webgl",kernelFunc:qpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qpe=VA;function Ype(n){Pi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,f=t.readSync(s.dataId),h=t.readSync(i.dataId),{selectedIndices:p,validOutputs:g}=Qpe(f,h,o,a,l,u);return[t.makeTensorInfo([p.length],"int32",new Int32Array(p)),t.makeTensorInfo([],"int32",new Int32Array([g]))]}const Jpe={kernelName:eA,backendName:"webgl",kernelFunc:Ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zpe=WA;function ege(n){Pi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,f=t.readSync(s.dataId),h=t.readSync(i.dataId),p=o,g=a,m=l,w=u,{selectedIndices:x,selectedScores:b}=Zpe(f,h,p,g,m,w);return[t.makeTensorInfo([x.length],"int32",new Int32Array(x)),t.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const tge={kernelName:tA,backendName:"webgl",kernelFunc:ege};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nge{constructor(e,t,r,s){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rge=n=>{const{inputs:e,backend:t,attrs:r}=n,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:l}=r,u=De(s.shape),f=new nge(u,o,a,l),h=nt({inputs:{x:s},backend:t,attrs:{shape:[u]}}),p=t.runWebGLProgram(f,[h],i);t.disposeIntermediateTensorInfo(h);const g=[...s.shape,o],m=nt({inputs:{x:p},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(p),m},sge={kernelName:qb,backendName:"webgl",kernelFunc:rge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="complex64"){const s=Oy({inputs:{input:r},backend:t}),i=_1({inputs:{x:s},backend:t}),o=Uv({inputs:{input:r},backend:t}),a=_1({inputs:{x:o},backend:t}),l=yc({inputs:{real:i,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return Dy({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:t})}const ige={kernelName:fv,backendName:"webgl",kernelFunc:_1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Oy({inputs:{input:r},backend:t}),i=mV({inputs:{x:s},backend:t}),o=Uv({inputs:{input:r},backend:t}),a=_1({inputs:{x:o},backend:t}),l=yc({inputs:{real:i,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return Dy({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:t})}const oge={kernelName:Kb,backendName:"webgl",kernelFunc:mV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function age(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r;if(e.length===1)return CE({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(f=>{S2(i,f.shape,"All tensors passed to stack must have matching shapes"),ee(o===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(f=>{const h=CE({inputs:{input:f},backend:t,attrs:{dim:s}});return a.push(h),h}),u=tV({inputs:l,backend:t,attrs:{axis:s}});return a.forEach(f=>t.disposeIntermediateTensorInfo(f)),u}const lge={kernelName:Xb,backendName:"webgl",kernelFunc:age};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uge{constructor(e,t,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((u,f)=>u[0]+e[f]+u[1]);const s=e.length,i=xn(s),o=t.map(u=>u[0]).join(","),a=t.map((u,f)=>u[0]+e[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cge{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((w,x)=>w[0]+e[x]+w[1]);const s=e.length,i=xn(s),o=t.map(w=>w[0]).join(","),a=t.map((w,x)=>w[0]+e[x]).join(","),l=Os("rc",s),u=Os("source",s),f=`${l[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${u.slice(-2).join()})`,p=[`${i} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${f}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${f}) {`],g=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let m="";for(let w=0,x=s===1?2:4;w<x;w++)m+=`
        ${p[w]}
        if (${g}) {
          result[${w}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${w}] = getChannel(getX(${u.join()}), ${h});
        }
      `;m+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yV=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,constantValue:o}=r;if(De(s.shape)===0){const u=i.map((f,h)=>f[0]+s.shape[h]+f[1]);return Dy({backend:t,attrs:{shape:u,value:o,dtype:s.dtype}})}const a=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cge(s.shape,i,o):new uge(s.shape,i,o),l=[[o]];return t.runWebGLProgram(a,[s],s.dtype,l)},fge={kernelName:Qb,backendName:"webgl",kernelFunc:yV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hge=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,dge=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+wh+`
  return result;
`,pge=rs({opSnippet:hge,packedOpSnippet:dge}),gge={kernelName:K0,backendName:"webgl",kernelFunc:pge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mge(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,l=[],u=zt(i,s.shape);let f=u;const h=Zn(f,a);let p=s;h!=null&&(p=Ps({inputs:{x:s},backend:t,attrs:{perm:h}}),f=pr(f.length,a),l.push(p)),ns("prod",f,a);let g;if(t.shouldExecuteOnCPU([p])){const m=t.texData.get(p.dataId).values,{outVals:w,outShape:x,outDtype:b}=ple(p.shape,p.dtype,m,f);g=t.makeTensorInfo(x,b,w)}else{const[m,w]=Gr(p.shape,f),x=De(w),b=nt({inputs:{x:p},backend:t,attrs:{shape:[-1,x]}}),C=dA(s.dtype),$=xh(b,C,"prod",t);g=nt({inputs:{x:$},backend:t,attrs:{shape:m}}),l.push(b),l.push($)}if(o){l.push(g);const m=Ir(g.shape,u);g=nt({inputs:{x:g},backend:t,attrs:{shape:m}})}return l.forEach(m=>t.disposeIntermediateTensorInfo(m)),g}const yge={kernelName:Jb,backendName:"webgl",kernelFunc:mge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wge(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,l=s.map(b=>t.readSync(b.dataId)),u=s.map(b=>b.shape),f=t.readSync(i.dataId),h=t.readSync(o.dataId),[p,g,m]=gle(l,u,f,i.shape,i.dtype,h,o.shape,a),w=p.map(b=>t.makeTensorInfo([b.length],"int32",b)),x=t.makeTensorInfo(m,i.dtype,g);return w.concat([x])}const xge={kernelName:eM,backendName:"webgl",kernelFunc:wge};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bge(n){const{inputs:e,backend:t}=n,{starts:r,limits:s,deltas:i}=e,o=t.readSync(r.dataId),a=t.readSync(s.dataId),l=t.readSync(i.dataId),[u,f]=mle(o,r.shape,r.dtype,a,s.shape,l,i.shape),h=t.makeTensorInfo([u.length],"int32",u),p=t.makeTensorInfo([f.length],r.dtype,f);return[h,p]}const vge={kernelName:tM,backendName:"webgl",kernelFunc:bge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge(n){const{inputs:e,backend:t,attrs:r}=n,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=t.readSync(s.dataId),f=t.readSync(i.dataId),h=t.readSync(o.dataId),p=a.map(x=>t.readSync(x.dataId)),g=a.map(x=>x.shape),[m,w]=yle(u,s.shape,f,i.shape,i.dtype,h,o.shape,p,g,l);return t.makeTensorInfo(m,i.dtype,w)}const Cge={kernelName:nM,backendName:"webgl",kernelFunc:Sge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wV=n=>{const{backend:e,attrs:t}=n,{start:r,stop:s,step:i,dtype:o}=t,a=wle(r,s,i,o);return e.makeTensorInfo([a.length],o,a)},kge={kernelName:nA,backendName:"webgl",kernelFunc:wV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ige="return 1.0 / x;",Ege=Xt({opSnippet:Ige}),Age={kernelName:q0,backendName:"webgl",kernelFunc:Ege};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tge=bo+`
  return (x < 0.0) ? 0.0 : x;
`,Nge=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$ge=Xt({opSnippet:Tge,packedOpSnippet:Nge}),Rge={kernelName:X0,backendName:"webgl",kernelFunc:$ge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge=bo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Dge=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_ge=Xt({opSnippet:Oge,packedOpSnippet:Dge}),Pge={kernelName:Q0,backendName:"webgl",kernelFunc:_ge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fge{constructor(e,t,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,t,r,u];const f=[s&&t>1?a-1:a,s&&r>1?l-1:l],h=[s&&t>1?t-1:t,s&&r>1?r-1:r];let p;i?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${f[0]/h[0]},
          ${f[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mge{constructor(e,t,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,t,r,u];const f=[s&&t>1?a-1:a,s&&r>1?l-1:l],h=[s&&t>1?t-1:t,s&&r>1?r-1:r];let p;i?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${f[0]/h[0]},
          ${f[1]/h[1]},
          ${f[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lge(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,f=Te().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Mge(s.shape,l,u,i,o):new Fge(s.shape,l,u,i,o);return t.runWebGLProgram(f,[s],"float32")}const Bge={kernelName:tv,backendName:"webgl",kernelFunc:Lge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zge{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,i]=t,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],f=l[0]/u[0],h=l[1]/u[1],p=1/f,g=1/h,m=Math.ceil(p)*2+2,w=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${f});
        const float widthScale = float(${h});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${m});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uge(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:o}=r,a=new zge(i.shape,s.shape,o);return t.runWebGLProgram(a,[i],i.dtype)}const Vge={kernelName:iA,backendName:"webgl",kernelFunc:Uge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wge{constructor(e,t,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,t,r,u];const f=[s&&t>1?a-1:a,s&&r>1?l-1:l],h=[s&&t>1?t-1:t,s&&r>1?r-1:r],p=s?"0.5":"0.0";let g;i?g="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${f[0]/h[0]},
          ${f[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gge{constructor(e,t,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,u]=e;this.outputShape=[o,t,r,u];const f=[s&&t>1?a-1:a,s&&r>1?l-1:l],h=[s&&t>1?t-1:t,s&&r>1?r-1:r],p=s?"0.5":"0.0";let g;i?g="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${f[0]/h[0]},
          ${f[1]/h[1]},
          ${f[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hge(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[l,u]=a,f=Te().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Gge(s.shape,l,u,i,o):new Wge(s.shape,l,u,i,o);return t.runWebGLProgram(f,[s],s.dtype)}const jge={kernelName:ev,backendName:"webgl",kernelFunc:Hge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kge{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,i]=t,[,o,a]=e,l=[r&&o>1?s-1:s,r&&a>1?i-1:i],u=[r&&o>1?o-1:o,r&&a>1?a-1:a],f=l[0]/u[0],h=l[1]/u[1],p=1/f,g=1/h,m=Math.ceil(p)*2+2,w=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${f});
        const float widthScale = float(${h});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${m});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qge(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:o}=r,a=new Kge(i.shape,s.shape,o);return t.runWebGLProgram(a,[i],i.dtype)}const Xge={kernelName:sA,backendName:"webgl",kernelFunc:qge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qge{constructor(e,t){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>t.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>s(l)).join(","),o=xn(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yge{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=Os("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=xn(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${i}){
            result.g = ${u(s.slice())};
          }
          if(${o}) {
            result.b = ${f(s.slice())};
            if(${i}) {
              result.a = ${h(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(m){return p(m)}function u(m){return m[r-1]="("+m[r-1]+" + 1)",p(m)}function f(m){return m[r-2]="("+m[r-2]+" + 1)",p(m)}function h(m){return m[r-1]="("+m[r-1]+" + 1)",m[r-2]="("+m[r-2]+" + 1)",p(m)}function p(m){const w=e.map((C,$)=>g($,m)),x=w.join(","),b=w.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${b}))`}function g(m,w){return t.indexOf(m)!==-1&&e[m]!==1?`${e[m]} - ${w[m]} - 1`:`${w[m]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jge(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dims:i}=r,o=s.shape.length,a=zt(i,s.shape);if(o===0)return vi({inputs:{x:s},backend:t});const l=Te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Yge(s.shape,a):new Qge(s.shape,a);return t.runWebGLProgram(l,[s],s.dtype)}const Zge={kernelName:nv,backendName:"webgl",kernelFunc:Jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eme{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof t=="number"?i=`float outputValue = ${t.toFixed(2)};`:i=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tme={kernelName:hA,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:s,fillValue:i,center:o}=e,a=t,l=new eme(r.shape,i),[u,f]=tT(o,r.shape[1],r.shape[2]),h=[[u,f,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nme=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,rme=Xt({opSnippet:nme}),sme={kernelName:Y0,backendName:"webgl",kernelFunc:rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ime="return inversesqrt(x);",ome=Xt({opSnippet:ime,cpuKernelImpl:xle}),ame={kernelName:J0,backendName:"webgl",kernelFunc:ome};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oN{constructor(e,t,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=xn(i.length),f=xn(o.length);let h="";r===1?h="i":r===2&&(h="i, j");const p=`getIndices(${h})`;let g="";s===1?g="i":s===2&&(g="i, coords[1]");const m=`getUpdates(${g})`;let w="";l&&(w="coords[0], coords[1]");const x=`getDefaultValue(${w})`,b=t>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${f} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${b};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${m};
              found = true;
            }
          }
          setOutput(mix(${x}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lme{constructor(e,t,r,s,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=xn(i.length),f=xn(o.length);let h="";r===1?h="i":r===2&&(h="i, j");const p=`getIndices(${h})`;let g="";s===1?g="i":s===2&&(g="i, coords[1]");const m=`getUpdates(${g})`;let w="";l&&(w="coords[0], coords[1]");const x=`getDefaultValue(${w})`,b=t>1?"strides[j]":"strides",C=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${f} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${p});
              flattenedIndex += index.xz * ${b};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${C};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${m};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${x}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ume(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:f,outputSize:h}=dh(i,s,o),p=[h/u,u];if(h===0)return t.makeTensorInfo(o,s.dtype);const g=nt({inputs:{x:s},backend:t,attrs:{shape:[l,a]}}),m=nt({inputs:{x:i},backend:t,attrs:{shape:[l,u]}}),w=t.makeTensorInfo([],"float32",new Float32Array([0]));let x;Te().getBool("WEBGL_PACK")?x=new lme(l,a,g.shape.length,m.shape.length,f,p):x=new oN(l,a,g.shape.length,m.shape.length,f,p);const b=t.runWebGLProgram(x,[m,g,w],m.dtype),C=nt({inputs:{x:b},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(w),C}const cme={kernelName:rM,backendName:"webgl",kernelFunc:ume};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fme{constructor(e,t,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,a=Te().getNumber("WEBGL_VERSION")===2?i:o,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hme(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:s,values:i}=e,{side:o}=r,a=new fme(s.shape[0],s.shape[1],i.shape[1],o),l=[[s.shape[1]]];return t.runWebGLProgram(a,[s,i],"int32",l)}const dme={kernelName:iM,backendName:"webgl",kernelFunc:hme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pme{constructor(e,t,r){this.variableNames=["c","a","b"],this.outputShape=t;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let f=0;f<t.length;f++)u.push(`${a[f]}`),f<e&&l.push(`${a[f]}`);s=l.join(),i=u.join()}const o=xn(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gme(n){const{inputs:e,backend:t}=n,{condition:r,t:s,e:i}=e,o=new pme(r.shape.length,s.shape,s.shape.length);return t.runWebGLProgram(o,[r,s,i],xi(s.dtype,i.dtype))}const mme={kernelName:rv,backendName:"webgl",kernelFunc:gme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yme=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Cv};
  float scale = ${kv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,wme=Xt({opSnippet:yme}),xme={kernelName:Z0,backendName:"webgl",kernelFunc:wme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bme=ig+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,vme=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Sme=Xt({opSnippet:bme,packedOpSnippet:vme,cpuKernelImpl:vle}),Cme={kernelName:ry,backendName:"webgl",kernelFunc:Sme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kme=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Ime=Xt({opSnippet:kme}),Eme={kernelName:ny,backendName:"webgl",kernelFunc:Ime};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ame=ig+`
  return sin(x);
`,Tme=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${wh}
  return result;
`,Nme=Xt({opSnippet:Ame,packedOpSnippet:Tme}),$me={kernelName:ey,backendName:"webgl",kernelFunc:Nme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rme=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Ome=Xt({opSnippet:Rme}),Dme={kernelName:ty,backendName:"webgl",kernelFunc:Ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _me=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Pme=Xt({opSnippet:_me}),Fme={kernelName:sy,backendName:"webgl",kernelFunc:Pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mme=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,paddings:o}=r;ee(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((b,C)=>b*C),l=[[0,0]];l.push(...o);for(let b=1+i.length;b<s.shape.length;++b)l.push([0,0]);const u=[],f=yV({inputs:{x:s},backend:t,attrs:{paddings:l,constantValue:0}}),h=yy(f.shape,i,a,!1),p=wy(h.length,i.length,!1),g=xy(f.shape,i,a,!1),m=nt({inputs:{x:f},backend:t,attrs:{shape:h}}),w=Ps({inputs:{x:m},backend:t,attrs:{perm:p}}),x=nt({inputs:{x:w},backend:t,attrs:{shape:g}});return u.push(f),u.push(m),u.push(w),u.forEach(b=>t.disposeIntermediateTensorInfo(b)),x},Lme={kernelName:ov,backendName:"webgl",kernelFunc:Mme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bme(n){const{inputs:e,backend:t}=n,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=t.readSync(r.dataId),l=t.readSync(s.dataId),u=t.readSync(i.dataId),f=t.readSync(o.dataId)[0],[h,p,g,m,w]=Cle(a,r.shape,r.dtype,l,s.dtype,u,f);return[t.makeTensorInfo(p,r.dtype,h),t.makeTensorInfo([p[0]],s.dtype,g),t.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(x=>Number(x)))),t.makeTensorInfo([w.length],r.dtype,new Int32Array(w))]}const zme={kernelName:oM,backendName:"webgl",kernelFunc:Bme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ume(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(t.readSync(s.dataId)),a=t.readSync(r.dataId),l=Array.from(t.readSync(i.dataId)),[u,f,h]=kle(a,r.shape,r.dtype,o,l);return[t.makeTensorInfo(f,r.dtype,u),t.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const Vme={kernelName:aM,backendName:"webgl",kernelFunc:Ume};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wme(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=t.readSync(r.dataId),a=t.readSync(s.dataId),l=t.readSync(i.dataId),[u,f]=VU(o,r.shape,r.dtype,a,l,!0);return t.makeTensorInfo(f,r.dtype,u)}const Gme={kernelName:lM,backendName:"webgl",kernelFunc:Wme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hme(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=t.readSync(r.dataId),a=t.readSync(s.dataId),l=t.readSync(i.dataId),[u,f]=VU(o,r.shape,r.dtype,a,l);return t.makeTensorInfo(f,r.dtype,u)}const jme={kernelName:uM,backendName:"webgl",kernelFunc:Hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kme(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:f,strides:h,outputSize:p}=dh(i,s,a),g=!1;if(i.dtype==="string"){const b=t.bufferSync(s),C=t.bufferSync(i),$=Qu(t.readSync(o.dataId)[0]),k=ble(b,C,a,p,f,u,l,h,$,g);return t.makeTensorInfo(a,k.dtype,k.values)}const m=new oN(u,l,s.shape.length,i.shape.length,h,[p,1],g),w=t.runWebGLProgram(m,[i,s,o],i.dtype),x=nt({inputs:{x:w},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(w),x}const qme={kernelName:cM,backendName:"webgl",kernelFunc:Kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xme(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=zt(o,s.shape)[0],l=mT(s,i,a),u=s.shape.length,f=new Array(u).fill(0),h=s.shape.slice();return l.map(p=>{const g=[...h];g[a]=p;const m=og({inputs:{x:s},backend:t,attrs:{begin:f,size:g}});return f[a]+=p,m})}const Qme={kernelName:av,backendName:"webgl",kernelFunc:Xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y_="return sqrt(x);",Yme=Xt({opSnippet:y_,packedOpSnippet:y_,cpuKernelImpl:Ile}),Jme={kernelName:iy,backendName:"webgl",kernelFunc:Yme};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zme="return x * x;",e0e=Xt({opSnippet:Zme}),t0e={kernelName:oA,backendName:"webgl",kernelFunc:e0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w_="return (a - b) * (a - b);",n0e=rs({opSnippet:w_,packedOpSnippet:w_}),r0e={kernelName:oy,backendName:"webgl",kernelFunc:n0e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=t.readSync(s.dataId),o=Ll(i),a=Ele(o,"string",r);return t.makeTensorInfo(s.shape,"string",a)}const i0e={kernelName:aA,backendName:"webgl",kernelFunc:s0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0e({inputs:n,attrs:e,backend:t}){const{x:r}=n,s=bo+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new Pa(r.shape,s);return t.runWebGLProgram(i,[r],r.dtype)}const a0e={kernelName:fy,backendName:"webgl",kernelFunc:o0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l0e{constructor(e,t,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=xn(r.length),o=xn(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((u,f)=>(l++,r.length===1?`coords * strides[${f}] + begin[${f}]`:`coords[${l-1}] * strides[${f}] + begin[${f}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:u,ellipsisMask:f,newAxisMask:h,shrinkAxisMask:p}=r,{finalShapeSparse:g,finalShape:m,isIdentity:w,sliceDim0:x,isSimpleSlice:b,begin:C,end:$,strides:k}=JA(s.shape,i,o,a,l,u,f,h,p);let N;if(w)N=nt({inputs:{x:s},backend:t,attrs:{shape:m}});else if(x||b){ee(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const U=XA(C,$,k),O=og({inputs:{x:s},backend:t,attrs:{begin:C,size:U}});N=nt({inputs:{x:O},backend:t,attrs:{shape:m}}),t.disposeIntermediateTensorInfo(O)}else if(t.shouldExecuteOnCPU([s])){const O=t.readSync(s.dataId),L=Bt(s.shape,s.dtype,O),T=Ale(g,L,k,C);N=t.makeTensorInfo(m,s.dtype,T.values)}else{const O=new l0e(C,k,g);N=t.runWebGLProgram(O,[s],s.dtype)}const _=nt({inputs:{x:N},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(N),_}const c0e={kernelName:lA,backendName:"webgl",kernelFunc:u0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f0e(n){const{inputs:e,backend:t,attrs:r}=n,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:f,dataSplits:h}=e,p=t.readSync(f.dataId),g=t.readSync(h.dataId),[m,w]=Tle(p,g,s,i,o,a,l,u);return[t.makeTensorInfo([m.length],"string",m),t.makeTensorInfo(h.shape,"int32",w)]}const h0e={kernelName:fM,backendName:"webgl",kernelFunc:f0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0e(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=t.readSync(i.dataId),l=t.readSync(o.dataId)[0],[u,f,h]=Nle(a,l,s),p=f.length;return[t.makeTensorInfo([p,2],"int32",u),t.makeTensorInfo([p],"string",f),t.makeTensorInfo([2],"int32",new Int32Array(h))]}const p0e={kernelName:hM,backendName:"webgl",kernelFunc:d0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=t.readSync(i.dataId),a=$le(o,s);return t.makeTensorInfo(i.shape,"int32",a)}const m0e={kernelName:dM,backendName:"webgl",kernelFunc:g0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y0e="return tan(x);",w0e=Xt({opSnippet:y0e}),x0e={kernelName:ly,backendName:"webgl",kernelFunc:w0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b0e=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,v0e=Xt({opSnippet:b0e}),S0e={kernelName:uy,backendName:"webgl",kernelFunc:v0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C0e(n){const{inputs:e,backend:t,attrs:r}=n,{tensor:s,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:f,outputSize:h}=dh(o,i,s.shape),p=[h/u,u];if(h===0)return t.makeTensorInfo(s.shape,i.dtype);const g=nt({inputs:{x:i},backend:t,attrs:{shape:[l,a]}}),m=nt({inputs:{x:o},backend:t,attrs:{shape:[l,u]}}),w=nt({inputs:{x:s},backend:t,attrs:{shape:p}}),x=new oN(l,a,g.shape.length,m.shape.length,f,p,!1,!0),b=t.runWebGLProgram(x,[m,g,w],w.dtype),C=nt({inputs:{x:b},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(b),C}const k0e={kernelName:sM,backendName:"webgl",kernelFunc:C0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I0e{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*t[o];this.outputShape=r,this.rank=r.length;const s=xn(this.rank),i=E0e(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function E0e(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<n.length;s++)r.push(`imod(${t[s]}, ${n[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const l=t.readSync(s.dataId),u=s.dtype==="string"?l.map(p=>Qu(p)):l,f=Bt(s.shape,s.dtype,u),h=Ole(f,i);return t.makeTensorInfo(h.shape,h.dtype,h.values)}const o=new I0e(s.shape,i);return t.runWebGLProgram(o,[s],s.dtype)}const A0e={kernelName:cy,backendName:"webgl",kernelFunc:xV};class T0e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class N0e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wc(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function x_(n){let e=1;for(;e<n;)e*=2;return e}function $0e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{k:i,sorted:o}=r,a=Te().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Te().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,f=u[u.length-1];if(t.shouldExecuteOnCPU([s])||f<a||i>l){const T=t.readSync(s.dataId),[I,v]=Dle(T,u,s.dtype,i,o);return[t.makeTensorInfo(I.shape,I.dtype,I.values),t.makeTensorInfo(v.shape,v.dtype,v.values)]}if(i===0)return u[u.length-1]=0,[t.makeTensorInfo(u,s.dtype,[]),t.makeTensorInfo(u,"int32",[])];if(f===1)return[s,Dy({attrs:{shape:u,dtype:"int32",value:0},backend:t})];const h=t.texData.get(s.dataId),p=h!==null&&h.isPacked,g=p?t.unpackTensor(s):s,w=De(u)/f,x=nt({inputs:{x:g},attrs:{shape:[w,f]},backend:t});p&&Wc(t,g);const b=x_(i),C=x_(f);let $=null;const k=()=>$===null?[x,x]:[x,$],N=(T,I,v)=>{const A=k(),M=new T0e(v),B=[[f],[$===null?1:0],[Number.NEGATIVE_INFINITY],[T],[I]],j=$;$=t.runWebGLProgram(M,A,"int32",B),Wc(t,j)};for(let T=1;T<b;T*=2){const I=T*2;for(let v=T;v>=1;v/=2)N(I,v,[w,C])}for(let T=C;T>b;T/=2){const I=k(),v=new N0e([w,T/2]),M=[[f],[$===null?1:0],[b]],D=$;$=t.runWebGLProgram(v,I,"int32",M),Wc(t,D);const B=b/2,j=B*2;for(let W=B;W>=1;W/=2)N(j,W,$.shape)}let _=$;$=og({inputs:{x:$},backend:t,attrs:{begin:0,size:[w,i]}}),Wc(t,_);let U=fV({inputs:{x,indices:$},backend:t,attrs:{axis:1,batchDims:1}});Wc(t,x);const O=u.slice(0,-1);O.push(i),_=$,$=nt({inputs:{x:$},attrs:{shape:O},backend:t}),Wc(t,_);const L=U;return U=nt({inputs:{x:U},attrs:{shape:O},backend:t}),Wc(t,L),[U,$]}const R0e={kernelName:uA,backendName:"webgl",kernelFunc:$0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O0e{constructor(e,t,r,s,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D0e(n){const{inputs:e,backend:t,attrs:r}=n,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:u}=r,[f,h,p,g]=s.shape,[m,w]=u??[h,p],x=[f,m,w,g],b=new O0e(h,p,o,a,l,x);return t.runWebGLProgram(b,[s,i],"float32")}const _0e={kernelName:cA,backendName:"webgl",kernelFunc:D0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P0e(n){const{inputs:e,attrs:t,backend:r}=n,{axis:s}=t,{x:i}=e;$y(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:a,outputShape:l,indices:u}=_le(o,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const F0e={kernelName:fA,backendName:"webgl",kernelFunc:P0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M0e(n){const{inputs:e,backend:t,attrs:r}=n,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s,a=o.shape.length,l=s.shape[i],u=new Array(a-1);let f=0;for(let w=0;w<a;w++)w!==i&&(u[f++]=o.shape[w]);const h=[],p=new Array(a).fill(0),g=o.shape.slice();g[i]=1;const m=new Array(l);for(let w=0;w<m.length;w++){p[i]=w;const x=og({inputs:{x:o},backend:t,attrs:{begin:p,size:g}}),b=nt({inputs:{x},backend:t,attrs:{shape:u}});m[w]=b,h.push(x)}return h.forEach(w=>t.disposeIntermediateTensorInfo(w)),m}const L0e={kernelName:uv,backendName:"webgl",kernelFunc:M0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B0e{constructor(e,t){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/r);this.outputShape=[s,a];const l="0.0",u="sumValue",f=Math.floor(r/4)*4,h=r%4,p=`
        sumValue += dot(values, segFilter);
    `;let g="";i%r>0&&(g=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${m}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${f}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${f};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0e(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,segmentIds:i}=e,{numSegments:o}=r,a=s.shape.length,l=[];let u=0;const f=Zn([u],a);let h=s;f!=null&&(h=Ps({inputs:{x:s},backend:t,attrs:{perm:f}}),l.push(h),u=pr(1,a)[0]);const p=rB(h.shape,u,o),g=De([h.shape[u]]),m=nt({inputs:{x:h},backend:t,attrs:{shape:[-1,g]}});l.push(m);const w=dA(s.dtype),x=(k,N,_,U,O)=>{const L=k.shape[0],T=k.shape[1],I=nB(T,O),v={windowSize:I,inSize:T,batchSize:L,numSegments:O},A=new B0e(v,N),M=t.compileAndRun(A,[k,_],U);if(l.push(M),M.shape[1]===O)return M;const D=wV({backend:t,attrs:{start:0,stop:O,step:1,dtype:"float32"}}),B=xV({inputs:{x:D},backend:t,attrs:{reps:[T/I]}});return l.push(D),l.push(B),x(M,N,B,U,O)},b=x(m,"unsortedSegmentSum",i,w,o),C=nt({inputs:{x:b},backend:t,attrs:{shape:p}});let $=C;if(f!=null){l.push(C);const k=fc(f);$=Ps({inputs:{x:$},backend:t,attrs:{perm:k}})}return l.forEach(k=>t.disposeIntermediateTensorInfo(k)),$}const U0e={kernelName:cv,backendName:"webgl",kernelFunc:z0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V0e=[Iue,Aue,$ue,Due,Pue,Lue,zue,Vue,jue,que,Yue,ece,rce,ace,cce,hce,pce,wce,bce,Sce,Ece,Dce,Pce,Bce,Uce,Kce,Xce,Zce,lue,nfe,afe,ffe,yfe,bfe,Sfe,kfe,Efe,$fe,Dfe,Ffe,Lfe,zfe,Vfe,Hfe,Kfe,Yfe,Zfe,nhe,ihe,ahe,fhe,ghe,xhe,She,Ihe,Ehe,The,$he,Ohe,_he,Fhe,zhe,Whe,jhe,qhe,Yhe,ede,sde,lde,aue,cde,ife,dde,mde,xde,cue,Cde,Ade,Nde,Dde,Fde,zde,Wde,Kde,Yde,epe,npe,ope,lpe,cpe,ppe,mpe,wpe,bpe,Spe,Epe,$pe,_pe,Vpe,due,jpe,Xpe,Jpe,tge,Wce,sge,oge,lge,fge,gge,hue,yge,xge,vge,Cge,kge,Gce,Lpe,Age,Rge,Pge,gue,Bge,Vge,jge,Xge,Zge,tme,sme,ame,cme,dme,mme,xme,Cme,Eme,$me,Dme,Rce,zpe,Fme,Lme,zme,Vme,Gme,jme,qme,Qme,Jme,t0e,r0e,i0e,a0e,c0e,h0e,p0e,m0e,Bpe,Sue,x0e,S0e,k0e,A0e,R0e,_0e,Cue,F0e,L0e,U0e,ige];for(const n of V0e)gM(n);var Ik={exports:{}},vn={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b_;function W0e(){if(b_)return vn;b_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),g=Symbol.for("react.client.reference");function m(w){if(typeof w=="object"&&w!==null){var x=w.$$typeof;switch(x){case n:switch(w=w.type,w){case t:case s:case r:case l:case u:return w;default:switch(w=w&&w.$$typeof,w){case o:case a:case h:case f:return w;case i:return w;default:return x}}case e:return x}}}return vn.ContextConsumer=i,vn.ContextProvider=o,vn.Element=n,vn.ForwardRef=a,vn.Fragment=t,vn.Lazy=h,vn.Memo=f,vn.Portal=e,vn.Profiler=s,vn.StrictMode=r,vn.Suspense=l,vn.SuspenseList=u,vn.isContextConsumer=function(w){return m(w)===i},vn.isContextProvider=function(w){return m(w)===o},vn.isElement=function(w){return typeof w=="object"&&w!==null&&w.$$typeof===n},vn.isForwardRef=function(w){return m(w)===a},vn.isFragment=function(w){return m(w)===t},vn.isLazy=function(w){return m(w)===h},vn.isMemo=function(w){return m(w)===f},vn.isPortal=function(w){return m(w)===e},vn.isProfiler=function(w){return m(w)===s},vn.isStrictMode=function(w){return m(w)===r},vn.isSuspense=function(w){return m(w)===l},vn.isSuspenseList=function(w){return m(w)===u},vn.isValidElementType=function(w){return typeof w=="string"||typeof w=="function"||w===t||w===s||w===r||w===l||w===u||w===p||typeof w=="object"&&w!==null&&(w.$$typeof===h||w.$$typeof===f||w.$$typeof===o||w.$$typeof===i||w.$$typeof===a||w.$$typeof===g||w.getModuleId!==void 0)},vn.typeOf=m,vn}var v_;function G0e(){return v_||(v_=1,Ik.exports=W0e()),Ik.exports}var bV=G0e(),Ek={exports:{}},Ak,S_;function H0e(){if(S_)return Ak;S_=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Ak=n,Ak}var Tk,C_;function j0e(){if(C_)return Tk;C_=1;var n=H0e();function e(){}function t(){}return t.resetWarningCache=e,Tk=function(){function r(o,a,l,u,f,h){if(h!==n){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function s(){return r}var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return i.PropTypes=i,i},Tk}var k_;function _y(){return k_||(k_=1,Ek.exports=j0e()()),Ek.exports}function vV(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=vV(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function nr(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=vV(n))&&(r&&(r+=" "),r+=e);return r}function ag(n,e,t=void 0){const r={};for(const s in n){const i=n[s];let o="",a=!0;for(let l=0;l<i.length;l+=1){const u=i[l];u&&(o+=(a===!0?"":" ")+e(u),a=!1,t&&t[u]&&(o+=" "+t[u]))}r[s]=o}return r}const K0e=Pe.createContext(),SV=()=>Pe.useContext(K0e)??!1;function q0e(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function kE(...n){return Pe.useMemo(()=>n.every(e=>e==null)?null:e=>{n.forEach(t=>{q0e(t,e)})},n)}function X0e(n){return typeof n=="string"}function Q0e(n,e,t){return n===void 0||X0e(n)?e:{...e,ownerState:{...e.ownerState,...t}}}function Y0e(n,e=[]){if(n===void 0)return{};const t={};return Object.keys(n).filter(r=>r.match(/^on[A-Z]/)&&typeof n[r]=="function"&&!e.includes(r)).forEach(r=>{t[r]=n[r]}),t}function I_(n){if(n===void 0)return{};const e={};return Object.keys(n).filter(t=>!(t.match(/^on[A-Z]/)&&typeof n[t]=="function")).forEach(t=>{e[t]=n[t]}),e}function J0e(n){const{getSlotProps:e,additionalProps:t,externalSlotProps:r,externalForwardedProps:s,className:i}=n;if(!e){const g=nr(t==null?void 0:t.className,i,s==null?void 0:s.className,r==null?void 0:r.className),m={...t==null?void 0:t.style,...s==null?void 0:s.style,...r==null?void 0:r.style},w={...t,...s,...r};return g.length>0&&(w.className=g),Object.keys(m).length>0&&(w.style=m),{props:w,internalRef:void 0}}const o=Y0e({...s,...r}),a=I_(r),l=I_(s),u=e(o),f=nr(u==null?void 0:u.className,t==null?void 0:t.className,i,s==null?void 0:s.className,r==null?void 0:r.className),h={...u==null?void 0:u.style,...t==null?void 0:t.style,...s==null?void 0:s.style,...r==null?void 0:r.style},p={...u,...t,...l,...a};return f.length>0&&(p.className=f),Object.keys(h).length>0&&(p.style=h),{props:p,internalRef:u.ref}}function Z0e(n,e,t){return typeof n=="function"?n(e,t):n}function P1(n){var h;const{elementType:e,externalSlotProps:t,ownerState:r,skipResolvingSlotProps:s=!1,...i}=n,o=s?{}:Z0e(t,r),{props:a,internalRef:l}=J0e({...i,externalSlotProps:o}),u=kE(l,o==null?void 0:o.ref,(h=n.additionalProps)==null?void 0:h.ref);return Q0e(e,{...a,ref:u},r)}function th(n,...e){const t=new URL(`https://mui.com/production-error/?code=${n}`);return e.forEach(r=>t.searchParams.append("args[]",r)),`Minified MUI error #${n}; visit ${t} for the full message.`}function nc(n){if(typeof n!="string")throw new Error(th(7));return n.charAt(0).toUpperCase()+n.slice(1)}function Oa(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function CV(n){if(Pe.isValidElement(n)||bV.isValidElementType(n)||!Oa(n))return n;const e={};return Object.keys(n).forEach(t=>{e[t]=CV(n[t])}),e}function Bi(n,e,t={clone:!0}){const r=t.clone?{...n}:n;return Oa(n)&&Oa(e)&&Object.keys(e).forEach(s=>{Pe.isValidElement(e[s])||bV.isValidElementType(e[s])?r[s]=e[s]:Oa(e[s])&&Object.prototype.hasOwnProperty.call(n,s)&&Oa(n[s])?r[s]=Bi(n[s],e[s],t):t.clone?r[s]=Oa(e[s])?CV(e[s]):e[s]:r[s]=e[s]}),r}function Am(n,e){return e?Bi(n,e,{clone:!1}):n}function eye(n,e){if(!n.containerQueries)return e;const t=Object.keys(e).filter(r=>r.startsWith("@container")).sort((r,s)=>{var o,a;const i=/min-width:\s*([0-9.]+)/;return+(((o=r.match(i))==null?void 0:o[1])||0)-+(((a=s.match(i))==null?void 0:a[1])||0)});return t.length?t.reduce((r,s)=>{const i=e[s];return delete r[s],r[s]=i,r},{...e}):e}function tye(n,e){return e==="@"||e.startsWith("@")&&(n.some(t=>e.startsWith(`@${t}`))||!!e.match(/^@\d/))}function nye(n,e){const t=e.match(/^@([^/]+)?\/?(.+)?$/);if(!t)return null;const[,r,s]=t,i=Number.isNaN(+r)?r||0:+r;return n.containerQueries(s).up(i)}function rye(n){const e=(i,o)=>i.replace("@media",o?`@container ${o}`:"@container");function t(i,o){i.up=(...a)=>e(n.breakpoints.up(...a),o),i.down=(...a)=>e(n.breakpoints.down(...a),o),i.between=(...a)=>e(n.breakpoints.between(...a),o),i.only=(...a)=>e(n.breakpoints.only(...a),o),i.not=(...a)=>{const l=e(n.breakpoints.not(...a),o);return l.includes("not all and")?l.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):l}}const r={},s=i=>(t(r,i),r);return t(s),{...n,containerQueries:s}}const Vv={xs:0,sm:600,md:900,lg:1200,xl:1536},E_={keys:["xs","sm","md","lg","xl"],up:n=>`@media (min-width:${Vv[n]}px)`},sye={containerQueries:n=>({up:e=>{let t=typeof e=="number"?e:Vv[e]||e;return typeof t=="number"&&(t=`${t}px`),n?`@container ${n} (min-width:${t})`:`@container (min-width:${t})`}})};function Bl(n,e,t){const r=n.theme||{};if(Array.isArray(e)){const i=r.breakpoints||E_;return e.reduce((o,a,l)=>(o[i.up(i.keys[l])]=t(e[l]),o),{})}if(typeof e=="object"){const i=r.breakpoints||E_;return Object.keys(e).reduce((o,a)=>{if(tye(i.keys,a)){const l=nye(r.containerQueries?r:sye,a);l&&(o[l]=t(e[a],a))}else if(Object.keys(i.values||Vv).includes(a)){const l=i.up(a);o[l]=t(e[a],a)}else{const l=a;o[l]=e[l]}return o},{})}return t(e)}function iye(n={}){var t;return((t=n.keys)==null?void 0:t.reduce((r,s)=>{const i=n.up(s);return r[i]={},r},{}))||{}}function oye(n,e){return n.reduce((t,r)=>{const s=t[r];return(!s||Object.keys(s).length===0)&&delete t[r],t},e)}function Wv(n,e,t=!0){if(!e||typeof e!="string")return null;if(n&&n.vars&&t){const r=`vars.${e}`.split(".").reduce((s,i)=>s&&s[i]?s[i]:null,n);if(r!=null)return r}return e.split(".").reduce((r,s)=>r&&r[s]!=null?r[s]:null,n)}function F1(n,e,t,r=t){let s;return typeof n=="function"?s=n(t):Array.isArray(n)?s=n[t]||r:s=Wv(n,t)||r,e&&(s=e(s,r,n)),s}function Er(n){const{prop:e,cssProperty:t=n.prop,themeKey:r,transform:s}=n,i=o=>{if(o[e]==null)return null;const a=o[e],l=o.theme,u=Wv(l,r)||{};return Bl(o,a,h=>{let p=F1(u,s,h);return h===p&&typeof h=="string"&&(p=F1(u,s,`${e}${h==="default"?"":nc(h)}`,h)),t===!1?p:{[t]:p}})};return i.propTypes={},i.filterProps=[e],i}function aye(n){const e={};return t=>(e[t]===void 0&&(e[t]=n(t)),e[t])}const lye={m:"margin",p:"padding"},uye={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},A_={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},cye=aye(n=>{if(n.length>2)if(A_[n])n=A_[n];else return[n];const[e,t]=n.split(""),r=lye[e],s=uye[t]||"";return Array.isArray(s)?s.map(i=>r+i):[r+s]}),aN=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],lN=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...aN,...lN];function Py(n,e,t,r){const s=Wv(n,e,!0)??t;return typeof s=="number"||typeof s=="string"?i=>typeof i=="string"?i:typeof s=="string"?`calc(${i} * ${s})`:s*i:Array.isArray(s)?i=>{if(typeof i=="string")return i;const o=Math.abs(i),a=s[o];return i>=0?a:typeof a=="number"?-a:`-${a}`}:typeof s=="function"?s:()=>{}}function uN(n){return Py(n,"spacing",8)}function Fy(n,e){return typeof e=="string"||e==null?e:n(e)}function fye(n,e){return t=>n.reduce((r,s)=>(r[s]=Fy(e,t),r),{})}function hye(n,e,t,r){if(!e.includes(t))return null;const s=cye(t),i=fye(s,r),o=n[t];return Bl(n,o,i)}function kV(n,e){const t=uN(n.theme);return Object.keys(n).map(r=>hye(n,e,r,t)).reduce(Am,{})}function ar(n){return kV(n,aN)}ar.propTypes={};ar.filterProps=aN;function lr(n){return kV(n,lN)}lr.propTypes={};lr.filterProps=lN;function Gv(...n){const e=n.reduce((r,s)=>(s.filterProps.forEach(i=>{r[i]=s}),r),{}),t=r=>Object.keys(r).reduce((s,i)=>e[i]?Am(s,e[i](r)):s,{});return t.propTypes={},t.filterProps=n.reduce((r,s)=>r.concat(s.filterProps),[]),t}function uo(n){return typeof n!="number"?n:`${n}px solid`}function vo(n,e){return Er({prop:n,themeKey:"borders",transform:e})}const dye=vo("border",uo),pye=vo("borderTop",uo),gye=vo("borderRight",uo),mye=vo("borderBottom",uo),yye=vo("borderLeft",uo),wye=vo("borderColor"),xye=vo("borderTopColor"),bye=vo("borderRightColor"),vye=vo("borderBottomColor"),Sye=vo("borderLeftColor"),Cye=vo("outline",uo),kye=vo("outlineColor"),Hv=n=>{if(n.borderRadius!==void 0&&n.borderRadius!==null){const e=Py(n.theme,"shape.borderRadius",4),t=r=>({borderRadius:Fy(e,r)});return Bl(n,n.borderRadius,t)}return null};Hv.propTypes={};Hv.filterProps=["borderRadius"];Gv(dye,pye,gye,mye,yye,wye,xye,bye,vye,Sye,Hv,Cye,kye);const jv=n=>{if(n.gap!==void 0&&n.gap!==null){const e=Py(n.theme,"spacing",8),t=r=>({gap:Fy(e,r)});return Bl(n,n.gap,t)}return null};jv.propTypes={};jv.filterProps=["gap"];const Kv=n=>{if(n.columnGap!==void 0&&n.columnGap!==null){const e=Py(n.theme,"spacing",8),t=r=>({columnGap:Fy(e,r)});return Bl(n,n.columnGap,t)}return null};Kv.propTypes={};Kv.filterProps=["columnGap"];const qv=n=>{if(n.rowGap!==void 0&&n.rowGap!==null){const e=Py(n.theme,"spacing",8),t=r=>({rowGap:Fy(e,r)});return Bl(n,n.rowGap,t)}return null};qv.propTypes={};qv.filterProps=["rowGap"];const Iye=Er({prop:"gridColumn"}),Eye=Er({prop:"gridRow"}),Aye=Er({prop:"gridAutoFlow"}),Tye=Er({prop:"gridAutoColumns"}),Nye=Er({prop:"gridAutoRows"}),$ye=Er({prop:"gridTemplateColumns"}),Rye=Er({prop:"gridTemplateRows"}),Oye=Er({prop:"gridTemplateAreas"}),Dye=Er({prop:"gridArea"});Gv(jv,Kv,qv,Iye,Eye,Aye,Tye,Nye,$ye,Rye,Oye,Dye);function Ad(n,e){return e==="grey"?e:n}const _ye=Er({prop:"color",themeKey:"palette",transform:Ad}),Pye=Er({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Ad}),Fye=Er({prop:"backgroundColor",themeKey:"palette",transform:Ad});Gv(_ye,Pye,Fye);function Fi(n){return n<=1&&n!==0?`${n*100}%`:n}const Mye=Er({prop:"width",transform:Fi}),cN=n=>{if(n.maxWidth!==void 0&&n.maxWidth!==null){const e=t=>{var s,i,o,a,l;const r=((o=(i=(s=n.theme)==null?void 0:s.breakpoints)==null?void 0:i.values)==null?void 0:o[t])||Vv[t];return r?((l=(a=n.theme)==null?void 0:a.breakpoints)==null?void 0:l.unit)!=="px"?{maxWidth:`${r}${n.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:Fi(t)}};return Bl(n,n.maxWidth,e)}return null};cN.filterProps=["maxWidth"];const Lye=Er({prop:"minWidth",transform:Fi}),Bye=Er({prop:"height",transform:Fi}),zye=Er({prop:"maxHeight",transform:Fi}),Uye=Er({prop:"minHeight",transform:Fi});Er({prop:"size",cssProperty:"width",transform:Fi});Er({prop:"size",cssProperty:"height",transform:Fi});const Vye=Er({prop:"boxSizing"});Gv(Mye,cN,Lye,Bye,zye,Uye,Vye);const My={border:{themeKey:"borders",transform:uo},borderTop:{themeKey:"borders",transform:uo},borderRight:{themeKey:"borders",transform:uo},borderBottom:{themeKey:"borders",transform:uo},borderLeft:{themeKey:"borders",transform:uo},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:uo},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Hv},color:{themeKey:"palette",transform:Ad},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Ad},backgroundColor:{themeKey:"palette",transform:Ad},p:{style:lr},pt:{style:lr},pr:{style:lr},pb:{style:lr},pl:{style:lr},px:{style:lr},py:{style:lr},padding:{style:lr},paddingTop:{style:lr},paddingRight:{style:lr},paddingBottom:{style:lr},paddingLeft:{style:lr},paddingX:{style:lr},paddingY:{style:lr},paddingInline:{style:lr},paddingInlineStart:{style:lr},paddingInlineEnd:{style:lr},paddingBlock:{style:lr},paddingBlockStart:{style:lr},paddingBlockEnd:{style:lr},m:{style:ar},mt:{style:ar},mr:{style:ar},mb:{style:ar},ml:{style:ar},mx:{style:ar},my:{style:ar},margin:{style:ar},marginTop:{style:ar},marginRight:{style:ar},marginBottom:{style:ar},marginLeft:{style:ar},marginX:{style:ar},marginY:{style:ar},marginInline:{style:ar},marginInlineStart:{style:ar},marginInlineEnd:{style:ar},marginBlock:{style:ar},marginBlockStart:{style:ar},marginBlockEnd:{style:ar},displayPrint:{cssProperty:!1,transform:n=>({"@media print":{display:n}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:jv},rowGap:{style:qv},columnGap:{style:Kv},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Fi},maxWidth:{style:cN},minWidth:{transform:Fi},height:{transform:Fi},maxHeight:{transform:Fi},minHeight:{transform:Fi},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function Wye(...n){const e=n.reduce((r,s)=>r.concat(Object.keys(s)),[]),t=new Set(e);return n.every(r=>t.size===Object.keys(r).length)}function Gye(n,e){return typeof n=="function"?n(e):n}function Hye(){function n(t,r,s,i){const o={[t]:r,theme:s},a=i[t];if(!a)return{[t]:r};const{cssProperty:l=t,themeKey:u,transform:f,style:h}=a;if(r==null)return null;if(u==="typography"&&r==="inherit")return{[t]:r};const p=Wv(s,u)||{};return h?h(o):Bl(o,r,m=>{let w=F1(p,f,m);return m===w&&typeof m=="string"&&(w=F1(p,f,`${t}${m==="default"?"":nc(m)}`,m)),l===!1?w:{[l]:w}})}function e(t){const{sx:r,theme:s={}}=t||{};if(!r)return null;const i=s.unstable_sxConfig??My;function o(a){let l=a;if(typeof a=="function")l=a(s);else if(typeof a!="object")return a;if(!l)return null;const u=iye(s.breakpoints),f=Object.keys(u);let h=u;return Object.keys(l).forEach(p=>{const g=Gye(l[p],s);if(g!=null)if(typeof g=="object")if(i[p])h=Am(h,n(p,g,s,i));else{const m=Bl({theme:s},g,w=>({[p]:w}));Wye(m,g)?h[p]=e({sx:g,theme:s}):h=Am(h,m)}else h=Am(h,n(p,g,s,i))}),eye(s,oye(f,h))}return Array.isArray(r)?r.map(o):o(r)}return e}const nh=Hye();nh.filterProps=["sx"];const jye=n=>{var r;const e={systemProps:{},otherProps:{}},t=((r=n==null?void 0:n.theme)==null?void 0:r.unstable_sxConfig)??My;return Object.keys(n).forEach(s=>{t[s]?e.systemProps[s]=n[s]:e.otherProps[s]=n[s]}),e};function IV(n){const{sx:e,...t}=n,{systemProps:r,otherProps:s}=jye(t);let i;return Array.isArray(e)?i=[r,...e]:typeof e=="function"?i=(...o)=>{const a=e(...o);return Oa(a)?{...r,...a}:r}:i={...r,...e},{...s,sx:i}}function M1(){return M1=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},M1.apply(null,arguments)}function Kye(n){if(n.sheet)return n.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===n)return document.styleSheets[e]}function qye(n){var e=document.createElement("style");return e.setAttribute("data-emotion",n.key),n.nonce!==void 0&&e.setAttribute("nonce",n.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Xye=function(){function n(t){var r=this;this._insertTag=function(s){var i;r.tags.length===0?r.insertionPoint?i=r.insertionPoint.nextSibling:r.prepend?i=r.container.firstChild:i=r.before:i=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(s,i),r.tags.push(s)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=n.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(qye(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var i=Kye(s);try{i.insertRule(r,i.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var s;return(s=r.parentNode)==null?void 0:s.removeChild(r)}),this.tags=[],this.ctr=0},n}(),Es="-ms-",L1="-moz-",ln="-webkit-",EV="comm",fN="rule",hN="decl",Qye="@import",AV="@keyframes",Yye="@layer",Jye=Math.abs,Xv=String.fromCharCode,Zye=Object.assign;function ewe(n,e){return ls(n,0)^45?(((e<<2^ls(n,0))<<2^ls(n,1))<<2^ls(n,2))<<2^ls(n,3):0}function TV(n){return n.trim()}function twe(n,e){return(n=e.exec(n))?n[0]:n}function un(n,e,t){return n.replace(e,t)}function IE(n,e){return n.indexOf(e)}function ls(n,e){return n.charCodeAt(e)|0}function Wm(n,e,t){return n.slice(e,t)}function Na(n){return n.length}function dN(n){return n.length}function ax(n,e){return e.push(n),n}function nwe(n,e){return n.map(e).join("")}var Qv=1,Rp=1,NV=0,Si=0,Nr=0,lg="";function Yv(n,e,t,r,s,i,o){return{value:n,root:e,parent:t,type:r,props:s,children:i,line:Qv,column:Rp,length:o,return:""}}function Qg(n,e){return Zye(Yv("",null,null,"",null,null,0),n,{length:-n.length},e)}function rwe(){return Nr}function swe(){return Nr=Si>0?ls(lg,--Si):0,Rp--,Nr===10&&(Rp=1,Qv--),Nr}function zi(){return Nr=Si<NV?ls(lg,Si++):0,Rp++,Nr===10&&(Rp=1,Qv++),Nr}function Ga(){return ls(lg,Si)}function Lx(){return Si}function Ly(n,e){return Wm(lg,n,e)}function Gm(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function $V(n){return Qv=Rp=1,NV=Na(lg=n),Si=0,[]}function RV(n){return lg="",n}function Bx(n){return TV(Ly(Si-1,EE(n===91?n+2:n===40?n+1:n)))}function iwe(n){for(;(Nr=Ga())&&Nr<33;)zi();return Gm(n)>2||Gm(Nr)>3?"":" "}function owe(n,e){for(;--e&&zi()&&!(Nr<48||Nr>102||Nr>57&&Nr<65||Nr>70&&Nr<97););return Ly(n,Lx()+(e<6&&Ga()==32&&zi()==32))}function EE(n){for(;zi();)switch(Nr){case n:return Si;case 34:case 39:n!==34&&n!==39&&EE(Nr);break;case 40:n===41&&EE(n);break;case 92:zi();break}return Si}function awe(n,e){for(;zi()&&n+Nr!==57;)if(n+Nr===84&&Ga()===47)break;return"/*"+Ly(e,Si-1)+"*"+Xv(n===47?n:zi())}function lwe(n){for(;!Gm(Ga());)zi();return Ly(n,Si)}function uwe(n){return RV(zx("",null,null,null,[""],n=$V(n),0,[0],n))}function zx(n,e,t,r,s,i,o,a,l){for(var u=0,f=0,h=o,p=0,g=0,m=0,w=1,x=1,b=1,C=0,$="",k=s,N=i,_=r,U=$;x;)switch(m=C,C=zi()){case 40:if(m!=108&&ls(U,h-1)==58){IE(U+=un(Bx(C),"&","&\f"),"&\f")!=-1&&(b=-1);break}case 34:case 39:case 91:U+=Bx(C);break;case 9:case 10:case 13:case 32:U+=iwe(m);break;case 92:U+=owe(Lx()-1,7);continue;case 47:switch(Ga()){case 42:case 47:ax(cwe(awe(zi(),Lx()),e,t),l);break;default:U+="/"}break;case 123*w:a[u++]=Na(U)*b;case 125*w:case 59:case 0:switch(C){case 0:case 125:x=0;case 59+f:b==-1&&(U=un(U,/\f/g,"")),g>0&&Na(U)-h&&ax(g>32?N_(U+";",r,t,h-1):N_(un(U," ","")+";",r,t,h-2),l);break;case 59:U+=";";default:if(ax(_=T_(U,e,t,u,f,s,a,$,k=[],N=[],h),i),C===123)if(f===0)zx(U,e,_,_,k,i,h,a,N);else switch(p===99&&ls(U,3)===110?100:p){case 100:case 108:case 109:case 115:zx(n,_,_,r&&ax(T_(n,_,_,0,0,s,a,$,s,k=[],h),N),s,N,h,a,r?k:N);break;default:zx(U,_,_,_,[""],N,0,a,N)}}u=f=g=0,w=b=1,$=U="",h=o;break;case 58:h=1+Na(U),g=m;default:if(w<1){if(C==123)--w;else if(C==125&&w++==0&&swe()==125)continue}switch(U+=Xv(C),C*w){case 38:b=f>0?1:(U+="\f",-1);break;case 44:a[u++]=(Na(U)-1)*b,b=1;break;case 64:Ga()===45&&(U+=Bx(zi())),p=Ga(),f=h=Na($=U+=lwe(Lx())),C++;break;case 45:m===45&&Na(U)==2&&(w=0)}}return i}function T_(n,e,t,r,s,i,o,a,l,u,f){for(var h=s-1,p=s===0?i:[""],g=dN(p),m=0,w=0,x=0;m<r;++m)for(var b=0,C=Wm(n,h+1,h=Jye(w=o[m])),$=n;b<g;++b)($=TV(w>0?p[b]+" "+C:un(C,/&\f/g,p[b])))&&(l[x++]=$);return Yv(n,e,t,s===0?fN:a,l,u,f)}function cwe(n,e,t){return Yv(n,e,t,EV,Xv(rwe()),Wm(n,2,-2),0)}function N_(n,e,t,r){return Yv(n,e,t,hN,Wm(n,0,r),Wm(n,r+1,-1),r)}function Td(n,e){for(var t="",r=dN(n),s=0;s<r;s++)t+=e(n[s],s,n,e)||"";return t}function fwe(n,e,t,r){switch(n.type){case Yye:if(n.children.length)break;case Qye:case hN:return n.return=n.return||n.value;case EV:return"";case AV:return n.return=n.value+"{"+Td(n.children,r)+"}";case fN:n.value=n.props.join(",")}return Na(t=Td(n.children,r))?n.return=n.value+"{"+t+"}":""}function hwe(n){var e=dN(n);return function(t,r,s,i){for(var o="",a=0;a<e;a++)o+=n[a](t,r,s,i)||"";return o}}function dwe(n){return function(e){e.root||(e=e.return)&&n(e)}}function OV(n){var e=Object.create(null);return function(t){return e[t]===void 0&&(e[t]=n(t)),e[t]}}var pwe=function(e,t,r){for(var s=0,i=0;s=i,i=Ga(),s===38&&i===12&&(t[r]=1),!Gm(i);)zi();return Ly(e,Si)},gwe=function(e,t){var r=-1,s=44;do switch(Gm(s)){case 0:s===38&&Ga()===12&&(t[r]=1),e[r]+=pwe(Si-1,t,r);break;case 2:e[r]+=Bx(s);break;case 4:if(s===44){e[++r]=Ga()===58?"&\f":"",t[r]=e[r].length;break}default:e[r]+=Xv(s)}while(s=zi());return e},mwe=function(e,t){return RV(gwe($V(e),t))},$_=new WeakMap,ywe=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var t=e.value,r=e.parent,s=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&t.charCodeAt(0)!==58&&!$_.get(r))&&!s){$_.set(e,!0);for(var i=[],o=mwe(t,i),a=r.props,l=0,u=0;l<o.length;l++)for(var f=0;f<a.length;f++,u++)e.props[u]=i[l]?o[l].replace(/&\f/g,a[f]):a[f]+" "+o[l]}}},wwe=function(e){if(e.type==="decl"){var t=e.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(e.return="",e.value="")}};function DV(n,e){switch(ewe(n,e)){case 5103:return ln+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ln+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return ln+n+L1+n+Es+n+n;case 6828:case 4268:return ln+n+Es+n+n;case 6165:return ln+n+Es+"flex-"+n+n;case 5187:return ln+n+un(n,/(\w+).+(:[^]+)/,ln+"box-$1$2"+Es+"flex-$1$2")+n;case 5443:return ln+n+Es+"flex-item-"+un(n,/flex-|-self/,"")+n;case 4675:return ln+n+Es+"flex-line-pack"+un(n,/align-content|flex-|-self/,"")+n;case 5548:return ln+n+Es+un(n,"shrink","negative")+n;case 5292:return ln+n+Es+un(n,"basis","preferred-size")+n;case 6060:return ln+"box-"+un(n,"-grow","")+ln+n+Es+un(n,"grow","positive")+n;case 4554:return ln+un(n,/([^-])(transform)/g,"$1"+ln+"$2")+n;case 6187:return un(un(un(n,/(zoom-|grab)/,ln+"$1"),/(image-set)/,ln+"$1"),n,"")+n;case 5495:case 3959:return un(n,/(image-set\([^]*)/,ln+"$1$`$1");case 4968:return un(un(n,/(.+:)(flex-)?(.*)/,ln+"box-pack:$3"+Es+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ln+n+n;case 4095:case 3583:case 4068:case 2532:return un(n,/(.+)-inline(.+)/,ln+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Na(n)-1-e>6)switch(ls(n,e+1)){case 109:if(ls(n,e+4)!==45)break;case 102:return un(n,/(.+:)(.+)-([^]+)/,"$1"+ln+"$2-$3$1"+L1+(ls(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~IE(n,"stretch")?DV(un(n,"stretch","fill-available"),e)+n:n}break;case 4949:if(ls(n,e+1)!==115)break;case 6444:switch(ls(n,Na(n)-3-(~IE(n,"!important")&&10))){case 107:return un(n,":",":"+ln)+n;case 101:return un(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ln+(ls(n,14)===45?"inline-":"")+"box$3$1"+ln+"$2$3$1"+Es+"$2box$3")+n}break;case 5936:switch(ls(n,e+11)){case 114:return ln+n+Es+un(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return ln+n+Es+un(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return ln+n+Es+un(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return ln+n+Es+n+n}return n}var xwe=function(e,t,r,s){if(e.length>-1&&!e.return)switch(e.type){case hN:e.return=DV(e.value,e.length);break;case AV:return Td([Qg(e,{value:un(e.value,"@","@"+ln)})],s);case fN:if(e.length)return nwe(e.props,function(i){switch(twe(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Td([Qg(e,{props:[un(i,/:(read-\w+)/,":"+L1+"$1")]})],s);case"::placeholder":return Td([Qg(e,{props:[un(i,/:(plac\w+)/,":"+ln+"input-$1")]}),Qg(e,{props:[un(i,/:(plac\w+)/,":"+L1+"$1")]}),Qg(e,{props:[un(i,/:(plac\w+)/,Es+"input-$1")]})],s)}return""})}},bwe=[xwe],vwe=function(e){var t=e.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(w){var x=w.getAttribute("data-emotion");x.indexOf(" ")!==-1&&(document.head.appendChild(w),w.setAttribute("data-s",""))})}var s=e.stylisPlugins||bwe,i={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(w){for(var x=w.getAttribute("data-emotion").split(" "),b=1;b<x.length;b++)i[x[b]]=!0;a.push(w)});var l,u=[ywe,wwe];{var f,h=[fwe,dwe(function(w){f.insert(w)})],p=hwe(u.concat(s,h)),g=function(x){return Td(uwe(x),p)};l=function(x,b,C,$){f=C,g(x?x+"{"+b.styles+"}":b.styles),$&&(m.inserted[b.name]=!0)}}var m={key:t,sheet:new Xye({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:i,registered:{},insert:l};return m.sheet.hydrate(a),m},Nk={exports:{}},hn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R_;function Swe(){if(R_)return hn;R_=1;var n=typeof Symbol=="function"&&Symbol.for,e=n?Symbol.for("react.element"):60103,t=n?Symbol.for("react.portal"):60106,r=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,i=n?Symbol.for("react.profiler"):60114,o=n?Symbol.for("react.provider"):60109,a=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,u=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,h=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,w=n?Symbol.for("react.block"):60121,x=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,C=n?Symbol.for("react.scope"):60119;function $(N){if(typeof N=="object"&&N!==null){var _=N.$$typeof;switch(_){case e:switch(N=N.type,N){case l:case u:case r:case i:case s:case h:return N;default:switch(N=N&&N.$$typeof,N){case a:case f:case m:case g:case o:return N;default:return _}}case t:return _}}}function k(N){return $(N)===u}return hn.AsyncMode=l,hn.ConcurrentMode=u,hn.ContextConsumer=a,hn.ContextProvider=o,hn.Element=e,hn.ForwardRef=f,hn.Fragment=r,hn.Lazy=m,hn.Memo=g,hn.Portal=t,hn.Profiler=i,hn.StrictMode=s,hn.Suspense=h,hn.isAsyncMode=function(N){return k(N)||$(N)===l},hn.isConcurrentMode=k,hn.isContextConsumer=function(N){return $(N)===a},hn.isContextProvider=function(N){return $(N)===o},hn.isElement=function(N){return typeof N=="object"&&N!==null&&N.$$typeof===e},hn.isForwardRef=function(N){return $(N)===f},hn.isFragment=function(N){return $(N)===r},hn.isLazy=function(N){return $(N)===m},hn.isMemo=function(N){return $(N)===g},hn.isPortal=function(N){return $(N)===t},hn.isProfiler=function(N){return $(N)===i},hn.isStrictMode=function(N){return $(N)===s},hn.isSuspense=function(N){return $(N)===h},hn.isValidElementType=function(N){return typeof N=="string"||typeof N=="function"||N===r||N===u||N===i||N===s||N===h||N===p||typeof N=="object"&&N!==null&&(N.$$typeof===m||N.$$typeof===g||N.$$typeof===o||N.$$typeof===a||N.$$typeof===f||N.$$typeof===x||N.$$typeof===b||N.$$typeof===C||N.$$typeof===w)},hn.typeOf=$,hn}var O_;function Cwe(){return O_||(O_=1,Nk.exports=Swe()),Nk.exports}var $k,D_;function kwe(){if(D_)return $k;D_=1;var n=Cwe(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},i={};i[n.ForwardRef]=r,i[n.Memo]=s;function o(m){return n.isMemo(m)?s:i[m.$$typeof]||e}var a=Object.defineProperty,l=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,p=Object.prototype;function g(m,w,x){if(typeof w!="string"){if(p){var b=h(w);b&&b!==p&&g(m,b,x)}var C=l(w);u&&(C=C.concat(u(w)));for(var $=o(m),k=o(w),N=0;N<C.length;++N){var _=C[N];if(!t[_]&&!(x&&x[_])&&!(k&&k[_])&&!($&&$[_])){var U=f(w,_);try{a(m,_,U)}catch{}}}}return m}return $k=g,$k}kwe();var Iwe=!0;function _V(n,e,t){var r="";return t.split(" ").forEach(function(s){n[s]!==void 0?e.push(n[s]+";"):s&&(r+=s+" ")}),r}var pN=function(e,t,r){var s=e.key+"-"+t.name;(r===!1||Iwe===!1)&&e.registered[s]===void 0&&(e.registered[s]=t.styles)},PV=function(e,t,r){pN(e,t,r);var s=e.key+"-"+t.name;if(e.inserted[t.name]===void 0){var i=t;do e.insert(t===i?"."+s:"",i,e.sheet,!0),i=i.next;while(i!==void 0)}};function Ewe(n){for(var e=0,t,r=0,s=n.length;s>=4;++r,s-=4)t=n.charCodeAt(r)&255|(n.charCodeAt(++r)&255)<<8|(n.charCodeAt(++r)&255)<<16|(n.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(n.charCodeAt(r+2)&255)<<16;case 2:e^=(n.charCodeAt(r+1)&255)<<8;case 1:e^=n.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var Awe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Twe=/[A-Z]|^ms/g,Nwe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,FV=function(e){return e.charCodeAt(1)===45},__=function(e){return e!=null&&typeof e!="boolean"},Rk=OV(function(n){return FV(n)?n:n.replace(Twe,"-$&").toLowerCase()}),P_=function(e,t){switch(e){case"animation":case"animationName":if(typeof t=="string")return t.replace(Nwe,function(r,s,i){return $a={name:s,styles:i,next:$a},s})}return Awe[e]!==1&&!FV(e)&&typeof t=="number"&&t!==0?t+"px":t};function Hm(n,e,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var s=t;if(s.anim===1)return $a={name:s.name,styles:s.styles,next:$a},s.name;var i=t;if(i.styles!==void 0){var o=i.next;if(o!==void 0)for(;o!==void 0;)$a={name:o.name,styles:o.styles,next:$a},o=o.next;var a=i.styles+";";return a}return $we(n,e,t)}case"function":{if(n!==void 0){var l=$a,u=t(n);return $a=l,Hm(n,e,u)}break}}var f=t;if(e==null)return f;var h=e[f];return h!==void 0?h:f}function $we(n,e,t){var r="";if(Array.isArray(t))for(var s=0;s<t.length;s++)r+=Hm(n,e,t[s])+";";else for(var i in t){var o=t[i];if(typeof o!="object"){var a=o;e!=null&&e[a]!==void 0?r+=i+"{"+e[a]+"}":__(a)&&(r+=Rk(i)+":"+P_(i,a)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var l=0;l<o.length;l++)__(o[l])&&(r+=Rk(i)+":"+P_(i,o[l])+";");else{var u=Hm(n,e,o);switch(i){case"animation":case"animationName":{r+=Rk(i)+":"+u+";";break}default:r+=i+"{"+u+"}"}}}return r}var F_=/label:\s*([^\s;{]+)\s*(;|$)/g,$a;function Jv(n,e,t){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var r=!0,s="";$a=void 0;var i=n[0];if(i==null||i.raw===void 0)r=!1,s+=Hm(t,e,i);else{var o=i;s+=o[0]}for(var a=1;a<n.length;a++)if(s+=Hm(t,e,n[a]),r){var l=i;s+=l[a]}F_.lastIndex=0;for(var u="",f;(f=F_.exec(s))!==null;)u+="-"+f[1];var h=Ewe(s)+u;return{name:h,styles:s,next:$a}}var Rwe=function(e){return e()},Owe=IO.useInsertionEffect?IO.useInsertionEffect:!1,MV=Owe||Rwe,LV=Pe.createContext(typeof HTMLElement<"u"?vwe({key:"css"}):null);LV.Provider;var BV=function(e){return Pe.forwardRef(function(t,r){var s=Pe.useContext(LV);return e(t,s,r)})},gN=Pe.createContext({}),mN={}.hasOwnProperty,AE="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Dwe=function(e,t){var r={};for(var s in t)mN.call(t,s)&&(r[s]=t[s]);return r[AE]=e,r},_we=function(e){var t=e.cache,r=e.serialized,s=e.isStringTag;return pN(t,r,s),MV(function(){return PV(t,r,s)}),null},Pwe=BV(function(n,e,t){var r=n.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var s=n[AE],i=[r],o="";typeof n.className=="string"?o=_V(e.registered,i,n.className):n.className!=null&&(o=n.className+" ");var a=Jv(i,void 0,Pe.useContext(gN));o+=e.key+"-"+a.name;var l={};for(var u in n)mN.call(n,u)&&u!=="css"&&u!==AE&&(l[u]=n[u]);return l.className=o,t&&(l.ref=t),Pe.createElement(Pe.Fragment,null,Pe.createElement(_we,{cache:e,serialized:a,isStringTag:typeof s=="string"}),Pe.createElement(s,l))}),Fwe=Pwe,Mwe=function(e,t){var r=arguments;if(t==null||!mN.call(t,"css"))return Pe.createElement.apply(void 0,r);var s=r.length,i=new Array(s);i[0]=Fwe,i[1]=Dwe(e,t);for(var o=2;o<s;o++)i[o]=r[o];return Pe.createElement.apply(null,i)};(function(n){var e;e||(e=n.JSX||(n.JSX={}))})(Mwe);function Lwe(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return Jv(e)}function yN(){var n=Lwe.apply(void 0,arguments),e="animation-"+n.name;return{name:e,styles:"@keyframes "+e+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var Bwe=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,zwe=OV(function(n){return Bwe.test(n)||n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)<91}),Uwe=zwe,Vwe=function(e){return e!=="theme"},M_=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?Uwe:Vwe},L_=function(e,t,r){var s;if(t){var i=t.shouldForwardProp;s=e.__emotion_forwardProp&&i?function(o){return e.__emotion_forwardProp(o)&&i(o)}:i}return typeof s!="function"&&r&&(s=e.__emotion_forwardProp),s},Wwe=function(e){var t=e.cache,r=e.serialized,s=e.isStringTag;return pN(t,r,s),MV(function(){return PV(t,r,s)}),null},Gwe=function n(e,t){var r=e.__emotion_real===e,s=r&&e.__emotion_base||e,i,o;t!==void 0&&(i=t.label,o=t.target);var a=L_(e,t,r),l=a||M_(s),u=!l("as");return function(){var f=arguments,h=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(i!==void 0&&h.push("label:"+i+";"),f[0]==null||f[0].raw===void 0)h.push.apply(h,f);else{var p=f[0];h.push(p[0]);for(var g=f.length,m=1;m<g;m++)h.push(f[m],p[m])}var w=BV(function(x,b,C){var $=u&&x.as||s,k="",N=[],_=x;if(x.theme==null){_={};for(var U in x)_[U]=x[U];_.theme=Pe.useContext(gN)}typeof x.className=="string"?k=_V(b.registered,N,x.className):x.className!=null&&(k=x.className+" ");var O=Jv(h.concat(N),b.registered,_);k+=b.key+"-"+O.name,o!==void 0&&(k+=" "+o);var L=u&&a===void 0?M_($):l,T={};for(var I in x)u&&I==="as"||L(I)&&(T[I]=x[I]);return T.className=k,C&&(T.ref=C),Pe.createElement(Pe.Fragment,null,Pe.createElement(Wwe,{cache:b,serialized:O,isStringTag:typeof $=="string"}),Pe.createElement($,T))});return w.displayName=i!==void 0?i:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",w.defaultProps=e.defaultProps,w.__emotion_real=w,w.__emotion_base=s,w.__emotion_styles=h,w.__emotion_forwardProp=a,Object.defineProperty(w,"toString",{value:function(){return"."+o}}),w.withComponent=function(x,b){var C=n(x,M1({},t,b,{shouldForwardProp:L_(w,b,!0)}));return C.apply(void 0,h)},w}},Hwe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],TE=Gwe.bind(null);Hwe.forEach(function(n){TE[n]=TE(n)});/**
 * @mui/styled-engine v6.4.0
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function zV(n,e){return TE(n,e)}function jwe(n,e){Array.isArray(n.__emotion_styles)&&(n.__emotion_styles=e(n.__emotion_styles))}const B_=[];function z_(n){return B_[0]=n,Jv(B_)}const Kwe=n=>{const e=Object.keys(n).map(t=>({key:t,val:n[t]}))||[];return e.sort((t,r)=>t.val-r.val),e.reduce((t,r)=>({...t,[r.key]:r.val}),{})};function qwe(n){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:t="px",step:r=5,...s}=n,i=Kwe(e),o=Object.keys(i);function a(p){return`@media (min-width:${typeof e[p]=="number"?e[p]:p}${t})`}function l(p){return`@media (max-width:${(typeof e[p]=="number"?e[p]:p)-r/100}${t})`}function u(p,g){const m=o.indexOf(g);return`@media (min-width:${typeof e[p]=="number"?e[p]:p}${t}) and (max-width:${(m!==-1&&typeof e[o[m]]=="number"?e[o[m]]:g)-r/100}${t})`}function f(p){return o.indexOf(p)+1<o.length?u(p,o[o.indexOf(p)+1]):a(p)}function h(p){const g=o.indexOf(p);return g===0?a(o[1]):g===o.length-1?l(o[g]):u(p,o[o.indexOf(p)+1]).replace("@media","@media not all and")}return{keys:o,values:i,up:a,down:l,between:u,only:f,not:h,unit:t,...s}}const Xwe={borderRadius:4};function UV(n=8,e=uN({spacing:n})){if(n.mui)return n;const t=(...r)=>(r.length===0?[1]:r).map(i=>{const o=e(i);return typeof o=="number"?`${o}px`:o}).join(" ");return t.mui=!0,t}function Qwe(n,e){var r;const t=this;if(t.vars){if(!((r=t.colorSchemes)!=null&&r[n])||typeof t.getColorSchemeSelector!="function")return{};let s=t.getColorSchemeSelector(n);return s==="&"?e:((s.includes("data-")||s.includes("."))&&(s=`*:where(${s.replace(/\s*&$/,"")}) &`),{[s]:e})}return t.palette.mode===n?e:{}}function Zv(n={},...e){const{breakpoints:t={},palette:r={},spacing:s,shape:i={},...o}=n,a=qwe(t),l=UV(s);let u=Bi({breakpoints:a,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:l,shape:{...Xwe,...i}},o);return u=rye(u),u.applyStyles=Qwe,u=e.reduce((f,h)=>Bi(f,h),u),u.unstable_sxConfig={...My,...o==null?void 0:o.unstable_sxConfig},u.unstable_sx=function(h){return nh({sx:h,theme:this})},u}function Ywe(n){return Object.keys(n).length===0}function Jwe(n=null){const e=Pe.useContext(gN);return!e||Ywe(e)?n:e}const Zwe=Zv();function eS(n=Zwe){return Jwe(n)}const U_=n=>n,exe=()=>{let n=U_;return{configure(e){n=e},generate(e){return n(e)},reset(){n=U_}}},VV=exe();function txe(n={}){const{themeId:e,defaultTheme:t,defaultClassName:r="MuiBox-root",generateClassName:s}=n,i=zV("div",{shouldForwardProp:a=>a!=="theme"&&a!=="sx"&&a!=="as"})(nh);return Pe.forwardRef(function(l,u){const f=eS(t),{className:h,component:p="div",...g}=IV(l);return Be.jsx(i,{as:p,ref:u,className:nr(h,s?s(r):r),theme:e&&f[e]||f,...g})})}const nxe={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function bh(n,e,t="Mui"){const r=nxe[e];return r?`${t}-${r}`:`${VV.generate(n)}-${e}`}function vh(n,e,t="Mui"){const r={};return e.forEach(s=>{r[s]=bh(n,s,t)}),r}function WV(n){const{variants:e,...t}=n,r={variants:e,style:z_(t),isProcessed:!0};return r.style===t||e&&e.forEach(s=>{typeof s.style!="function"&&(s.style=z_(s.style))}),r}const rxe=Zv();function Ok(n){return n!=="ownerState"&&n!=="theme"&&n!=="sx"&&n!=="as"}function sxe(n){return n?(e,t)=>t[n]:null}function ixe(n,e,t){n.theme=axe(n.theme)?t:n.theme[e]||n.theme}function Ux(n,e){const t=typeof e=="function"?e(n):e;if(Array.isArray(t))return t.flatMap(r=>Ux(n,r));if(Array.isArray(t==null?void 0:t.variants)){let r;if(t.isProcessed)r=t.style;else{const{variants:s,...i}=t;r=i}return GV(n,t.variants,[r])}return t!=null&&t.isProcessed?t.style:t}function GV(n,e,t=[]){var s;let r;e:for(let i=0;i<e.length;i+=1){const o=e[i];if(typeof o.props=="function"){if(r??(r={...n,...n.ownerState,ownerState:n.ownerState}),!o.props(r))continue}else for(const a in o.props)if(n[a]!==o.props[a]&&((s=n.ownerState)==null?void 0:s[a])!==o.props[a])continue e;typeof o.style=="function"?(r??(r={...n,...n.ownerState,ownerState:n.ownerState}),t.push(o.style(r))):t.push(o.style)}return t}function HV(n={}){const{themeId:e,defaultTheme:t=rxe,rootShouldForwardProp:r=Ok,slotShouldForwardProp:s=Ok}=n;function i(a){ixe(a,e,t)}return(a,l={})=>{jwe(a,N=>N.filter(_=>_!==nh));const{name:u,slot:f,skipVariantsResolver:h,skipSx:p,overridesResolver:g=sxe(uxe(f)),...m}=l,w=h!==void 0?h:f&&f!=="Root"&&f!=="root"||!1,x=p||!1;let b=Ok;f==="Root"||f==="root"?b=r:f?b=s:lxe(a)&&(b=void 0);const C=zV(a,{shouldForwardProp:b,label:oxe(),...m}),$=N=>{if(typeof N=="function"&&N.__emotion_real!==N)return function(U){return Ux(U,N)};if(Oa(N)){const _=WV(N);return _.variants?function(O){return Ux(O,_)}:_.style}return N},k=(...N)=>{const _=[],U=N.map($),O=[];if(_.push(i),u&&g&&O.push(function(v){var B,j;const M=(j=(B=v.theme.components)==null?void 0:B[u])==null?void 0:j.styleOverrides;if(!M)return null;const D={};for(const W in M)D[W]=Ux(v,M[W]);return g(v,D)}),u&&!w&&O.push(function(v){var D,B;const A=v.theme,M=(B=(D=A==null?void 0:A.components)==null?void 0:D[u])==null?void 0:B.variants;return M?GV(v,M):null}),x||O.push(nh),Array.isArray(U[0])){const I=U.shift(),v=new Array(_.length).fill(""),A=new Array(O.length).fill("");let M;M=[...v,...I,...A],M.raw=[...v,...I.raw,...A],_.unshift(M)}const L=[..._,...U,...O],T=C(...L);return a.muiName&&(T.muiName=a.muiName),T};return C.withConfig&&(k.withConfig=C.withConfig),k}}function oxe(n,e){return void 0}function axe(n){for(const e in n)return!1;return!0}function lxe(n){return typeof n=="string"&&n.charCodeAt(0)>96}function uxe(n){return n&&n.charAt(0).toLowerCase()+n.slice(1)}const cxe=HV();function B1(n,e){const t={...e};for(const r in n)if(Object.prototype.hasOwnProperty.call(n,r)){const s=r;if(s==="components"||s==="slots")t[s]={...n[s],...t[s]};else if(s==="componentsProps"||s==="slotProps"){const i=n[s],o=e[s];if(!o)t[s]=i||{};else if(!i)t[s]=o;else{t[s]={...o};for(const a in i)if(Object.prototype.hasOwnProperty.call(i,a)){const l=a;t[s][l]=B1(i[l],o[l])}}}else t[s]===void 0&&(t[s]=n[s])}return t}function fxe(n){const{theme:e,name:t,props:r}=n;return!e||!e.components||!e.components[t]||!e.components[t].defaultProps?r:B1(e.components[t].defaultProps,r)}function hxe({props:n,name:e,defaultTheme:t,themeId:r}){let s=eS(t);return r&&(s=s[r]||s),fxe({theme:s,name:e,props:n})}const jV=typeof window<"u"?Pe.useLayoutEffect:Pe.useEffect;function dxe(n,e=Number.MIN_SAFE_INTEGER,t=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(n,t))}function wN(n,e=0,t=1){return dxe(n,e,t)}function pxe(n){n=n.slice(1);const e=new RegExp(`.{1,${n.length>=6?2:1}}`,"g");let t=n.match(e);return t&&t[0].length===1&&(t=t.map(r=>r+r)),t?`rgb${t.length===4?"a":""}(${t.map((r,s)=>s<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function rc(n){if(n.type)return n;if(n.charAt(0)==="#")return rc(pxe(n));const e=n.indexOf("("),t=n.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(t))throw new Error(th(9,n));let r=n.substring(e+1,n.length-1),s;if(t==="color"){if(r=r.split(" "),s=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(s))throw new Error(th(10,s))}else r=r.split(",");return r=r.map(i=>parseFloat(i)),{type:t,values:r,colorSpace:s}}const gxe=n=>{const e=rc(n);return e.values.slice(0,3).map((t,r)=>e.type.includes("hsl")&&r!==0?`${t}%`:t).join(" ")},dm=(n,e)=>{try{return gxe(n)}catch{return n}};function tS(n){const{type:e,colorSpace:t}=n;let{values:r}=n;return e.includes("rgb")?r=r.map((s,i)=>i<3?parseInt(s,10):s):e.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.includes("color")?r=`${t} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function KV(n){n=rc(n);const{values:e}=n,t=e[0],r=e[1]/100,s=e[2]/100,i=r*Math.min(s,1-s),o=(u,f=(u+t/30)%12)=>s-i*Math.max(Math.min(f-3,9-f,1),-1);let a="rgb";const l=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return n.type==="hsla"&&(a+="a",l.push(e[3])),tS({type:a,values:l})}function NE(n){n=rc(n);let e=n.type==="hsl"||n.type==="hsla"?rc(KV(n)).values:n.values;return e=e.map(t=>(n.type!=="color"&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function mxe(n,e){const t=NE(n),r=NE(e);return(Math.max(t,r)+.05)/(Math.min(t,r)+.05)}function yxe(n,e){return n=rc(n),e=wN(e),(n.type==="rgb"||n.type==="hsl")&&(n.type+="a"),n.type==="color"?n.values[3]=`/${e}`:n.values[3]=e,tS(n)}function lx(n,e,t){try{return yxe(n,e)}catch{return n}}function xN(n,e){if(n=rc(n),e=wN(e),n.type.includes("hsl"))n.values[2]*=1-e;else if(n.type.includes("rgb")||n.type.includes("color"))for(let t=0;t<3;t+=1)n.values[t]*=1-e;return tS(n)}function Tn(n,e,t){try{return xN(n,e)}catch{return n}}function bN(n,e){if(n=rc(n),e=wN(e),n.type.includes("hsl"))n.values[2]+=(100-n.values[2])*e;else if(n.type.includes("rgb"))for(let t=0;t<3;t+=1)n.values[t]+=(255-n.values[t])*e;else if(n.type.includes("color"))for(let t=0;t<3;t+=1)n.values[t]+=(1-n.values[t])*e;return tS(n)}function Nn(n,e,t){try{return bN(n,e)}catch{return n}}function wxe(n,e=.15){return NE(n)>.5?xN(n,e):bN(n,e)}function ux(n,e,t){try{return wxe(n,e)}catch{return n}}function qV(n,e=166){let t;function r(...s){const i=()=>{n.apply(this,s)};clearTimeout(t),t=setTimeout(i,e)}return r.clear=()=>{clearTimeout(t)},r}function xxe(n,e){var t,r,s;return Pe.isValidElement(n)&&e.indexOf(n.type.muiName??((s=(r=(t=n.type)==null?void 0:t._payload)==null?void 0:r.value)==null?void 0:s.muiName))!==-1}function XV(n){return n&&n.ownerDocument||document}function QV(n){return XV(n).defaultView||window}function Df(n){const e=Pe.useRef(n);return jV(()=>{e.current=n}),Pe.useRef((...t)=>(0,e.current)(...t)).current}const V_={};function YV(n,e){const t=Pe.useRef(V_);return t.current===V_&&(t.current=n(e)),t}const bxe=[];function vxe(n){Pe.useEffect(n,bxe)}class vN{constructor(){Se(this,"currentId",null);Se(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});Se(this,"disposeEffect",()=>this.clear)}static create(){return new vN}start(e,t){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,t()},e)}}function Sxe(){const n=YV(vN.create).current;return vxe(n.disposeEffect),n}function W_(n){try{return n.matches(":focus-visible")}catch{}return!1}const Cxe=Pe.createContext(void 0);function kxe(n){const{theme:e,name:t,props:r}=n;if(!e||!e.components||!e.components[t])return r;const s=e.components[t];return s.defaultProps?B1(s.defaultProps,r):!s.styleOverrides&&!s.variants?B1(s,r):r}function Ixe({props:n,name:e}){const t=Pe.useContext(Cxe);return kxe({props:n,name:e,theme:{components:t}})}const G_={theme:void 0};function Exe(n){let e,t;return function(s){let i=e;return(i===void 0||s.theme!==t)&&(G_.theme=s.theme,i=WV(n(G_)),e=i,t=s.theme),i}}function Axe(n=""){function e(...r){if(!r.length)return"";const s=r[0];return typeof s=="string"&&!s.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${n?`${n}-`:""}${s}${e(...r.slice(1))})`:`, ${s}`}return(r,...s)=>`var(--${n?`${n}-`:""}${r}${e(...s)})`}const H_=(n,e,t,r=[])=>{let s=n;e.forEach((i,o)=>{o===e.length-1?Array.isArray(s)?s[Number(i)]=t:s&&typeof s=="object"&&(s[i]=t):s&&typeof s=="object"&&(s[i]||(s[i]=r.includes(i)?[]:{}),s=s[i])})},Txe=(n,e,t)=>{function r(s,i=[],o=[]){Object.entries(s).forEach(([a,l])=>{(!t||!t([...i,a]))&&l!=null&&(typeof l=="object"&&Object.keys(l).length>0?r(l,[...i,a],Array.isArray(l)?[...o,a]:o):e([...i,a],l,o))})}r(n)},Nxe=(n,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>n.includes(r))||n[n.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function Dk(n,e){const{prefix:t,shouldSkipGeneratingVar:r}=e||{},s={},i={},o={};return Txe(n,(a,l,u)=>{if((typeof l=="string"||typeof l=="number")&&(!r||!r(a,l))){const f=`--${t?`${t}-`:""}${a.join("-")}`,h=Nxe(a,l);Object.assign(s,{[f]:h}),H_(i,a,`var(${f})`,u),H_(o,a,`var(${f}, ${h})`,u)}},a=>a[0]==="vars"),{css:s,vars:i,varsWithDefaults:o}}function $xe(n,e={}){const{getSelector:t=x,disableCssColorScheme:r,colorSchemeSelector:s}=e,{colorSchemes:i={},components:o,defaultColorScheme:a="light",...l}=n,{vars:u,css:f,varsWithDefaults:h}=Dk(l,e);let p=h;const g={},{[a]:m,...w}=i;if(Object.entries(w||{}).forEach(([$,k])=>{const{vars:N,css:_,varsWithDefaults:U}=Dk(k,e);p=Bi(p,U),g[$]={css:_,vars:N}}),m){const{css:$,vars:k,varsWithDefaults:N}=Dk(m,e);p=Bi(p,N),g[a]={css:$,vars:k}}function x($,k){var _,U;let N=s;if(s==="class"&&(N=".%s"),s==="data"&&(N="[data-%s]"),s!=null&&s.startsWith("data-")&&!s.includes("%s")&&(N=`[${s}="%s"]`),$){if(N==="media")return n.defaultColorScheme===$?":root":{[`@media (prefers-color-scheme: ${((U=(_=i[$])==null?void 0:_.palette)==null?void 0:U.mode)||$})`]:{":root":k}};if(N)return n.defaultColorScheme===$?`:root, ${N.replace("%s",String($))}`:N.replace("%s",String($))}return":root"}return{vars:p,generateThemeVars:()=>{let $={...u};return Object.entries(g).forEach(([,{vars:k}])=>{$=Bi($,k)}),$},generateStyleSheets:()=>{var O,L;const $=[],k=n.defaultColorScheme||"light";function N(T,I){Object.keys(I).length&&$.push(typeof T=="string"?{[T]:{...I}}:T)}N(t(void 0,{...f}),f);const{[k]:_,...U}=g;if(_){const{css:T}=_,I=(L=(O=i[k])==null?void 0:O.palette)==null?void 0:L.mode,v=!r&&I?{colorScheme:I,...T}:{...T};N(t(k,{...v}),v)}return Object.entries(U).forEach(([T,{css:I}])=>{var M,D;const v=(D=(M=i[T])==null?void 0:M.palette)==null?void 0:D.mode,A=!r&&v?{colorScheme:v,...I}:{...I};N(t(T,{...A}),A)}),$}}}function Rxe(n){return function(t){return n==="media"?`@media (prefers-color-scheme: ${t})`:n?n.startsWith("data-")&&!n.includes("%s")?`[${n}="${t}"] &`:n==="class"?`.${t} &`:n==="data"?`[data-${t}] &`:`${n.replace("%s",t)} &`:"&"}}const Oxe=(n,e)=>n.filter(t=>e.includes(t)),ug=(n,e,t)=>{const r=n.keys[0];Array.isArray(e)?e.forEach((s,i)=>{t((o,a)=>{i<=n.keys.length-1&&(i===0?Object.assign(o,a):o[n.up(n.keys[i])]=a)},s)}):e&&typeof e=="object"?(Object.keys(e).length>n.keys.length?n.keys:Oxe(n.keys,Object.keys(e))).forEach(i=>{if(n.keys.includes(i)){const o=e[i];o!==void 0&&t((a,l)=>{r===i?Object.assign(a,l):a[n.up(i)]=l},o)}}):(typeof e=="number"||typeof e=="string")&&t((s,i)=>{Object.assign(s,i)},e)};function z1(n){return`--Grid-${n}Spacing`}function nS(n){return`--Grid-parent-${n}Spacing`}const j_="--Grid-columns",Nd="--Grid-parent-columns",Dxe=({theme:n,ownerState:e})=>{const t={};return ug(n.breakpoints,e.size,(r,s)=>{let i={};s==="grow"&&(i={flexBasis:0,flexGrow:1,maxWidth:"100%"}),s==="auto"&&(i={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof s=="number"&&(i={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${s} / var(${Nd}) - (var(${Nd}) - ${s}) * (var(${nS("column")}) / var(${Nd})))`}),r(t,i)}),t},_xe=({theme:n,ownerState:e})=>{const t={};return ug(n.breakpoints,e.offset,(r,s)=>{let i={};s==="auto"&&(i={marginLeft:"auto"}),typeof s=="number"&&(i={marginLeft:s===0?"0px":`calc(100% * ${s} / var(${Nd}) + var(${nS("column")}) * ${s} / var(${Nd}))`}),r(t,i)}),t},Pxe=({theme:n,ownerState:e})=>{if(!e.container)return{};const t={[j_]:12};return ug(n.breakpoints,e.columns,(r,s)=>{const i=s??12;r(t,{[j_]:i,"> *":{[Nd]:i}})}),t},Fxe=({theme:n,ownerState:e})=>{if(!e.container)return{};const t={};return ug(n.breakpoints,e.rowSpacing,(r,s)=>{var o;const i=typeof s=="string"?s:(o=n.spacing)==null?void 0:o.call(n,s);r(t,{[z1("row")]:i,"> *":{[nS("row")]:i}})}),t},Mxe=({theme:n,ownerState:e})=>{if(!e.container)return{};const t={};return ug(n.breakpoints,e.columnSpacing,(r,s)=>{var o;const i=typeof s=="string"?s:(o=n.spacing)==null?void 0:o.call(n,s);r(t,{[z1("column")]:i,"> *":{[nS("column")]:i}})}),t},Lxe=({theme:n,ownerState:e})=>{if(!e.container)return{};const t={};return ug(n.breakpoints,e.direction,(r,s)=>{r(t,{flexDirection:s})}),t},Bxe=({ownerState:n})=>({minWidth:0,boxSizing:"border-box",...n.container&&{display:"flex",flexWrap:"wrap",...n.wrap&&n.wrap!=="wrap"&&{flexWrap:n.wrap},gap:`var(${z1("row")}) var(${z1("column")})`}}),zxe=n=>{const e=[];return Object.entries(n).forEach(([t,r])=>{r!==!1&&r!==void 0&&e.push(`grid-${t}-${String(r)}`)}),e},Uxe=(n,e="xs")=>{function t(r){return r===void 0?!1:typeof r=="string"&&!Number.isNaN(Number(r))||typeof r=="number"&&r>0}if(t(n))return[`spacing-${e}-${String(n)}`];if(typeof n=="object"&&!Array.isArray(n)){const r=[];return Object.entries(n).forEach(([s,i])=>{t(i)&&r.push(`spacing-${s}-${String(i)}`)}),r}return[]},Vxe=n=>n===void 0?[]:typeof n=="object"?Object.entries(n).map(([e,t])=>`direction-${e}-${t}`):[`direction-xs-${String(n)}`],Wxe=Zv(),Gxe=cxe("div",{name:"MuiGrid",slot:"Root",overridesResolver:(n,e)=>e.root});function Hxe(n){return hxe({props:n,name:"MuiGrid",defaultTheme:Wxe})}function jxe(n={}){const{createStyledComponent:e=Gxe,useThemeProps:t=Hxe,useTheme:r=eS,componentName:s="MuiGrid"}=n,i=(u,f)=>{const{container:h,direction:p,spacing:g,wrap:m,size:w}=u,x={root:["root",h&&"container",m!=="wrap"&&`wrap-xs-${String(m)}`,...Vxe(p),...zxe(w),...h?Uxe(g,f.breakpoints.keys[0]):[]]};return ag(x,b=>bh(s,b),{})};function o(u,f,h=()=>!0){const p={};return u===null||(Array.isArray(u)?u.forEach((g,m)=>{g!==null&&h(g)&&f.keys[m]&&(p[f.keys[m]]=g)}):typeof u=="object"?Object.keys(u).forEach(g=>{const m=u[g];m!=null&&h(m)&&(p[g]=m)}):p[f.keys[0]]=u),p}const a=e(Pxe,Mxe,Fxe,Dxe,Lxe,Bxe,_xe),l=Pe.forwardRef(function(f,h){const p=r(),g=t(f),m=IV(g),{className:w,children:x,columns:b=12,container:C=!1,component:$="div",direction:k="row",wrap:N="wrap",size:_={},offset:U={},spacing:O=0,rowSpacing:L=O,columnSpacing:T=O,unstable_level:I=0,...v}=m,A=o(_,p.breakpoints,R=>R!==!1),M=o(U,p.breakpoints),D=f.columns??(I?void 0:b),B=f.spacing??(I?void 0:O),j=f.rowSpacing??f.spacing??(I?void 0:L),W=f.columnSpacing??f.spacing??(I?void 0:T),P={...m,level:I,columns:D,container:C,direction:k,wrap:N,spacing:B,rowSpacing:j,columnSpacing:W,size:A,offset:M},E=i(P,p);return Be.jsx(a,{ref:h,as:$,ownerState:P,className:nr(E.root,w),...v,children:Pe.Children.map(x,R=>{var H;return Pe.isValidElement(R)&&xxe(R,["Grid"])&&C&&R.props.container?Pe.cloneElement(R,{unstable_level:((H=R.props)==null?void 0:H.unstable_level)??I+1}):R})})});return l.muiName="Grid",l}const jm={black:"#000",white:"#fff"},Kxe={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},td={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},nd={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Yg={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},rd={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},sd={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},id={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};function JV(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:jm.white,default:jm.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const qxe=JV();function ZV(){return{text:{primary:jm.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:jm.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const K_=ZV();function q_(n,e,t,r){const s=r.light||r,i=r.dark||r*1.5;n[e]||(n.hasOwnProperty(t)?n[e]=n[t]:e==="light"?n.light=bN(n.main,s):e==="dark"&&(n.dark=xN(n.main,i)))}function Xxe(n="light"){return n==="dark"?{main:rd[200],light:rd[50],dark:rd[400]}:{main:rd[700],light:rd[400],dark:rd[800]}}function Qxe(n="light"){return n==="dark"?{main:td[200],light:td[50],dark:td[400]}:{main:td[500],light:td[300],dark:td[700]}}function Yxe(n="light"){return n==="dark"?{main:nd[500],light:nd[300],dark:nd[700]}:{main:nd[700],light:nd[400],dark:nd[800]}}function Jxe(n="light"){return n==="dark"?{main:sd[400],light:sd[300],dark:sd[700]}:{main:sd[700],light:sd[500],dark:sd[900]}}function Zxe(n="light"){return n==="dark"?{main:id[400],light:id[300],dark:id[700]}:{main:id[800],light:id[500],dark:id[900]}}function e1e(n="light"){return n==="dark"?{main:Yg[400],light:Yg[300],dark:Yg[700]}:{main:"#ed6c02",light:Yg[500],dark:Yg[900]}}function SN(n){const{mode:e="light",contrastThreshold:t=3,tonalOffset:r=.2,...s}=n,i=n.primary||Xxe(e),o=n.secondary||Qxe(e),a=n.error||Yxe(e),l=n.info||Jxe(e),u=n.success||Zxe(e),f=n.warning||e1e(e);function h(w){return mxe(w,K_.text.primary)>=t?K_.text.primary:qxe.text.primary}const p=({color:w,name:x,mainShade:b=500,lightShade:C=300,darkShade:$=700})=>{if(w={...w},!w.main&&w[b]&&(w.main=w[b]),!w.hasOwnProperty("main"))throw new Error(th(11,x?` (${x})`:"",b));if(typeof w.main!="string")throw new Error(th(12,x?` (${x})`:"",JSON.stringify(w.main)));return q_(w,"light",C,r),q_(w,"dark",$,r),w.contrastText||(w.contrastText=h(w.main)),w};let g;return e==="light"?g=JV():e==="dark"&&(g=ZV()),Bi({common:{...jm},mode:e,primary:p({color:i,name:"primary"}),secondary:p({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:p({color:a,name:"error"}),warning:p({color:f,name:"warning"}),info:p({color:l,name:"info"}),success:p({color:u,name:"success"}),grey:Kxe,contrastThreshold:t,getContrastText:h,augmentColor:p,tonalOffset:r,...g},s)}function t1e(n){const e={};return Object.entries(n).forEach(r=>{const[s,i]=r;typeof i=="object"&&(e[s]=`${i.fontStyle?`${i.fontStyle} `:""}${i.fontVariant?`${i.fontVariant} `:""}${i.fontWeight?`${i.fontWeight} `:""}${i.fontStretch?`${i.fontStretch} `:""}${i.fontSize||""}${i.lineHeight?`/${i.lineHeight} `:""}${i.fontFamily||""}`)}),e}function n1e(n,e){return{toolbar:{minHeight:56,[n.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[n.up("sm")]:{minHeight:64}},...e}}function r1e(n){return Math.round(n*1e5)/1e5}const X_={textTransform:"uppercase"},Q_='"Roboto", "Helvetica", "Arial", sans-serif';function s1e(n,e){const{fontFamily:t=Q_,fontSize:r=14,fontWeightLight:s=300,fontWeightRegular:i=400,fontWeightMedium:o=500,fontWeightBold:a=700,htmlFontSize:l=16,allVariants:u,pxToRem:f,...h}=typeof e=="function"?e(n):e,p=r/14,g=f||(x=>`${x/l*p}rem`),m=(x,b,C,$,k)=>({fontFamily:t,fontWeight:x,fontSize:g(b),lineHeight:C,...t===Q_?{letterSpacing:`${r1e($/b)}em`}:{},...k,...u}),w={h1:m(s,96,1.167,-1.5),h2:m(s,60,1.2,-.5),h3:m(i,48,1.167,0),h4:m(i,34,1.235,.25),h5:m(i,24,1.334,0),h6:m(o,20,1.6,.15),subtitle1:m(i,16,1.75,.15),subtitle2:m(o,14,1.57,.1),body1:m(i,16,1.5,.15),body2:m(i,14,1.43,.15),button:m(o,14,1.75,.4,X_),caption:m(i,12,1.66,.4),overline:m(i,12,2.66,1,X_),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Bi({htmlFontSize:l,pxToRem:g,fontFamily:t,fontSize:r,fontWeightLight:s,fontWeightRegular:i,fontWeightMedium:o,fontWeightBold:a,...w},h,{clone:!1})}const i1e=.2,o1e=.14,a1e=.12;function Yn(...n){return[`${n[0]}px ${n[1]}px ${n[2]}px ${n[3]}px rgba(0,0,0,${i1e})`,`${n[4]}px ${n[5]}px ${n[6]}px ${n[7]}px rgba(0,0,0,${o1e})`,`${n[8]}px ${n[9]}px ${n[10]}px ${n[11]}px rgba(0,0,0,${a1e})`].join(",")}const l1e=["none",Yn(0,2,1,-1,0,1,1,0,0,1,3,0),Yn(0,3,1,-2,0,2,2,0,0,1,5,0),Yn(0,3,3,-2,0,3,4,0,0,1,8,0),Yn(0,2,4,-1,0,4,5,0,0,1,10,0),Yn(0,3,5,-1,0,5,8,0,0,1,14,0),Yn(0,3,5,-1,0,6,10,0,0,1,18,0),Yn(0,4,5,-2,0,7,10,1,0,2,16,1),Yn(0,5,5,-3,0,8,10,1,0,3,14,2),Yn(0,5,6,-3,0,9,12,1,0,3,16,2),Yn(0,6,6,-3,0,10,14,1,0,4,18,3),Yn(0,6,7,-4,0,11,15,1,0,4,20,3),Yn(0,7,8,-4,0,12,17,2,0,5,22,4),Yn(0,7,8,-4,0,13,19,2,0,5,24,4),Yn(0,7,9,-4,0,14,21,2,0,5,26,4),Yn(0,8,9,-5,0,15,22,2,0,6,28,5),Yn(0,8,10,-5,0,16,24,2,0,6,30,5),Yn(0,8,11,-5,0,17,26,2,0,6,32,5),Yn(0,9,11,-5,0,18,28,2,0,7,34,6),Yn(0,9,12,-6,0,19,29,2,0,7,36,6),Yn(0,10,13,-6,0,20,31,3,0,8,38,7),Yn(0,10,13,-6,0,21,33,3,0,8,40,7),Yn(0,10,14,-6,0,22,35,3,0,8,42,7),Yn(0,11,14,-7,0,23,36,3,0,9,44,8),Yn(0,11,15,-7,0,24,38,3,0,9,46,8)],u1e={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},c1e={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Y_(n){return`${Math.round(n)}ms`}function f1e(n){if(!n)return 0;const e=n/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function h1e(n){const e={...u1e,...n.easing},t={...c1e,...n.duration};return{getAutoHeightDuration:f1e,create:(s=["all"],i={})=>{const{duration:o=t.standard,easing:a=e.easeInOut,delay:l=0,...u}=i;return(Array.isArray(s)?s:[s]).map(f=>`${f} ${typeof o=="string"?o:Y_(o)} ${a} ${typeof l=="string"?l:Y_(l)}`).join(",")},...n,easing:e,duration:t}}const d1e={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function p1e(n){return Oa(n)||typeof n>"u"||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||Array.isArray(n)}function e6(n={}){const e={...n};function t(r){const s=Object.entries(r);for(let i=0;i<s.length;i++){const[o,a]=s[i];!p1e(a)||o.startsWith("unstable_")?delete r[o]:Oa(a)&&(r[o]={...a},t(r[o]))}}return t(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function $E(n={},...e){const{breakpoints:t,mixins:r={},spacing:s,palette:i={},transitions:o={},typography:a={},shape:l,...u}=n;if(n.vars)throw new Error(th(20));const f=SN(i),h=Zv(n);let p=Bi(h,{mixins:n1e(h.breakpoints,r),palette:f,shadows:l1e.slice(),typography:s1e(f,a),transitions:h1e(o),zIndex:{...d1e}});return p=Bi(p,u),p=e.reduce((g,m)=>Bi(g,m),p),p.unstable_sxConfig={...My,...u==null?void 0:u.unstable_sxConfig},p.unstable_sx=function(m){return nh({sx:m,theme:this})},p.toRuntimeSource=e6,p}function g1e(n){let e;return n<1?e=5.11916*n**2:e=4.5*Math.log(n+1)+2,Math.round(e*10)/1e3}const m1e=[...Array(25)].map((n,e)=>{if(e===0)return"none";const t=g1e(e);return`linear-gradient(rgba(255 255 255 / ${t}), rgba(255 255 255 / ${t}))`});function t6(n){return{inputPlaceholder:n==="dark"?.5:.42,inputUnderline:n==="dark"?.7:.42,switchTrackDisabled:n==="dark"?.2:.12,switchTrack:n==="dark"?.3:.38}}function n6(n){return n==="dark"?m1e:[]}function y1e(n){const{palette:e={mode:"light"},opacity:t,overlays:r,...s}=n,i=SN(e);return{palette:i,opacity:{...t6(i.mode),...t},overlays:r||n6(i.mode),...s}}function w1e(n){var e;return!!n[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!n[0].match(/sxConfig$/)||n[0]==="palette"&&!!((e=n[1])!=null&&e.match(/(mode|contrastThreshold|tonalOffset)/))}const x1e=n=>[...[...Array(25)].map((e,t)=>`--${n?`${n}-`:""}overlays-${t}`),`--${n?`${n}-`:""}palette-AppBar-darkBg`,`--${n?`${n}-`:""}palette-AppBar-darkColor`],b1e=n=>(e,t)=>{const r=n.rootSelector||":root",s=n.colorSchemeSelector;let i=s;if(s==="class"&&(i=".%s"),s==="data"&&(i="[data-%s]"),s!=null&&s.startsWith("data-")&&!s.includes("%s")&&(i=`[${s}="%s"]`),n.defaultColorScheme===e){if(e==="dark"){const o={};return x1e(n.cssVarPrefix).forEach(a=>{o[a]=t[a],delete t[a]}),i==="media"?{[r]:t,"@media (prefers-color-scheme: dark)":{[r]:o}}:i?{[i.replace("%s",e)]:o,[`${r}, ${i.replace("%s",e)}`]:t}:{[r]:{...t,...o}}}if(i&&i!=="media")return`${r}, ${i.replace("%s",String(e))}`}else if(e){if(i==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[r]:t}};if(i)return i.replace("%s",String(e))}return r};function v1e(n,e){e.forEach(t=>{n[t]||(n[t]={})})}function Fe(n,e,t){!n[e]&&t&&(n[e]=t)}function pm(n){return typeof n!="string"||!n.startsWith("hsl")?n:KV(n)}function ul(n,e){`${e}Channel`in n||(n[`${e}Channel`]=dm(pm(n[e])))}function S1e(n){return typeof n=="number"?`${n}px`:typeof n=="string"||typeof n=="function"||Array.isArray(n)?n:"8px"}const pa=n=>{try{return n()}catch{}},C1e=(n="mui")=>Axe(n);function _k(n,e,t,r){if(!e)return;e=e===!0?{}:e;const s=r==="dark"?"dark":"light";if(!t){n[r]=y1e({...e,palette:{mode:s,...e==null?void 0:e.palette}});return}const{palette:i,...o}=$E({...t,palette:{mode:s,...e==null?void 0:e.palette}});return n[r]={...e,palette:i,opacity:{...t6(s),...e==null?void 0:e.opacity},overlays:(e==null?void 0:e.overlays)||n6(s)},o}function k1e(n={},...e){const{colorSchemes:t={light:!0},defaultColorScheme:r,disableCssColorScheme:s=!1,cssVarPrefix:i="mui",shouldSkipGeneratingVar:o=w1e,colorSchemeSelector:a=t.light&&t.dark?"media":void 0,rootSelector:l=":root",...u}=n,f=Object.keys(t)[0],h=r||(t.light&&f!=="light"?"light":f),p=C1e(i),{[h]:g,light:m,dark:w,...x}=t,b={...x};let C=g;if((h==="dark"&&!("dark"in t)||h==="light"&&!("light"in t))&&(C=!0),!C)throw new Error(th(21,h));const $=_k(b,C,u,h);m&&!b.light&&_k(b,m,void 0,"light"),w&&!b.dark&&_k(b,w,void 0,"dark");let k={defaultColorScheme:h,...$,cssVarPrefix:i,colorSchemeSelector:a,rootSelector:l,getCssVar:p,colorSchemes:b,font:{...t1e($.typography),...$.font},spacing:S1e(u.spacing)};Object.keys(k.colorSchemes).forEach(L=>{const T=k.colorSchemes[L].palette,I=v=>{const A=v.split("-"),M=A[1],D=A[2];return p(v,T[M][D])};if(T.mode==="light"&&(Fe(T.common,"background","#fff"),Fe(T.common,"onBackground","#000")),T.mode==="dark"&&(Fe(T.common,"background","#000"),Fe(T.common,"onBackground","#fff")),v1e(T,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),T.mode==="light"){Fe(T.Alert,"errorColor",Tn(T.error.light,.6)),Fe(T.Alert,"infoColor",Tn(T.info.light,.6)),Fe(T.Alert,"successColor",Tn(T.success.light,.6)),Fe(T.Alert,"warningColor",Tn(T.warning.light,.6)),Fe(T.Alert,"errorFilledBg",I("palette-error-main")),Fe(T.Alert,"infoFilledBg",I("palette-info-main")),Fe(T.Alert,"successFilledBg",I("palette-success-main")),Fe(T.Alert,"warningFilledBg",I("palette-warning-main")),Fe(T.Alert,"errorFilledColor",pa(()=>T.getContrastText(T.error.main))),Fe(T.Alert,"infoFilledColor",pa(()=>T.getContrastText(T.info.main))),Fe(T.Alert,"successFilledColor",pa(()=>T.getContrastText(T.success.main))),Fe(T.Alert,"warningFilledColor",pa(()=>T.getContrastText(T.warning.main))),Fe(T.Alert,"errorStandardBg",Nn(T.error.light,.9)),Fe(T.Alert,"infoStandardBg",Nn(T.info.light,.9)),Fe(T.Alert,"successStandardBg",Nn(T.success.light,.9)),Fe(T.Alert,"warningStandardBg",Nn(T.warning.light,.9)),Fe(T.Alert,"errorIconColor",I("palette-error-main")),Fe(T.Alert,"infoIconColor",I("palette-info-main")),Fe(T.Alert,"successIconColor",I("palette-success-main")),Fe(T.Alert,"warningIconColor",I("palette-warning-main")),Fe(T.AppBar,"defaultBg",I("palette-grey-100")),Fe(T.Avatar,"defaultBg",I("palette-grey-400")),Fe(T.Button,"inheritContainedBg",I("palette-grey-300")),Fe(T.Button,"inheritContainedHoverBg",I("palette-grey-A100")),Fe(T.Chip,"defaultBorder",I("palette-grey-400")),Fe(T.Chip,"defaultAvatarColor",I("palette-grey-700")),Fe(T.Chip,"defaultIconColor",I("palette-grey-700")),Fe(T.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Fe(T.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Fe(T.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Fe(T.LinearProgress,"primaryBg",Nn(T.primary.main,.62)),Fe(T.LinearProgress,"secondaryBg",Nn(T.secondary.main,.62)),Fe(T.LinearProgress,"errorBg",Nn(T.error.main,.62)),Fe(T.LinearProgress,"infoBg",Nn(T.info.main,.62)),Fe(T.LinearProgress,"successBg",Nn(T.success.main,.62)),Fe(T.LinearProgress,"warningBg",Nn(T.warning.main,.62)),Fe(T.Skeleton,"bg",`rgba(${I("palette-text-primaryChannel")} / 0.11)`),Fe(T.Slider,"primaryTrack",Nn(T.primary.main,.62)),Fe(T.Slider,"secondaryTrack",Nn(T.secondary.main,.62)),Fe(T.Slider,"errorTrack",Nn(T.error.main,.62)),Fe(T.Slider,"infoTrack",Nn(T.info.main,.62)),Fe(T.Slider,"successTrack",Nn(T.success.main,.62)),Fe(T.Slider,"warningTrack",Nn(T.warning.main,.62));const v=ux(T.background.default,.8);Fe(T.SnackbarContent,"bg",v),Fe(T.SnackbarContent,"color",pa(()=>T.getContrastText(v))),Fe(T.SpeedDialAction,"fabHoverBg",ux(T.background.paper,.15)),Fe(T.StepConnector,"border",I("palette-grey-400")),Fe(T.StepContent,"border",I("palette-grey-400")),Fe(T.Switch,"defaultColor",I("palette-common-white")),Fe(T.Switch,"defaultDisabledColor",I("palette-grey-100")),Fe(T.Switch,"primaryDisabledColor",Nn(T.primary.main,.62)),Fe(T.Switch,"secondaryDisabledColor",Nn(T.secondary.main,.62)),Fe(T.Switch,"errorDisabledColor",Nn(T.error.main,.62)),Fe(T.Switch,"infoDisabledColor",Nn(T.info.main,.62)),Fe(T.Switch,"successDisabledColor",Nn(T.success.main,.62)),Fe(T.Switch,"warningDisabledColor",Nn(T.warning.main,.62)),Fe(T.TableCell,"border",Nn(lx(T.divider,1),.88)),Fe(T.Tooltip,"bg",lx(T.grey[700],.92))}if(T.mode==="dark"){Fe(T.Alert,"errorColor",Nn(T.error.light,.6)),Fe(T.Alert,"infoColor",Nn(T.info.light,.6)),Fe(T.Alert,"successColor",Nn(T.success.light,.6)),Fe(T.Alert,"warningColor",Nn(T.warning.light,.6)),Fe(T.Alert,"errorFilledBg",I("palette-error-dark")),Fe(T.Alert,"infoFilledBg",I("palette-info-dark")),Fe(T.Alert,"successFilledBg",I("palette-success-dark")),Fe(T.Alert,"warningFilledBg",I("palette-warning-dark")),Fe(T.Alert,"errorFilledColor",pa(()=>T.getContrastText(T.error.dark))),Fe(T.Alert,"infoFilledColor",pa(()=>T.getContrastText(T.info.dark))),Fe(T.Alert,"successFilledColor",pa(()=>T.getContrastText(T.success.dark))),Fe(T.Alert,"warningFilledColor",pa(()=>T.getContrastText(T.warning.dark))),Fe(T.Alert,"errorStandardBg",Tn(T.error.light,.9)),Fe(T.Alert,"infoStandardBg",Tn(T.info.light,.9)),Fe(T.Alert,"successStandardBg",Tn(T.success.light,.9)),Fe(T.Alert,"warningStandardBg",Tn(T.warning.light,.9)),Fe(T.Alert,"errorIconColor",I("palette-error-main")),Fe(T.Alert,"infoIconColor",I("palette-info-main")),Fe(T.Alert,"successIconColor",I("palette-success-main")),Fe(T.Alert,"warningIconColor",I("palette-warning-main")),Fe(T.AppBar,"defaultBg",I("palette-grey-900")),Fe(T.AppBar,"darkBg",I("palette-background-paper")),Fe(T.AppBar,"darkColor",I("palette-text-primary")),Fe(T.Avatar,"defaultBg",I("palette-grey-600")),Fe(T.Button,"inheritContainedBg",I("palette-grey-800")),Fe(T.Button,"inheritContainedHoverBg",I("palette-grey-700")),Fe(T.Chip,"defaultBorder",I("palette-grey-700")),Fe(T.Chip,"defaultAvatarColor",I("palette-grey-300")),Fe(T.Chip,"defaultIconColor",I("palette-grey-300")),Fe(T.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Fe(T.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Fe(T.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Fe(T.LinearProgress,"primaryBg",Tn(T.primary.main,.5)),Fe(T.LinearProgress,"secondaryBg",Tn(T.secondary.main,.5)),Fe(T.LinearProgress,"errorBg",Tn(T.error.main,.5)),Fe(T.LinearProgress,"infoBg",Tn(T.info.main,.5)),Fe(T.LinearProgress,"successBg",Tn(T.success.main,.5)),Fe(T.LinearProgress,"warningBg",Tn(T.warning.main,.5)),Fe(T.Skeleton,"bg",`rgba(${I("palette-text-primaryChannel")} / 0.13)`),Fe(T.Slider,"primaryTrack",Tn(T.primary.main,.5)),Fe(T.Slider,"secondaryTrack",Tn(T.secondary.main,.5)),Fe(T.Slider,"errorTrack",Tn(T.error.main,.5)),Fe(T.Slider,"infoTrack",Tn(T.info.main,.5)),Fe(T.Slider,"successTrack",Tn(T.success.main,.5)),Fe(T.Slider,"warningTrack",Tn(T.warning.main,.5));const v=ux(T.background.default,.98);Fe(T.SnackbarContent,"bg",v),Fe(T.SnackbarContent,"color",pa(()=>T.getContrastText(v))),Fe(T.SpeedDialAction,"fabHoverBg",ux(T.background.paper,.15)),Fe(T.StepConnector,"border",I("palette-grey-600")),Fe(T.StepContent,"border",I("palette-grey-600")),Fe(T.Switch,"defaultColor",I("palette-grey-300")),Fe(T.Switch,"defaultDisabledColor",I("palette-grey-600")),Fe(T.Switch,"primaryDisabledColor",Tn(T.primary.main,.55)),Fe(T.Switch,"secondaryDisabledColor",Tn(T.secondary.main,.55)),Fe(T.Switch,"errorDisabledColor",Tn(T.error.main,.55)),Fe(T.Switch,"infoDisabledColor",Tn(T.info.main,.55)),Fe(T.Switch,"successDisabledColor",Tn(T.success.main,.55)),Fe(T.Switch,"warningDisabledColor",Tn(T.warning.main,.55)),Fe(T.TableCell,"border",Tn(lx(T.divider,1),.68)),Fe(T.Tooltip,"bg",lx(T.grey[700],.92))}ul(T.background,"default"),ul(T.background,"paper"),ul(T.common,"background"),ul(T.common,"onBackground"),ul(T,"divider"),Object.keys(T).forEach(v=>{const A=T[v];v!=="tonalOffset"&&A&&typeof A=="object"&&(A.main&&Fe(T[v],"mainChannel",dm(pm(A.main))),A.light&&Fe(T[v],"lightChannel",dm(pm(A.light))),A.dark&&Fe(T[v],"darkChannel",dm(pm(A.dark))),A.contrastText&&Fe(T[v],"contrastTextChannel",dm(pm(A.contrastText))),v==="text"&&(ul(T[v],"primary"),ul(T[v],"secondary")),v==="action"&&(A.active&&ul(T[v],"active"),A.selected&&ul(T[v],"selected")))})}),k=e.reduce((L,T)=>Bi(L,T),k);const N={prefix:i,disableCssColorScheme:s,shouldSkipGeneratingVar:o,getSelector:b1e(k)},{vars:_,generateThemeVars:U,generateStyleSheets:O}=$xe(k,N);return k.vars=_,Object.entries(k.colorSchemes[k.defaultColorScheme]).forEach(([L,T])=>{k[L]=T}),k.generateThemeVars=U,k.generateStyleSheets=O,k.generateSpacing=function(){return UV(u.spacing,uN(this))},k.getColorSchemeSelector=Rxe(a),k.spacing=k.generateSpacing(),k.shouldSkipGeneratingVar=o,k.unstable_sxConfig={...My,...u==null?void 0:u.unstable_sxConfig},k.unstable_sx=function(T){return nh({sx:T,theme:this})},k.toRuntimeSource=e6,k}function J_(n,e,t){n.colorSchemes&&t&&(n.colorSchemes[e]={...t!==!0&&t,palette:SN({...t===!0?{}:t.palette,mode:e})})}function r6(n={},...e){const{palette:t,cssVariables:r=!1,colorSchemes:s=t?void 0:{light:!0},defaultColorScheme:i=t==null?void 0:t.mode,...o}=n,a=i||"light",l=s==null?void 0:s[a],u={...s,...t?{[a]:{...typeof l!="boolean"&&l,palette:t}}:void 0};if(r===!1){if(!("colorSchemes"in n))return $E(n,...e);let f=t;"palette"in n||u[a]&&(u[a]!==!0?f=u[a].palette:a==="dark"&&(f={mode:"dark"}));const h=$E({...n,palette:f},...e);return h.defaultColorScheme=a,h.colorSchemes=u,h.palette.mode==="light"&&(h.colorSchemes.light={...u.light!==!0&&u.light,palette:h.palette},J_(h,"dark",u.dark)),h.palette.mode==="dark"&&(h.colorSchemes.dark={...u.dark!==!0&&u.dark,palette:h.palette},J_(h,"light",u.light)),h}return!t&&!("light"in u)&&a==="light"&&(u.light=!0),k1e({...o,colorSchemes:u,defaultColorScheme:a,...typeof r!="boolean"&&r},...e)}const s6=r6(),CN="$$material";function i6(){const n=eS(s6);return n[CN]||n}function I1e(n){return n!=="ownerState"&&n!=="theme"&&n!=="sx"&&n!=="as"}const E1e=n=>I1e(n)&&n!=="classes",So=HV({themeId:CN,defaultTheme:s6,rootShouldForwardProp:E1e}),rS=Exe;function Sh(n){return Ixe(n)}function A1e(n){return(1+Math.sin(Math.PI*n-Math.PI/2))/2}function T1e(n,e,t,r={},s=()=>{}){const{ease:i=A1e,duration:o=300}=r;let a=null;const l=e[n];let u=!1;const f=()=>{u=!0},h=p=>{if(u){s(new Error("Animation cancelled"));return}a===null&&(a=p);const g=Math.min(1,(p-a)/o);if(e[n]=i(g)*(t-l)+l,g>=1){requestAnimationFrame(()=>{s(null)});return}requestAnimationFrame(h)};return l===t?(s(new Error("Element already at target position")),f):(requestAnimationFrame(h),f)}function N1e(n){return bh("MuiSvgIcon",n)}vh("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const $1e=n=>{const{color:e,fontSize:t,classes:r}=n,s={root:["root",e!=="inherit"&&`color${nc(e)}`,`fontSize${nc(t)}`]};return ag(s,N1e,r)},R1e=So("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:t}=n;return[e.root,t.color!=="inherit"&&e[`color${nc(t.color)}`],e[`fontSize${nc(t.fontSize)}`]]}})(rS(({theme:n})=>{var e,t,r,s,i,o,a,l,u,f,h,p,g,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(s=(e=n.transitions)==null?void 0:e.create)==null?void 0:s.call(e,"fill",{duration:(r=(t=(n.vars??n).transitions)==null?void 0:t.duration)==null?void 0:r.shorter}),variants:[{props:w=>!w.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((o=(i=n.typography)==null?void 0:i.pxToRem)==null?void 0:o.call(i,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((l=(a=n.typography)==null?void 0:a.pxToRem)==null?void 0:l.call(a,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((f=(u=n.typography)==null?void 0:u.pxToRem)==null?void 0:f.call(u,35))||"2.1875rem"}},...Object.entries((n.vars??n).palette).filter(([,w])=>w&&w.main).map(([w])=>{var x,b;return{props:{color:w},style:{color:(b=(x=(n.vars??n).palette)==null?void 0:x[w])==null?void 0:b.main}}}),{props:{color:"action"},style:{color:(p=(h=(n.vars??n).palette)==null?void 0:h.action)==null?void 0:p.active}},{props:{color:"disabled"},style:{color:(m=(g=(n.vars??n).palette)==null?void 0:g.action)==null?void 0:m.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),RE=Pe.forwardRef(function(e,t){const r=Sh({props:e,name:"MuiSvgIcon"}),{children:s,className:i,color:o="inherit",component:a="svg",fontSize:l="medium",htmlColor:u,inheritViewBox:f=!1,titleAccess:h,viewBox:p="0 0 24 24",...g}=r,m=Pe.isValidElement(s)&&s.type==="svg",w={...r,color:o,component:a,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:f,viewBox:p,hasSvgAsChild:m},x={};f||(x.viewBox=p);const b=$1e(w);return Be.jsxs(R1e,{as:a,className:nr(b.root,i),focusable:"false",color:u,"aria-hidden":h?void 0:!0,role:h?"img":void 0,ref:t,...x,...g,...m&&s.props,ownerState:w,children:[m?s.props.children:s,h?Be.jsx("title",{children:h}):null]})});RE.muiName="SvgIcon";function o6(n,e){function t(r,s){return Be.jsx(RE,{"data-testid":`${e}Icon`,ref:s,...r,children:n})}return t.muiName=RE.muiName,Pe.memo(Pe.forwardRef(t))}const O1e={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function D1e(n){const{onChange:e,...t}=n,r=Pe.useRef(),s=Pe.useRef(null),i=()=>{r.current=s.current.offsetHeight-s.current.clientHeight};return jV(()=>{const o=qV(()=>{const l=r.current;i(),l!==r.current&&e(r.current)}),a=QV(s.current);return a.addEventListener("resize",o),()=>{o.clear(),a.removeEventListener("resize",o)}},[e]),Pe.useEffect(()=>{i(),e(r.current)},[e]),Be.jsx("div",{style:O1e,...t,ref:s})}const _1e=o6(Be.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),P1e=o6(Be.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight");class U1{constructor(){Se(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new U1}static use(){const e=YV(U1.create).current,[t,r]=Pe.useState(!1);return e.shouldMount=t,e.setShouldMount=r,Pe.useEffect(e.mountEffect,[t]),e}mount(){return this.mounted||(this.mounted=M1e(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...e){this.mount().then(()=>{var t;return(t=this.ref.current)==null?void 0:t.start(...e)})}stop(...e){this.mount().then(()=>{var t;return(t=this.ref.current)==null?void 0:t.stop(...e)})}pulsate(...e){this.mount().then(()=>{var t;return(t=this.ref.current)==null?void 0:t.pulsate(...e)})}}function F1e(){return U1.use()}function M1e(){let n,e;const t=new Promise((r,s)=>{n=r,e=s});return t.resolve=n,t.reject=e,t}function L1e(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function OE(n,e){return OE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},OE(n,e)}function B1e(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,OE(n,e)}const Z_=fo.createContext(null);function z1e(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function kN(n,e){var t=function(i){return e&&Pe.isValidElement(i)?e(i):i},r=Object.create(null);return n&&Pe.Children.map(n,function(s){return s}).forEach(function(s){r[s.key]=t(s)}),r}function U1e(n,e){n=n||{},e=e||{};function t(f){return f in e?e[f]:n[f]}var r=Object.create(null),s=[];for(var i in n)i in e?s.length&&(r[i]=s,s=[]):s.push(i);var o,a={};for(var l in e){if(r[l])for(o=0;o<r[l].length;o++){var u=r[l][o];a[r[l][o]]=t(u)}a[l]=t(l)}for(o=0;o<s.length;o++)a[s[o]]=t(s[o]);return a}function rf(n,e,t){return t[e]!=null?t[e]:n.props[e]}function V1e(n,e){return kN(n.children,function(t){return Pe.cloneElement(t,{onExited:e.bind(null,t),in:!0,appear:rf(t,"appear",n),enter:rf(t,"enter",n),exit:rf(t,"exit",n)})})}function W1e(n,e,t){var r=kN(n.children),s=U1e(e,r);return Object.keys(s).forEach(function(i){var o=s[i];if(Pe.isValidElement(o)){var a=i in e,l=i in r,u=e[i],f=Pe.isValidElement(u)&&!u.props.in;l&&(!a||f)?s[i]=Pe.cloneElement(o,{onExited:t.bind(null,o),in:!0,exit:rf(o,"exit",n),enter:rf(o,"enter",n)}):!l&&a&&!f?s[i]=Pe.cloneElement(o,{in:!1}):l&&a&&Pe.isValidElement(u)&&(s[i]=Pe.cloneElement(o,{onExited:t.bind(null,o),in:u.props.in,exit:rf(o,"exit",n),enter:rf(o,"enter",n)}))}}),s}var G1e=Object.values||function(n){return Object.keys(n).map(function(e){return n[e]})},H1e={component:"div",childFactory:function(e){return e}},IN=function(n){B1e(e,n);function e(r,s){var i;i=n.call(this,r,s)||this;var o=i.handleExited.bind(z1e(i));return i.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},i}var t=e.prototype;return t.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},t.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(s,i){var o=i.children,a=i.handleExited,l=i.firstRender;return{children:l?V1e(s,a):W1e(s,o,a),firstRender:!1}},t.handleExited=function(s,i){var o=kN(this.props.children);s.key in o||(s.props.onExited&&s.props.onExited(i),this.mounted&&this.setState(function(a){var l=M1({},a.children);return delete l[s.key],{children:l}}))},t.render=function(){var s=this.props,i=s.component,o=s.childFactory,a=L1e(s,["component","childFactory"]),l=this.state.contextValue,u=G1e(this.state.children).map(o);return delete a.appear,delete a.enter,delete a.exit,i===null?fo.createElement(Z_.Provider,{value:l},u):fo.createElement(Z_.Provider,{value:l},fo.createElement(i,a,u))},e}(fo.Component);IN.propTypes={};IN.defaultProps=H1e;function j1e(n){const{className:e,classes:t,pulsate:r=!1,rippleX:s,rippleY:i,rippleSize:o,in:a,onExited:l,timeout:u}=n,[f,h]=Pe.useState(!1),p=nr(e,t.ripple,t.rippleVisible,r&&t.ripplePulsate),g={width:o,height:o,top:-(o/2)+i,left:-(o/2)+s},m=nr(t.child,f&&t.childLeaving,r&&t.childPulsate);return!a&&!f&&h(!0),Pe.useEffect(()=>{if(!a&&l!=null){const w=setTimeout(l,u);return()=>{clearTimeout(w)}}},[l,a,u]),Be.jsx("span",{className:p,style:g,children:Be.jsx("span",{className:m})})}const lo=vh("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),DE=550,K1e=80,q1e=yN`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,X1e=yN`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Q1e=yN`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,Y1e=So("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),J1e=So(j1e,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${lo.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${q1e};
    animation-duration: ${DE}ms;
    animation-timing-function: ${({theme:n})=>n.transitions.easing.easeInOut};
  }

  &.${lo.ripplePulsate} {
    animation-duration: ${({theme:n})=>n.transitions.duration.shorter}ms;
  }

  & .${lo.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${lo.childLeaving} {
    opacity: 0;
    animation-name: ${X1e};
    animation-duration: ${DE}ms;
    animation-timing-function: ${({theme:n})=>n.transitions.easing.easeInOut};
  }

  & .${lo.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Q1e};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:n})=>n.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,Z1e=Pe.forwardRef(function(e,t){const r=Sh({props:e,name:"MuiTouchRipple"}),{center:s=!1,classes:i={},className:o,...a}=r,[l,u]=Pe.useState([]),f=Pe.useRef(0),h=Pe.useRef(null);Pe.useEffect(()=>{h.current&&(h.current(),h.current=null)},[l]);const p=Pe.useRef(!1),g=Sxe(),m=Pe.useRef(null),w=Pe.useRef(null),x=Pe.useCallback(k=>{const{pulsate:N,rippleX:_,rippleY:U,rippleSize:O,cb:L}=k;u(T=>[...T,Be.jsx(J1e,{classes:{ripple:nr(i.ripple,lo.ripple),rippleVisible:nr(i.rippleVisible,lo.rippleVisible),ripplePulsate:nr(i.ripplePulsate,lo.ripplePulsate),child:nr(i.child,lo.child),childLeaving:nr(i.childLeaving,lo.childLeaving),childPulsate:nr(i.childPulsate,lo.childPulsate)},timeout:DE,pulsate:N,rippleX:_,rippleY:U,rippleSize:O},f.current)]),f.current+=1,h.current=L},[i]),b=Pe.useCallback((k={},N={},_=()=>{})=>{const{pulsate:U=!1,center:O=s||N.pulsate,fakeElement:L=!1}=N;if((k==null?void 0:k.type)==="mousedown"&&p.current){p.current=!1;return}(k==null?void 0:k.type)==="touchstart"&&(p.current=!0);const T=L?null:w.current,I=T?T.getBoundingClientRect():{width:0,height:0,left:0,top:0};let v,A,M;if(O||k===void 0||k.clientX===0&&k.clientY===0||!k.clientX&&!k.touches)v=Math.round(I.width/2),A=Math.round(I.height/2);else{const{clientX:D,clientY:B}=k.touches&&k.touches.length>0?k.touches[0]:k;v=Math.round(D-I.left),A=Math.round(B-I.top)}if(O)M=Math.sqrt((2*I.width**2+I.height**2)/3),M%2===0&&(M+=1);else{const D=Math.max(Math.abs((T?T.clientWidth:0)-v),v)*2+2,B=Math.max(Math.abs((T?T.clientHeight:0)-A),A)*2+2;M=Math.sqrt(D**2+B**2)}k!=null&&k.touches?m.current===null&&(m.current=()=>{x({pulsate:U,rippleX:v,rippleY:A,rippleSize:M,cb:_})},g.start(K1e,()=>{m.current&&(m.current(),m.current=null)})):x({pulsate:U,rippleX:v,rippleY:A,rippleSize:M,cb:_})},[s,x,g]),C=Pe.useCallback(()=>{b({},{pulsate:!0})},[b]),$=Pe.useCallback((k,N)=>{if(g.clear(),(k==null?void 0:k.type)==="touchend"&&m.current){m.current(),m.current=null,g.start(0,()=>{$(k,N)});return}m.current=null,u(_=>_.length>0?_.slice(1):_),h.current=N},[g]);return Pe.useImperativeHandle(t,()=>({pulsate:C,start:b,stop:$}),[C,b,$]),Be.jsx(Y1e,{className:nr(lo.root,i.root,o),ref:w,...a,children:Be.jsx(IN,{component:null,exit:!0,children:l})})});function ebe(n){return bh("MuiButtonBase",n)}const tbe=vh("MuiButtonBase",["root","disabled","focusVisible"]),nbe=n=>{const{disabled:e,focusVisible:t,focusVisibleClassName:r,classes:s}=n,o=ag({root:["root",e&&"disabled",t&&"focusVisible"]},ebe,s);return t&&r&&(o.root+=` ${r}`),o},rbe=So("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(n,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${tbe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),a6=Pe.forwardRef(function(e,t){const r=Sh({props:e,name:"MuiButtonBase"}),{action:s,centerRipple:i=!1,children:o,className:a,component:l="button",disabled:u=!1,disableRipple:f=!1,disableTouchRipple:h=!1,focusRipple:p=!1,focusVisibleClassName:g,LinkComponent:m="a",onBlur:w,onClick:x,onContextMenu:b,onDragLeave:C,onFocus:$,onFocusVisible:k,onKeyDown:N,onKeyUp:_,onMouseDown:U,onMouseLeave:O,onMouseUp:L,onTouchEnd:T,onTouchMove:I,onTouchStart:v,tabIndex:A=0,TouchRippleProps:M,touchRippleRef:D,type:B,...j}=r,W=Pe.useRef(null),P=F1e(),E=kE(P.ref,D),[R,H]=Pe.useState(!1);u&&R&&H(!1),Pe.useImperativeHandle(s,()=>({focusVisible:()=>{H(!0),W.current.focus()}}),[]);const K=P.shouldMount&&!f&&!u;Pe.useEffect(()=>{R&&p&&!f&&P.pulsate()},[f,p,R,P]);const Q=cl(P,"start",U,h),J=cl(P,"stop",b,h),ie=cl(P,"stop",C,h),ce=cl(P,"stop",L,h),ge=cl(P,"stop",Ue=>{R&&Ue.preventDefault(),O&&O(Ue)},h),be=cl(P,"start",v,h),Ae=cl(P,"stop",T,h),ne=cl(P,"stop",I,h),he=cl(P,"stop",Ue=>{W_(Ue.target)||H(!1),w&&w(Ue)},!1),Ie=Df(Ue=>{W.current||(W.current=Ue.currentTarget),W_(Ue.target)&&(H(!0),k&&k(Ue)),$&&$(Ue)}),ze=()=>{const Ue=W.current;return l&&l!=="button"&&!(Ue.tagName==="A"&&Ue.href)},Re=Df(Ue=>{p&&!Ue.repeat&&R&&Ue.key===" "&&P.stop(Ue,()=>{P.start(Ue)}),Ue.target===Ue.currentTarget&&ze()&&Ue.key===" "&&Ue.preventDefault(),N&&N(Ue),Ue.target===Ue.currentTarget&&ze()&&Ue.key==="Enter"&&!u&&(Ue.preventDefault(),x&&x(Ue))}),Ke=Df(Ue=>{p&&Ue.key===" "&&R&&!Ue.defaultPrevented&&P.stop(Ue,()=>{P.pulsate(Ue)}),_&&_(Ue),x&&Ue.target===Ue.currentTarget&&ze()&&Ue.key===" "&&!Ue.defaultPrevented&&x(Ue)});let tt=l;tt==="button"&&(j.href||j.to)&&(tt=m);const Xe={};tt==="button"?(Xe.type=B===void 0?"button":B,Xe.disabled=u):(!j.href&&!j.to&&(Xe.role="button"),u&&(Xe["aria-disabled"]=u));const ot=kE(t,W),et={...r,centerRipple:i,component:l,disabled:u,disableRipple:f,disableTouchRipple:h,focusRipple:p,tabIndex:A,focusVisible:R},mt=nbe(et);return Be.jsxs(rbe,{as:tt,className:nr(mt.root,a),ownerState:et,onBlur:he,onClick:x,onContextMenu:J,onFocus:Ie,onKeyDown:Re,onKeyUp:Ke,onMouseDown:Q,onMouseLeave:ge,onMouseUp:ce,onDragLeave:ie,onTouchEnd:Ae,onTouchMove:ne,onTouchStart:be,ref:ot,tabIndex:u?-1:A,type:B,...Xe,...j,children:[o,K?Be.jsx(Z1e,{ref:E,center:i,...M}):null]})});function cl(n,e,t,r=!1){return Df(s=>(t&&t(s),r||n[e](s),!0))}function sbe(n){return bh("MuiTabScrollButton",n)}const ibe=vh("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),obe=n=>{const{classes:e,orientation:t,disabled:r}=n;return ag({root:["root",t,r&&"disabled"]},sbe,e)},abe=So(a6,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:t}=n;return[e.root,t.orientation&&e[t.orientation]]}})({width:40,flexShrink:0,opacity:.8,[`&.${ibe.disabled}`]:{opacity:0},variants:[{props:{orientation:"vertical"},style:{width:"100%",height:40,"& svg":{transform:"var(--TabScrollButton-svgRotate)"}}}]}),lbe=Pe.forwardRef(function(e,t){const r=Sh({props:e,name:"MuiTabScrollButton"}),{className:s,slots:i={},slotProps:o={},direction:a,orientation:l,disabled:u,...f}=r,h=SV(),p={isRtl:h,...r},g=obe(p),m=i.StartScrollButtonIcon??_1e,w=i.EndScrollButtonIcon??P1e,x=P1({elementType:m,externalSlotProps:o.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:p}),b=P1({elementType:w,externalSlotProps:o.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:p});return Be.jsx(abe,{component:"div",className:nr(g.root,s),ref:t,role:null,ownerState:p,tabIndex:null,...f,style:{...f.style,...l==="vertical"&&{"--TabScrollButton-svgRotate":`rotate(${h?-90:90}deg)`}},children:a==="left"?Be.jsx(m,{...x}):Be.jsx(w,{...b})})});function ube(n){return bh("MuiTabs",n)}const Pk=vh("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),eP=(n,e)=>n===e?n.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n.firstChild,tP=(n,e)=>n===e?n.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n.lastChild,cx=(n,e,t)=>{let r=!1,s=t(n,e);for(;s;){if(s===n.firstChild){if(r)return;r=!0}const i=s.disabled||s.getAttribute("aria-disabled")==="true";if(!s.hasAttribute("tabindex")||i)s=t(n,s);else{s.focus();return}}},cbe=n=>{const{vertical:e,fixed:t,hideScrollbar:r,scrollableX:s,scrollableY:i,centered:o,scrollButtonsHideMobile:a,classes:l}=n;return ag({root:["root",e&&"vertical"],scroller:["scroller",t&&"fixed",r&&"hideScrollbar",s&&"scrollableX",i&&"scrollableY"],flexContainer:["flexContainer",e&&"flexContainerVertical",o&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",a&&"scrollButtonsHideMobile"],scrollableX:[s&&"scrollableX"],hideScrollbar:[r&&"hideScrollbar"]},ube,l)},fbe=So("div",{name:"MuiTabs",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:t}=n;return[{[`& .${Pk.scrollButtons}`]:e.scrollButtons},{[`& .${Pk.scrollButtons}`]:t.scrollButtonsHideMobile&&e.scrollButtonsHideMobile},e.root,t.vertical&&e.vertical]}})(rS(({theme:n})=>({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex",variants:[{props:({ownerState:e})=>e.vertical,style:{flexDirection:"column"}},{props:({ownerState:e})=>e.scrollButtonsHideMobile,style:{[`& .${Pk.scrollButtons}`]:{[n.breakpoints.down("sm")]:{display:"none"}}}}]}))),hbe=So("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(n,e)=>{const{ownerState:t}=n;return[e.scroller,t.fixed&&e.fixed,t.hideScrollbar&&e.hideScrollbar,t.scrollableX&&e.scrollableX,t.scrollableY&&e.scrollableY]}})({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap",variants:[{props:({ownerState:n})=>n.fixed,style:{overflowX:"hidden",width:"100%"}},{props:({ownerState:n})=>n.hideScrollbar,style:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}},{props:({ownerState:n})=>n.scrollableX,style:{overflowX:"auto",overflowY:"hidden"}},{props:({ownerState:n})=>n.scrollableY,style:{overflowY:"auto",overflowX:"hidden"}}]}),dbe=So("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(n,e)=>{const{ownerState:t}=n;return[e.flexContainer,t.vertical&&e.flexContainerVertical,t.centered&&e.centered]}})({display:"flex",variants:[{props:({ownerState:n})=>n.vertical,style:{flexDirection:"column"}},{props:({ownerState:n})=>n.centered,style:{justifyContent:"center"}}]}),pbe=So("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(n,e)=>e.indicator})(rS(({theme:n})=>({position:"absolute",height:2,bottom:0,width:"100%",transition:n.transitions.create(),variants:[{props:{indicatorColor:"primary"},style:{backgroundColor:(n.vars||n).palette.primary.main}},{props:{indicatorColor:"secondary"},style:{backgroundColor:(n.vars||n).palette.secondary.main}},{props:({ownerState:e})=>e.vertical,style:{height:"100%",width:2,right:0}}]}))),gbe=So(D1e)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),nP={},mbe=Pe.forwardRef(function(e,t){const r=Sh({props:e,name:"MuiTabs"}),s=i6(),i=SV(),{"aria-label":o,"aria-labelledby":a,action:l,centered:u=!1,children:f,className:h,component:p="div",allowScrollButtonsMobile:g=!1,indicatorColor:m="primary",onChange:w,orientation:x="horizontal",ScrollButtonComponent:b=lbe,scrollButtons:C="auto",selectionFollowsFocus:$,slots:k={},slotProps:N={},TabIndicatorProps:_={},TabScrollButtonProps:U={},textColor:O="primary",value:L,variant:T="standard",visibleScrollbar:I=!1,...v}=r,A=T==="scrollable",M=x==="vertical",D=M?"scrollTop":"scrollLeft",B=M?"top":"left",j=M?"bottom":"right",W=M?"clientHeight":"clientWidth",P=M?"height":"width",E={...r,component:p,allowScrollButtonsMobile:g,indicatorColor:m,orientation:x,vertical:M,scrollButtons:C,textColor:O,variant:T,visibleScrollbar:I,fixed:!A,hideScrollbar:A&&!I,scrollableX:A&&!M,scrollableY:A&&M,centered:u&&!A,scrollButtonsHideMobile:!g},R=cbe(E),H=P1({elementType:k.StartScrollButtonIcon,externalSlotProps:N.startScrollButtonIcon,ownerState:E}),K=P1({elementType:k.EndScrollButtonIcon,externalSlotProps:N.endScrollButtonIcon,ownerState:E}),[Q,J]=Pe.useState(!1),[ie,ce]=Pe.useState(nP),[ge,be]=Pe.useState(!1),[Ae,ne]=Pe.useState(!1),[he,Ie]=Pe.useState(!1),[ze,Re]=Pe.useState({overflow:"hidden",scrollbarWidth:0}),Ke=new Map,tt=Pe.useRef(null),Xe=Pe.useRef(null),ot=()=>{const He=tt.current;let Me;if(He){const at=He.getBoundingClientRect();Me={clientWidth:He.clientWidth,scrollLeft:He.scrollLeft,scrollTop:He.scrollTop,scrollWidth:He.scrollWidth,top:at.top,bottom:at.bottom,left:at.left,right:at.right}}let Ze;if(He&&L!==!1){const at=Xe.current.children;if(at.length>0){const bt=at[Ke.get(L)];Ze=bt?bt.getBoundingClientRect():null}}return{tabsMeta:Me,tabMeta:Ze}},et=Df(()=>{const{tabsMeta:He,tabMeta:Me}=ot();let Ze=0,at;M?(at="top",Me&&He&&(Ze=Me.top-He.top+He.scrollTop)):(at=i?"right":"left",Me&&He&&(Ze=(i?-1:1)*(Me[at]-He[at]+He.scrollLeft)));const bt={[at]:Ze,[P]:Me?Me[P]:0};if(typeof ie[at]!="number"||typeof ie[P]!="number")ce(bt);else{const _t=Math.abs(ie[at]-bt[at]),sr=Math.abs(ie[P]-bt[P]);(_t>=1||sr>=1)&&ce(bt)}}),mt=(He,{animation:Me=!0}={})=>{Me?T1e(D,tt.current,He,{duration:s.transitions.duration.standard}):tt.current[D]=He},Ue=He=>{let Me=tt.current[D];M?Me+=He:Me+=He*(i?-1:1),mt(Me)},Vt=()=>{const He=tt.current[W];let Me=0;const Ze=Array.from(Xe.current.children);for(let at=0;at<Ze.length;at+=1){const bt=Ze[at];if(Me+bt[W]>He){at===0&&(Me=He);break}Me+=bt[W]}return Me},At=()=>{Ue(-1*Vt())},St=()=>{Ue(Vt())},Dn=Pe.useCallback(He=>{Re({overflow:null,scrollbarWidth:He})},[]),q=()=>{const He={};He.scrollbarSizeListener=A?Be.jsx(gbe,{onChange:Dn,className:nr(R.scrollableX,R.hideScrollbar)}):null;const Ze=A&&(C==="auto"&&(ge||Ae)||C===!0);return He.scrollButtonStart=Ze?Be.jsx(b,{slots:{StartScrollButtonIcon:k.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:H},orientation:x,direction:i?"right":"left",onClick:At,disabled:!ge,...U,className:nr(R.scrollButtons,U.className)}):null,He.scrollButtonEnd=Ze?Be.jsx(b,{slots:{EndScrollButtonIcon:k.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:K},orientation:x,direction:i?"left":"right",onClick:St,disabled:!Ae,...U,className:nr(R.scrollButtons,U.className)}):null,He},z=Df(He=>{const{tabsMeta:Me,tabMeta:Ze}=ot();if(!(!Ze||!Me)){if(Ze[B]<Me[B]){const at=Me[D]+(Ze[B]-Me[B]);mt(at,{animation:He})}else if(Ze[j]>Me[j]){const at=Me[D]+(Ze[j]-Me[j]);mt(at,{animation:He})}}}),G=Df(()=>{A&&C!==!1&&Ie(!he)});Pe.useEffect(()=>{const He=qV(()=>{tt.current&&et()});let Me;const Ze=_t=>{_t.forEach(sr=>{sr.removedNodes.forEach(Wt=>{Me==null||Me.unobserve(Wt)}),sr.addedNodes.forEach(Wt=>{Me==null||Me.observe(Wt)})}),He(),G()},at=QV(tt.current);at.addEventListener("resize",He);let bt;return typeof ResizeObserver<"u"&&(Me=new ResizeObserver(He),Array.from(Xe.current.children).forEach(_t=>{Me.observe(_t)})),typeof MutationObserver<"u"&&(bt=new MutationObserver(Ze),bt.observe(Xe.current,{childList:!0})),()=>{He.clear(),at.removeEventListener("resize",He),bt==null||bt.disconnect(),Me==null||Me.disconnect()}},[et,G]),Pe.useEffect(()=>{const He=Array.from(Xe.current.children),Me=He.length;if(typeof IntersectionObserver<"u"&&Me>0&&A&&C!==!1){const Ze=He[0],at=He[Me-1],bt={root:tt.current,threshold:.99},_t=Ms=>{be(!Ms[0].isIntersecting)},sr=new IntersectionObserver(_t,bt);sr.observe(Ze);const Wt=Ms=>{ne(!Ms[0].isIntersecting)},Qt=new IntersectionObserver(Wt,bt);return Qt.observe(at),()=>{sr.disconnect(),Qt.disconnect()}}},[A,C,he,f==null?void 0:f.length]),Pe.useEffect(()=>{J(!0)},[]),Pe.useEffect(()=>{et()}),Pe.useEffect(()=>{z(nP!==ie)},[z,ie]),Pe.useImperativeHandle(l,()=>({updateIndicator:et,updateScrollButtons:G}),[et,G]);const Z=Be.jsx(pbe,{..._,className:nr(R.indicator,_.className),ownerState:E,style:{...ie,..._.style}});let ae=0;const ke=Pe.Children.map(f,He=>{if(!Pe.isValidElement(He))return null;const Me=He.props.value===void 0?ae:He.props.value;Ke.set(Me,ae);const Ze=Me===L;return ae+=1,Pe.cloneElement(He,{fullWidth:T==="fullWidth",indicator:Ze&&!Q&&Z,selected:Ze,selectionFollowsFocus:$,onChange:w,textColor:O,value:Me,...ae===1&&L===!1&&!He.props.tabIndex?{tabIndex:0}:{}})}),Ne=He=>{const Me=Xe.current,Ze=XV(Me).activeElement;if(Ze.getAttribute("role")!=="tab")return;let bt=x==="horizontal"?"ArrowLeft":"ArrowUp",_t=x==="horizontal"?"ArrowRight":"ArrowDown";switch(x==="horizontal"&&i&&(bt="ArrowRight",_t="ArrowLeft"),He.key){case bt:He.preventDefault(),cx(Me,Ze,tP);break;case _t:He.preventDefault(),cx(Me,Ze,eP);break;case"Home":He.preventDefault(),cx(Me,null,eP);break;case"End":He.preventDefault(),cx(Me,null,tP);break}},Ye=q();return Be.jsxs(fbe,{className:nr(R.root,h),ownerState:E,ref:t,as:p,...v,children:[Ye.scrollButtonStart,Ye.scrollbarSizeListener,Be.jsxs(hbe,{className:R.scroller,ownerState:E,style:{overflow:ze.overflow,[M?`margin${i?"Left":"Right"}`:"marginBottom"]:I?void 0:-ze.scrollbarWidth},ref:tt,children:[Be.jsx(dbe,{"aria-label":o,"aria-labelledby":a,"aria-orientation":x==="vertical"?"vertical":null,className:R.flexContainer,ownerState:E,onKeyDown:Ne,ref:Xe,role:"tablist",children:ke}),Q&&Z]}),Ye.scrollButtonEnd]})});function ybe(n){return bh("MuiTab",n)}const Ji=vh("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper","icon"]),wbe=n=>{const{classes:e,textColor:t,fullWidth:r,wrapped:s,icon:i,label:o,selected:a,disabled:l}=n,u={root:["root",i&&o&&"labelIcon",`textColor${nc(t)}`,r&&"fullWidth",s&&"wrapped",a&&"selected",l&&"disabled"],icon:["iconWrapper","icon"]};return ag(u,ybe,e)},xbe=So(a6,{name:"MuiTab",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:t}=n;return[e.root,t.label&&t.icon&&e.labelIcon,e[`textColor${nc(t.textColor)}`],t.fullWidth&&e.fullWidth,t.wrapped&&e.wrapped,{[`& .${Ji.iconWrapper}`]:e.iconWrapper},{[`& .${Ji.icon}`]:e.icon}]}})(rS(({theme:n})=>({...n.typography.button,maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center",lineHeight:1.25,variants:[{props:({ownerState:e})=>e.label&&(e.iconPosition==="top"||e.iconPosition==="bottom"),style:{flexDirection:"column"}},{props:({ownerState:e})=>e.label&&e.iconPosition!=="top"&&e.iconPosition!=="bottom",style:{flexDirection:"row"}},{props:({ownerState:e})=>e.icon&&e.label,style:{minHeight:72,paddingTop:9,paddingBottom:9}},{props:({ownerState:e,iconPosition:t})=>e.icon&&e.label&&t==="top",style:{[`& > .${Ji.icon}`]:{marginBottom:6}}},{props:({ownerState:e,iconPosition:t})=>e.icon&&e.label&&t==="bottom",style:{[`& > .${Ji.icon}`]:{marginTop:6}}},{props:({ownerState:e,iconPosition:t})=>e.icon&&e.label&&t==="start",style:{[`& > .${Ji.icon}`]:{marginRight:n.spacing(1)}}},{props:({ownerState:e,iconPosition:t})=>e.icon&&e.label&&t==="end",style:{[`& > .${Ji.icon}`]:{marginLeft:n.spacing(1)}}},{props:{textColor:"inherit"},style:{color:"inherit",opacity:.6,[`&.${Ji.selected}`]:{opacity:1},[`&.${Ji.disabled}`]:{opacity:(n.vars||n).palette.action.disabledOpacity}}},{props:{textColor:"primary"},style:{color:(n.vars||n).palette.text.secondary,[`&.${Ji.selected}`]:{color:(n.vars||n).palette.primary.main},[`&.${Ji.disabled}`]:{color:(n.vars||n).palette.text.disabled}}},{props:{textColor:"secondary"},style:{color:(n.vars||n).palette.text.secondary,[`&.${Ji.selected}`]:{color:(n.vars||n).palette.secondary.main},[`&.${Ji.disabled}`]:{color:(n.vars||n).palette.text.disabled}}},{props:({ownerState:e})=>e.fullWidth,style:{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"}},{props:({ownerState:e})=>e.wrapped,style:{fontSize:n.typography.pxToRem(12)}}]}))),Fk=Pe.forwardRef(function(e,t){const r=Sh({props:e,name:"MuiTab"}),{className:s,disabled:i=!1,disableFocusRipple:o=!1,fullWidth:a,icon:l,iconPosition:u="top",indicator:f,label:h,onChange:p,onClick:g,onFocus:m,selected:w,selectionFollowsFocus:x,textColor:b="inherit",value:C,wrapped:$=!1,...k}=r,N={...r,disabled:i,disableFocusRipple:o,selected:w,icon:!!l,iconPosition:u,label:!!h,fullWidth:a,textColor:b,wrapped:$},_=wbe(N),U=l&&h&&Pe.isValidElement(l)?Pe.cloneElement(l,{className:nr(_.icon,l.props.className)}):l,O=T=>{!w&&p&&p(T,C),g&&g(T)},L=T=>{x&&!w&&p&&p(T,C),m&&m(T)};return Be.jsxs(xbe,{focusRipple:!o,className:nr(_.root,s),ref:t,role:"tab","aria-selected":w,disabled:i,onClick:O,onFocus:L,ownerState:N,tabIndex:w?0:-1,...k,children:[u==="top"||u==="start"?Be.jsxs(Pe.Fragment,{children:[U,h]}):Be.jsxs(Pe.Fragment,{children:[h,U]}),f]})}),bbe=vh("MuiBox",["root"]),vbe=r6(),Jg=txe({themeId:CN,defaultTheme:vbe,defaultClassName:bbe.root,generateClassName:VV.generate}),fx=jxe({createStyledComponent:So("div",{name:"MuiGrid2",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:t}=n;return[e.root,t.container&&e.container]}}),componentName:"MuiGrid2",useThemeProps:n=>Sh({props:n,name:"MuiGrid2"}),useTheme:i6}),Sbe="6.13.5";function Cbe(n,e,t){const r=e.split("|").map(i=>i.trim());for(let i=0;i<r.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof n===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=n,s}async function Gs(n){const e=Object.keys(n);return(await Promise.all(e.map(r=>Promise.resolve(n[r])))).reduce((r,s,i)=>(r[e[i]]=s,r),{})}function Nt(n,e,t){for(let r in e){let s=e[r];const i=t?t[r]:null;i&&Cbe(s,i,r),Object.defineProperty(n,r,{enumerable:!0,value:s,writable:!1})}}function md(n){if(n==null)return"null";if(Array.isArray(n))return"[ "+n.map(md).join(", ")+" ]";if(n instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let r=0;r<n.length;r++)t+=e[n[r]>>4],t+=e[n[r]&15];return t}if(typeof n=="object"&&typeof n.toJSON=="function")return md(n.toJSON());switch(typeof n){case"boolean":case"symbol":return n.toString();case"bigint":return BigInt(n).toString();case"number":return n.toString();case"string":return JSON.stringify(n);case"object":{const e=Object.keys(n);return e.sort(),"{ "+e.map(t=>`${md(t)}: ${md(n[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function cs(n,e){return n&&n.code===e}function EN(n){return cs(n,"CALL_EXCEPTION")}function ur(n,e,t){let r=n;{const i=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${md(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];i.push(o+"="+md(a))}}i.push(`code=${e}`),i.push(`version=${Sbe}`),i.length&&(n+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(n);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(n);break;default:s=new Error(n)}return Nt(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&Nt(s,{shortMessage:r}),s}function je(n,e,t,r){if(!n)throw ur(e,t,r)}function we(n,e,t,r){je(n,e,"INVALID_ARGUMENT",{argument:t,value:r})}function l6(n,e,t){t==null&&(t=""),t&&(t=": "+t),je(n>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:n,expectedCount:e}),je(n<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:n,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((n,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");n.push(e)}catch{}return n},[]);function sS(n,e,t){if(t==null&&(t=""),n!==e){let r=t,s="new";t&&(r+=".",s+=" "+t),je(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function u6(n,e,t){if(n instanceof Uint8Array)return t?new Uint8Array(n):n;if(typeof n=="string"&&n.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((n.length-2)/2);let s=2;for(let i=0;i<r.length;i++)r[i]=parseInt(n.substring(s,s+2),16),s+=2;return r}we(!1,"invalid BytesLike value",e||"value",n)}function tn(n,e){return u6(n,e,!1)}function qs(n,e){return u6(n,e,!0)}function zn(n,e){return!(typeof n!="string"||!n.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&n.length!==2+2*e||e===!0&&n.length%2!==0)}function AN(n){return zn(n,!0)||n instanceof Uint8Array}const rP="0123456789abcdef";function ht(n){const e=tn(n);let t="0x";for(let r=0;r<e.length;r++){const s=e[r];t+=rP[(s&240)>>4]+rP[s&15]}return t}function kr(n){return"0x"+n.map(e=>ht(e).substring(2)).join("")}function $d(n){return zn(n,!0)?(n.length-2)/2:tn(n).length}function cr(n,e,t){const r=tn(n);return t!=null&&t>r.length&&je(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:t}),ht(r.slice(e??0,t??r.length))}function c6(n,e,t){const r=tn(n);je(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(r,e-r.length):s.set(r,0),ht(s)}function rh(n,e){return c6(n,e,!0)}function kbe(n,e){return c6(n,e,!1)}const iS=BigInt(0),Wo=BigInt(1),_E=9007199254740991;function Ibe(n,e){const t=oS(n,"value"),r=BigInt(jt(e,"width"));if(je(t>>r===iS,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:n}),t>>r-Wo){const s=(Wo<<r)-Wo;return-((~t&s)+Wo)}return t}function f6(n,e){let t=wt(n,"value");const r=BigInt(jt(e,"width")),s=Wo<<r-Wo;if(t<iS){t=-t,je(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});const i=(Wo<<r)-Wo;return(~t&i)+Wo}else je(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});return t}function gm(n,e){const t=oS(n,"value"),r=BigInt(jt(e,"bits"));return t&(Wo<<r)-Wo}function wt(n,e){switch(typeof n){case"bigint":return n;case"number":return we(Number.isInteger(n),"underflow",e||"value",n),we(n>=-9007199254740991&&n<=_E,"overflow",e||"value",n),BigInt(n);case"string":try{if(n==="")throw new Error("empty string");return n[0]==="-"&&n[1]!=="-"?-BigInt(n.substring(1)):BigInt(n)}catch(t){we(!1,`invalid BigNumberish string: ${t.message}`,e||"value",n)}}we(!1,"invalid BigNumberish value",e||"value",n)}function oS(n,e){const t=wt(n,e);return je(t>=iS,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:n}),t}const sP="0123456789abcdef";function TN(n){if(n instanceof Uint8Array){let e="0x0";for(const t of n)e+=sP[t>>4],e+=sP[t&15];return BigInt(e)}return wt(n)}function jt(n,e){switch(typeof n){case"bigint":return we(n>=-9007199254740991&&n<=_E,"overflow",e||"value",n),Number(n);case"number":return we(Number.isInteger(n),"underflow",e||"value",n),we(n>=-9007199254740991&&n<=_E,"overflow",e||"value",n),n;case"string":try{if(n==="")throw new Error("empty string");return jt(BigInt(n),e)}catch(t){we(!1,`invalid numeric string: ${t.message}`,e||"value",n)}}we(!1,"invalid numeric value",e||"value",n)}function Ebe(n){return jt(TN(n))}function sc(n,e){let r=oS(n,"value").toString(16);if(e==null)r.length%2&&(r="0"+r);else{const s=jt(e,"width");for(je(s*2>=r.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:n});r.length<s*2;)r="0"+r}return"0x"+r}function Xs(n){const e=oS(n,"value");if(e===iS)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const r=new Uint8Array(t.length/2);for(let s=0;s<r.length;s++){const i=s*2;r[s]=parseInt(t.substring(i,i+2),16)}return r}function yd(n){let e=ht(AN(n)?n:Xs(n)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const iP="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const oP=BigInt(58);function Abe(n){const e=tn(n);let t=TN(e),r="";for(;t;)r=iP[Number(t%oP)]+r,t/=oP;for(let s=0;s<e.length&&!e[s];s++)r=iP[0]+r;return r}function Tbe(n){n=atob(n);const e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return tn(e)}function Nbe(n){const e=tn(n);let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}var _d;class h6{constructor(e,t,r){Se(this,"filter");Se(this,"emitter");_e(this,_d);se(this,_d,t),Nt(this,{emitter:e,filter:r})}async removeListener(){Y(this,_d)!=null&&await this.emitter.off(this.filter,Y(this,_d))}}_d=new WeakMap;function $be(n,e,t,r,s){we(!1,`invalid codepoint at offset ${e}; ${n}`,"bytes",t)}function d6(n,e,t,r,s){if(n==="BAD_PREFIX"||n==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)i++;return i}return n==="OVERRUN"?t.length-e-1:0}function Rbe(n,e,t,r,s){return n==="OVERLONG"?(we(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),r.push(s),0):(r.push(65533),d6(n,e,t))}const Obe=Object.freeze({error:$be,ignore:d6,replace:Rbe});function Dbe(n,e){e==null&&(e=Obe.error);const t=tn(n,"bytes"),r=[];let s=0;for(;s<t.length;){const i=t[s++];if(!(i>>7)){r.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,r):s+=e("BAD_PREFIX",s-1,t,r);continue}if(s-1+o>=t.length){s+=e("OVERRUN",s-1,t,r);continue}let l=i&(1<<8-o-1)-1;for(let u=0;u<o;u++){let f=t[s];if((f&192)!=128){s+=e("MISSING_CONTINUE",s,t,r),l=null;break}l=l<<6|f&63,s++}if(l!==null){if(l>1114111){s+=e("OUT_OF_RANGE",s-1-o,t,r,l);continue}if(l>=55296&&l<=57343){s+=e("UTF16_SURROGATE",s-1-o,t,r,l);continue}if(l<=a){s+=e("OVERLONG",s-1-o,t,r,l);continue}r.push(l)}}return r}function Dl(n,e){we(typeof n=="string","invalid string value","str",n);let t=[];for(let r=0;r<n.length;r++){const s=n.charCodeAt(r);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){r++;const i=n.charCodeAt(r);we(r<n.length&&(i&64512)===56320,"invalid surrogate pair","str",n);const o=65536+((s&1023)<<10)+(i&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function _be(n){return n.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function V1(n,e){return _be(Dbe(n,e))}function p6(n){async function e(t,r){je(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();je(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),je(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=ur("request timeout","TIMEOUT"),o.abort()},t.timeout);r&&r.addListener(()=>{i=ur("request cancelled","CANCELLED"),o.abort()});const l={method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal};let u;try{u=await fetch(t.url,l)}catch(g){throw clearTimeout(a),i||g}clearTimeout(a);const f={};u.headers.forEach((g,m)=>{f[m.toLowerCase()]=g});const h=await u.arrayBuffer(),p=h==null?null:new Uint8Array(h);return{statusCode:u.status,statusMessage:u.statusText,headers:f,body:p}}return e}const Pbe=12,Fbe=250;let aP=p6();const Mbe=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Lbe=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Mk=!1;async function g6(n,e){try{const t=n.match(Mbe);if(!t)throw new Error("invalid data");return new Xu(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?Tbe(t[3]):zbe(t[3]))}catch{return new Xu(599,"BAD REQUEST (invalid data: URI)",{},null,new zl(n))}}function m6(n){async function e(t,r){try{const s=t.match(Lbe);if(!s)throw new Error("invalid link");return new zl(`${n}${s[2]}`)}catch{return new Xu(599,"BAD REQUEST (invalid IPFS URI)",{},null,new zl(t))}}return e}const hx={data:g6,ipfs:m6("https://gateway.ipfs.io/ipfs/")},y6=new WeakMap;var uf,Iu;class Bbe{constructor(e){_e(this,uf);_e(this,Iu);se(this,uf,[]),se(this,Iu,!1),y6.set(e,()=>{if(!Y(this,Iu)){se(this,Iu,!0);for(const t of Y(this,uf))setTimeout(()=>{t()},0);se(this,uf,[])}})}addListener(e){je(!Y(this,Iu),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),Y(this,uf).push(e)}get cancelled(){return Y(this,Iu)}checkSignal(){je(!this.cancelled,"cancelled","CANCELLED",{})}}uf=new WeakMap,Iu=new WeakMap;function dx(n){if(n==null)throw new Error("missing signal; should not happen");return n.checkSignal(),n}var Pd,Fd,Mo,yl,Md,Ld,Xr,Ri,wl,cf,ff,hf,wa,Lo,Eu,df,mm;const sb=class sb{constructor(e){_e(this,df);_e(this,Pd);_e(this,Fd);_e(this,Mo);_e(this,yl);_e(this,Md);_e(this,Ld);_e(this,Xr);_e(this,Ri);_e(this,wl);_e(this,cf);_e(this,ff);_e(this,hf);_e(this,wa);_e(this,Lo);_e(this,Eu);se(this,Ld,String(e)),se(this,Pd,!1),se(this,Fd,!0),se(this,Mo,{}),se(this,yl,""),se(this,Md,3e5),se(this,Lo,{slotInterval:Fbe,maxAttempts:Pbe}),se(this,Eu,null)}get url(){return Y(this,Ld)}set url(e){se(this,Ld,String(e))}get body(){return Y(this,Xr)==null?null:new Uint8Array(Y(this,Xr))}set body(e){if(e==null)se(this,Xr,void 0),se(this,Ri,void 0);else if(typeof e=="string")se(this,Xr,Dl(e)),se(this,Ri,"text/plain");else if(e instanceof Uint8Array)se(this,Xr,e),se(this,Ri,"application/octet-stream");else if(typeof e=="object")se(this,Xr,Dl(JSON.stringify(e))),se(this,Ri,"application/json");else throw new Error("invalid body")}hasBody(){return Y(this,Xr)!=null}get method(){return Y(this,yl)?Y(this,yl):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),se(this,yl,String(e).toUpperCase())}get headers(){const e=Object.assign({},Y(this,Mo));return Y(this,wl)&&(e.authorization=`Basic ${Nbe(Dl(Y(this,wl)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&Y(this,Ri)&&(e["content-type"]=Y(this,Ri)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){Y(this,Mo)[String(e).toLowerCase()]=String(t)}clearHeaders(){se(this,Mo,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const s=t[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return Y(this,wl)||null}setCredentials(e,t){we(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),se(this,wl,`${e}:${t}`)}get allowGzip(){return Y(this,Fd)}set allowGzip(e){se(this,Fd,!!e)}get allowInsecureAuthentication(){return!!Y(this,Pd)}set allowInsecureAuthentication(e){se(this,Pd,!!e)}get timeout(){return Y(this,Md)}set timeout(e){we(e>=0,"timeout must be non-zero","timeout",e),se(this,Md,e)}get preflightFunc(){return Y(this,cf)||null}set preflightFunc(e){se(this,cf,e)}get processFunc(){return Y(this,ff)||null}set processFunc(e){se(this,ff,e)}get retryFunc(){return Y(this,hf)||null}set retryFunc(e){se(this,hf,e)}get getUrlFunc(){return Y(this,Eu)||aP}set getUrlFunc(e){se(this,Eu,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${Y(this,Xr)?ht(Y(this,Xr)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(Y(this,Lo).slotInterval=e.slotInterval),e.maxAttempts!=null&&(Y(this,Lo).maxAttempts=e.maxAttempts)}send(){return je(Y(this,wa)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),se(this,wa,new Bbe(this)),rt(this,df,mm).call(this,0,lP()+this.timeout,0,this,new Xu(0,"",{},null,this))}cancel(){je(Y(this,wa)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=y6.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();je(this.method==="GET"&&(t!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new sb(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,se(s,Mo,Object.assign({},Y(this,Mo))),Y(this,Xr)&&se(s,Xr,new Uint8Array(Y(this,Xr))),se(s,Ri,Y(this,Ri)),s}clone(){const e=new sb(this.url);return se(e,yl,Y(this,yl)),Y(this,Xr)&&se(e,Xr,Y(this,Xr)),se(e,Ri,Y(this,Ri)),se(e,Mo,Object.assign({},Y(this,Mo))),se(e,wl,Y(this,wl)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),se(e,cf,Y(this,cf)),se(e,ff,Y(this,ff)),se(e,hf,Y(this,hf)),se(e,Lo,Object.assign({},Y(this,Lo))),se(e,Eu,Y(this,Eu)),e}static lockConfig(){Mk=!0}static getGateway(e){return hx[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(Mk)throw new Error("gateways locked");hx[e]=t}static registerGetUrl(e){if(Mk)throw new Error("gateways locked");aP=e}static createGetUrlFunc(e){return p6()}static createDataGateway(){return g6}static createIpfsGatewayFunc(e){return m6(e)}};Pd=new WeakMap,Fd=new WeakMap,Mo=new WeakMap,yl=new WeakMap,Md=new WeakMap,Ld=new WeakMap,Xr=new WeakMap,Ri=new WeakMap,wl=new WeakMap,cf=new WeakMap,ff=new WeakMap,hf=new WeakMap,wa=new WeakMap,Lo=new WeakMap,Eu=new WeakMap,df=new WeakSet,mm=async function(e,t,r,s,i){var f,h,p;if(e>=Y(this,Lo).maxAttempts)return i.makeServerError("exceeded maximum retry limit");je(lP()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),r>0&&await Ube(r);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in hx){const g=await hx[a](o.url,dx(Y(s,wa)));if(g instanceof Xu){let m=g;if(this.processFunc){dx(Y(s,wa));try{m=await this.processFunc(o,m)}catch(w){(w.throttle==null||typeof w.stall!="number")&&m.makeServerError("error in post-processing function",w).assertOk()}}return m}o=g}this.preflightFunc&&(o=await this.preflightFunc(o));const l=await this.getUrlFunc(o,dx(Y(s,wa)));let u=new Xu(l.statusCode,l.statusMessage,l.headers,l.body,s);if(u.statusCode===301||u.statusCode===302){try{const g=u.headers.location||"";return rt(f=o.redirect(g),df,mm).call(f,e+1,t,0,s,u)}catch{}return u}else if(u.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,u,e))){const g=u.headers["retry-after"];let m=Y(this,Lo).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof g=="string"&&g.match(/^[1-9][0-9]*$/)&&(m=parseInt(g)),rt(h=o.clone(),df,mm).call(h,e+1,t,m,s,u)}if(this.processFunc){dx(Y(s,wa));try{u=await this.processFunc(o,u)}catch(g){(g.throttle==null||typeof g.stall!="number")&&u.makeServerError("error in post-processing function",g).assertOk();let m=Y(this,Lo).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return g.stall>=0&&(m=g.stall),rt(p=o.clone(),df,mm).call(p,e+1,t,m,s,u)}}return u};let zl=sb;var s0,i0,o0,Oi,Bd,pf;const o$=class o${constructor(e,t,r,s,i){_e(this,s0);_e(this,i0);_e(this,o0);_e(this,Oi);_e(this,Bd);_e(this,pf);se(this,s0,e),se(this,i0,t),se(this,o0,Object.keys(r).reduce((o,a)=>(o[a.toLowerCase()]=String(r[a]),o),{})),se(this,Oi,s==null?null:new Uint8Array(s)),se(this,Bd,i||null),se(this,pf,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${Y(this,Oi)?ht(Y(this,Oi)):"null"}>`}get statusCode(){return Y(this,s0)}get statusMessage(){return Y(this,i0)}get headers(){return Object.assign({},Y(this,o0))}get body(){return Y(this,Oi)==null?null:new Uint8Array(Y(this,Oi))}get bodyText(){try{return Y(this,Oi)==null?"":V1(Y(this,Oi))}catch{je(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{je(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const s=t[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new o$(599,r,this.headers,this.body,Y(this,Bd)||void 0);return se(s,pf,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:we(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const r=new Error(e||"throttling requests");throw Nt(r,{stall:t,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return Y(this,Oi)!=null}get request(){return Y(this,Bd)}ok(){return Y(this,pf).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=Y(this,pf);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let s=null;try{Y(this,Oi)&&(s=V1(Y(this,Oi)))}catch{}je(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:r,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};s0=new WeakMap,i0=new WeakMap,o0=new WeakMap,Oi=new WeakMap,Bd=new WeakMap,pf=new WeakMap;let Xu=o$;function lP(){return new Date().getTime()}function zbe(n){return Dl(n.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function Ube(n){return new Promise(e=>setTimeout(e,n))}function Vbe(n){let e=n.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function uP(n,e,t){let r=0;for(let s=0;s<t;s++)r=r*256+n[e+s];return r}function cP(n,e,t,r){const s=[];for(;t<e+1+r;){const i=w6(n,t);s.push(i.result),t+=i.consumed,je(t<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:n,length:r,offset:e})}return{consumed:1+r,result:s}}function w6(n,e){je(n.length!==0,"data too short","BUFFER_OVERRUN",{buffer:n,length:0,offset:1});const t=r=>{je(r<=n.length,"data short segment too short","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:r})};if(n[e]>=248){const r=n[e]-247;t(e+1+r);const s=uP(n,e+1,r);return t(e+1+r+s),cP(n,e,e+1+r,r+s)}else if(n[e]>=192){const r=n[e]-192;return t(e+1+r),cP(n,e,e+1,r)}else if(n[e]>=184){const r=n[e]-183;t(e+1+r);const s=uP(n,e+1,r);t(e+1+r+s);const i=ht(n.slice(e+1+r,e+1+r+s));return{consumed:1+r+s,result:i}}else if(n[e]>=128){const r=n[e]-128;t(e+1+r);const s=ht(n.slice(e+1,e+1+r));return{consumed:1+r,result:s}}return{consumed:1,result:Vbe(n[e])}}function aS(n){const e=tn(n,"data"),t=w6(e,0);return we(t.consumed===e.length,"unexpected junk after rlp payload","data",n),t.result}function fP(n){const e=[];for(;n;)e.unshift(n&255),n>>=8;return e}function x6(n){if(Array.isArray(n)){let r=[];if(n.forEach(function(i){r=r.concat(x6(i))}),r.length<=55)return r.unshift(192+r.length),r;const s=fP(r.length);return s.unshift(247+s.length),s.concat(r)}const e=Array.prototype.slice.call(tn(n,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=fP(e.length);return t.unshift(183+t.length),t.concat(e)}const hP="0123456789abcdef";function sh(n){let e="0x";for(const t of x6(n))e+=hP[t>>4],e+=hP[t&15];return e}const Qs=32,PE=new Uint8Array(Qs),Wbe=["then"],px={},b6=new WeakMap;function Yc(n){return b6.get(n)}function dP(n,e){b6.set(n,e)}function Zg(n,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${n}`);throw t.error=e,t}function FE(n,e,t){return n.indexOf(null)>=0?e.map((r,s)=>r instanceof Op?FE(Yc(r),r,t):r):n.reduce((r,s,i)=>{let o=e.getValue(s);return s in r||(t&&o instanceof Op&&(o=FE(Yc(o),o,t)),r[s]=o),r},{})}var zd;const xd=class xd extends Array{constructor(...t){const r=t[0];let s=t[1],i=(t[2]||[]).slice(),o=!0;r!==px&&(s=t,i=[],o=!1);super(s.length);_e(this,zd);s.forEach((u,f)=>{this[f]=u});const a=i.reduce((u,f)=>(typeof f=="string"&&u.set(f,(u.get(f)||0)+1),u),new Map);if(dP(this,Object.freeze(s.map((u,f)=>{const h=i[f];return h!=null&&a.get(h)===1?h:null}))),se(this,zd,[]),Y(this,zd)==null&&Y(this,zd),!o)return;Object.freeze(this);const l=new Proxy(this,{get:(u,f,h)=>{if(typeof f=="string"){if(f.match(/^[0-9]+$/)){const g=jt(f,"%index");if(g<0||g>=this.length)throw new RangeError("out of result range");const m=u[g];return m instanceof Error&&Zg(`index ${g}`,m),m}if(Wbe.indexOf(f)>=0)return Reflect.get(u,f,h);const p=u[f];if(p instanceof Function)return function(...g){return p.apply(this===h?u:this,g)};if(!(f in u))return u.getValue.apply(this===h?u:this,[f])}return Reflect.get(u,f,h)}});return dP(l,Yc(this)),l}toArray(t){const r=[];return this.forEach((s,i)=>{s instanceof Error&&Zg(`index ${i}`,s),t&&s instanceof xd&&(s=s.toArray(t)),r.push(s)}),r}toObject(t){const r=Yc(this);return r.reduce((s,i,o)=>(je(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),FE(r,this,t)),{})}slice(t,r){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),r==null&&(r=this.length),r<0&&(r+=this.length,r<0&&(r=0)),r>this.length&&(r=this.length);const s=Yc(this),i=[],o=[];for(let a=t;a<r;a++)i.push(this[a]),o.push(s[a]);return new xd(px,i,o)}filter(t,r){const s=Yc(this),i=[],o=[];for(let a=0;a<this.length;a++){const l=this[a];l instanceof Error&&Zg(`index ${a}`,l),t.call(r,l,a,this)&&(i.push(l),o.push(s[a]))}return new xd(px,i,o)}map(t,r){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&Zg(`index ${i}`,o),s.push(t.call(r,o,i,this))}return s}getValue(t){const r=Yc(this).indexOf(t);if(r===-1)return;const s=this[r];return s instanceof Error&&Zg(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,r){return new xd(px,t,r)}};zd=new WeakMap;let Op=xd;function pP(n){let e=Xs(n);return je(e.length<=Qs,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Qs,offset:e.length}),e.length!==Qs&&(e=qs(kr([PE.slice(e.length%Qs),e]))),e}class jl{constructor(e,t,r,s){Se(this,"name");Se(this,"type");Se(this,"localName");Se(this,"dynamic");Nt(this,{name:e,type:t,localName:r,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){we(!1,e,this.localName,t)}}var xl,gf,Ud,Vx;class ME{constructor(){_e(this,Ud);_e(this,xl);_e(this,gf);se(this,xl,[]),se(this,gf,0)}get data(){return kr(Y(this,xl))}get length(){return Y(this,gf)}appendWriter(e){return rt(this,Ud,Vx).call(this,qs(e.data))}writeBytes(e){let t=qs(e);const r=t.length%Qs;return r&&(t=qs(kr([t,PE.slice(r)]))),rt(this,Ud,Vx).call(this,t)}writeValue(e){return rt(this,Ud,Vx).call(this,pP(e))}writeUpdatableValue(){const e=Y(this,xl).length;return Y(this,xl).push(PE),se(this,gf,Y(this,gf)+Qs),t=>{Y(this,xl)[e]=pP(t)}}}xl=new WeakMap,gf=new WeakMap,Ud=new WeakSet,Vx=function(e){return Y(this,xl).push(e),se(this,gf,Y(this,gf)+e.length),e.length};var hi,Di,mf,yf,Au,uh,BE,v6;const a$=class a${constructor(e,t,r){_e(this,uh);Se(this,"allowLoose");_e(this,hi);_e(this,Di);_e(this,mf);_e(this,yf);_e(this,Au);Nt(this,{allowLoose:!!t}),se(this,hi,qs(e)),se(this,mf,0),se(this,yf,null),se(this,Au,r??1024),se(this,Di,0)}get data(){return ht(Y(this,hi))}get dataLength(){return Y(this,hi).length}get consumed(){return Y(this,Di)}get bytes(){return new Uint8Array(Y(this,hi))}subReader(e){const t=new a$(Y(this,hi).slice(Y(this,Di)+e),this.allowLoose,Y(this,Au));return se(t,yf,this),t}readBytes(e,t){let r=rt(this,uh,v6).call(this,0,e,!!t);return rt(this,uh,BE).call(this,e),se(this,Di,Y(this,Di)+r.length),r.slice(0,e)}readValue(){return TN(this.readBytes(Qs))}readIndex(){return Ebe(this.readBytes(Qs))}};hi=new WeakMap,Di=new WeakMap,mf=new WeakMap,yf=new WeakMap,Au=new WeakMap,uh=new WeakSet,BE=function(e){var t;if(Y(this,yf))return rt(t=Y(this,yf),uh,BE).call(t,e);se(this,mf,Y(this,mf)+e),je(Y(this,Au)<1||Y(this,mf)<=Y(this,Au)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${Y(this,Au)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:qs(Y(this,hi)),offset:Y(this,Di),length:e,info:{bytesRead:Y(this,mf),dataLength:this.dataLength}})},v6=function(e,t,r){let s=Math.ceil(t/Qs)*Qs;return Y(this,Di)+s>Y(this,hi).length&&(this.allowLoose&&r&&Y(this,Di)+t<=Y(this,hi).length?s=t:je(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:qs(Y(this,hi)),length:Y(this,hi).length,offset:Y(this,Di)+s})),Y(this,hi).slice(Y(this,Di),Y(this,Di)+s)};let LE=a$;function W1(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function NN(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function Gbe(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");W1(n.outputLen),W1(n.blockLen)}function Dp(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function S6(n,e){NN(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Lk=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const C6=n=>n instanceof Uint8Array,Hbe=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),Bk=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),ga=(n,e)=>n<<32-e|n>>>e,jbe=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!jbe)throw new Error("Non little-endian hardware is not supported");function Kbe(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function lS(n){if(typeof n=="string"&&(n=Kbe(n)),!C6(n))throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function qbe(...n){const e=new Uint8Array(n.reduce((r,s)=>r+s.length,0));let t=0;return n.forEach(r=>{if(!C6(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}class $N{clone(){return this._cloneInto()}}function RN(n){const e=r=>n().update(lS(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Xbe(n=32){if(Lk&&typeof Lk.getRandomValues=="function")return Lk.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}class k6 extends $N{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Gbe(e);const r=lS(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Dp(this),this.iHash.update(e),this}digestInto(e){Dp(this),NN(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const I6=(n,e,t)=>new k6(n,e).update(t).digest();I6.create=(n,e)=>new k6(n,e);function Qbe(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),l=r?4:0,u=r?0:4;n.setUint32(e+l,o,r),n.setUint32(e+u,a,r)}class E6 extends $N{constructor(e,t,r,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Bk(this.buffer)}update(e){Dp(this);const{view:t,buffer:r,blockLen:s}=this;e=lS(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const l=Bk(e);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Dp(this),S6(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)t[h]=0;Qbe(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Bk(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=l/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,f[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(r),e}}const Ybe=(n,e,t)=>n&e^~n&t,Jbe=(n,e,t)=>n&e^n&t^e&t,Zbe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),mu=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),yu=new Uint32Array(64);class eve extends E6{constructor(){super(64,32,8,!1),this.A=mu[0]|0,this.B=mu[1]|0,this.C=mu[2]|0,this.D=mu[3]|0,this.E=mu[4]|0,this.F=mu[5]|0,this.G=mu[6]|0,this.H=mu[7]|0}get(){const{A:e,B:t,C:r,D:s,E:i,F:o,G:a,H:l}=this;return[e,t,r,s,i,o,a,l]}set(e,t,r,s,i,o,a,l){this.A=e|0,this.B=t|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=l|0}process(e,t){for(let h=0;h<16;h++,t+=4)yu[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const p=yu[h-15],g=yu[h-2],m=ga(p,7)^ga(p,18)^p>>>3,w=ga(g,17)^ga(g,19)^g>>>10;yu[h]=w+yu[h-7]+m+yu[h-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:l,G:u,H:f}=this;for(let h=0;h<64;h++){const p=ga(a,6)^ga(a,11)^ga(a,25),g=f+p+Ybe(a,l,u)+Zbe[h]+yu[h]|0,w=(ga(r,2)^ga(r,13)^ga(r,22))+Jbe(r,s,i)|0;f=u,u=l,l=a,a=o+g|0,o=i,i=s,s=r,r=g+w|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,l=l+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(r,s,i,o,a,l,u,f)}roundClean(){yu.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const A6=RN(()=>new eve),gx=BigInt(2**32-1),zE=BigInt(32);function T6(n,e=!1){return e?{h:Number(n&gx),l:Number(n>>zE&gx)}:{h:Number(n>>zE&gx)|0,l:Number(n&gx)|0}}function N6(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let s=0;s<n.length;s++){const{h:i,l:o}=T6(n[s],e);[t[s],r[s]]=[i,o]}return[t,r]}const tve=(n,e)=>BigInt(n>>>0)<<zE|BigInt(e>>>0),nve=(n,e,t)=>n>>>t,rve=(n,e,t)=>n<<32-t|e>>>t,sve=(n,e,t)=>n>>>t|e<<32-t,ive=(n,e,t)=>n<<32-t|e>>>t,ove=(n,e,t)=>n<<64-t|e>>>t-32,ave=(n,e,t)=>n>>>t-32|e<<64-t,lve=(n,e)=>e,uve=(n,e)=>n,$6=(n,e,t)=>n<<t|e>>>32-t,R6=(n,e,t)=>e<<t|n>>>32-t,O6=(n,e,t)=>e<<t-32|n>>>64-t,D6=(n,e,t)=>n<<t-32|e>>>64-t;function cve(n,e,t,r){const s=(e>>>0)+(r>>>0);return{h:n+t+(s/2**32|0)|0,l:s|0}}const fve=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),hve=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,dve=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),pve=(n,e,t,r,s)=>e+t+r+s+(n/2**32|0)|0,gve=(n,e,t,r,s)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(s>>>0),mve=(n,e,t,r,s,i)=>e+t+r+s+i+(n/2**32|0)|0,Mt={fromBig:T6,split:N6,toBig:tve,shrSH:nve,shrSL:rve,rotrSH:sve,rotrSL:ive,rotrBH:ove,rotrBL:ave,rotr32H:lve,rotr32L:uve,rotlSH:$6,rotlSL:R6,rotlBH:O6,rotlBL:D6,add:cve,add3L:fve,add3H:hve,add4L:dve,add4H:pve,add5H:mve,add5L:gve},[yve,wve]=Mt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),wu=new Uint32Array(80),xu=new Uint32Array(80);class xve extends E6{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:l,Eh:u,El:f,Fh:h,Fl:p,Gh:g,Gl:m,Hh:w,Hl:x}=this;return[e,t,r,s,i,o,a,l,u,f,h,p,g,m,w,x]}set(e,t,r,s,i,o,a,l,u,f,h,p,g,m,w,x){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=l|0,this.Eh=u|0,this.El=f|0,this.Fh=h|0,this.Fl=p|0,this.Gh=g|0,this.Gl=m|0,this.Hh=w|0,this.Hl=x|0}process(e,t){for(let $=0;$<16;$++,t+=4)wu[$]=e.getUint32(t),xu[$]=e.getUint32(t+=4);for(let $=16;$<80;$++){const k=wu[$-15]|0,N=xu[$-15]|0,_=Mt.rotrSH(k,N,1)^Mt.rotrSH(k,N,8)^Mt.shrSH(k,N,7),U=Mt.rotrSL(k,N,1)^Mt.rotrSL(k,N,8)^Mt.shrSL(k,N,7),O=wu[$-2]|0,L=xu[$-2]|0,T=Mt.rotrSH(O,L,19)^Mt.rotrBH(O,L,61)^Mt.shrSH(O,L,6),I=Mt.rotrSL(O,L,19)^Mt.rotrBL(O,L,61)^Mt.shrSL(O,L,6),v=Mt.add4L(U,I,xu[$-7],xu[$-16]),A=Mt.add4H(v,_,T,wu[$-7],wu[$-16]);wu[$]=A|0,xu[$]=v|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:l,Dh:u,Dl:f,Eh:h,El:p,Fh:g,Fl:m,Gh:w,Gl:x,Hh:b,Hl:C}=this;for(let $=0;$<80;$++){const k=Mt.rotrSH(h,p,14)^Mt.rotrSH(h,p,18)^Mt.rotrBH(h,p,41),N=Mt.rotrSL(h,p,14)^Mt.rotrSL(h,p,18)^Mt.rotrBL(h,p,41),_=h&g^~h&w,U=p&m^~p&x,O=Mt.add5L(C,N,U,wve[$],xu[$]),L=Mt.add5H(O,b,k,_,yve[$],wu[$]),T=O|0,I=Mt.rotrSH(r,s,28)^Mt.rotrBH(r,s,34)^Mt.rotrBH(r,s,39),v=Mt.rotrSL(r,s,28)^Mt.rotrBL(r,s,34)^Mt.rotrBL(r,s,39),A=r&i^r&a^i&a,M=s&o^s&l^o&l;b=w|0,C=x|0,w=g|0,x=m|0,g=h|0,m=p|0,{h,l:p}=Mt.add(u|0,f|0,L|0,T|0),u=a|0,f=l|0,a=i|0,l=o|0,i=r|0,o=s|0;const D=Mt.add3L(T,v,M);r=Mt.add3H(D,L,I,A),s=D|0}({h:r,l:s}=Mt.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Mt.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l}=Mt.add(this.Ch|0,this.Cl|0,a|0,l|0),{h:u,l:f}=Mt.add(this.Dh|0,this.Dl|0,u|0,f|0),{h,l:p}=Mt.add(this.Eh|0,this.El|0,h|0,p|0),{h:g,l:m}=Mt.add(this.Fh|0,this.Fl|0,g|0,m|0),{h:w,l:x}=Mt.add(this.Gh|0,this.Gl|0,w|0,x|0),{h:b,l:C}=Mt.add(this.Hh|0,this.Hl|0,b|0,C|0),this.set(r,s,i,o,a,l,u,f,h,p,g,m,w,x,b,C)}roundClean(){wu.fill(0),xu.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const bve=RN(()=>new xve);function vve(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const gP=vve();gP.crypto||gP.msCrypto;function Sve(n){switch(n){case"sha256":return A6.create();case"sha512":return bve.create()}we(!1,"invalid hashing algorithm name","algorithm",n)}const[_6,P6,F6]=[[],[],[]],Cve=BigInt(0),em=BigInt(1),kve=BigInt(2),Ive=BigInt(7),Eve=BigInt(256),Ave=BigInt(113);for(let n=0,e=em,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],_6.push(2*(5*r+t)),P6.push((n+1)*(n+2)/2%64);let s=Cve;for(let i=0;i<7;i++)e=(e<<em^(e>>Ive)*Ave)%Eve,e&kve&&(s^=em<<(em<<BigInt(i))-em);F6.push(s)}const[Tve,Nve]=N6(F6,!0),mP=(n,e,t)=>t>32?O6(n,e,t):$6(n,e,t),yP=(n,e,t)=>t>32?D6(n,e,t):R6(n,e,t);function $ve(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,l=(o+2)%10,u=t[l],f=t[l+1],h=mP(u,f,1)^t[a],p=yP(u,f,1)^t[a+1];for(let g=0;g<50;g+=10)n[o+g]^=h,n[o+g+1]^=p}let s=n[2],i=n[3];for(let o=0;o<24;o++){const a=P6[o],l=mP(s,i,a),u=yP(s,i,a),f=_6[o];s=n[f],i=n[f+1],n[f]=l,n[f+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=Tve[r],n[1]^=Nve[r]}t.fill(0)}class ON extends $N{constructor(e,t,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,W1(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Hbe(this.state)}keccak(){$ve(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Dp(this);const{blockLen:t,state:r}=this;e=lS(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:s}=this;e[r]^=t,t&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Dp(this,!1),NN(e),this.finish();const t=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return W1(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(S6(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new ON(t,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Rve=(n,e,t)=>RN(()=>new ON(e,n,t)),Ove=Rve(1,136,256/8);let M6=!1;const L6=function(n){return Ove(n)};let B6=L6;function Rr(n){const e=tn(n,"data");return ht(B6(e))}Rr._=L6;Rr.lock=function(){M6=!0};Rr.register=function(n){if(M6)throw new TypeError("keccak256 is locked");B6=n};Object.freeze(Rr);const z6=function(n){return Sve("sha256").update(n).digest()};let U6=z6,V6=!1;function cg(n){const e=tn(n,"data");return ht(U6(e))}cg._=z6;cg.lock=function(){V6=!0};cg.register=function(n){if(V6)throw new Error("sha256 is locked");U6=n};Object.freeze(cg);Object.freeze(cg);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const W6=BigInt(0),uS=BigInt(1),Dve=BigInt(2),cS=n=>n instanceof Uint8Array,_ve=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function _p(n){if(!cS(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=_ve[n[t]];return e}function G6(n){const e=n.toString(16);return e.length&1?`0${e}`:e}function DN(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function Pp(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let r=0;r<t.length;r++){const s=r*2,i=n.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function _f(n){return DN(_p(n))}function _N(n){if(!cS(n))throw new Error("Uint8Array expected");return DN(_p(Uint8Array.from(n).reverse()))}function Fp(n,e){return Pp(n.toString(16).padStart(e*2,"0"))}function PN(n,e){return Fp(n,e).reverse()}function Pve(n){return Pp(G6(n))}function Fo(n,e,t){let r;if(typeof e=="string")try{r=Pp(e)}catch(i){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${i}`)}else if(cS(e))r=Uint8Array.from(e);else throw new Error(`${n} must be hex string or Uint8Array`);const s=r.length;if(typeof t=="number"&&s!==t)throw new Error(`${n} expected ${t} bytes, got ${s}`);return r}function Km(...n){const e=new Uint8Array(n.reduce((r,s)=>r+s.length,0));let t=0;return n.forEach(r=>{if(!cS(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}function Fve(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Mve(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function Lve(n){let e;for(e=0;n>W6;n>>=uS,e+=1);return e}function Bve(n,e){return n>>BigInt(e)&uS}const zve=(n,e,t)=>n|(t?uS:W6)<<BigInt(e),FN=n=>(Dve<<BigInt(n-1))-uS,zk=n=>new Uint8Array(n),wP=n=>Uint8Array.from(n);function H6(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=zk(n),s=zk(n),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...h)=>t(s,r,...h),l=(h=zk())=>{s=a(wP([0]),h),r=a(),h.length!==0&&(s=a(wP([1]),h),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const p=[];for(;h<e;){r=a();const g=r.slice();p.push(g),h+=r.length}return Km(...p)};return(h,p)=>{o(),l(h);let g;for(;!(g=p(u()));)l();return o(),g}}const Uve={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||n instanceof Uint8Array,isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function By(n,e,t={}){const r=(s,i,o)=>{const a=Uve[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const l=n[s];if(!(o&&l===void 0)&&!a(l,n))throw new Error(`Invalid param ${String(s)}=${l} (${typeof l}), expected ${i}`)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(t))r(s,i,!0);return n}const Vve=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Bve,bitLen:Lve,bitMask:FN,bitSet:zve,bytesToHex:_p,bytesToNumberBE:_f,bytesToNumberLE:_N,concatBytes:Km,createHmacDrbg:H6,ensureBytes:Fo,equalBytes:Fve,hexToBytes:Pp,hexToNumber:DN,numberToBytesBE:Fp,numberToBytesLE:PN,numberToHexUnpadded:G6,numberToVarBytesBE:Pve,utf8ToBytes:Mve,validateObject:By},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zr=BigInt(0),vr=BigInt(1),Jc=BigInt(2),Wve=BigInt(3),UE=BigInt(4),xP=BigInt(5),bP=BigInt(8);BigInt(9);BigInt(16);function pi(n,e){const t=n%e;return t>=Zr?t:e+t}function Gve(n,e,t){if(t<=Zr||e<Zr)throw new Error("Expected power/modulo > 0");if(t===vr)return Zr;let r=vr;for(;e>Zr;)e&vr&&(r=r*n%t),n=n*n%t,e>>=vr;return r}function Zi(n,e,t){let r=n;for(;e-- >Zr;)r*=r,r%=t;return r}function VE(n,e){if(n===Zr||e<=Zr)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=pi(n,e),r=e,s=Zr,i=vr;for(;t!==Zr;){const a=r/t,l=r%t,u=s-i*a;r=t,t=l,s=i,i=u}if(r!==vr)throw new Error("invert: does not exist");return pi(s,e)}function Hve(n){const e=(n-vr)/Jc;let t,r,s;for(t=n-vr,r=0;t%Jc===Zr;t/=Jc,r++);for(s=Jc;s<n&&Gve(s,e,n)!==n-vr;s++);if(r===1){const o=(n+vr)/UE;return function(l,u){const f=l.pow(u,o);if(!l.eql(l.sqr(f),u))throw new Error("Cannot find square root");return f}}const i=(t+vr)/Jc;return function(a,l){if(a.pow(l,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=r,f=a.pow(a.mul(a.ONE,s),t),h=a.pow(l,i),p=a.pow(l,t);for(;!a.eql(p,a.ONE);){if(a.eql(p,a.ZERO))return a.ZERO;let g=1;for(let w=a.sqr(p);g<u&&!a.eql(w,a.ONE);g++)w=a.sqr(w);const m=a.pow(f,vr<<BigInt(u-g-1));f=a.sqr(m),h=a.mul(h,m),p=a.mul(p,f),u=g}return h}}function jve(n){if(n%UE===Wve){const e=(n+vr)/UE;return function(r,s){const i=r.pow(s,e);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(n%bP===xP){const e=(n-xP)/bP;return function(r,s){const i=r.mul(s,Jc),o=r.pow(i,e),a=r.mul(s,o),l=r.mul(r.mul(a,Jc),o),u=r.mul(a,r.sub(l,r.ONE));if(!r.eql(r.sqr(u),s))throw new Error("Cannot find square root");return u}}return Hve(n)}const Kve=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function qve(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=Kve.reduce((r,s)=>(r[s]="function",r),e);return By(n,t)}function Xve(n,e,t){if(t<Zr)throw new Error("Expected power > 0");if(t===Zr)return n.ONE;if(t===vr)return e;let r=n.ONE,s=e;for(;t>Zr;)t&vr&&(r=n.mul(r,s)),s=n.sqr(s),t>>=vr;return r}function Qve(n,e){const t=new Array(e.length),r=e.reduce((i,o,a)=>n.is0(o)?i:(t[a]=i,n.mul(i,o)),n.ONE),s=n.inv(r);return e.reduceRight((i,o,a)=>n.is0(o)?i:(t[a]=n.mul(i,t[a]),n.mul(i,o)),s),t}function j6(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function Yve(n,e,t=!1,r={}){if(n<=Zr)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:s,nByteLength:i}=j6(n,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=jve(n),a=Object.freeze({ORDER:n,BITS:s,BYTES:i,MASK:FN(s),ZERO:Zr,ONE:vr,create:l=>pi(l,n),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return Zr<=l&&l<n},is0:l=>l===Zr,isOdd:l=>(l&vr)===vr,neg:l=>pi(-l,n),eql:(l,u)=>l===u,sqr:l=>pi(l*l,n),add:(l,u)=>pi(l+u,n),sub:(l,u)=>pi(l-u,n),mul:(l,u)=>pi(l*u,n),pow:(l,u)=>Xve(a,l,u),div:(l,u)=>pi(l*VE(u,n),n),sqrN:l=>l*l,addN:(l,u)=>l+u,subN:(l,u)=>l-u,mulN:(l,u)=>l*u,inv:l=>VE(l,n),sqrt:r.sqrt||(l=>o(a,l)),invertBatch:l=>Qve(a,l),cmov:(l,u,f)=>f?u:l,toBytes:l=>t?PN(l,i):Fp(l,i),fromBytes:l=>{if(l.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${l.length}`);return t?_N(l):_f(l)}});return Object.freeze(a)}function K6(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function q6(n){const e=K6(n);return e+Math.ceil(e/2)}function Jve(n,e,t=!1){const r=n.length,s=K6(e),i=q6(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const o=t?_f(n):_N(n),a=pi(o,e-vr)+vr;return t?PN(a,s):Fp(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zve=BigInt(0),Uk=BigInt(1);function eSe(n,e){const t=(s,i)=>{const o=i.negate();return s?o:i},r=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,i){let o=n.ZERO,a=s;for(;i>Zve;)i&Uk&&(o=o.add(a)),a=a.double(),i>>=Uk;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=r(i),l=[];let u=s,f=u;for(let h=0;h<o;h++){f=u,l.push(f);for(let p=1;p<a;p++)f=f.add(u),l.push(f);u=f.double()}return l},wNAF(s,i,o){const{windows:a,windowSize:l}=r(s);let u=n.ZERO,f=n.BASE;const h=BigInt(2**s-1),p=2**s,g=BigInt(s);for(let m=0;m<a;m++){const w=m*l;let x=Number(o&h);o>>=g,x>l&&(x-=p,o+=Uk);const b=w,C=w+Math.abs(x)-1,$=m%2!==0,k=x<0;x===0?f=f.add(t($,i[b])):u=u.add(t(k,i[C]))}return{p:u,f}},wNAFCached(s,i,o,a){const l=s._WINDOW_SIZE||1;let u=i.get(s);return u||(u=this.precomputeWindow(s,l),l!==1&&i.set(s,a(u))),this.wNAF(l,u,o)}}}function X6(n){return qve(n.Fp),By(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...j6(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function tSe(n){const e=X6(n);By(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:s}=e;if(t){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:nSe,hexToBytes:rSe}=Vve,sf={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){const{Err:e}=sf;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:nSe(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=sf,t=typeof n=="string"?rSe(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=sf._parseInt(t.subarray(2)),{d:o,l:a}=sf._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(n){const e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,t=u=>{const f=u.toString(16);return f.length&1?`0${f}`:f},r=e(t(n.s)),s=e(t(n.r)),i=r.length/2,o=s.length/2,a=t(i),l=t(o);return`30${t(o+i+4)}02${l}${s}02${a}${r}`}},$l=BigInt(0),ao=BigInt(1);BigInt(2);const vP=BigInt(3);BigInt(4);function sSe(n){const e=tSe(n),{Fp:t}=e,r=e.toBytes||((m,w,x)=>{const b=w.toAffine();return Km(Uint8Array.from([4]),t.toBytes(b.x),t.toBytes(b.y))}),s=e.fromBytes||(m=>{const w=m.subarray(1),x=t.fromBytes(w.subarray(0,t.BYTES)),b=t.fromBytes(w.subarray(t.BYTES,2*t.BYTES));return{x,y:b}});function i(m){const{a:w,b:x}=e,b=t.sqr(m),C=t.mul(b,m);return t.add(t.add(C,t.mul(m,w)),x)}if(!t.eql(t.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(m){return typeof m=="bigint"&&$l<m&&m<e.n}function a(m){if(!o(m))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(m){const{allowedPrivateKeyLengths:w,nByteLength:x,wrapPrivateKey:b,n:C}=e;if(w&&typeof m!="bigint"){if(m instanceof Uint8Array&&(m=_p(m)),typeof m!="string"||!w.includes(m.length))throw new Error("Invalid key");m=m.padStart(x*2,"0")}let $;try{$=typeof m=="bigint"?m:_f(Fo("private key",m,x))}catch{throw new Error(`private key must be ${x} bytes, hex or bigint, not ${typeof m}`)}return b&&($=pi($,C)),a($),$}const u=new Map;function f(m){if(!(m instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(w,x,b){if(this.px=w,this.py=x,this.pz=b,w==null||!t.isValid(w))throw new Error("x required");if(x==null||!t.isValid(x))throw new Error("y required");if(b==null||!t.isValid(b))throw new Error("z required")}static fromAffine(w){const{x,y:b}=w||{};if(!w||!t.isValid(x)||!t.isValid(b))throw new Error("invalid affine point");if(w instanceof h)throw new Error("projective point not allowed");const C=$=>t.eql($,t.ZERO);return C(x)&&C(b)?h.ZERO:new h(x,b,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(w){const x=t.invertBatch(w.map(b=>b.pz));return w.map((b,C)=>b.toAffine(x[C])).map(h.fromAffine)}static fromHex(w){const x=h.fromAffine(s(Fo("pointHex",w)));return x.assertValidity(),x}static fromPrivateKey(w){return h.BASE.multiply(l(w))}_setWindowSize(w){this._WINDOW_SIZE=w,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:w,y:x}=this.toAffine();if(!t.isValid(w)||!t.isValid(x))throw new Error("bad point: x or y not FE");const b=t.sqr(x),C=i(w);if(!t.eql(b,C))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:w}=this.toAffine();if(t.isOdd)return!t.isOdd(w);throw new Error("Field doesn't support isOdd")}equals(w){f(w);const{px:x,py:b,pz:C}=this,{px:$,py:k,pz:N}=w,_=t.eql(t.mul(x,N),t.mul($,C)),U=t.eql(t.mul(b,N),t.mul(k,C));return _&&U}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:w,b:x}=e,b=t.mul(x,vP),{px:C,py:$,pz:k}=this;let N=t.ZERO,_=t.ZERO,U=t.ZERO,O=t.mul(C,C),L=t.mul($,$),T=t.mul(k,k),I=t.mul(C,$);return I=t.add(I,I),U=t.mul(C,k),U=t.add(U,U),N=t.mul(w,U),_=t.mul(b,T),_=t.add(N,_),N=t.sub(L,_),_=t.add(L,_),_=t.mul(N,_),N=t.mul(I,N),U=t.mul(b,U),T=t.mul(w,T),I=t.sub(O,T),I=t.mul(w,I),I=t.add(I,U),U=t.add(O,O),O=t.add(U,O),O=t.add(O,T),O=t.mul(O,I),_=t.add(_,O),T=t.mul($,k),T=t.add(T,T),O=t.mul(T,I),N=t.sub(N,O),U=t.mul(T,L),U=t.add(U,U),U=t.add(U,U),new h(N,_,U)}add(w){f(w);const{px:x,py:b,pz:C}=this,{px:$,py:k,pz:N}=w;let _=t.ZERO,U=t.ZERO,O=t.ZERO;const L=e.a,T=t.mul(e.b,vP);let I=t.mul(x,$),v=t.mul(b,k),A=t.mul(C,N),M=t.add(x,b),D=t.add($,k);M=t.mul(M,D),D=t.add(I,v),M=t.sub(M,D),D=t.add(x,C);let B=t.add($,N);return D=t.mul(D,B),B=t.add(I,A),D=t.sub(D,B),B=t.add(b,C),_=t.add(k,N),B=t.mul(B,_),_=t.add(v,A),B=t.sub(B,_),O=t.mul(L,D),_=t.mul(T,A),O=t.add(_,O),_=t.sub(v,O),O=t.add(v,O),U=t.mul(_,O),v=t.add(I,I),v=t.add(v,I),A=t.mul(L,A),D=t.mul(T,D),v=t.add(v,A),A=t.sub(I,A),A=t.mul(L,A),D=t.add(D,A),I=t.mul(v,D),U=t.add(U,I),I=t.mul(B,D),_=t.mul(M,_),_=t.sub(_,I),I=t.mul(M,v),O=t.mul(B,O),O=t.add(O,I),new h(_,U,O)}subtract(w){return this.add(w.negate())}is0(){return this.equals(h.ZERO)}wNAF(w){return g.wNAFCached(this,u,w,x=>{const b=t.invertBatch(x.map(C=>C.pz));return x.map((C,$)=>C.toAffine(b[$])).map(h.fromAffine)})}multiplyUnsafe(w){const x=h.ZERO;if(w===$l)return x;if(a(w),w===ao)return this;const{endo:b}=e;if(!b)return g.unsafeLadder(this,w);let{k1neg:C,k1:$,k2neg:k,k2:N}=b.splitScalar(w),_=x,U=x,O=this;for(;$>$l||N>$l;)$&ao&&(_=_.add(O)),N&ao&&(U=U.add(O)),O=O.double(),$>>=ao,N>>=ao;return C&&(_=_.negate()),k&&(U=U.negate()),U=new h(t.mul(U.px,b.beta),U.py,U.pz),_.add(U)}multiply(w){a(w);let x=w,b,C;const{endo:$}=e;if($){const{k1neg:k,k1:N,k2neg:_,k2:U}=$.splitScalar(x);let{p:O,f:L}=this.wNAF(N),{p:T,f:I}=this.wNAF(U);O=g.constTimeNegate(k,O),T=g.constTimeNegate(_,T),T=new h(t.mul(T.px,$.beta),T.py,T.pz),b=O.add(T),C=L.add(I)}else{const{p:k,f:N}=this.wNAF(x);b=k,C=N}return h.normalizeZ([b,C])[0]}multiplyAndAddUnsafe(w,x,b){const C=h.BASE,$=(N,_)=>_===$l||_===ao||!N.equals(C)?N.multiplyUnsafe(_):N.multiply(_),k=$(this,x).add($(w,b));return k.is0()?void 0:k}toAffine(w){const{px:x,py:b,pz:C}=this,$=this.is0();w==null&&(w=$?t.ONE:t.inv(C));const k=t.mul(x,w),N=t.mul(b,w),_=t.mul(C,w);if($)return{x:t.ZERO,y:t.ZERO};if(!t.eql(_,t.ONE))throw new Error("invZ was invalid");return{x:k,y:N}}isTorsionFree(){const{h:w,isTorsionFree:x}=e;if(w===ao)return!0;if(x)return x(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:w,clearCofactor:x}=e;return w===ao?this:x?x(h,this):this.multiplyUnsafe(e.h)}toRawBytes(w=!0){return this.assertValidity(),r(h,this,w)}toHex(w=!0){return _p(this.toRawBytes(w))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const p=e.nBitLength,g=eSe(h,e.endo?Math.ceil(p/2):p);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:i,isWithinCurveOrder:o}}function iSe(n){const e=X6(n);return By(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function oSe(n){const e=iSe(n),{Fp:t,n:r}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(D){return $l<D&&D<t.ORDER}function a(D){return pi(D,r)}function l(D){return VE(D,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:f,weierstrassEquation:h,isWithinCurveOrder:p}=sSe({...e,toBytes(D,B,j){const W=B.toAffine(),P=t.toBytes(W.x),E=Km;return j?E(Uint8Array.from([B.hasEvenY()?2:3]),P):E(Uint8Array.from([4]),P,t.toBytes(W.y))},fromBytes(D){const B=D.length,j=D[0],W=D.subarray(1);if(B===s&&(j===2||j===3)){const P=_f(W);if(!o(P))throw new Error("Point is not on curve");const E=h(P);let R=t.sqrt(E);const H=(R&ao)===ao;return(j&1)===1!==H&&(R=t.neg(R)),{x:P,y:R}}else if(B===i&&j===4){const P=t.fromBytes(W.subarray(0,t.BYTES)),E=t.fromBytes(W.subarray(t.BYTES,2*t.BYTES));return{x:P,y:E}}else throw new Error(`Point of length ${B} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),g=D=>_p(Fp(D,e.nByteLength));function m(D){const B=r>>ao;return D>B}function w(D){return m(D)?a(-D):D}const x=(D,B,j)=>_f(D.slice(B,j));class b{constructor(B,j,W){this.r=B,this.s=j,this.recovery=W,this.assertValidity()}static fromCompact(B){const j=e.nByteLength;return B=Fo("compactSignature",B,j*2),new b(x(B,0,j),x(B,j,2*j))}static fromDER(B){const{r:j,s:W}=sf.toSig(Fo("DER",B));return new b(j,W)}assertValidity(){if(!p(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!p(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(B){return new b(this.r,this.s,B)}recoverPublicKey(B){const{r:j,s:W,recovery:P}=this,E=U(Fo("msgHash",B));if(P==null||![0,1,2,3].includes(P))throw new Error("recovery id invalid");const R=P===2||P===3?j+e.n:j;if(R>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const H=P&1?"03":"02",K=u.fromHex(H+g(R)),Q=l(R),J=a(-E*Q),ie=a(W*Q),ce=u.BASE.multiplyAndAddUnsafe(K,J,ie);if(!ce)throw new Error("point at infinify");return ce.assertValidity(),ce}hasHighS(){return m(this.s)}normalizeS(){return this.hasHighS()?new b(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Pp(this.toDERHex())}toDERHex(){return sf.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Pp(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}const C={isValidPrivateKey(D){try{return f(D),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const D=q6(e.n);return Jve(e.randomBytes(D),e.n)},precompute(D=8,B=u.BASE){return B._setWindowSize(D),B.multiply(BigInt(3)),B}};function $(D,B=!0){return u.fromPrivateKey(D).toRawBytes(B)}function k(D){const B=D instanceof Uint8Array,j=typeof D=="string",W=(B||j)&&D.length;return B?W===s||W===i:j?W===2*s||W===2*i:D instanceof u}function N(D,B,j=!0){if(k(D))throw new Error("first arg must be private key");if(!k(B))throw new Error("second arg must be public key");return u.fromHex(B).multiply(f(D)).toRawBytes(j)}const _=e.bits2int||function(D){const B=_f(D),j=D.length*8-e.nBitLength;return j>0?B>>BigInt(j):B},U=e.bits2int_modN||function(D){return a(_(D))},O=FN(e.nBitLength);function L(D){if(typeof D!="bigint")throw new Error("bigint expected");if(!($l<=D&&D<O))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Fp(D,e.nByteLength)}function T(D,B,j=I){if(["recovered","canonical"].some(be=>be in j))throw new Error("sign() legacy options not supported");const{hash:W,randomBytes:P}=e;let{lowS:E,prehash:R,extraEntropy:H}=j;E==null&&(E=!0),D=Fo("msgHash",D),R&&(D=Fo("prehashed msgHash",W(D)));const K=U(D),Q=f(B),J=[L(Q),L(K)];if(H!=null){const be=H===!0?P(t.BYTES):H;J.push(Fo("extraEntropy",be))}const ie=Km(...J),ce=K;function ge(be){const Ae=_(be);if(!p(Ae))return;const ne=l(Ae),he=u.BASE.multiply(Ae).toAffine(),Ie=a(he.x);if(Ie===$l)return;const ze=a(ne*a(ce+Ie*Q));if(ze===$l)return;let Re=(he.x===Ie?0:2)|Number(he.y&ao),Ke=ze;return E&&m(ze)&&(Ke=w(ze),Re^=1),new b(Ie,Ke,Re)}return{seed:ie,k2sig:ge}}const I={lowS:e.lowS,prehash:!1},v={lowS:e.lowS,prehash:!1};function A(D,B,j=I){const{seed:W,k2sig:P}=T(D,B,j),E=e;return H6(E.hash.outputLen,E.nByteLength,E.hmac)(W,P)}u.BASE._setWindowSize(8);function M(D,B,j,W=v){var he;const P=D;if(B=Fo("msgHash",B),j=Fo("publicKey",j),"strict"in W)throw new Error("options.strict was renamed to lowS");const{lowS:E,prehash:R}=W;let H,K;try{if(typeof P=="string"||P instanceof Uint8Array)try{H=b.fromDER(P)}catch(Ie){if(!(Ie instanceof sf.Err))throw Ie;H=b.fromCompact(P)}else if(typeof P=="object"&&typeof P.r=="bigint"&&typeof P.s=="bigint"){const{r:Ie,s:ze}=P;H=new b(Ie,ze)}else throw new Error("PARSE");K=u.fromHex(j)}catch(Ie){if(Ie.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(E&&H.hasHighS())return!1;R&&(B=e.hash(B));const{r:Q,s:J}=H,ie=U(B),ce=l(J),ge=a(ie*ce),be=a(Q*ce),Ae=(he=u.BASE.multiplyAndAddUnsafe(K,ge,be))==null?void 0:he.toAffine();return Ae?a(Ae.x)===Q:!1}return{CURVE:e,getPublicKey:$,getSharedSecret:N,sign:A,verify:M,ProjectivePoint:u,Signature:b,utils:C}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function aSe(n){return{hash:n,hmac:(e,...t)=>I6(n,e,qbe(...t)),randomBytes:Xbe}}function lSe(n,e){const t=r=>oSe({...n,...aSe(r)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Q6=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),SP=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),uSe=BigInt(1),WE=BigInt(2),CP=(n,e)=>(n+e/WE)/e;function cSe(n){const e=Q6,t=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),l=BigInt(88),u=n*n*n%e,f=u*u*n%e,h=Zi(f,t,e)*f%e,p=Zi(h,t,e)*f%e,g=Zi(p,WE,e)*u%e,m=Zi(g,s,e)*g%e,w=Zi(m,i,e)*m%e,x=Zi(w,a,e)*w%e,b=Zi(x,l,e)*x%e,C=Zi(b,a,e)*w%e,$=Zi(C,t,e)*f%e,k=Zi($,o,e)*m%e,N=Zi(k,r,e)*u%e,_=Zi(N,WE,e);if(!GE.eql(GE.sqr(_),n))throw new Error("Cannot find square root");return _}const GE=Yve(Q6,void 0,void 0,{sqrt:cSe}),Su=lSe({a:BigInt(0),b:BigInt(7),Fp:GE,n:SP,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=SP,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-uSe*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=CP(i*n,e),l=CP(-r*n,e);let u=pi(n-a*t-l*s,e),f=pi(-a*r-l*i,e);const h=u>o,p=f>o;if(h&&(u=e-u),p&&(f=e-f),u>o||f>o)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:h,k1:u,k2neg:p,k2:f}}}},A6);BigInt(0);Su.ProjectivePoint;const qm="0x0000000000000000000000000000000000000000",kP="0x0000000000000000000000000000000000000000000000000000000000000000",IP=BigInt(0),EP=BigInt(1),AP=BigInt(2),TP=BigInt(27),NP=BigInt(28),mx=BigInt(35),od={};function $P(n){return rh(Xs(n),32)}var Vd,Wd,Gd,wf;const Po=class Po{constructor(e,t,r,s){_e(this,Vd);_e(this,Wd);_e(this,Gd);_e(this,wf);sS(e,od,"Signature"),se(this,Vd,t),se(this,Wd,r),se(this,Gd,s),se(this,wf,null)}get r(){return Y(this,Vd)}set r(e){we($d(e)===32,"invalid r","value",e),se(this,Vd,ht(e))}get s(){return Y(this,Wd)}set s(e){we($d(e)===32,"invalid s","value",e);const t=ht(e);we(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),se(this,Wd,t)}get v(){return Y(this,Gd)}set v(e){const t=jt(e,"value");we(t===27||t===28,"invalid v","v",e),se(this,Gd,t)}get networkV(){return Y(this,wf)}get legacyChainId(){const e=this.networkV;return e==null?null:Po.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=tn(this.s);return this.yParity&&(e[0]|=128),ht(e)}get compactSerialized(){return kr([this.r,this.yParityAndS])}get serialized(){return kr([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Po(od,this.r,this.s,this.v);return this.networkV&&se(e,wf,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=wt(e,"v");return t==TP||t==NP?IP:(we(t>=mx,"invalid EIP-155 v","v",e),(t-mx)/AP)}static getChainIdV(e,t){return wt(e)*AP+BigInt(35+t-27)}static getNormalizedV(e){const t=wt(e);return t===IP||t===TP?27:t===EP||t===NP?28:(we(t>=mx,"invalid v","v",e),t&EP?27:28)}static from(e){function t(u,f){we(u,f,"signature",e)}if(e==null)return new Po(od,kP,kP,27);if(typeof e=="string"){const u=tn(e,"signature");if(u.length===64){const f=ht(u.slice(0,32)),h=u.slice(32,64),p=h[0]&128?28:27;return h[0]&=127,new Po(od,f,ht(h),p)}if(u.length===65){const f=ht(u.slice(0,32)),h=u.slice(32,64);t((h[0]&128)===0,"non-canonical s");const p=Po.getNormalizedV(u[64]);return new Po(od,f,ht(h),p)}t(!1,"invalid raw signature length")}if(e instanceof Po)return e.clone();const r=e.r;t(r!=null,"missing r");const s=$P(r),i=function(u,f){if(u!=null)return $P(u);if(f!=null){t(zn(f,32),"invalid yParityAndS");const h=tn(f);return h[0]&=127,ht(h)}t(!1,"missing s")}(e.s,e.yParityAndS);t((tn(i)[0]&128)==0,"non-canonical s");const{networkV:o,v:a}=function(u,f,h){if(u!=null){const p=wt(u);return{networkV:p>=mx?p:void 0,v:Po.getNormalizedV(p)}}if(f!=null)return t(zn(f,32),"invalid yParityAndS"),{v:tn(f)[0]&128?28:27};if(h!=null){switch(jt(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),l=new Po(od,s,i,a);return o&&se(l,wf,o),t(e.yParity==null||jt(e.yParity,"sig.yParity")===l.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===l.yParityAndS,"yParityAndS mismatch"),l}};Vd=new WeakMap,Wd=new WeakMap,Gd=new WeakMap,wf=new WeakMap;let Jo=Po;var bl;const Zc=class Zc{constructor(e){_e(this,bl);we($d(e)===32,"invalid private key","privateKey","[REDACTED]"),se(this,bl,ht(e))}get privateKey(){return Y(this,bl)}get publicKey(){return Zc.computePublicKey(Y(this,bl))}get compressedPublicKey(){return Zc.computePublicKey(Y(this,bl),!0)}sign(e){we($d(e)===32,"invalid digest length","digest",e);const t=Su.sign(qs(e),qs(Y(this,bl)),{lowS:!0});return Jo.from({r:sc(t.r,32),s:sc(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=Zc.computePublicKey(e);return ht(Su.getSharedSecret(qs(Y(this,bl)),tn(t),!1))}static computePublicKey(e,t){let r=tn(e,"key");if(r.length===32){const i=Su.getPublicKey(r,!!t);return ht(i)}if(r.length===64){const i=new Uint8Array(65);i[0]=4,i.set(r,1),r=i}const s=Su.ProjectivePoint.fromHex(r);return ht(s.toRawBytes(t))}static recoverPublicKey(e,t){we($d(e)===32,"invalid digest length","digest",e);const r=Jo.from(t);let s=Su.Signature.fromCompact(qs(kr([r.r,r.s])));s=s.addRecoveryBit(r.yParity);const i=s.recoverPublicKey(qs(e));return we(i!=null,"invalid signautre for digest","signature",t),"0x"+i.toHex(!1)}static addPoints(e,t,r){const s=Su.ProjectivePoint.fromHex(Zc.computePublicKey(e).substring(2)),i=Su.ProjectivePoint.fromHex(Zc.computePublicKey(t).substring(2));return"0x"+s.add(i).toHex(!!r)}};bl=new WeakMap;let Xm=Zc;const fSe=BigInt(0),hSe=BigInt(36);function RP(n){n=n.toLowerCase();const e=n.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const r=tn(Rr(t));for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(r[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const MN={};for(let n=0;n<10;n++)MN[String(n)]=String(n);for(let n=0;n<26;n++)MN[String.fromCharCode(65+n)]=String(10+n);const OP=15;function dSe(n){n=n.toUpperCase(),n=n.substring(4)+n.substring(0,2)+"00";let e=n.split("").map(r=>MN[r]).join("");for(;e.length>=OP;){let r=e.substring(0,OP);e=parseInt(r,10)%97+e.substring(r.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const pSe=function(){const n={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];n[t]=BigInt(e)}return n}();function gSe(n){n=n.toLowerCase();let e=fSe;for(let t=0;t<n.length;t++)e=e*hSe+pSe[n[t]];return e}function Cn(n){if(we(typeof n=="string","invalid address","address",n),n.match(/^(0x)?[0-9a-fA-F]{40}$/)){n.startsWith("0x")||(n="0x"+n);const e=RP(n);return we(!n.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===n,"bad address checksum","address",n),e}if(n.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){we(n.substring(2,4)===dSe(n),"bad icap checksum","address",n);let e=gSe(n.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return RP("0x"+e)}we(!1,"invalid address","address",n)}function mSe(n){const e=Cn(n.from);let r=wt(n.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,Cn(cr(Rr(sh([e,r])),12))}function Y6(n){return n&&typeof n.getAddress=="function"}async function Vk(n,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(je(typeof n!="string","unconfigured name","UNCONFIGURED_NAME",{value:n}),we(!1,"invalid AddressLike value; did not resolve to a value address","target",n)),Cn(t)}function Ys(n,e){if(typeof n=="string")return n.match(/^0x[0-9a-f]{40}$/i)?Cn(n):(je(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),Vk(n,e.resolveName(n)));if(Y6(n))return Vk(n,n.getAddress());if(n&&typeof n.then=="function")return Vk(n,n);we(!1,"unsupported addressable value","target",n)}const fl={};function ft(n,e){let t=!1;return e<0&&(t=!0,e*=-1),new _s(fl,`${t?"":"u"}int${e}`,n,{signed:t,width:e})}function rn(n,e){return new _s(fl,`bytes${e||""}`,n,{size:e})}const DP=Symbol.for("_ethers_typed");var xf;const dl=class dl{constructor(e,t,r,s){Se(this,"type");Se(this,"value");_e(this,xf);Se(this,"_typedSymbol");s==null&&(s=null),sS(fl,e,"Typed"),Nt(this,{_typedSymbol:DP,type:t,value:r}),se(this,xf,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return Y(this,xf)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return Y(this,xf)===!0?-1:Y(this,xf)===!1?this.value.length:null}static from(e,t){return new dl(fl,e,t)}static uint8(e){return ft(e,8)}static uint16(e){return ft(e,16)}static uint24(e){return ft(e,24)}static uint32(e){return ft(e,32)}static uint40(e){return ft(e,40)}static uint48(e){return ft(e,48)}static uint56(e){return ft(e,56)}static uint64(e){return ft(e,64)}static uint72(e){return ft(e,72)}static uint80(e){return ft(e,80)}static uint88(e){return ft(e,88)}static uint96(e){return ft(e,96)}static uint104(e){return ft(e,104)}static uint112(e){return ft(e,112)}static uint120(e){return ft(e,120)}static uint128(e){return ft(e,128)}static uint136(e){return ft(e,136)}static uint144(e){return ft(e,144)}static uint152(e){return ft(e,152)}static uint160(e){return ft(e,160)}static uint168(e){return ft(e,168)}static uint176(e){return ft(e,176)}static uint184(e){return ft(e,184)}static uint192(e){return ft(e,192)}static uint200(e){return ft(e,200)}static uint208(e){return ft(e,208)}static uint216(e){return ft(e,216)}static uint224(e){return ft(e,224)}static uint232(e){return ft(e,232)}static uint240(e){return ft(e,240)}static uint248(e){return ft(e,248)}static uint256(e){return ft(e,256)}static uint(e){return ft(e,256)}static int8(e){return ft(e,-8)}static int16(e){return ft(e,-16)}static int24(e){return ft(e,-24)}static int32(e){return ft(e,-32)}static int40(e){return ft(e,-40)}static int48(e){return ft(e,-48)}static int56(e){return ft(e,-56)}static int64(e){return ft(e,-64)}static int72(e){return ft(e,-72)}static int80(e){return ft(e,-80)}static int88(e){return ft(e,-88)}static int96(e){return ft(e,-96)}static int104(e){return ft(e,-104)}static int112(e){return ft(e,-112)}static int120(e){return ft(e,-120)}static int128(e){return ft(e,-128)}static int136(e){return ft(e,-136)}static int144(e){return ft(e,-144)}static int152(e){return ft(e,-152)}static int160(e){return ft(e,-160)}static int168(e){return ft(e,-168)}static int176(e){return ft(e,-176)}static int184(e){return ft(e,-184)}static int192(e){return ft(e,-192)}static int200(e){return ft(e,-200)}static int208(e){return ft(e,-208)}static int216(e){return ft(e,-216)}static int224(e){return ft(e,-224)}static int232(e){return ft(e,-232)}static int240(e){return ft(e,-240)}static int248(e){return ft(e,-248)}static int256(e){return ft(e,-256)}static int(e){return ft(e,-256)}static bytes1(e){return rn(e,1)}static bytes2(e){return rn(e,2)}static bytes3(e){return rn(e,3)}static bytes4(e){return rn(e,4)}static bytes5(e){return rn(e,5)}static bytes6(e){return rn(e,6)}static bytes7(e){return rn(e,7)}static bytes8(e){return rn(e,8)}static bytes9(e){return rn(e,9)}static bytes10(e){return rn(e,10)}static bytes11(e){return rn(e,11)}static bytes12(e){return rn(e,12)}static bytes13(e){return rn(e,13)}static bytes14(e){return rn(e,14)}static bytes15(e){return rn(e,15)}static bytes16(e){return rn(e,16)}static bytes17(e){return rn(e,17)}static bytes18(e){return rn(e,18)}static bytes19(e){return rn(e,19)}static bytes20(e){return rn(e,20)}static bytes21(e){return rn(e,21)}static bytes22(e){return rn(e,22)}static bytes23(e){return rn(e,23)}static bytes24(e){return rn(e,24)}static bytes25(e){return rn(e,25)}static bytes26(e){return rn(e,26)}static bytes27(e){return rn(e,27)}static bytes28(e){return rn(e,28)}static bytes29(e){return rn(e,29)}static bytes30(e){return rn(e,30)}static bytes31(e){return rn(e,31)}static bytes32(e){return rn(e,32)}static address(e){return new dl(fl,"address",e)}static bool(e){return new dl(fl,"bool",!!e)}static bytes(e){return new dl(fl,"bytes",e)}static string(e){return new dl(fl,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new dl(fl,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===DP}static dereference(e,t){if(dl.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};xf=new WeakMap;let _s=dl;class ySe extends jl{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let r=_s.dereference(t,"string");try{r=Cn(r)}catch(s){return this._throwError(s.message,t)}return e.writeValue(r)}decode(e){return Cn(sc(e.readValue(),20))}}class wSe extends jl{constructor(t){super(t.name,t.type,"_",t.dynamic);Se(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,r){return this.coder.encode(t,r)}decode(t){return this.coder.decode(t)}}function J6(n,e,t){let r=[];if(Array.isArray(t))r=t;else if(t&&typeof t=="object"){let l={};r=e.map(u=>{const f=u.localName;return je(f,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:u},value:t}),je(!l[f],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:u},value:t}),l[f]=!0,t[f]})}else we(!1,"invalid tuple value","tuple",t);we(e.length===r.length,"types/value length mismatch","tuple",t);let s=new ME,i=new ME,o=[];e.forEach((l,u)=>{let f=r[u];if(l.dynamic){let h=i.length;l.encode(i,f);let p=s.writeUpdatableValue();o.push(g=>{p(g+h)})}else l.encode(s,f)}),o.forEach(l=>{l(s.length)});let a=n.appendWriter(s);return a+=n.appendWriter(i),a}function Z6(n,e){let t=[],r=[],s=n.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=n.readIndex(),l=s.subReader(a);try{o=i.decode(l)}catch(u){if(cs(u,"BUFFER_OVERRUN"))throw u;o=u,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(n)}catch(a){if(cs(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");t.push(o),r.push(i.localName||null)}),Op.fromItems(t,r)}class xSe extends jl{constructor(t,r,s){const i=t.type+"["+(r>=0?r:"")+"]",o=r===-1||t.dynamic;super("array",i,s,o);Se(this,"coder");Se(this,"length");Nt(this,{coder:t,length:r})}defaultValue(){const t=this.coder.defaultValue(),r=[];for(let s=0;s<this.length;s++)r.push(t);return r}encode(t,r){const s=_s.dereference(r,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,t.writeValue(s.length)),l6(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return J6(t,o,s)}decode(t){let r=this.length;r===-1&&(r=t.readIndex(),je(r*Qs<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:r*Qs,length:t.dataLength}));let s=[];for(let i=0;i<r;i++)s.push(new wSe(this.coder));return Z6(t,s)}}class bSe extends jl{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const r=_s.dereference(t,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class eW extends jl{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=qs(t);let r=e.writeValue(t.length);return r+=e.writeBytes(t),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class vSe extends eW{constructor(e){super("bytes",e)}decode(e){return ht(super.decode(e))}}class SSe extends jl{constructor(t,r){let s="bytes"+String(t);super(s,s,r,!1);Se(this,"size");Nt(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,r){let s=qs(_s.dereference(r,this.type));return s.length!==this.size&&this._throwError("incorrect data length",r),t.writeBytes(s)}decode(t){return ht(t.readBytes(this.size))}}const CSe=new Uint8Array([]);class kSe extends jl{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(CSe)}decode(e){return e.readBytes(0),null}}const ISe=BigInt(0),ESe=BigInt(1),ASe=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class TSe extends jl{constructor(t,r,s){const i=(r?"int":"uint")+t*8;super(i,i,s,!1);Se(this,"size");Se(this,"signed");Nt(this,{size:t,signed:r},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,r){let s=wt(_s.dereference(r,this.type)),i=gm(ASe,Qs*8);if(this.signed){let o=gm(i,this.size*8-1);(s>o||s<-(o+ESe))&&this._throwError("value out-of-bounds",r),s=f6(s,8*Qs)}else(s<ISe||s>gm(i,this.size*8))&&this._throwError("value out-of-bounds",r);return t.writeValue(s)}decode(t){let r=gm(t.readValue(),this.size*8);return this.signed&&(r=Ibe(r,this.size*8)),r}}class NSe extends eW{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Dl(_s.dereference(t,"string")))}decode(e){return V1(super.decode(e))}}class yx extends jl{constructor(t,r){let s=!1;const i=[];t.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,r,s);Se(this,"coders");Nt(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const r=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||r[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[i]))}),Object.freeze(t)}encode(t,r){const s=_s.dereference(r,"tuple");return J6(t,this.coders,s)}decode(t){return Z6(t,this.coders)}}function ih(n){return Rr(Dl(n))}var $Se="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const _P=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),PP=4;function RSe(n){let e=0;function t(){return n[e++]<<8|n[e++]}let r=t(),s=1,i=[0,1];for(let N=1;N<r;N++)i.push(s+=t());let o=t(),a=e;e+=o;let l=0,u=0;function f(){return l==0&&(u=u<<8|n[e++],l=8),u>>--l&1}const h=31,p=2**h,g=p>>>1,m=g>>1,w=p-1;let x=0;for(let N=0;N<h;N++)x=x<<1|f();let b=[],C=0,$=p;for(;;){let N=Math.floor(((x-C+1)*s-1)/$),_=0,U=r;for(;U-_>1;){let T=_+U>>>1;N<i[T]?U=T:_=T}if(_==0)break;b.push(_);let O=C+Math.floor($*i[_]/s),L=C+Math.floor($*i[_+1]/s)-1;for(;!((O^L)&g);)x=x<<1&w|f(),O=O<<1&w,L=L<<1&w|1;for(;O&~L&m;)x=x&g|x<<1&w>>>1|f(),O=O<<1^g,L=(L^g)<<1|g|1;C=O,$=1+L-O}let k=r-4;return b.map(N=>{switch(N-k){case 3:return k+65792+(n[a++]<<16|n[a++]<<8|n[a++]);case 2:return k+256+(n[a++]<<8|n[a++]);case 1:return k+n[a++];default:return N-1}})}function OSe(n){let e=0;return()=>n[e++]}function tW(n){return OSe(RSe(DSe(n)))}function DSe(n){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let t=n.length,r=new Uint8Array(6*t>>3);for(let s=0,i=0,o=0,a=0;s<t;s++)a=a<<6|e[n.charCodeAt(s)],o+=6,o>=8&&(r[i++]=a>>(o-=8));return r}function _Se(n){return n&1?~n>>1:n>>1}function PSe(n,e){let t=Array(n);for(let r=0,s=0;r<n;r++)t[r]=s+=_Se(e());return t}function Qm(n,e=0){let t=[];for(;;){let r=n(),s=n();if(!s)break;e+=r;for(let i=0;i<s;i++)t.push(e+i);e+=s+1}return t}function nW(n){return Ym(()=>{let e=Qm(n);if(e.length)return e})}function rW(n){let e=[];for(;;){let t=n();if(t==0)break;e.push(FSe(t,n))}for(;;){let t=n()-1;if(t<0)break;e.push(MSe(t,n))}return e.flat()}function Ym(n){let e=[];for(;;){let t=n(e.length);if(!t)break;e.push(t)}return e}function sW(n,e,t){let r=Array(n).fill().map(()=>[]);for(let s=0;s<e;s++)PSe(n,t).forEach((i,o)=>r[o].push(i));return r}function FSe(n,e){let t=1+e(),r=e(),s=Ym(e);return sW(s.length,1+n,e).flatMap((o,a)=>{let[l,...u]=o;return Array(s[a]).fill().map((f,h)=>{let p=h*r;return[l+h*t,u.map(g=>g+p)]})})}function MSe(n,e){let t=1+e();return sW(t,1+n,e).map(s=>[s[0],s.slice(1)])}function LSe(n){let e=[],t=Qm(n);return s(r([]),[]),e;function r(i){let o=n(),a=Ym(()=>{let l=Qm(n).map(u=>t[u]);if(l.length)return r(l)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,l){if(!(i&4&&l===a[a.length-1])){i&2&&(l=a[a.length-1]),i&1&&e.push(a);for(let u of o)for(let f of u.Q)s(u,[...a,f],l)}}}function BSe(n){return n.toString(16).toUpperCase().padStart(2,"0")}function iW(n){return`{${BSe(n)}}`}function zSe(n){let e=[];for(let t=0,r=n.length;t<r;){let s=n.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function Mp(n){let t=n.length;if(t<4096)return String.fromCodePoint(...n);let r=[];for(let s=0;s<t;)r.push(String.fromCodePoint(...n.slice(s,s+=4096)));return r.join("")}function USe(n,e){let t=n.length,r=t-e.length;for(let s=0;r==0&&s<t;s++)r=n[s]-e[s];return r}var VSe="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const Jm=44032,G1=4352,H1=4449,j1=4519,oW=19,aW=21,Lp=28,K1=aW*Lp,WSe=oW*K1,GSe=Jm+WSe,HSe=G1+oW,jSe=H1+aW,KSe=j1+Lp;function ym(n){return n>>24&255}function lW(n){return n&16777215}let HE,FP,jE,Wx;function qSe(){let n=tW(VSe);HE=new Map(nW(n).flatMap((e,t)=>e.map(r=>[r,t+1<<24]))),FP=new Set(Qm(n)),jE=new Map,Wx=new Map;for(let[e,t]of rW(n)){if(!FP.has(e)&&t.length==2){let[r,s]=t,i=Wx.get(r);i||(i=new Map,Wx.set(r,i)),i.set(s,e)}jE.set(e,t.reverse())}}function uW(n){return n>=Jm&&n<GSe}function XSe(n,e){if(n>=G1&&n<HSe&&e>=H1&&e<jSe)return Jm+(n-G1)*K1+(e-H1)*Lp;if(uW(n)&&e>j1&&e<KSe&&(n-Jm)%Lp==0)return n+(e-j1);{let t=Wx.get(n);return t&&(t=t.get(e),t)?t:-1}}function cW(n){HE||qSe();let e=[],t=[],r=!1;function s(i){let o=HE.get(i);o&&(r=!0,i|=o),e.push(i)}for(let i of n)for(;;){if(i<128)e.push(i);else if(uW(i)){let o=i-Jm,a=o/K1|0,l=o%K1/Lp|0,u=o%Lp;s(G1+a),s(H1+l),u>0&&s(j1+u)}else{let o=jE.get(i);o?t.push(...o):s(i)}if(!t.length)break;i=t.pop()}if(r&&e.length>1){let i=ym(e[0]);for(let o=1;o<e.length;o++){let a=ym(e[o]);if(a==0||i<=a){i=a;continue}let l=o-1;for(;;){let u=e[l+1];if(e[l+1]=e[l],e[l]=u,!l||(i=ym(e[--l]),i<=a))break}i=ym(e[o])}}return e}function QSe(n){let e=[],t=[],r=-1,s=0;for(let i of n){let o=ym(i),a=lW(i);if(r==-1)o==0?r=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(r,...t),t.length=0,r=a):t.push(a),s=o;else{let l=XSe(r,a);l>=0?r=l:s==0&&o==0?(e.push(r),r=a):(t.push(a),s=o)}}return r>=0&&e.push(r,...t),e}function fW(n){return cW(n).map(lW)}function YSe(n){return QSe(cW(n))}const MP=45,hW=".",dW=65039,pW=1,q1=n=>Array.from(n);function Zm(n,e){return n.P.has(e)||n.Q.has(e)}class JSe extends Array{get is_emoji(){return!0}}let KE,gW,of,qE,mW,Rd,Wk,dd,Kc,LP,XE;function LN(){if(KE)return;let n=tW($Se);const e=()=>Qm(n),t=()=>new Set(e()),r=(f,h)=>h.forEach(p=>f.add(p));KE=new Map(rW(n)),gW=t(),of=e(),qE=new Set(e().map(f=>of[f])),of=new Set(of),mW=t(),t();let s=nW(n),i=n();const o=()=>{let f=new Set;return e().forEach(h=>r(f,s[h])),r(f,e()),f};Rd=Ym(f=>{let h=Ym(n).map(p=>p+96);if(h.length){let p=f>=i;h[0]-=32,h=Mp(h),p&&(h=`Restricted[${h}]`);let g=o(),m=o(),w=!n();return{N:h,P:g,Q:m,M:w,R:p}}}),Wk=t(),dd=new Map;let a=e().concat(q1(Wk)).sort((f,h)=>f-h);a.forEach((f,h)=>{let p=n(),g=a[h]=p?a[h-p]:{V:[],M:new Map};g.V.push(f),Wk.has(f)||dd.set(f,g)});for(let{V:f,M:h}of new Set(dd.values())){let p=[];for(let m of f){let w=Rd.filter(b=>Zm(b,m)),x=p.find(({G:b})=>w.some(C=>b.has(C)));x||(x={G:new Set,V:[]},p.push(x)),x.V.push(m),r(x.G,w)}let g=p.flatMap(m=>q1(m.G));for(let{G:m,V:w}of p){let x=new Set(g.filter(b=>!m.has(b)));for(let b of w)h.set(b,x)}}Kc=new Set;let l=new Set;const u=f=>Kc.has(f)?l.add(f):Kc.add(f);for(let f of Rd){for(let h of f.P)u(h);for(let h of f.Q)u(h)}for(let f of Kc)!dd.has(f)&&!l.has(f)&&dd.set(f,pW);r(Kc,fW(Kc)),LP=LSe(n).map(f=>JSe.from(f)).sort(USe),XE=new Map;for(let f of LP){let h=[XE];for(let p of f){let g=h.map(m=>{let w=m.get(p);return w||(w=new Map,m.set(p,w)),w});p===dW?h.push(...g):h=g}for(let p of h)p.V=f}}function BN(n){return(yW(n)?"":`${zN(fS([n]))} `)+iW(n)}function zN(n){return`"${n}"`}function ZSe(n){if(n.length>=4&&n[2]==MP&&n[3]==MP)throw new Error(`invalid label extension: "${Mp(n.slice(0,4))}"`)}function eCe(n){for(let t=n.lastIndexOf(95);t>0;)if(n[--t]!==95)throw new Error("underscore allowed only at start")}function tCe(n){let e=n[0],t=_P.get(e);if(t)throw Tm(`leading ${t}`);let r=n.length,s=-1;for(let i=1;i<r;i++){e=n[i];let o=_P.get(e);if(o){if(s==i)throw Tm(`${t} + ${o}`);s=i+1,t=o}}if(s==r)throw Tm(`trailing ${t}`)}function fS(n,e=1/0,t=iW){let r=[];nCe(n[0])&&r.push(""),n.length>e&&(e>>=1,n=[...n.slice(0,e),8230,...n.slice(-e)]);let s=0,i=n.length;for(let o=0;o<i;o++){let a=n[o];yW(a)&&(r.push(Mp(n.slice(s,o))),r.push(t(a)),s=o+1)}return r.push(Mp(n.slice(s,i))),r.join("")}function nCe(n){return LN(),of.has(n)}function yW(n){return LN(),mW.has(n)}function rCe(n){return aCe(sCe(n,YSe,cCe))}function sCe(n,e,t){if(!n)return[];LN();let r=0;return n.split(hW).map(s=>{let i=zSe(s),o={input:i,offset:r};r+=i.length+1;try{let a=o.tokens=uCe(i,e,t),l=a.length,u;if(!l)throw new Error("empty label");let f=o.output=a.flat();if(eCe(f),!(o.emoji=l>1||a[0].is_emoji)&&f.every(p=>p<128))ZSe(f),u="ASCII";else{let p=a.flatMap(g=>g.is_emoji?[]:g);if(!p.length)u="Emoji";else{if(of.has(f[0]))throw Tm("leading combining mark");for(let w=1;w<l;w++){let x=a[w];if(!x.is_emoji&&of.has(x[0]))throw Tm(`emoji + combining mark: "${Mp(a[w-1])} + ${fS([x[0]])}"`)}tCe(f);let g=q1(new Set(p)),[m]=oCe(g);lCe(m,p),iCe(m,g),u=m.N}}o.type=u}catch(a){o.error=a}return o})}function iCe(n,e){let t,r=[];for(let s of e){let i=dd.get(s);if(i===pW)return;if(i){let o=i.M.get(s);if(t=t?t.filter(a=>o.has(a)):q1(o),!t.length)return}else r.push(s)}if(t){for(let s of t)if(r.every(i=>Zm(s,i)))throw new Error(`whole-script confusable: ${n.N}/${s.N}`)}}function oCe(n){let e=Rd;for(let t of n){let r=e.filter(s=>Zm(s,t));if(!r.length)throw Rd.some(s=>Zm(s,t))?xW(e[0],t):wW(t);if(e=r,r.length==1)break}return e}function aCe(n){return n.map(({input:e,error:t,output:r})=>{if(t){let s=t.message;throw new Error(n.length==1?s:`Invalid label ${zN(fS(e,63))}: ${s}`)}return Mp(r)}).join(hW)}function wW(n){return new Error(`disallowed character: ${BN(n)}`)}function xW(n,e){let t=BN(e),r=Rd.find(s=>s.P.has(e));return r&&(t=`${r.N} ${t}`),new Error(`illegal mixture: ${n.N} + ${t}`)}function Tm(n){return new Error(`illegal placement: ${n}`)}function lCe(n,e){for(let t of e)if(!Zm(n,t))throw xW(n,t);if(n.M){let t=fW(e);for(let r=1,s=t.length;r<s;r++)if(qE.has(t[r])){let i=r+1;for(let o;i<s&&qE.has(o=t[i]);i++)for(let a=r;a<i;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${BN(o)}`);if(i-r>PP)throw new Error(`excessive non-spacing marks: ${zN(fS(t.slice(r-1,i)))} (${i-r}/${PP})`);r=i}}}function uCe(n,e,t){let r=[],s=[];for(n=n.slice().reverse();n.length;){let i=fCe(n);if(i)s.length&&(r.push(e(s)),s=[]),r.push(t(i));else{let o=n.pop();if(Kc.has(o))s.push(o);else{let a=KE.get(o);if(a)s.push(...a);else if(!gW.has(o))throw wW(o)}}}return s.length&&r.push(e(s)),r}function cCe(n){return n.filter(e=>e!=dW)}function fCe(n,e){let t=XE,r,s=n.length;for(;s&&(t=t.get(n[--s]),!!t);){let{V:i}=t;i&&(r=i,n.length=s)}return r}const bW=new Uint8Array(32);bW.fill(0);function BP(n){return we(n.length!==0,"invalid ENS name; empty component","comp",n),n}function vW(n){const e=Dl(hCe(n)),t=[];if(n.length===0)return t;let r=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(BP(e.slice(r,s))),r=s+1);return we(r<e.length,"invalid ENS name; empty component","name",n),t.push(BP(e.slice(r))),t}function hCe(n){try{if(n.length===0)throw new Error("empty label");return rCe(n)}catch(e){we(!1,`invalid ENS name (${e.message})`,"name",n)}}function QE(n){we(typeof n=="string","invalid ENS name; not a string","name",n),we(n.length,"invalid ENS name (empty label)","name",n);let e=bW;const t=vW(n);for(;t.length;)e=Rr(kr([e,Rr(t.pop())]));return ht(e)}function dCe(n,e){const t=e;return we(t<=255,"DNS encoded label cannot exceed 255","length",t),ht(kr(vW(n).map(r=>{we(r.length<=t,`label ${JSON.stringify(n)} exceeds ${t} bytes`,"name",n);const s=new Uint8Array(r.length+1);return s.set(r,1),s[0]=s.length-1,s})))+"00"}function Gk(n,e){return{address:Cn(n),storageKeys:e.map((t,r)=>(we(zn(t,32),"invalid slot",`storageKeys[${r}]`,t),t.toLowerCase()))}}function Ch(n){if(Array.isArray(n))return n.map((t,r)=>Array.isArray(t)?(we(t.length===2,"invalid slot set",`value[${r}]`,t),Gk(t[0],t[1])):(we(t!=null&&typeof t=="object","invalid address-slot set","value",n),Gk(t.address,t.storageKeys)));we(n!=null&&typeof n=="object","invalid access list","value",n);const e=Object.keys(n).map(t=>{const r=n[t].reduce((s,i)=>(s[i]=!0,s),{});return Gk(t,Object.keys(r).sort())});return e.sort((t,r)=>t.address.localeCompare(r.address)),e}function pCe(n){let e;return typeof n=="string"?e=Xm.computePublicKey(n,!1):e=n.publicKey,Cn(Rr("0x"+e.substring(4)).substring(26))}function gCe(n,e){return pCe(Xm.recoverPublicKey(n,e))}const Yr=BigInt(0),mCe=BigInt(2),yCe=BigInt(27),wCe=BigInt(28),xCe=BigInt(35),bCe=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Hk=4096*32;function zP(n,e){let t=n.toString(16);for(;t.length<2;)t="0"+t;return t+=cg(e).substring(4),"0x"+t}function hS(n){return n==="0x"?null:Cn(n)}function UN(n,e){try{return Ch(n)}catch(t){we(!1,t.message,e,n)}}function zy(n,e){return n==="0x"?0:jt(n,e)}function Sr(n,e){if(n==="0x")return Yr;const t=wt(n,e);return we(t<=bCe,"value exceeds uint size",e,t),t}function Hn(n,e){const t=wt(n,"value"),r=Xs(t);return we(r.length<=32,"value too large",`tx.${e}`,t),r}function VN(n){return Ch(n).map(e=>[e.address,e.storageKeys])}function vCe(n,e){we(Array.isArray(n),`invalid ${e}`,"value",n);for(let t=0;t<n.length;t++)we(zn(n[t],32),"invalid ${ param } hash",`value[${t}]`,n[t]);return n}function SCe(n){const e=aS(n);we(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",n);const t={type:0,nonce:zy(e[0],"nonce"),gasPrice:Sr(e[1],"gasPrice"),gasLimit:Sr(e[2],"gasLimit"),to:hS(e[3]),value:Sr(e[4],"value"),data:ht(e[5]),chainId:Yr};if(e.length===6)return t;const r=Sr(e[6],"v"),s=Sr(e[7],"r"),i=Sr(e[8],"s");if(s===Yr&&i===Yr)t.chainId=r;else{let o=(r-xCe)/mCe;o<Yr&&(o=Yr),t.chainId=o,we(o!==Yr||r===yCe||r===wCe,"non-canonical legacy v","v",e[6]),t.signature=Jo.from({r:rh(e[7],32),s:rh(e[8],32),v:r})}return t}function CCe(n,e){const t=[Hn(n.nonce,"nonce"),Hn(n.gasPrice||0,"gasPrice"),Hn(n.gasLimit,"gasLimit"),n.to||"0x",Hn(n.value,"value"),n.data];let r=Yr;if(n.chainId!=Yr)r=wt(n.chainId,"tx.chainId"),we(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(n.signature){const i=n.signature.legacyChainId;i!=null&&(r=i)}if(!e)return r!==Yr&&(t.push(Xs(r)),t.push("0x"),t.push("0x")),sh(t);let s=BigInt(27+e.yParity);return r!==Yr?s=Jo.getChainIdV(r,e.v):BigInt(e.v)!==s&&we(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(Xs(s)),t.push(Xs(e.r)),t.push(Xs(e.s)),sh(t)}function WN(n,e){let t;try{if(t=zy(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{we(!1,"invalid yParity","yParity",e[0])}const r=rh(e[1],32),s=rh(e[2],32),i=Jo.from({r,s,yParity:t});n.signature=i}function kCe(n){const e=aS(tn(n).slice(1));we(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",ht(n));const t={type:2,chainId:Sr(e[0],"chainId"),nonce:zy(e[1],"nonce"),maxPriorityFeePerGas:Sr(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Sr(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Sr(e[4],"gasLimit"),to:hS(e[5]),value:Sr(e[6],"value"),data:ht(e[7]),accessList:UN(e[8],"accessList")};return e.length===9||WN(t,e.slice(9)),t}function ICe(n,e){const t=[Hn(n.chainId,"chainId"),Hn(n.nonce,"nonce"),Hn(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Hn(n.maxFeePerGas||0,"maxFeePerGas"),Hn(n.gasLimit,"gasLimit"),n.to||"0x",Hn(n.value,"value"),n.data,VN(n.accessList||[])];return e&&(t.push(Hn(e.yParity,"yParity")),t.push(Xs(e.r)),t.push(Xs(e.s))),kr(["0x02",sh(t)])}function ECe(n){const e=aS(tn(n).slice(1));we(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",ht(n));const t={type:1,chainId:Sr(e[0],"chainId"),nonce:zy(e[1],"nonce"),gasPrice:Sr(e[2],"gasPrice"),gasLimit:Sr(e[3],"gasLimit"),to:hS(e[4]),value:Sr(e[5],"value"),data:ht(e[6]),accessList:UN(e[7],"accessList")};return e.length===8||WN(t,e.slice(8)),t}function ACe(n,e){const t=[Hn(n.chainId,"chainId"),Hn(n.nonce,"nonce"),Hn(n.gasPrice||0,"gasPrice"),Hn(n.gasLimit,"gasLimit"),n.to||"0x",Hn(n.value,"value"),n.data,VN(n.accessList||[])];return e&&(t.push(Hn(e.yParity,"recoveryParam")),t.push(Xs(e.r)),t.push(Xs(e.s))),kr(["0x01",sh(t)])}function TCe(n){let e=aS(tn(n).slice(1)),t="3",r=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const i=e[1],o=e[2],a=e[3];we(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),we(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),we(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),we(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),we(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),r=[];for(let l=0;l<e[1].length;l++)r.push({data:i[l],commitment:o[l],proof:a[l]});e=e[0]}we(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",ht(n));const s={type:3,chainId:Sr(e[0],"chainId"),nonce:zy(e[1],"nonce"),maxPriorityFeePerGas:Sr(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Sr(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Sr(e[4],"gasLimit"),to:hS(e[5]),value:Sr(e[6],"value"),data:ht(e[7]),accessList:UN(e[8],"accessList"),maxFeePerBlobGas:Sr(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};r&&(s.blobs=r),we(s.to!=null,`invalid address for transaction type: ${t}`,"data",n),we(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",n);for(let i=0;i<s.blobVersionedHashes.length;i++)we(zn(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",n);return e.length===11||WN(s,e.slice(11)),s}function NCe(n,e,t){const r=[Hn(n.chainId,"chainId"),Hn(n.nonce,"nonce"),Hn(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Hn(n.maxFeePerGas||0,"maxFeePerGas"),Hn(n.gasLimit,"gasLimit"),n.to||qm,Hn(n.value,"value"),n.data,VN(n.accessList||[]),Hn(n.maxFeePerBlobGas||0,"maxFeePerBlobGas"),vCe(n.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(r.push(Hn(e.yParity,"yParity")),r.push(Xs(e.r)),r.push(Xs(e.s)),t)?kr(["0x03",sh([r,t.map(s=>s.data),t.map(s=>s.commitment),t.map(s=>s.proof)])]):kr(["0x03",sh(r)])}var xa,Hd,jd,Kd,qd,Xd,Qd,Yd,Jd,Zd,ep,tp,bf,Tu,vl,Nu,np,Gx;const pl=class pl{constructor(){_e(this,np);_e(this,xa);_e(this,Hd);_e(this,jd);_e(this,Kd);_e(this,qd);_e(this,Xd);_e(this,Qd);_e(this,Yd);_e(this,Jd);_e(this,Zd);_e(this,ep);_e(this,tp);_e(this,bf);_e(this,Tu);_e(this,vl);_e(this,Nu);se(this,xa,null),se(this,Hd,null),se(this,Kd,0),se(this,qd,Yr),se(this,Xd,null),se(this,Qd,null),se(this,Yd,null),se(this,jd,"0x"),se(this,Jd,Yr),se(this,Zd,Yr),se(this,ep,null),se(this,tp,null),se(this,bf,null),se(this,Tu,null),se(this,Nu,null),se(this,vl,null)}get type(){return Y(this,xa)}set type(e){switch(e){case null:se(this,xa,null);break;case 0:case"legacy":se(this,xa,0);break;case 1:case"berlin":case"eip-2930":se(this,xa,1);break;case 2:case"london":case"eip-1559":se(this,xa,2);break;case 3:case"cancun":case"eip-4844":se(this,xa,3);break;default:we(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844"}return null}get to(){const e=Y(this,Hd);return e==null&&this.type===3?qm:e}set to(e){se(this,Hd,e==null?null:Cn(e))}get nonce(){return Y(this,Kd)}set nonce(e){se(this,Kd,jt(e,"value"))}get gasLimit(){return Y(this,qd)}set gasLimit(e){se(this,qd,wt(e))}get gasPrice(){const e=Y(this,Xd);return e==null&&(this.type===0||this.type===1)?Yr:e}set gasPrice(e){se(this,Xd,e==null?null:wt(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=Y(this,Qd);return e??(this.type===2||this.type===3?Yr:null)}set maxPriorityFeePerGas(e){se(this,Qd,e==null?null:wt(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=Y(this,Yd);return e??(this.type===2||this.type===3?Yr:null)}set maxFeePerGas(e){se(this,Yd,e==null?null:wt(e,"maxFeePerGas"))}get data(){return Y(this,jd)}set data(e){se(this,jd,ht(e))}get value(){return Y(this,Jd)}set value(e){se(this,Jd,wt(e,"value"))}get chainId(){return Y(this,Zd)}set chainId(e){se(this,Zd,wt(e))}get signature(){return Y(this,ep)||null}set signature(e){se(this,ep,e==null?null:Jo.from(e))}get accessList(){const e=Y(this,tp)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){se(this,tp,e==null?null:Ch(e))}get maxFeePerBlobGas(){const e=Y(this,bf);return e==null&&this.type===3?Yr:e}set maxFeePerBlobGas(e){se(this,bf,e==null?null:wt(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=Y(this,Tu);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){we(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)we(zn(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}se(this,Tu,e)}get blobs(){return Y(this,Nu)==null?null:Y(this,Nu).map(e=>Object.assign({},e))}set blobs(e){if(e==null){se(this,Nu,null);return}const t=[],r=[];for(let s=0;s<e.length;s++){const i=e[s];if(AN(i)){je(Y(this,vl),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=tn(i);if(we(o.length<=Hk,"blob is too large",`blobs[${s}]`,i),o.length!==Hk){const u=new Uint8Array(Hk);u.set(o),o=u}const a=Y(this,vl).blobToKzgCommitment(o),l=ht(Y(this,vl).computeBlobKzgProof(o,a));t.push({data:ht(o),commitment:ht(a),proof:l}),r.push(zP(1,a))}else{const o=ht(i.commitment);t.push({data:ht(i.data),commitment:o,proof:ht(i.proof)}),r.push(zP(1,o))}}se(this,Nu,t),se(this,Tu,r)}get kzg(){return Y(this,vl)}set kzg(e){se(this,vl,e)}get hash(){return this.signature==null?null:Rr(rt(this,np,Gx).call(this,!0,!1))}get unsignedHash(){return Rr(this.unsignedSerialized)}get from(){return this.signature==null?null:gCe(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Xm.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return rt(this,np,Gx).call(this,!0,!0)}get unsignedSerialized(){return rt(this,np,Gx).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,s=Y(this,bf)!=null||Y(this,Tu);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&je(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),je(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),je(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):t?i.push(2):e?(i.push(1),r||i.push(0)):r?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return pl.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new pl;if(typeof e=="string"){const r=tn(e);if(r[0]>=127)return pl.from(SCe(r));switch(r[0]){case 1:return pl.from(ECe(r));case 2:return pl.from(kCe(r));case 3:return pl.from(TCe(r))}je(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new pl;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=Jo.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(we(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),we(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(we(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),we(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};xa=new WeakMap,Hd=new WeakMap,jd=new WeakMap,Kd=new WeakMap,qd=new WeakMap,Xd=new WeakMap,Qd=new WeakMap,Yd=new WeakMap,Jd=new WeakMap,Zd=new WeakMap,ep=new WeakMap,tp=new WeakMap,bf=new WeakMap,Tu=new WeakMap,vl=new WeakMap,Nu=new WeakMap,np=new WeakSet,Gx=function(e,t){je(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=e?this.signature:null;switch(this.inferType()){case 0:return CCe(this,r);case 1:return ACe(this,r);case 2:return ICe(this,r);case 3:return NCe(this,r,t?this.blobs:null)}je(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let X1=pl;const SW=new Uint8Array(32);SW.fill(0);const $Ce=BigInt(-1),CW=BigInt(0),kW=BigInt(1),RCe=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function OCe(n){const e=tn(n),t=e.length%32;return t?kr([e,SW.slice(t)]):ht(e)}const DCe=sc(kW,32),_Ce=sc(CW,32),UP={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},jk=["name","version","chainId","verifyingContract","salt"];function VP(n){return function(e){return we(typeof e=="string",`invalid domain value for ${JSON.stringify(n)}`,`domain.${n}`,e),e}}const PCe={name:VP("name"),version:VP("version"),chainId:function(n){const e=wt(n,"domain.chainId");return we(e>=0,"invalid chain ID","domain.chainId",n),Number.isSafeInteger(e)?Number(e):yd(e)},verifyingContract:function(n){try{return Cn(n).toLowerCase()}catch{}we(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",n)},salt:function(n){const e=tn(n,"domain.salt");return we(e.length===32,'invalid domain value "salt"',"domain.salt",n),ht(e)}};function Kk(n){{const e=n.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",r=parseInt(e[2]);we(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",n);const s=gm(RCe,t?r-1:r),i=t?(s+kW)*$Ce:CW;return function(o){const a=wt(o,"value");return we(a>=i&&a<=s,`value out-of-bounds for ${n}`,"value",a),sc(t?f6(a,256):a,32)}}}{const e=n.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return we(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",n),function(r){const s=tn(r);return we(s.length===t,`invalid length for ${n}`,"value",r),OCe(r)}}}switch(n){case"address":return function(e){return rh(Cn(e),32)};case"bool":return function(e){return e?DCe:_Ce};case"bytes":return function(e){return Rr(e)};case"string":return function(e){return ih(e)}}return null}function WP(n,e){return`${n}(${e.map(({name:t,type:r})=>r+" "+t).join(",")})`}function wx(n){const e=n.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:n}}var a0,Sl,rp,ib,IW;const eo=class eo{constructor(e){_e(this,ib);Se(this,"primaryType");_e(this,a0);_e(this,Sl);_e(this,rp);se(this,Sl,new Map),se(this,rp,new Map);const t=new Map,r=new Map,s=new Map,i={};Object.keys(e).forEach(l=>{i[l]=e[l].map(({name:u,type:f})=>{let{base:h,index:p}=wx(f);return h==="int"&&!e.int&&(h="int256"),h==="uint"&&!e.uint&&(h="uint256"),{name:u,type:h+(p||"")}}),t.set(l,new Set),r.set(l,[]),s.set(l,new Set)}),se(this,a0,JSON.stringify(i));for(const l in i){const u=new Set;for(const f of i[l]){we(!u.has(f.name),`duplicate variable name ${JSON.stringify(f.name)} in ${JSON.stringify(l)}`,"types",e),u.add(f.name);const h=wx(f.type).base;we(h!==l,`circular type reference to ${JSON.stringify(h)}`,"types",e),!Kk(h)&&(we(r.has(h),`unknown type ${JSON.stringify(h)}`,"types",e),r.get(h).push(l),t.get(l).add(h))}}const o=Array.from(r.keys()).filter(l=>r.get(l).length===0);we(o.length!==0,"missing primary type","types",e),we(o.length===1,`ambiguous primary types or unused types: ${o.map(l=>JSON.stringify(l)).join(", ")}`,"types",e),Nt(this,{primaryType:o[0]});function a(l,u){we(!u.has(l),`circular type reference to ${JSON.stringify(l)}`,"types",e),u.add(l);for(const f of t.get(l))if(r.has(f)){a(f,u);for(const h of u)s.get(h).add(f)}u.delete(l)}a(this.primaryType,new Set);for(const[l,u]of s){const f=Array.from(u);f.sort(),Y(this,Sl).set(l,WP(l,i[l])+f.map(h=>WP(h,i[h])).join(""))}}get types(){return JSON.parse(Y(this,a0))}getEncoder(e){let t=Y(this,rp).get(e);return t||(t=rt(this,ib,IW).call(this,e),Y(this,rp).set(e,t)),t}encodeType(e){const t=Y(this,Sl).get(e);return we(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return Rr(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,r){if(Kk(e))return r(e,t);const s=wx(e).array;if(s)return we(s.count===-1||s.count===t.length,`array length mismatch; expected length ${s.count}`,"value",t),t.map(o=>this._visit(s.prefix,o,r));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:l})=>(o[a]=this._visit(l,t[a],r),o),{});we(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new eo(e)}static getPrimaryType(e){return eo.from(e).primaryType}static hashStruct(e,t,r){return eo.from(t).hashStruct(e,r)}static hashDomain(e){const t=[];for(const r in e){if(e[r]==null)continue;const s=UP[r];we(s,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),t.push({name:r,type:s})}return t.sort((r,s)=>jk.indexOf(r.name)-jk.indexOf(s.name)),eo.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,r){return kr(["0x1901",eo.hashDomain(e),eo.from(t).hash(r)])}static hash(e,t,r){return Rr(eo.encode(e,t,r))}static async resolveNames(e,t,r,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!zn(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=eo.from(t);o.visit(r,(a,l)=>(a==="address"&&!zn(l,20)&&(i[l]="0x"),l));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),r=o.visit(r,(a,l)=>a==="address"&&i[l]?i[l]:l),{domain:e,value:r}}static getPayload(e,t,r){eo.hashDomain(e);const s={},i=[];jk.forEach(l=>{const u=e[l];u!=null&&(s[l]=PCe[l](u),i.push({name:l,type:UP[l]}))});const o=eo.from(t);t=o.types;const a=Object.assign({},t);return we(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=i,o.encode(r),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(r,(l,u)=>{if(l.match(/^bytes(\d*)/))return ht(tn(u));if(l.match(/^u?int/))return wt(u).toString();switch(l){case"address":return u.toLowerCase();case"bool":return!!u;case"string":return we(typeof u=="string","invalid string","value",u),u}we(!1,"unsupported type","type",l)})}}};a0=new WeakMap,Sl=new WeakMap,rp=new WeakMap,ib=new WeakSet,IW=function(e){{const s=Kk(e);if(s)return s}const t=wx(e).array;if(t){const s=t.prefix,i=this.getEncoder(s);return o=>{we(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(i);return Y(this,Sl).has(s)&&(a=a.map(Rr)),Rr(kr(a))}}const r=this.types[e];if(r){const s=ih(Y(this,Sl).get(e));return i=>{const o=r.map(({name:a,type:l})=>{const u=this.getEncoder(l)(i[a]);return Y(this,Sl).has(l)?Rr(u):u});return o.unshift(s),kr(o)}}we(!1,`unknown type: ${e}`,"type",e)};let Q1=eo;function Js(n){const e=new Set;return n.forEach(t=>e.add(t)),Object.freeze(e)}const FCe="external public payable override",MCe=Js(FCe.split(" ")),EW="constant external internal payable private public pure view override",LCe=Js(EW.split(" ")),AW="constructor error event fallback function receive struct",TW=Js(AW.split(" ")),NW="calldata memory storage payable indexed",BCe=Js(NW.split(" ")),zCe="tuple returns",UCe=[AW,NW,zCe,EW].join(" "),VCe=Js(UCe.split(" ")),WCe={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},GCe=new RegExp("^(\\s*)"),HCe=new RegExp("^([0-9]+)"),jCe=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),$W=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),RW=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var as,Bo,l0,YE;const ob=class ob{constructor(e){_e(this,l0);_e(this,as);_e(this,Bo);se(this,as,0),se(this,Bo,e.slice())}get offset(){return Y(this,as)}get length(){return Y(this,Bo).length-Y(this,as)}clone(){return new ob(Y(this,Bo))}reset(){se(this,as,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=rt(this,l0,YE).call(this,Y(this,as)+1,e.match+1);return se(this,as,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;Y(this,as)<e.match-1;){const r=this.peek().linkNext;t.push(rt(this,l0,YE).call(this,Y(this,as)+1,r)),se(this,as,r)}return se(this,as,e.match+1),t}peek(){if(Y(this,as)>=Y(this,Bo).length)throw new Error("out-of-bounds");return Y(this,Bo)[Y(this,as)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return Gg(this,as)._++,e}toString(){const e=[];for(let t=Y(this,as);t<Y(this,Bo).length;t++){const r=Y(this,Bo)[t];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}};as=new WeakMap,Bo=new WeakMap,l0=new WeakSet,YE=function(e=0,t=0){return new ob(Y(this,Bo).slice(e,t).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))};let Zo=ob;function wc(n){const e=[],t=o=>{const a=i<n.length?JSON.stringify(n[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let r=[],s=[],i=0;for(;i<n.length;){let o=n.substring(i),a=o.match(GCe);a&&(i+=a[1].length,o=n.substring(i));const l={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(l);let u=WCe[o[0]]||"";if(u){if(l.type=u,l.text=o[0],i++,u==="OPEN_PAREN")r.push(e.length-1),s.push(e.length-1);else if(u=="CLOSE_PAREN")r.length===0&&t("no matching open bracket"),l.match=r.pop(),e[l.match].match=e.length-1,l.depth--,l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1;else if(u==="COMMA")l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(u==="OPEN_BRACKET")l.type="BRACKET";else if(u==="CLOSE_BRACKET"){let f=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;f=h+f,e[e.length-1].value=jt(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=f}continue}if(a=o.match(jCe),a){if(l.text=a[1],i+=l.text.length,VCe.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(RW)){l.type="TYPE";continue}l.type="ID";continue}if(a=o.match(HCe),a){l.text=a[1],l.type="NUMBER",i+=l.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new Zo(e.map(o=>Object.freeze(o)))}function GP(n,e){let t=[];for(const r in e.keys())n.has(r)&&t.push(r);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function dS(n,e){if(e.peekKeyword(TW)){const t=e.pop().text;if(t!==n)throw new Error(`expected ${n}, got ${t}`)}return e.popType("ID")}function Ul(n,e){const t=new Set;for(;;){const r=n.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(n.pop(),t.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);t.add(r)}return Object.freeze(t)}function OW(n){let e=Ul(n,LCe);return GP(e,Js("constant payable nonpayable".split(" "))),GP(e,Js("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function _l(n,e){return n.popParams().map(t=>fs.from(t,e))}function DW(n){if(n.peekType("AT")){if(n.pop(),n.peekType("NUMBER"))return wt(n.pop().text);throw new Error("invalid gas")}return null}function oh(n){if(n.length)throw new Error(`unexpected tokens at offset ${n.offset}: ${n.toString()}`)}const KCe=new RegExp(/^(.*)\[([0-9]*)\]$/);function HP(n){const e=n.match(RW);if(we(e,"invalid type","type",n),n==="uint")return"uint256";if(n==="int")return"int256";if(e[2]){const t=parseInt(e[2]);we(t!==0&&t<=32,"invalid bytes length","type",n)}else if(e[3]){const t=parseInt(e[3]);we(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",n)}return n}const rr={},Ci=Symbol.for("_ethers_internal"),jP="_ParamTypeInternal",KP="_ErrorInternal",qP="_EventInternal",XP="_ConstructorInternal",QP="_FallbackInternal",YP="_FunctionInternal",JP="_StructInternal";var sp,Hx;const to=class to{constructor(e,t,r,s,i,o,a,l){_e(this,sp);Se(this,"name");Se(this,"type");Se(this,"baseType");Se(this,"indexed");Se(this,"components");Se(this,"arrayLength");Se(this,"arrayChildren");if(sS(e,rr,"ParamType"),Object.defineProperty(this,Ci,{value:jP}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||l==null)throw new Error("")}else if(a!=null||l!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");Nt(this,{name:t,type:r,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:l})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=r,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(s=>r.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((s,i)=>r.components[i].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const r=[],s=[e];return rt(this,sp,Hx).call(this,r,e,t,i=>{s[0]=i}),r.length&&await Promise.all(r),s[0]}static from(e,t){if(to.isParamType(e))return e;if(typeof e=="string")try{return to.from(wc(e),t)}catch{we(!1,"invalid param type","obj",e)}else if(e instanceof Zo){let a="",l="",u=null;Ul(e,Js(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(l="tuple",u=e.popParams().map(w=>to.from(w)),a=`tuple(${u.map(w=>w.format()).join(",")})`):(a=HP(e.popType("TYPE")),l=a);let f=null,h=null;for(;e.length&&e.peekType("BRACKET");){const w=e.pop();f=new to(rr,"",a,l,null,u,h,f),h=w.value,a+=w.text,l="array",u=null}let p=null;if(Ul(e,BCe).has("indexed")){if(!t)throw new Error("");p=!0}const m=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new to(rr,m,a,l,p,u,h,f)}const r=e.name;we(!r||typeof r=="string"&&r.match($W),"invalid name","obj.name",r);let s=e.indexed;s!=null&&(we(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(KCe);if(o){const a=parseInt(o[2]||"-1"),l=to.from({type:o[1],components:e.components});return new to(rr,r||"",i,"array",s,null,a,l)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(u=>to.from(u)):null;return new to(rr,r||"",i,"tuple",s,a,null,null)}return i=HP(e.type),new to(rr,r||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[Ci]===jP}};sp=new WeakSet,Hx=function(e,t,r,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((l,u)=>{var f;rt(f=o,sp,Hx).call(f,e,l,r,h=>{a[u]=h})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(l=>{if(!l.name)throw new Error("cannot use object value with unnamed components");if(!(l.name in t))throw new Error(`missing value for component ${l.name}`);return t[l.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((l,u)=>{var f;rt(f=o[u],sp,Hx).call(f,e,l,r,h=>{a[u]=h})}),s(a);return}const i=r(this.type,t);i.then?e.push(async function(){s(await i)}()):s(i)};let fs=to;class ah{constructor(e,t,r){Se(this,"type");Se(this,"inputs");sS(e,rr,"Fragment"),r=Object.freeze(r.slice()),Nt(this,{type:t,inputs:r})}static from(e){if(typeof e=="string"){try{ah.from(JSON.parse(e))}catch{}return ah.from(wc(e))}if(e instanceof Zo)switch(e.peekKeyword(TW)){case"constructor":return Ol.from(e);case"error":return gi.from(e);case"event":return Da.from(e);case"fallback":case"receive":return ml.from(e);case"function":return _a.from(e);case"struct":return Pf.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Ol.from(e);case"error":return gi.from(e);case"event":return Da.from(e);case"fallback":case"receive":return ml.from(e);case"function":return _a.from(e);case"struct":return Pf.from(e)}je(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}we(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Ol.isFragment(e)}static isError(e){return gi.isFragment(e)}static isEvent(e){return Da.isFragment(e)}static isFunction(e){return _a.isFragment(e)}static isStruct(e){return Pf.isFragment(e)}}class pS extends ah{constructor(t,r,s,i){super(t,r,i);Se(this,"name");we(typeof s=="string"&&s.match($W),"invalid identifier","name",s),i=Object.freeze(i.slice()),Nt(this,{name:s})}}function e0(n,e){return"("+e.map(t=>t.format(n)).join(n==="full"?", ":",")+")"}class gi extends pS{constructor(e,t,r){super(e,"error",t,r),Object.defineProperty(this,Ci,{value:KP})}get selector(){return ih(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+e0(e,this.inputs)),t.join(" ")}static from(e){if(gi.isFragment(e))return e;if(typeof e=="string")return gi.from(wc(e));if(e instanceof Zo){const t=dS("error",e),r=_l(e);return oh(e),new gi(rr,t,r)}return new gi(rr,e.name,e.inputs?e.inputs.map(fs.from):[])}static isFragment(e){return e&&e[Ci]===KP}}class Da extends pS{constructor(t,r,s,i){super(t,"event",r,s);Se(this,"anonymous");Object.defineProperty(this,Ci,{value:qP}),Nt(this,{anonymous:i})}get topicHash(){return ih(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const r=[];return t!=="sighash"&&r.push("event"),r.push(this.name+e0(t,this.inputs)),t!=="sighash"&&this.anonymous&&r.push("anonymous"),r.join(" ")}static getTopicHash(t,r){return r=(r||[]).map(i=>fs.from(i)),new Da(rr,t,r,!1).topicHash}static from(t){if(Da.isFragment(t))return t;if(typeof t=="string")try{return Da.from(wc(t))}catch{we(!1,"invalid event fragment","obj",t)}else if(t instanceof Zo){const r=dS("event",t),s=_l(t,!0),i=!!Ul(t,Js(["anonymous"])).has("anonymous");return oh(t),new Da(rr,r,s,i)}return new Da(rr,t.name,t.inputs?t.inputs.map(r=>fs.from(r,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Ci]===qP}}class Ol extends ah{constructor(t,r,s,i,o){super(t,r,s);Se(this,"payable");Se(this,"gas");Object.defineProperty(this,Ci,{value:XP}),Nt(this,{payable:i,gas:o})}format(t){if(je(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const r=[`constructor${e0(t,this.inputs)}`];return this.payable&&r.push("payable"),this.gas!=null&&r.push(`@${this.gas.toString()}`),r.join(" ")}static from(t){if(Ol.isFragment(t))return t;if(typeof t=="string")try{return Ol.from(wc(t))}catch{we(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof Zo){Ul(t,Js(["constructor"]));const r=_l(t),s=!!Ul(t,MCe).has("payable"),i=DW(t);return oh(t),new Ol(rr,"constructor",r,s,i)}return new Ol(rr,"constructor",t.inputs?t.inputs.map(fs.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ci]===XP}}class ml extends ah{constructor(t,r,s){super(t,"fallback",r);Se(this,"payable");Object.defineProperty(this,Ci,{value:QP}),Nt(this,{payable:s})}format(t){const r=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:r,stateMutability:s})}return`${r}()${this.payable?" payable":""}`}static from(t){if(ml.isFragment(t))return t;if(typeof t=="string")try{return ml.from(wc(t))}catch{we(!1,"invalid fallback fragment","obj",t)}else if(t instanceof Zo){const r=t.toString(),s=t.peekKeyword(Js(["fallback","receive"]));if(we(s,"type must be fallback or receive","obj",r),t.popKeyword(Js(["fallback","receive"]))==="receive"){const l=_l(t);return we(l.length===0,"receive cannot have arguments","obj.inputs",l),Ul(t,Js(["payable"])),oh(t),new ml(rr,[],!0)}let o=_l(t);o.length?we(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(l=>l.format("minimal")).join(", ")):o=[fs.from("bytes")];const a=OW(t);if(we(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),Ul(t,Js(["returns"])).has("returns")){const l=_l(t);we(l.length===1&&l[0].type==="bytes","invalid fallback outputs","obj.outputs",l.map(u=>u.format("minimal")).join(", "))}return oh(t),new ml(rr,o,a==="payable")}if(t.type==="receive")return new ml(rr,[],!0);if(t.type==="fallback"){const r=[fs.from("bytes")],s=t.stateMutability==="payable";return new ml(rr,r,s)}we(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Ci]===QP}}class _a extends pS{constructor(t,r,s,i,o,a){super(t,"function",r,i);Se(this,"constant");Se(this,"outputs");Se(this,"stateMutability");Se(this,"payable");Se(this,"gas");Object.defineProperty(this,Ci,{value:YP}),o=Object.freeze(o.slice()),Nt(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return ih(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const r=[];return t!=="sighash"&&r.push("function"),r.push(this.name+e0(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&r.push(this.stateMutability),this.outputs&&this.outputs.length&&(r.push("returns"),r.push(e0(t,this.outputs))),this.gas!=null&&r.push(`@${this.gas.toString()}`)),r.join(" ")}static getSelector(t,r){return r=(r||[]).map(i=>fs.from(i)),new _a(rr,t,"view",r,[],null).selector}static from(t){if(_a.isFragment(t))return t;if(typeof t=="string")try{return _a.from(wc(t))}catch{we(!1,"invalid function fragment","obj",t)}else if(t instanceof Zo){const s=dS("function",t),i=_l(t),o=OW(t);let a=[];Ul(t,Js(["returns"])).has("returns")&&(a=_l(t));const l=DW(t);return oh(t),new _a(rr,s,o,i,a,l)}let r=t.stateMutability;return r==null&&(r="payable",typeof t.constant=="boolean"?(r="view",t.constant||(r="payable",typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable")),new _a(rr,t.name,r,t.inputs?t.inputs.map(fs.from):[],t.outputs?t.outputs.map(fs.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ci]===YP}}class Pf extends pS{constructor(e,t,r){super(e,"struct",t,r),Object.defineProperty(this,Ci,{value:JP})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Pf.from(wc(e))}catch{we(!1,"invalid struct fragment","obj",e)}else if(e instanceof Zo){const t=dS("struct",e),r=_l(e);return oh(e),new Pf(rr,t,r)}return new Pf(rr,e.name,e.inputs?e.inputs.map(fs.from):[])}static isFragment(e){return e&&e[Ci]===JP}}const ta=new Map;ta.set(0,"GENERIC_PANIC");ta.set(1,"ASSERT_FALSE");ta.set(17,"OVERFLOW");ta.set(18,"DIVIDE_BY_ZERO");ta.set(33,"ENUM_RANGE_ERROR");ta.set(34,"BAD_STORAGE_DATA");ta.set(49,"STACK_UNDERFLOW");ta.set(50,"ARRAY_RANGE_ERROR");ta.set(65,"OUT_OF_MEMORY");ta.set(81,"UNINITIALIZED_FUNCTION_CALL");const qCe=new RegExp(/^bytes([0-9]*)$/),XCe=new RegExp(/^(u?int)([0-9]*)$/);let qk=null,ZP=1024;function QCe(n,e,t,r){let s="missing revert data",i=null;const o=null;let a=null;if(t){s="execution reverted";const u=tn(t);if(t=ht(t),u.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(u.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(ht(u.slice(0,4))==="0x08c379a0")try{i=r.decode(["string"],u.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(ht(u.slice(0,4))==="0x4e487b71")try{const f=Number(r.decode(["uint256"],u.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[f]},i=`Panic due to ${ta.get(f)||"UNKNOWN"}(${f})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const l={to:e.to?Cn(e.to):null,data:e.data||"0x"};return e.from&&(l.from=Cn(e.from)),ur(s,"CALL_EXCEPTION",{action:n,data:t,reason:i,transaction:l,invocation:o,revert:a})}var $u,pd;const ab=class ab{constructor(){_e(this,$u)}getDefaultValue(e){const t=e.map(s=>rt(this,$u,pd).call(this,fs.from(s)));return new yx(t,"_").defaultValue()}encode(e,t){l6(t.length,e.length,"types/values length mismatch");const r=e.map(o=>rt(this,$u,pd).call(this,fs.from(o))),s=new yx(r,"_"),i=new ME;return s.encode(i,t),i.data}decode(e,t,r){const s=e.map(o=>rt(this,$u,pd).call(this,fs.from(o)));return new yx(s,"_").decode(new LE(t,r,ZP))}static _setDefaultMaxInflation(e){we(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),ZP=e}static defaultAbiCoder(){return qk==null&&(qk=new ab),qk}static getBuiltinCallException(e,t,r){return QCe(e,t,r,ab.defaultAbiCoder())}};$u=new WeakSet,pd=function(e){if(e.isArray())return new xSe(rt(this,$u,pd).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new yx(e.components.map(r=>rt(this,$u,pd).call(this,r)),e.name);switch(e.baseType){case"address":return new ySe(e.name);case"bool":return new bSe(e.name);case"string":return new NSe(e.name);case"bytes":return new vSe(e.name);case"":return new kSe(e.name)}let t=e.type.match(XCe);if(t){let r=parseInt(t[2]||"256");return we(r!==0&&r<=256&&r%8===0,"invalid "+t[1]+" bit length","param",e),new TSe(r/8,t[1]==="int",e.name)}if(t=e.type.match(qCe),t){let r=parseInt(t[1]);return we(r!==0&&r<=32,"invalid bytes length","param",e),new SSe(r,e.name)}we(!1,"invalid type","type",e.type)};let t0=ab;class YCe{constructor(e,t,r){Se(this,"fragment");Se(this,"name");Se(this,"signature");Se(this,"topic");Se(this,"args");const s=e.name,i=e.format();Nt(this,{fragment:e,name:s,signature:i,topic:t,args:r})}}class JCe{constructor(e,t,r,s){Se(this,"fragment");Se(this,"name");Se(this,"args");Se(this,"signature");Se(this,"selector");Se(this,"value");const i=e.name,o=e.format();Nt(this,{fragment:e,name:i,args:r,signature:o,selector:t,value:s})}}class ZCe{constructor(e,t,r){Se(this,"fragment");Se(this,"name");Se(this,"args");Se(this,"signature");Se(this,"selector");const s=e.name,i=e.format();Nt(this,{fragment:e,name:s,args:r,signature:i,selector:t})}}class eF{constructor(e){Se(this,"hash");Se(this,"_isIndexed");Nt(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const tF={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},nF={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:n=>`reverted with reason string ${JSON.stringify(n)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:n=>{let e="unknown panic code";return n>=0&&n<=255&&tF[n.toString()]&&(e=tF[n.toString()]),`reverted with panic code 0x${n.toString(16)} (${e})`}}};var ba,va,Sa,As,Ha,jx,Kx;const ef=class ef{constructor(e){_e(this,Ha);Se(this,"fragments");Se(this,"deploy");Se(this,"fallback");Se(this,"receive");_e(this,ba);_e(this,va);_e(this,Sa);_e(this,As);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,se(this,Sa,new Map),se(this,ba,new Map),se(this,va,new Map);const r=[];for(const o of t)try{r.push(ah.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}Nt(this,{fragments:Object.freeze(r)});let s=null,i=!1;se(this,As,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let l;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}Nt(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(we(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":l=Y(this,Sa);break;case"event":l=Y(this,va);break;case"error":l=Y(this,ba);break;default:return}const u=o.format();l.has(u)||l.set(u,o)}),this.deploy||Nt(this,{deploy:Ol.from("constructor()")}),Nt(this,{fallback:s,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return t0.defaultAbiCoder()}getFunctionName(e){const t=rt(this,Ha,jx).call(this,e,null,!1);return we(t,"no matching function","key",e),t.name}hasFunction(e){return!!rt(this,Ha,jx).call(this,e,null,!1)}getFunction(e,t){return rt(this,Ha,jx).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(Y(this,Sa).keys());t.sort((r,s)=>r.localeCompare(s));for(let r=0;r<t.length;r++){const s=t[r];e(Y(this,Sa).get(s),r)}}getEventName(e){const t=rt(this,Ha,Kx).call(this,e,null,!1);return we(t,"no matching event","key",e),t.name}hasEvent(e){return!!rt(this,Ha,Kx).call(this,e,null,!1)}getEvent(e,t){return rt(this,Ha,Kx).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(Y(this,va).keys());t.sort((r,s)=>r.localeCompare(s));for(let r=0;r<t.length;r++){const s=t[r];e(Y(this,va).get(s),r)}}getError(e,t){if(zn(e)){const s=e.toLowerCase();if(nF[s])return gi.from(nF[s].signature);for(const i of Y(this,ba).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of Y(this,ba))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?gi.from("error Error(string)"):e==="Panic"?gi.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");we(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=gi.from(e).format(),e==="Error(string)")return gi.from("error Error(string)");if(e==="Panic(uint256)")return gi.from("error Panic(uint256)");const r=Y(this,ba).get(e);return r||null}forEachError(e){const t=Array.from(Y(this,ba).keys());t.sort((r,s)=>r.localeCompare(s));for(let r=0;r<t.length;r++){const s=t[r];e(Y(this,ba).get(s),r)}}_decodeParams(e,t){return Y(this,As).decode(e,t)}_encodeParams(e,t){return Y(this,As).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);we(r,"unknown error","fragment",e),e=r}return we(cr(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,cr(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);we(r,"unknown error","fragment",e),e=r}return kr([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);we(r,"unknown function","fragment",e),e=r}return we(cr(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,cr(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);we(r,"unknown function","fragment",e),e=r}return kr([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const i=this.getFunction(e);we(i,"unknown function","fragment",e),e=i}let r="invalid length for result data";const s=qs(t);if(s.length%32===0)try{return Y(this,As).decode(e.outputs,s)}catch{r="could not decode result data"}je(!1,r,"BAD_DATA",{value:ht(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const r=tn(e,"data"),s=t0.getBuiltinCallException("call",t,r);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=ht(r.slice(0,4)),l=this.getError(a);if(l)try{const u=Y(this,As).decode(l.inputs,r.slice(4));s.revert={name:l.name,signature:l.format(),args:u},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const r=this.getFunction(e);we(r,"unknown function","fragment",e),e=r}return ht(Y(this,As).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const i=this.getEvent(e);we(i,"unknown event","eventFragment",e),e=i}je(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const s=(i,o)=>i.type==="string"?ih(o):i.type==="bytes"?Rr(ht(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=sc(o):i.type.match(/^bytes/)?o=kbe(o,32):i.type==="address"&&Y(this,As).encode(["address"],[o]),rh(ht(o),32));for(t.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){we(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?r.push(null):a.baseType==="array"||a.baseType==="tuple"?we(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?r.push(i.map(l=>s(a,l))):r.push(s(a,i))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);we(o,"unknown event","eventFragment",e),e=o}const r=[],s=[],i=[];return e.anonymous||r.push(e.topicHash),we(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const l=t[a];if(o.indexed)if(o.type==="string")r.push(ih(l));else if(o.type==="bytes")r.push(Rr(l));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");r.push(Y(this,As).encode([o.type],[l]))}else s.push(o),i.push(l)}),{data:Y(this,As).encode(s,i),topics:r}}decodeEventLog(e,t,r){if(typeof e=="string"){const g=this.getEvent(e);we(g,"unknown event","eventFragment",e),e=g}if(r!=null&&!e.anonymous){const g=e.topicHash;we(zn(r[0],32)&&r[0].toLowerCase()===g,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((g,m)=>{g.indexed?g.type==="string"||g.type==="bytes"||g.baseType==="tuple"||g.baseType==="array"?(s.push(fs.from({type:"bytes32",name:g.name})),o.push(!0)):(s.push(g),o.push(!1)):(i.push(g),o.push(!1))});const a=r!=null?Y(this,As).decode(s,kr(r)):null,l=Y(this,As).decode(i,t,!0),u=[],f=[];let h=0,p=0;return e.inputs.forEach((g,m)=>{let w=null;if(g.indexed)if(a==null)w=new eF(null);else if(o[m])w=new eF(a[p++]);else try{w=a[p++]}catch(x){w=x}else try{w=l[h++]}catch(x){w=x}u.push(w),f.push(g.name||null)}),Op.fromItems(u,f)}parseTransaction(e){const t=tn(e.data,"tx.data"),r=wt(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(ht(t.slice(0,4)));if(!s)return null;const i=Y(this,As).decode(s.inputs,t.slice(4));return new JCe(s,s.selector,i,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new YCe(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=ht(e),r=this.getError(cr(t,0,4));if(!r)return null;const s=Y(this,As).decode(r.inputs,cr(t,4));return new ZCe(r,r.selector,s)}static from(e){return e instanceof ef?e:typeof e=="string"?new ef(JSON.parse(e)):typeof e.formatJson=="function"?new ef(e.formatJson()):typeof e.format=="function"?new ef(e.format("json")):new ef(e)}};ba=new WeakMap,va=new WeakMap,Sa=new WeakMap,As=new WeakMap,Ha=new WeakSet,jx=function(e,t,r){if(zn(e)){const i=e.toLowerCase();for(const o of Y(this,Sa).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of Y(this,Sa))o.split("(")[0]===e&&i.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,l=!0;_s.isTyped(o)&&o.type==="overrides"&&(l=!1,a--);for(let u=i.length-1;u>=0;u--){const f=i[u].inputs.length;f!==a&&(!l||f!==a-1)&&i.splice(u,1)}for(let u=i.length-1;u>=0;u--){const f=i[u].inputs;for(let h=0;h<t.length;h++)if(_s.isTyped(t[h])){if(h>=f.length){if(t[h].type==="overrides")continue;i.splice(u,1);break}if(t[h].type!==f[h].baseType){i.splice(u,1);break}}}}if(i.length===1&&t&&t.length!==i[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(a=>JSON.stringify(a.format())).join(", ");we(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=Y(this,Sa).get(_a.from(e).format());return s||null},Kx=function(e,t,r){if(zn(e)){const i=e.toLowerCase();for(const o of Y(this,va).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of Y(this,va))o.split("(")[0]===e&&i.push(a);if(t){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<t.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let l=0;l<t.length;l++)if(_s.isTyped(t[l])&&t[l].type!==a[l].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(a=>JSON.stringify(a.format())).join(", ");we(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=Y(this,va).get(Da.from(e).format());return s||null};let JE=ef;const _W=BigInt(0);function Od(n){return n??null}function br(n){return n==null?null:n.toString()}class rF{constructor(e,t,r){Se(this,"gasPrice");Se(this,"maxFeePerGas");Se(this,"maxPriorityFeePerGas");Nt(this,{gasPrice:Od(e),maxFeePerGas:Od(t),maxPriorityFeePerGas:Od(r)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:br(e),maxFeePerGas:br(t),maxPriorityFeePerGas:br(r)}}}function Y1(n){const e={};n.to&&(e.to=n.to),n.from&&(e.from=n.from),n.data&&(e.data=ht(n.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in n)||n[s]==null||(e[s]=wt(n[s],`request.${s}`));const r="type,nonce".split(/,/);for(const s of r)!(s in n)||n[s]==null||(e[s]=jt(n[s],`request.${s}`));return n.accessList&&(e.accessList=Ch(n.accessList)),"blockTag"in n&&(e.blockTag=n.blockTag),"enableCcipRead"in n&&(e.enableCcipRead=!!n.enableCcipRead),"customData"in n&&(e.customData=n.customData),"blobVersionedHashes"in n&&n.blobVersionedHashes&&(e.blobVersionedHashes=n.blobVersionedHashes.slice()),"kzg"in n&&(e.kzg=n.kzg),"blobs"in n&&n.blobs&&(e.blobs=n.blobs.map(s=>AN(s)?ht(s):Object.assign({},s))),e}var Cl;class eke{constructor(e,t){Se(this,"provider");Se(this,"number");Se(this,"hash");Se(this,"timestamp");Se(this,"parentHash");Se(this,"parentBeaconBlockRoot");Se(this,"nonce");Se(this,"difficulty");Se(this,"gasLimit");Se(this,"gasUsed");Se(this,"stateRoot");Se(this,"receiptsRoot");Se(this,"blobGasUsed");Se(this,"excessBlobGas");Se(this,"miner");Se(this,"prevRandao");Se(this,"extraData");Se(this,"baseFeePerGas");_e(this,Cl);se(this,Cl,e.transactions.map(r=>typeof r!="string"?new n0(r,t):r)),Nt(this,{provider:t,hash:Od(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:Od(e.prevRandao),extraData:e.extraData,baseFeePerGas:Od(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return Y(this,Cl).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=Y(this,Cl).slice();return e.length===0?[]:(je(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:r,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:l,nonce:u,number:f,parentHash:h,parentBeaconBlockRoot:p,stateRoot:g,receiptsRoot:m,timestamp:w,transactions:x}=this;return{_type:"Block",baseFeePerGas:br(e),difficulty:br(t),extraData:r,gasLimit:br(s),gasUsed:br(i),blobGasUsed:br(this.blobGasUsed),excessBlobGas:br(this.excessBlobGas),hash:o,miner:a,prevRandao:l,nonce:u,number:f,parentHash:h,timestamp:w,parentBeaconBlockRoot:p,stateRoot:g,receiptsRoot:m,transactions:x}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return Y(this,Cl).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=Y(this,Cl)[e];else{const r=e.toLowerCase();for(const s of Y(this,Cl))if(typeof s=="string"){if(s!==r)continue;t=s;break}else{if(s.hash!==r)continue;t=s;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const r of t)if(r.hash===e)return r;we(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return tke(this)}}Cl=new WeakMap;class Uy{constructor(e,t){Se(this,"provider");Se(this,"transactionHash");Se(this,"blockHash");Se(this,"blockNumber");Se(this,"removed");Se(this,"address");Se(this,"data");Se(this,"topics");Se(this,"index");Se(this,"transactionIndex");this.provider=t;const r=Object.freeze(e.topics.slice());Nt(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:r,data:s,index:i,removed:o,topics:a,transactionHash:l,transactionIndex:u}=this;return{_type:"log",address:e,blockHash:t,blockNumber:r,data:s,index:i,removed:o,topics:a,transactionHash:l,transactionIndex:u}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return je(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return je(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return je(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return nke(this)}}var u0;class PW{constructor(e,t){Se(this,"provider");Se(this,"to");Se(this,"from");Se(this,"contractAddress");Se(this,"hash");Se(this,"index");Se(this,"blockHash");Se(this,"blockNumber");Se(this,"logsBloom");Se(this,"gasUsed");Se(this,"blobGasUsed");Se(this,"cumulativeGasUsed");Se(this,"gasPrice");Se(this,"blobGasPrice");Se(this,"type");Se(this,"status");Se(this,"root");_e(this,u0);se(this,u0,Object.freeze(e.logs.map(s=>new Uy(s,t))));let r=_W;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),Nt(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return Y(this,u0)}toJSON(){const{to:e,from:t,contractAddress:r,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:l,logs:u,status:f,root:h}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:r,cumulativeGasUsed:br(this.cumulativeGasUsed),from:t,gasPrice:br(this.gasPrice),blobGasUsed:br(this.blobGasUsed),blobGasPrice:br(this.blobGasPrice),gasUsed:br(this.gasUsed),hash:s,index:i,logs:u,logsBloom:l,root:h,status:f,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return MW(this)}reorderedEvent(e){return je(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),FW(this,e)}}u0=new WeakMap;var Ru;const l$=class l${constructor(e,t){Se(this,"provider");Se(this,"blockNumber");Se(this,"blockHash");Se(this,"index");Se(this,"hash");Se(this,"type");Se(this,"to");Se(this,"from");Se(this,"nonce");Se(this,"gasLimit");Se(this,"gasPrice");Se(this,"maxPriorityFeePerGas");Se(this,"maxFeePerGas");Se(this,"maxFeePerBlobGas");Se(this,"data");Se(this,"value");Se(this,"chainId");Se(this,"signature");Se(this,"accessList");Se(this,"blobVersionedHashes");_e(this,Ru);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,se(this,Ru,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:r,hash:s,type:i,to:o,from:a,nonce:l,data:u,signature:f,accessList:h,blobVersionedHashes:p}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:t,blobVersionedHashes:p,chainId:br(this.chainId),data:u,from:a,gasLimit:br(this.gasLimit),gasPrice:br(this.gasPrice),hash:s,maxFeePerGas:br(this.maxFeePerGas),maxPriorityFeePerGas:br(this.maxPriorityFeePerGas),maxFeePerBlobGas:br(this.maxFeePerBlobGas),nonce:l,signature:f,to:o,index:r,type:i,value:br(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:r}=await Gs({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:r-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const r=e??1,s=t??0;let i=Y(this,Ru),o=-1,a=i===-1;const l=async()=>{if(a)return null;const{blockNumber:p,nonce:g}=await Gs({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(g<this.nonce){i=p;return}if(a)return null;const m=await this.getTransaction();if(!(m&&m.blockNumber!=null))for(o===-1&&(o=i-3,o<Y(this,Ru)&&(o=Y(this,Ru)));o<=p;){if(a)return null;const w=await this.provider.getBlock(o,!0);if(w==null)return;for(const x of w)if(x===this.hash)return;for(let x=0;x<w.length;x++){const b=await w.getTransaction(x);if(b.from===this.from&&b.nonce===this.nonce){if(a)return null;const C=await this.provider.getTransactionReceipt(b.hash);if(C==null||p-C.blockNumber+1<r)return;let $="replaced";b.data===this.data&&b.to===this.to&&b.value===this.value?$="repriced":b.data==="0x"&&b.from===b.to&&b.value===_W&&($="cancelled"),je(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:$==="replaced"||$==="cancelled",reason:$,replacement:b.replaceableTransaction(i),hash:b.hash,receipt:C})}}o++}},u=p=>{if(p==null||p.status!==0)return p;je(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:p.to,from:p.from,data:""},receipt:p})},f=await this.provider.getTransactionReceipt(this.hash);if(r===0)return u(f);if(f){if(await f.confirmations()>=r)return u(f)}else if(await l(),r===0)return null;return await new Promise((p,g)=>{const m=[],w=()=>{m.forEach(b=>b())};if(m.push(()=>{a=!0}),s>0){const b=setTimeout(()=>{w(),g(ur("wait for transaction timeout","TIMEOUT"))},s);m.push(()=>{clearTimeout(b)})}const x=async b=>{if(await b.confirmations()>=r){w();try{p(u(b))}catch(C){g(C)}}};if(m.push(()=>{this.provider.off(this.hash,x)}),this.provider.on(this.hash,x),i>=0){const b=async()=>{try{await l()}catch(C){if(cs(C,"TRANSACTION_REPLACED")){w(),g(C);return}}a||this.provider.once("block",b)};m.push(()=>{this.provider.off("block",b)}),this.provider.once("block",b)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return je(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),MW(this)}reorderedEvent(e){return je(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),je(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),FW(this,e)}replaceableTransaction(e){we(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new l$(this,this.provider);return se(t,Ru,e),t}};Ru=new WeakMap;let n0=l$;function tke(n){return{orphan:"drop-block",hash:n.hash,number:n.number}}function FW(n,e){return{orphan:"reorder-transaction",tx:n,other:e}}function MW(n){return{orphan:"drop-transaction",tx:n}}function nke(n){return{orphan:"drop-log",log:{transactionHash:n.transactionHash,blockHash:n.blockHash,blockNumber:n.blockNumber,address:n.address,data:n.data,topics:Object.freeze(n.topics.slice()),index:n.index}}}class GN extends Uy{constructor(t,r,s){super(t,t.provider);Se(this,"interface");Se(this,"fragment");Se(this,"args");const i=r.decodeEventLog(s,t.data,t.topics);Nt(this,{args:i,fragment:s,interface:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class LW extends Uy{constructor(t,r){super(t,t.provider);Se(this,"error");Nt(this,{error:r})}}var ip;class rke extends PW{constructor(t,r,s){super(s,r);_e(this,ip);se(this,ip,t)}get logs(){return super.logs.map(t=>{const r=t.topics.length?Y(this,ip).getEvent(t.topics[0]):null;if(r)try{return new GN(t,Y(this,ip),r)}catch(s){return new LW(t,s)}return t})}}ip=new WeakMap;var c0;class HN extends n0{constructor(t,r,s){super(s,r);_e(this,c0);se(this,c0,t)}async wait(t,r){const s=await super.wait(t,r);return s==null?null:new rke(Y(this,c0),this.provider,s)}}c0=new WeakMap;class BW extends h6{constructor(t,r,s,i){super(t,r,s);Se(this,"log");Nt(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class ske extends BW{constructor(e,t,r,s,i){super(e,t,r,new GN(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);Nt(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const sF=BigInt(0);function zW(n){return n&&typeof n.call=="function"}function UW(n){return n&&typeof n.estimateGas=="function"}function gS(n){return n&&typeof n.resolveName=="function"}function VW(n){return n&&typeof n.sendTransaction=="function"}function WW(n){if(n!=null){if(gS(n))return n;if(n.provider)return n.provider}}var f0;class ike{constructor(e,t,r){_e(this,f0);Se(this,"fragment");if(Nt(this,{fragment:t}),t.inputs.length<r.length)throw new Error("too many arguments");const s=lh(e.runner,"resolveName"),i=gS(s)?s:null;se(this,f0,async function(){const o=await Promise.all(t.inputs.map((a,l)=>r[l]==null?null:a.walkAsync(r[l],(f,h)=>f==="address"?Array.isArray(h)?Promise.all(h.map(p=>Ys(p,i))):Ys(h,i):h)));return e.interface.encodeFilterTopics(t,o)}())}getTopicFilter(){return Y(this,f0)}}f0=new WeakMap;function lh(n,e){return n==null?null:typeof n[e]=="function"?n:n.provider&&typeof n.provider[e]=="function"?n.provider:null}function af(n){return n==null?null:n.provider||null}async function GW(n,e){const t=_s.dereference(n,"overrides");we(typeof t=="object","invalid overrides parameter","overrides",n);const r=Y1(t);return we(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),we(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function oke(n,e,t){const r=lh(n,"resolveName"),s=gS(r)?r:null;return await Promise.all(e.map((i,o)=>i.walkAsync(t[o],(a,l)=>(l=_s.dereference(l,a),a==="address"?Ys(l,s):l))))}function ake(n){const e=async function(o){const a=await GW(o,["data"]);a.to=await n.getAddress(),a.from&&(a.from=await Ys(a.from,WW(n.runner)));const l=n.interface,u=wt(a.value||sF,"overrides.value")===sF,f=(a.data||"0x")==="0x";l.fallback&&!l.fallback.payable&&l.receive&&!f&&!u&&we(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),we(l.fallback||f,"cannot send data to receive-only contract","overrides.data",a.data);const h=l.receive||l.fallback&&l.fallback.payable;return we(h||u,"cannot send value to non-payable fallback","overrides.value",a.value),we(l.fallback||f,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=lh(n.runner,"call");je(zW(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const l=await e(o);try{return await a.call(l)}catch(u){throw EN(u)&&u.data?n.interface.makeError(u.data,l):u}},r=async function(o){const a=n.runner;je(VW(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const l=await a.sendTransaction(await e(o)),u=af(n.runner);return new HN(n.interface,u,l)},s=async function(o){const a=lh(n.runner,"estimateGas");return je(UW(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await r(o);return Nt(i,{_contract:n,estimateGas:s,populateTransaction:e,send:r,staticCall:t}),i}function lke(n,e){const t=function(...u){const f=n.interface.getFunction(e,u);return je(f,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:u}}),f},r=async function(...u){const f=t(...u);let h={};if(f.inputs.length+1===u.length&&(h=await GW(u.pop()),h.from&&(h.from=await Ys(h.from,WW(n.runner)))),f.inputs.length!==u.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const p=await oke(n.runner,f.inputs,u);return Object.assign({},h,await Gs({to:n.getAddress(),data:n.interface.encodeFunctionData(f,p)}))},s=async function(...u){const f=await a(...u);return f.length===1?f[0]:f},i=async function(...u){const f=n.runner;je(VW(f),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await f.sendTransaction(await r(...u)),p=af(n.runner);return new HN(n.interface,p,h)},o=async function(...u){const f=lh(n.runner,"estimateGas");return je(UW(f),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await f.estimateGas(await r(...u))},a=async function(...u){const f=lh(n.runner,"call");je(zW(f),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await r(...u);let p="0x";try{p=await f.call(h)}catch(m){throw EN(m)&&m.data?n.interface.makeError(m.data,h):m}const g=t(...u);return n.interface.decodeFunctionResult(g,p)},l=async(...u)=>t(...u).constant?await s(...u):await i(...u);return Nt(l,{name:n.interface.getFunctionName(e),_contract:n,_key:e,getFragment:t,estimateGas:o,populateTransaction:r,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(l,"fragment",{configurable:!1,enumerable:!0,get:()=>{const u=n.interface.getFunction(e);return je(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),u}}),l}function uke(n,e){const t=function(...s){const i=n.interface.getEvent(e,s);return je(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},r=function(...s){return new ike(n,t(...s),s)};return Nt(r,{name:n.interface.getEventName(e),_contract:n,_key:e,getFragment:t}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=n.interface.getEvent(e);return je(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),r}const J1=Symbol.for("_ethersInternal_contract"),HW=new WeakMap;function cke(n,e){HW.set(n[J1],e)}function Ni(n){return HW.get(n[J1])}function fke(n){return n&&typeof n=="object"&&"getTopicFilter"in n&&typeof n.getTopicFilter=="function"&&n.fragment}async function jN(n,e){let t,r=null;if(Array.isArray(e)){const i=function(o){if(zn(o,32))return o;const a=n.interface.getEvent(o);return we(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?t=[null]:typeof e=="string"?zn(e,32)?t=[e]:(r=n.interface.getEvent(e),we(r,"unknown fragment","event",e),t=[r.topicHash]):fke(e)?t=await e.getTopicFilter():"fragment"in e?(r=e.fragment,t=[r.topicHash]):we(!1,"unknown event name","event",e);t=t.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=t.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:r,tag:s,topics:t}}async function wm(n,e){const{subs:t}=Ni(n);return t.get((await jN(n,e)).tag)||null}async function iF(n,e,t){const r=af(n.runner);je(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await jN(n,t),{addr:a,subs:l}=Ni(n);let u=l.get(i);if(!u){const h={address:a||n,topics:o},p=x=>{let b=s;if(b==null)try{b=n.interface.getEvent(x.topics[0])}catch{}if(b){const C=b,$=s?n.interface.decodeEventLog(s,x.data,x.topics):[];e2(n,t,$,k=>new ske(n,k,t,C,x))}else e2(n,t,[],C=>new BW(n,C,t,x))};let g=[];u={tag:i,listeners:[],start:()=>{g.length||g.push(r.on(h,p))},stop:async()=>{if(g.length==0)return;let x=g;g=[],await Promise.all(x),r.off(h,p)}},l.set(i,u)}return u}let ZE=Promise.resolve();async function hke(n,e,t,r){await ZE;const s=await wm(n,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const l=Array.from(t);r&&l.push(r(a?null:o));try{o.call(n,...l)}catch{}return!a}),s.listeners.length===0&&(s.stop(),Ni(n).subs.delete(s.tag)),i>0}async function e2(n,e,t,r){try{await ZE}catch{}const s=hke(n,e,t,r);return ZE=s,await s}const xx=["then"];var L3;L3=J1;const $m=class $m{constructor(e,t,r,s){Se(this,"target");Se(this,"interface");Se(this,"runner");Se(this,"filters");Se(this,L3);Se(this,"fallback");we(typeof e=="string"||Y6(e),"invalid value for Contract target","target",e),r==null&&(r=null);const i=JE.from(t);Nt(this,{target:e,runner:r,interface:i}),Object.defineProperty(this,J1,{value:{}});let o,a=null,l=null;if(s){const h=af(r);l=new HN(this.interface,h,s)}let u=new Map;if(typeof e=="string")if(zn(e))a=e,o=Promise.resolve(e);else{const h=lh(r,"resolveName");if(!gS(h))throw ur("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(e).then(p=>{if(p==null)throw ur("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Ni(this).addr=p,p})}else o=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return Ni(this).addr=h,h});cke(this,{addrPromise:o,addr:a,deployTx:l,subs:u});const f=new Proxy({},{get:(h,p,g)=>{if(typeof p=="symbol"||xx.indexOf(p)>=0)return Reflect.get(h,p,g);try{return this.getEvent(p)}catch(m){if(!cs(m,"INVALID_ARGUMENT")||m.argument!=="key")throw m}},has:(h,p)=>xx.indexOf(p)>=0?Reflect.has(h,p):Reflect.has(h,p)||this.interface.hasEvent(String(p))});return Nt(this,{filters:f}),Nt(this,{fallback:i.receive||i.fallback?ake(this):null}),new Proxy(this,{get:(h,p,g)=>{if(typeof p=="symbol"||p in h||xx.indexOf(p)>=0)return Reflect.get(h,p,g);try{return h.getFunction(p)}catch(m){if(!cs(m,"INVALID_ARGUMENT")||m.argument!=="key")throw m}},has:(h,p)=>typeof p=="symbol"||p in h||xx.indexOf(p)>=0?Reflect.has(h,p):h.interface.hasFunction(p)})}connect(e){return new $m(this.target,this.interface,e)}attach(e){return new $m(e,this.interface,this.runner)}async getAddress(){return await Ni(this).addrPromise}async getDeployedCode(){const e=af(this.runner);je(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=af(this.runner);return je(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);r.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return Ni(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),lke(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),uke(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,r){t==null&&(t=0),r==null&&(r="latest");const{addr:s,addrPromise:i}=Ni(this),o=s||await i,{fragment:a,topics:l}=await jN(this,e),u={address:o,topics:l,fromBlock:t,toBlock:r},f=af(this.runner);return je(f,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await f.getLogs(u)).map(h=>{let p=a;if(p==null)try{p=this.interface.getEvent(h.topics[0])}catch{}if(p)try{return new GN(h,this.interface,p)}catch(g){return new LW(h,g)}return new Uy(h,f)})}async on(e,t){const r=await iF(this,"on",e);return r.listeners.push({listener:t,once:!1}),r.start(),this}async once(e,t){const r=await iF(this,"once",e);return r.listeners.push({listener:t,once:!0}),r.start(),this}async emit(e,...t){return await e2(this,e,t,null)}async listenerCount(e){if(e){const s=await wm(this,e);return s?s.listeners.length:0}const{subs:t}=Ni(this);let r=0;for(const{listeners:s}of t.values())r+=s.length;return r}async listeners(e){if(e){const s=await wm(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:t}=Ni(this);let r=[];for(const{listeners:s}of t.values())r=r.concat(s.map(({listener:i})=>i));return r}async off(e,t){const r=await wm(this,e);if(!r)return this;if(t){const s=r.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&r.listeners.splice(s,1)}return(t==null||r.listeners.length===0)&&(r.stop(),Ni(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const t=await wm(this,e);if(!t)return this;t.stop(),Ni(this).subs.delete(t.tag)}else{const{subs:t}=Ni(this);for(const{tag:r,stop:s}of t.values())s(),t.delete(r)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends $m{constructor(s,i=null){super(s,e,i)}}return t}static from(e,t,r){return r==null&&(r=null),new this(e,t,r)}};let t2=$m;function dke(){return t2}class Dd extends dke(){}function Xk(n){return n.match(/^ipfs:\/\/ipfs\//i)?n=n.substring(12):n.match(/^ipfs:\/\//i)?n=n.substring(7):we(!1,"unsupported IPFS format","link",n),`https://gateway.ipfs.io/ipfs/${n}`}class pke{constructor(e){Se(this,"name");Nt(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const jW=new RegExp("^(ipfs)://(.*)$","i"),oF=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),jW,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var Ou,vf,Du,gd,lb,KW;const bd=class bd{constructor(e,t,r){_e(this,Du);Se(this,"provider");Se(this,"address");Se(this,"name");_e(this,Ou);_e(this,vf);Nt(this,{provider:e,address:t,name:r}),se(this,Ou,null),se(this,vf,new Dd(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return Y(this,Ou)==null&&se(this,Ou,(async()=>{try{return await Y(this,vf).supportsInterface("0x9061b923")}catch(e){if(cs(e,"CALL_EXCEPTION"))return!1;throw se(this,Ou,null),e}})()),await Y(this,Ou)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await rt(this,Du,gd).call(this,"addr(bytes32)");return i==null||i===qm?null:i}catch(i){if(cs(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await rt(this,Du,gd).call(this,"addr(bytes32,uint)",[i]);if(zn(o,20))return Cn(o)}let t=null;for(const i of this.provider.plugins)if(i instanceof pke&&i.supportsCoinType(e)){t=i;break}if(t==null)return null;const r=await rt(this,Du,gd).call(this,"addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;const s=await t.decodeAddress(e,r);if(s!=null)return s;je(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){const t=await rt(this,Du,gd).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await rt(this,Du,gd).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",i=parseInt(t[4],16);if(t[5].length===i*2)return`${s}://${Abe("0x"+t[2])}`}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;je(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let r=0;r<oF.length;r++){const s=t.match(oF[r]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=Xk(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const l=(s[2]||"").split("/");if(l.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const u=l[1],f=new Dd(l[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const w=await f.ownerOf(u);if(a!==w)return e.push({type:"!owner",value:w}),{url:null,linkage:e};e.push({type:"owner",value:w})}else if(i==="erc1155"){const w=await f.balanceOf(a,u);if(!w)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:w.toString()})}let h=await f[o](u);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),i==="erc1155"&&(h=h.replace("{id}",sc(u,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=Xk(h)),e.push({type:"metadata-url",value:h});let p={};const g=await new zl(h).send();g.assertOk();try{p=g.bodyJson}catch{try{e.push({type:"!metadata",value:g.bodyText})}catch{const b=g.body;return b&&e.push({type:"!metadata",value:ht(b)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!p)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(p)});let m=p.image;if(typeof m!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!m.match(/^(https:\/\/|data:)/i)){if(m.match(jW)==null)return e.push({type:"!imageUrl-ipfs",value:m}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:m}),m=Xk(m)}return e.push({type:"url",value:m}),{linkage:e,url:m}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),r=t.getPlugin("org.ethers.plugins.network.Ens");return je(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),r.address}static async fromName(e,t){var s;let r=t;for(;;){if(r===""||r==="."||t!=="eth"&&r==="eth")return null;const i=await rt(s=bd,lb,KW).call(s,e,r);if(i!=null){const o=new bd(e,i,t);return r!==t&&!await o.supportsWildcard()?null:o}r=r.split(".").slice(1).join(".")}}};Ou=new WeakMap,vf=new WeakMap,Du=new WeakSet,gd=async function(e,t){t=(t||[]).slice();const r=Y(this,vf).interface;t.unshift(QE(this.name));let s=null;await this.supportsWildcard()&&(s=r.getFunction(e),je(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[dCe(this.name,255),r.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const i=await Y(this,vf)[e](...t);return s?r.decodeFunctionResult(s,i)[0]:i}catch(i){if(!cs(i,"CALL_EXCEPTION"))throw i}return null},lb=new WeakSet,KW=async function(e,t){const r=await bd.getEnsAddress(e);try{const i=await new Dd(r,["function resolver(bytes32) view returns (address)"],e).resolver(QE(t),{enableCcipRead:!0});return i===qm?null:i}catch(s){throw s}return null},_e(bd,lb);let Z1=bd;const aF=BigInt(0);function Jt(n,e){return function(t){return t==null?e:n(t)}}function mS(n,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(r=>n(r))}}function Vy(n,e){return t=>{const r={};for(const s in n){let i=s;if(e&&s in e&&!(i in t)){for(const o of e[s])if(o in t){i=o;break}}try{const o=n[s](t[i]);o!==void 0&&(r[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";je(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:t})}}return r}}function gke(n){switch(n){case!0:case"true":return!0;case!1:case"false":return!1}we(!1,`invalid boolean; ${JSON.stringify(n)}`,"value",n)}function Bp(n){return we(zn(n,!0),"invalid data","value",n),n}function us(n){return we(zn(n,32),"invalid hash","value",n),n}const mke=Vy({address:Cn,blockHash:us,blockNumber:jt,data:Bp,index:jt,removed:Jt(gke,!1),topics:mS(us),transactionHash:us,transactionIndex:jt},{index:["logIndex"]});function yke(n){return mke(n)}const wke=Vy({hash:Jt(us),parentHash:us,parentBeaconBlockRoot:Jt(us,null),number:jt,timestamp:jt,nonce:Jt(Bp),difficulty:wt,gasLimit:wt,gasUsed:wt,stateRoot:Jt(us,null),receiptsRoot:Jt(us,null),blobGasUsed:Jt(wt,null),excessBlobGas:Jt(wt,null),miner:Jt(Cn),prevRandao:Jt(us,null),extraData:Bp,baseFeePerGas:Jt(wt)},{prevRandao:["mixHash"]});function xke(n){const e=wke(n);return e.transactions=n.transactions.map(t=>typeof t=="string"?t:qW(t)),e}const bke=Vy({transactionIndex:jt,blockNumber:jt,transactionHash:us,address:Cn,topics:mS(us),data:Bp,index:jt,blockHash:us},{index:["logIndex"]});function vke(n){return bke(n)}const Ske=Vy({to:Jt(Cn,null),from:Jt(Cn,null),contractAddress:Jt(Cn,null),index:jt,root:Jt(ht),gasUsed:wt,blobGasUsed:Jt(wt,null),logsBloom:Jt(Bp),blockHash:us,hash:us,logs:mS(vke),blockNumber:jt,cumulativeGasUsed:wt,effectiveGasPrice:Jt(wt),blobGasPrice:Jt(wt,null),status:Jt(jt),type:Jt(jt,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function Cke(n){return Ske(n)}function qW(n){n.to&&wt(n.to)===aF&&(n.to="0x0000000000000000000000000000000000000000");const e=Vy({hash:us,index:Jt(jt,void 0),type:t=>t==="0x"||t==null?0:jt(t),accessList:Jt(Ch,null),blobVersionedHashes:Jt(mS(us,!0),null),blockHash:Jt(us,null),blockNumber:Jt(jt,null),transactionIndex:Jt(jt,null),from:Cn,gasPrice:Jt(wt),maxPriorityFeePerGas:Jt(wt),maxFeePerGas:Jt(wt),maxFeePerBlobGas:Jt(wt,null),gasLimit:wt,to:Jt(Cn,null),value:wt,nonce:jt,data:Bp,creates:Jt(Cn,null),chainId:Jt(wt,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(n);if(e.to==null&&e.creates==null&&(e.creates=mSe(e)),(n.type===1||n.type===2)&&n.accessList==null&&(e.accessList=[]),n.signature?e.signature=Jo.from(n.signature):e.signature=Jo.from(n),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&wt(e.blockHash)===aF&&(e.blockHash=null),e}const kke="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class Wy{constructor(e){Se(this,"name");Nt(this,{name:e})}clone(){return new Wy(this.name)}}class yS extends Wy{constructor(t,r){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);Se(this,"effectiveBlock");Se(this,"txBase");Se(this,"txCreate");Se(this,"txDataZero");Se(this,"txDataNonzero");Se(this,"txAccessListStorageKey");Se(this,"txAccessListAddress");const s={effectiveBlock:t};function i(o,a){let l=(r||{})[o];l==null&&(l=a),we(typeof l=="number",`invalud value for ${o}`,"costs",r),s[o]=l}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),Nt(this,s)}clone(){return new yS(this.effectiveBlock,this)}}class wS extends Wy{constructor(t,r){super("org.ethers.plugins.network.Ens");Se(this,"address");Se(this,"targetNetwork");Nt(this,{address:t||kke,targetNetwork:r??1})}clone(){return new wS(this.address,this.targetNetwork)}}var h0,d0;class Ike extends Wy{constructor(t,r){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");_e(this,h0);_e(this,d0);se(this,h0,t),se(this,d0,r)}get url(){return Y(this,h0)}get processFunc(){return Y(this,d0)}clone(){return this}}h0=new WeakMap,d0=new WeakMap;const Qk=new Map;var op,ap,_u;const vd=class vd{constructor(e,t){_e(this,op);_e(this,ap);_e(this,_u);se(this,op,e),se(this,ap,wt(t)),se(this,_u,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return Y(this,op)}set name(e){se(this,op,e)}get chainId(){return Y(this,ap)}set chainId(e){se(this,ap,wt(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===wt(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===wt(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===wt(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(Y(this,_u).values())}attachPlugin(e){if(Y(this,_u).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return Y(this,_u).set(e.name,e.clone()),this}getPlugin(e){return Y(this,_u).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new vd(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new yS;let r=t.txBase;if(e.to==null&&(r+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?r+=t.txDataZero:r+=t.txDataNonzero;if(e.accessList){const s=Ch(e.accessList);for(const i in s)r+=t.txAccessListAddress+t.txAccessListStorageKey*s[i].storageKeys.length}return r}static from(e){if(Eke(),e==null)return vd.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=Qk.get(e);if(t)return t();if(typeof e=="bigint")return new vd("unknown",e);we(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){we(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new vd(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new wS(e.ensAddress,e.ensNetwork)),t}we(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const r=Qk.get(e);r&&we(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),Qk.set(e,t)}};op=new WeakMap,ap=new WeakMap,_u=new WeakMap;let Fa=vd;function lF(n,e){const t=String(n);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${n}`);const r=t.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${n}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let s=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||s++,r[1]=s.toString()}return BigInt(r[0]+r[1])}function uF(n){return new Ike(n,async(e,t,r)=>{r.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([r.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:lF(a.maxFee,9),maxPriorityFeePerGas:lF(a.maxPriorityFee,9)}}catch(i){je(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:s,error:i})}})}let cF=!1;function Eke(){if(cF)return;cF=!0;function n(e,t,r){const s=function(){const i=new Fa(e,t);return r.ensNetwork!=null&&i.attachPlugin(new wS(null,r.ensNetwork)),i.attachPlugin(new yS),(r.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};Fa.register(e,s),Fa.register(t,s),r.altNames&&r.altNames.forEach(i=>{Fa.register(i,s)})}n("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),n("ropsten",3,{ensNetwork:3}),n("rinkeby",4,{ensNetwork:4}),n("goerli",5,{ensNetwork:5}),n("kovan",42,{ensNetwork:42}),n("sepolia",11155111,{ensNetwork:11155111}),n("holesky",17e3,{ensNetwork:17e3}),n("classic",61,{}),n("classicKotti",6,{}),n("arbitrum",42161,{ensNetwork:1}),n("arbitrum-goerli",421613,{}),n("arbitrum-sepolia",421614,{}),n("base",8453,{ensNetwork:1}),n("base-goerli",84531,{}),n("base-sepolia",84532,{}),n("bnb",56,{ensNetwork:1}),n("bnbt",97,{}),n("linea",59144,{ensNetwork:1}),n("linea-goerli",59140,{}),n("linea-sepolia",59141,{}),n("matic",137,{ensNetwork:1,plugins:[uF("https://gasstation.polygon.technology/v2")]}),n("matic-amoy",80002,{}),n("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[uF("https://gasstation-testnet.polygon.technology/v2")]}),n("optimism",10,{ensNetwork:1,plugins:[]}),n("optimism-goerli",420,{}),n("optimism-sepolia",11155420,{}),n("xdai",100,{ensNetwork:1})}function n2(n){return JSON.parse(JSON.stringify(n))}var kl,ro,Pu,Ca,lp,qx;class Ake{constructor(e){_e(this,lp);_e(this,kl);_e(this,ro);_e(this,Pu);_e(this,Ca);se(this,kl,e),se(this,ro,null),se(this,Pu,4e3),se(this,Ca,-2)}get pollingInterval(){return Y(this,Pu)}set pollingInterval(e){se(this,Pu,e)}start(){Y(this,ro)||(se(this,ro,Y(this,kl)._setTimeout(rt(this,lp,qx).bind(this),Y(this,Pu))),rt(this,lp,qx).call(this))}stop(){Y(this,ro)&&(Y(this,kl)._clearTimeout(Y(this,ro)),se(this,ro,null))}pause(e){this.stop(),e&&se(this,Ca,-2)}resume(){this.start()}}kl=new WeakMap,ro=new WeakMap,Pu=new WeakMap,Ca=new WeakMap,lp=new WeakSet,qx=async function(){try{const e=await Y(this,kl).getBlockNumber();if(Y(this,Ca)===-2){se(this,Ca,e);return}if(e!==Y(this,Ca)){for(let t=Y(this,Ca)+1;t<=e;t++){if(Y(this,ro)==null)return;await Y(this,kl).emit("block",t)}se(this,Ca,e)}}catch{}Y(this,ro)!=null&&se(this,ro,Y(this,kl)._setTimeout(rt(this,lp,qx).bind(this),Y(this,Pu)))};var Sf,Cf,Fu;class KN{constructor(e){_e(this,Sf);_e(this,Cf);_e(this,Fu);se(this,Sf,e),se(this,Fu,!1),se(this,Cf,t=>{this._poll(t,Y(this,Sf))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){Y(this,Fu)||(se(this,Fu,!0),Y(this,Cf).call(this,-2),Y(this,Sf).on("block",Y(this,Cf)))}stop(){Y(this,Fu)&&(se(this,Fu,!1),Y(this,Sf).off("block",Y(this,Cf)))}pause(e){this.stop()}resume(){this.start()}}Sf=new WeakMap,Cf=new WeakMap,Fu=new WeakMap;var up,Il;class Tke extends KN{constructor(t,r){super(t);_e(this,up);_e(this,Il);se(this,up,r),se(this,Il,-2)}pause(t){t&&se(this,Il,-2),super.pause(t)}async _poll(t,r){const s=await r.getBlock(Y(this,up));s!=null&&(Y(this,Il)===-2?se(this,Il,s.number):s.number>Y(this,Il)&&(r.emit(Y(this,up),s.number),se(this,Il,s.number)))}}up=new WeakMap,Il=new WeakMap;var ub;class Nke extends KN{constructor(t,r){super(t);_e(this,ub);se(this,ub,n2(r))}async _poll(t,r){throw new Error("@TODO")}}ub=new WeakMap;var cp;class $ke extends KN{constructor(t,r){super(t);_e(this,cp);se(this,cp,r)}async _poll(t,r){const s=await r.getTransactionReceipt(Y(this,cp));s&&r.emit(Y(this,cp),s)}}cp=new WeakMap;var El,fp,hp,Mu,so,cb,XW;class qN{constructor(e,t){_e(this,cb);_e(this,El);_e(this,fp);_e(this,hp);_e(this,Mu);_e(this,so);se(this,El,e),se(this,fp,n2(t)),se(this,hp,rt(this,cb,XW).bind(this)),se(this,Mu,!1),se(this,so,-2)}start(){Y(this,Mu)||(se(this,Mu,!0),Y(this,so)===-2&&Y(this,El).getBlockNumber().then(e=>{se(this,so,e)}),Y(this,El).on("block",Y(this,hp)))}stop(){Y(this,Mu)&&(se(this,Mu,!1),Y(this,El).off("block",Y(this,hp)))}pause(e){this.stop(),e&&se(this,so,-2)}resume(){this.start()}}El=new WeakMap,fp=new WeakMap,hp=new WeakMap,Mu=new WeakMap,so=new WeakMap,cb=new WeakSet,XW=async function(e){if(Y(this,so)===-2)return;const t=n2(Y(this,fp));t.fromBlock=Y(this,so)+1,t.toBlock=e;const r=await Y(this,El).getLogs(t);if(r.length===0){Y(this,so)<e-60&&se(this,so,e-60);return}for(const s of r)Y(this,El).emit(Y(this,fp),s),se(this,so,s.blockNumber)};const Rke=BigInt(2),Oke=10;function bx(n){return n&&typeof n.then=="function"}function Xx(n,e){return n+":"+JSON.stringify(e,(t,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){const s=Object.keys(r);return s.sort(),s.reduce((i,o)=>(i[o]=r[o],i),{})}return r})}class QW{constructor(e){Se(this,"name");Nt(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function Dke(n){return JSON.parse(JSON.stringify(n))}function r2(n){return n=Array.from(new Set(n).values()),n.sort(),n}async function Yk(n,e){if(n==null)throw new Error("invalid event");if(Array.isArray(n)&&(n={topics:n}),typeof n=="string")switch(n){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:n,tag:n}}if(zn(n,32)){const t=n.toLowerCase();return{type:"transaction",tag:Xx("tx",{hash:t}),hash:t}}if(n.orphan){const t=n;return{type:"orphan",tag:Xx("orphan",t),filter:Dke(t)}}if(n.address||n.topics){const t=n,r={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?r2(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],i=[],o=a=>{zn(a)?s.push(a):i.push((async()=>{s.push(await Ys(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),i.length&&await Promise.all(i),r.address=r2(s.map(a=>a.toLowerCase()))}return{filter:r,tag:Xx("event",r),type:"event"}}we(!1,"unknown ProviderEvent","event",n)}function Jk(){return new Date().getTime()}const _ke={cacheTimeout:250,pollingInterval:4e3};var Ts,Lu,Ns,dp,_i,kf,Bu,Al,p0,io,pp,gp,Ht,Ti,s2,i2,xm,o2,bm,Qx;class Pke{constructor(e,t){_e(this,Ht);_e(this,Ts);_e(this,Lu);_e(this,Ns);_e(this,dp);_e(this,_i);_e(this,kf);_e(this,Bu);_e(this,Al);_e(this,p0);_e(this,io);_e(this,pp);_e(this,gp);if(se(this,gp,Object.assign({},_ke,t||{})),e==="any")se(this,kf,!0),se(this,_i,null);else if(e){const r=Fa.from(e);se(this,kf,!1),se(this,_i,Promise.resolve(r)),setTimeout(()=>{this.emit("network",r,null)},0)}else se(this,kf,!1),se(this,_i,null);se(this,Al,-1),se(this,Bu,new Map),se(this,Ts,new Map),se(this,Lu,new Map),se(this,Ns,null),se(this,dp,!1),se(this,p0,1),se(this,io,new Map),se(this,pp,!1)}get pollingInterval(){return Y(this,gp).pollingInterval}get provider(){return this}get plugins(){return Array.from(Y(this,Lu).values())}attachPlugin(e){if(Y(this,Lu).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return Y(this,Lu).set(e.name,e.connect(this)),this}getPlugin(e){return Y(this,Lu).get(e)||null}get disableCcipRead(){return Y(this,pp)}set disableCcipRead(e){se(this,pp,!!e)}async ccipReadFetch(e,t,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<r.length;a++){const l=r[a],u=l.replace("{sender}",s).replace("{data}",i),f=new zl(u);l.indexOf("{data}")===-1&&(f.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:f,index:a,urls:r});let h="unknown error",p;try{p=await f.send()}catch(g){o.push(g.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:f,result:{error:g}});continue}try{const g=p.bodyJson;if(g.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:f,result:g}),g.data;g.message&&(h=g.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:f,result:g})}catch{}je(p.statusCode<400||p.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:l,errorMessage:h}}),o.push(h)}je(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:o}})}_wrapBlock(e,t){return new eke(xke(e),this)}_wrapLog(e,t){return new Uy(yke(e),this)}_wrapTransactionReceipt(e,t){return new PW(Cke(e),this)}_wrapTransactionResponse(e,t){return new n0(qW(e),this)}_detectNetwork(){je(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){je(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=jt(await rt(this,Ht,Ti).call(this,{method:"getBlockNumber"}),"%response");return Y(this,Al)>=0&&se(this,Al,e),e}_getAddress(e){return Ys(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(zn(e))return zn(e,32)?e:yd(e);if(typeof e=="bigint"&&(e=jt(e,"blockTag")),typeof e=="number")return e>=0?yd(e):Y(this,Al)>=0?yd(Y(this,Al)+e):this.getBlockNumber().then(t=>yd(t+e));we(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(l=>l==null?null:Array.isArray(l)?r2(l.map(u=>u.toLowerCase())):l.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,s=(l,u,f)=>{let h;switch(l.length){case 0:break;case 1:h=l[0];break;default:l.sort(),h=l}if(r&&(u!=null||f!=null))throw new Error("invalid filter");const p={};return h&&(p.address=h),t.length&&(p.topics=t),u&&(p.fromBlock=u),f&&(p.toBlock=f),r&&(p.blockHash=r),p};let i=[];if(e.address)if(Array.isArray(e.address))for(const l of e.address)i.push(this._getAddress(l));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(l=>typeof l!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(l=>s(l[0],l[1],l[2])):s(i,o,a)}_getTransactionRequest(e){const t=Y1(e),r=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const i=Ys(t[s],this);bx(i)?r.push(async function(){t[s]=await i}()):t[s]=i}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);bx(s)?r.push(async function(){t.blockTag=await s}()):t.blockTag=s}return r.length?async function(){return await Promise.all(r),t}():t}async getNetwork(){if(Y(this,_i)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw Y(this,_i)===s&&se(this,_i,null),i}})();return se(this,_i,s),(await s).clone()}const e=Y(this,_i),[t,r]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==r.chainId&&(Y(this,kf)?(this.emit("network",r,t),Y(this,_i)===e&&se(this,_i,Promise.resolve(r))):je(!1,`network changed: ${t.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await Gs({_block:rt(this,Ht,o2).call(this,"latest",!1),gasPrice:(async()=>{try{const f=await rt(this,Ht,Ti).call(this,{method:"getGasPrice"});return wt(f,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const f=await rt(this,Ht,Ti).call(this,{method:"getPriorityFee"});return wt(f,"%response")}catch{}return null})()});let a=null,l=null;const u=this._wrapBlock(s,e);return u&&u.baseFeePerGas&&(l=o??BigInt("1000000000"),a=u.baseFeePerGas*Rke+l),new rF(i,a,l)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const s=new zl(r.url),i=await r.processFunc(t,this,s);return new rF(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return bx(t)&&(t=await t),wt(await rt(this,Ht,Ti).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:r}=await Gs({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await rt(this,Ht,i2).call(this,rt(this,Ht,s2).call(this,t,r,e.enableCcipRead?0:-1))}async getBalance(e,t){return wt(await rt(this,Ht,xm).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return jt(await rt(this,Ht,xm).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return ht(await rt(this,Ht,xm).call(this,{method:"getCode"},e,t))}async getStorage(e,t,r){const s=wt(t,"position");return ht(await rt(this,Ht,xm).call(this,{method:"getStorage",position:s},e,r))}async broadcastTransaction(e){const{blockNumber:t,hash:r,network:s}=await Gs({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=X1.from(e);if(i.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(t)}async getBlock(e,t){const{network:r,params:s}=await Gs({network:this.getNetwork(),params:rt(this,Ht,o2).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,r)}async getTransaction(e){const{network:t,params:r}=await Gs({network:this.getNetwork(),params:rt(this,Ht,Ti).call(this,{method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,t)}async getTransactionReceipt(e){const{network:t,params:r}=await Gs({network:this.getNetwork(),params:rt(this,Ht,Ti).call(this,{method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){const s=await rt(this,Ht,Ti).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(r,t)}async getTransactionResult(e){const{result:t}=await Gs({network:this.getNetwork(),result:rt(this,Ht,Ti).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:ht(t)}async getLogs(e){let t=this._getFilter(e);bx(t)&&(t=await t);const{network:r,params:s}=await Gs({network:this.getNetwork(),params:rt(this,Ht,Ti).call(this,{method:"getLogs",filter:t})});return s.map(i=>this._wrapLog(i,r))}_getProvider(e){je(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await Z1.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=Cn(e);const t=QE(e.substring(2).toLowerCase()+".addr.reverse");try{const r=await Z1.getEnsAddress(this),i=await new Dd(r,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(i==null||i===qm)return null;const a=await new Dd(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(r){if(cs(r,"BAD_DATA")&&r.value==="0x"||cs(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,t,r){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const l=async u=>{try{const f=await this.getTransactionReceipt(e);if(f!=null&&u-f.blockNumber+1>=s){i(f),a&&(clearTimeout(a),a=null);return}}catch(f){console.log("EEE",f)}this.once("block",l)};r!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",l),o(ur("timeout","TIMEOUT",{reason:"timeout"})))},r)),l(await this.getBlockNumber())})}async waitForBlock(e){je(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=Y(this,io).get(e);t&&(t.timer&&clearTimeout(t.timer),Y(this,io).delete(e))}_setTimeout(e,t){t==null&&(t=0);const r=Gg(this,p0)._++,s=()=>{Y(this,io).delete(r),e()};if(this.paused)Y(this,io).set(r,{timer:null,func:s,time:t});else{const i=setTimeout(s,t);Y(this,io).set(r,{timer:i,func:s,time:Jk()})}return r}_forEachSubscriber(e){for(const t of Y(this,Ts).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new QW(e.type);case"block":{const t=new Ake(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new Tke(this,e.type);case"event":return new qN(this,e.filter);case"transaction":return new $ke(this,e.hash);case"orphan":return new Nke(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const r of Y(this,Ts).values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=t,r.started&&t.start(),Y(this,Ns)!=null&&t.pause(Y(this,Ns));break}}async on(e,t){const r=await rt(this,Ht,Qx).call(this,e);return r.listeners.push({listener:t,once:!1}),r.started||(r.subscriber.start(),r.started=!0,Y(this,Ns)!=null&&r.subscriber.pause(Y(this,Ns))),this}async once(e,t){const r=await rt(this,Ht,Qx).call(this,e);return r.listeners.push({listener:t,once:!0}),r.started||(r.subscriber.start(),r.started=!0,Y(this,Ns)!=null&&r.subscriber.pause(Y(this,Ns))),this}async emit(e,...t){const r=await rt(this,Ht,bm).call(this,e,t);if(!r||r.listeners.length===0)return!1;const s=r.listeners.length;return r.listeners=r.listeners.filter(({listener:i,once:o})=>{const a=new h6(this,o?null:i,e);try{i.call(this,...t,a)}catch{}return!o}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),Y(this,Ts).delete(r.tag)),s>0}async listenerCount(e){if(e){const r=await rt(this,Ht,bm).call(this,e);return r?r.listeners.length:0}let t=0;for(const{listeners:r}of Y(this,Ts).values())t+=r.length;return t}async listeners(e){if(e){const r=await rt(this,Ht,bm).call(this,e);return r?r.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:r}of Y(this,Ts).values())t=t.concat(r.map(({listener:s})=>s));return t}async off(e,t){const r=await rt(this,Ht,bm).call(this,e);if(!r)return this;if(t){const s=r.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&r.listeners.splice(s,1)}return(!t||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),Y(this,Ts).delete(r.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:r,subscriber:s}=await rt(this,Ht,Qx).call(this,e);r&&s.stop(),Y(this,Ts).delete(t)}else for(const[t,{started:r,subscriber:s}]of Y(this,Ts))r&&s.stop(),Y(this,Ts).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return Y(this,dp)}destroy(){this.removeAllListeners();for(const e of Y(this,io).keys())this._clearTimeout(e);se(this,dp,!0)}get paused(){return Y(this,Ns)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(se(this,Al,-1),Y(this,Ns)!=null){if(Y(this,Ns)==!!e)return;je(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),se(this,Ns,!!e);for(const t of Y(this,io).values())t.timer&&clearTimeout(t.timer),t.time=Jk()-t.time}resume(){if(Y(this,Ns)!=null){this._forEachSubscriber(e=>e.resume()),se(this,Ns,null);for(const e of Y(this,io).values()){let t=e.time;t<0&&(t=0),e.time=Jk(),setTimeout(e.func,t)}}}}Ts=new WeakMap,Lu=new WeakMap,Ns=new WeakMap,dp=new WeakMap,_i=new WeakMap,kf=new WeakMap,Bu=new WeakMap,Al=new WeakMap,p0=new WeakMap,io=new WeakMap,pp=new WeakMap,gp=new WeakMap,Ht=new WeakSet,Ti=async function(e){const t=Y(this,gp).cacheTimeout;if(t<0)return await this._perform(e);const r=Xx(e.method,e);let s=Y(this,Bu).get(r);return s||(s=this._perform(e),Y(this,Bu).set(r,s),setTimeout(()=>{Y(this,Bu).get(r)===s&&Y(this,Bu).delete(r)},t)),await s},s2=async function(e,t,r){je(r<Oke,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=Y1(e);try{return ht(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(i){if(!this.disableCcipRead&&EN(i)&&i.data&&r>=0&&t==="latest"&&s.to!=null&&cr(i.data,0,4)==="0x556f1830"){const o=i.data,a=await Ys(s.to,this);let l;try{l=zke(cr(i.data,4))}catch(h){je(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}je(l.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:l.errorArgs}});const u=await this.ccipReadFetch(s,l.calldata,l.urls);je(u!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:l.errorArgs}});const f={to:a,data:kr([l.selector,Bke([u,l.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:f});try{const h=await rt(this,Ht,s2).call(this,f,t,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},f),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},f),error:h}),h}}throw i}},i2=async function(e){const{value:t}=await Gs({network:this.getNetwork(),value:e});return t},xm=async function(e,t,r){let s=this._getAddress(t),i=this._getBlockTag(r);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await rt(this,Ht,i2).call(this,rt(this,Ht,Ti).call(this,Object.assign(e,{address:s,blockTag:i})))},o2=async function(e,t){if(zn(e,32))return await rt(this,Ht,Ti).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await rt(this,Ht,Ti).call(this,{method:"getBlock",blockTag:r,includeTransactions:t})},bm=async function(e,t){let r=await Yk(e,this);return r.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(r=await Yk({orphan:"drop-log",log:t[0]},this)),Y(this,Ts).get(r.tag)||null},Qx=async function(e){const t=await Yk(e,this),r=t.tag;let s=Y(this,Ts).get(r);return s||(s={subscriber:this._getSubscriber(t),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},Y(this,Ts).set(r,s)),s};function Fke(n,e){try{const t=a2(n,e);if(t)return V1(t)}catch{}return null}function a2(n,e){if(n==="0x")return null;try{const t=jt(cr(n,e,e+32)),r=jt(cr(n,t,t+32));return cr(n,t+32,t+32+r)}catch{}return null}function fF(n){const e=Xs(n);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function Mke(n){if(n.length%32===0)return n;const e=new Uint8Array(Math.ceil(n.length/32)*32);return e.set(n),e}const Lke=new Uint8Array([]);function Bke(n){const e=[];let t=0;for(let r=0;r<n.length;r++)e.push(Lke),t+=32;for(let r=0;r<n.length;r++){const s=tn(n[r]);e[r]=fF(t),e.push(fF(s.length)),e.push(Mke(s)),t+=32+Math.ceil(s.length/32)*32}return kr(e)}const hF="0x0000000000000000000000000000000000000000000000000000000000000000";function zke(n){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};je($d(n)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=cr(n,0,32);je(cr(t,0,12)===cr(hF,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=cr(t,12);try{const r=[],s=jt(cr(n,32,64)),i=jt(cr(n,s,s+32)),o=cr(n,s+32);for(let a=0;a<i;a++){const l=Fke(o,a*32);if(l==null)throw new Error("abort");r.push(l)}e.urls=r}catch{je(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=a2(n,64);if(r==null)throw new Error("abort");e.calldata=r}catch{je(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}je(cr(n,100,128)===cr(hF,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=cr(n,96,100);try{const r=a2(n,128);if(r==null)throw new Error("abort");e.extraData=r}catch{je(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function ad(n,e){if(n.provider)return n.provider;je(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function dF(n,e){let t=Y1(e);if(t.to!=null&&(t.to=Ys(t.to,n)),t.from!=null){const r=t.from;t.from=Promise.all([n.getAddress(),Ys(r,n)]).then(([s,i])=>(we(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else t.from=n.getAddress();return await Gs(t)}class Uke{constructor(e){Se(this,"provider");Nt(this,{provider:e||null})}async getNonce(e){return ad(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await dF(this,e)}async populateTransaction(e){const t=ad(this,"populateTransaction"),r=await dF(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));const s=await this.provider.getNetwork();if(r.chainId!=null){const o=wt(r.chainId);we(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=s.chainId;const i=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||i)?we(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&i&&we(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){const o=await t.getFeeData();je(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(r.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(r.type=2,r.gasPrice!=null){const a=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=a,r.maxPriorityFeePerGas=a}else r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(je(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice),r.type=0):je(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Gs(r)}async estimateGas(e){return ad(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return ad(this,"call").call(await this.populateCall(e))}async resolveName(e){return await ad(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=ad(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;const s=X1.from(r);return await t.broadcastTransaction(await this.signTransaction(s))}}function Vke(n){return JSON.parse(JSON.stringify(n))}var Ws,ka,If,zu,Ef,mp,ic,l2,u2;class YW{constructor(e){_e(this,ic);_e(this,Ws);_e(this,ka);_e(this,If);_e(this,zu);_e(this,Ef);_e(this,mp);se(this,Ws,e),se(this,ka,null),se(this,If,rt(this,ic,l2).bind(this)),se(this,zu,!1),se(this,Ef,null),se(this,mp,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){Y(this,zu)||(se(this,zu,!0),rt(this,ic,l2).call(this,-2))}stop(){Y(this,zu)&&(se(this,zu,!1),se(this,mp,!0),rt(this,ic,u2).call(this),Y(this,Ws).off("block",Y(this,If)))}pause(e){e&&rt(this,ic,u2).call(this),Y(this,Ws).off("block",Y(this,If))}resume(){this.start()}}Ws=new WeakMap,ka=new WeakMap,If=new WeakMap,zu=new WeakMap,Ef=new WeakMap,mp=new WeakMap,ic=new WeakSet,l2=async function(e){try{Y(this,ka)==null&&se(this,ka,this._subscribe(Y(this,Ws)));let t=null;try{t=await Y(this,ka)}catch(i){if(!cs(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(t==null){se(this,ka,null),Y(this,Ws)._recoverSubscriber(this,this._recover(Y(this,Ws)));return}const r=await Y(this,Ws).getNetwork();if(Y(this,Ef)||se(this,Ef,r),Y(this,Ef).chainId!==r.chainId)throw new Error("chaid changed");if(Y(this,mp))return;const s=await Y(this,Ws).send("eth_getFilterChanges",[t]);await this._emitResults(Y(this,Ws),s)}catch(t){console.log("@TODO",t)}Y(this,Ws).once("block",Y(this,If))},u2=function(){const e=Y(this,ka);e&&(se(this,ka,null),e.then(t=>{Y(this,Ws).destroyed||Y(this,Ws).send("eth_uninstallFilter",[t])}))};var Af;class Wke extends YW{constructor(t,r){super(t);_e(this,Af);se(this,Af,Vke(r))}_recover(t){return new qN(t,Y(this,Af))}async _subscribe(t){return await t.send("eth_newFilter",[Y(this,Af)])}async _emitResults(t,r){for(const s of r)t.emit(Y(this,Af),t._wrapLog(s,t._network))}}Af=new WeakMap;class Gke extends YW{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const r of t)e.emit("pending",r)}}const Hke="bigint,boolean,function,number,string,symbol".split(/,/g);function Yx(n){if(n==null||Hke.indexOf(typeof n)>=0||typeof n.getAddress=="function")return n;if(Array.isArray(n))return n.map(Yx);if(typeof n=="object")return Object.keys(n).reduce((e,t)=>(e[t]=n[t],e),{});throw new Error(`should not happen: ${n} (${typeof n})`)}function jke(n){return new Promise(e=>{setTimeout(e,n)})}function ld(n){return n&&n.toLowerCase()}function pF(n){return n&&typeof n.pollingInterval=="number"}const JW={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class Zk extends Uke{constructor(t,r){super(t);Se(this,"address");r=Cn(r),Nt(this,{address:r})}connect(t){je(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const r=Yx(t),s=[];if(r.from){const o=r.from;s.push((async()=>{const a=await Ys(o,this.provider);we(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),r.from=a})())}else r.from=this.address;if(r.gasLimit==null&&s.push((async()=>{r.gasLimit=await this.provider.estimateGas({...r,from:this.address})})()),r.to!=null){const o=r.to;s.push((async()=>{r.to=await Ys(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(r);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(t){const r=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((i,o)=>{const a=[1e3,100];let l=0;const u=async()=>{try{const f=await this.provider.getTransaction(s);if(f!=null){i(f.replaceableTransaction(r));return}}catch(f){if(cs(f,"CANCELLED")||cs(f,"BAD_DATA")||cs(f,"NETWORK_ERROR")||cs(f,"UNSUPPORTED_OPERATION")){f.info==null&&(f.info={}),f.info.sendTransactionHash=s,o(f);return}if(cs(f,"INVALID_ARGUMENT")&&(l++,f.info==null&&(f.info={}),f.info.sendTransactionHash=s,l>10)){o(f);return}this.provider.emit("error",ur("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:f}))}this.provider._setTimeout(()=>{u()},a.pop()||4e3)};u()})}async signTransaction(t){const r=Yx(t);if(r.from){const i=await Ys(r.from,this.provider);we(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),r.from=i}else r.from=this.address;const s=this.provider.getRpcTransaction(r);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const r=typeof t=="string"?Dl(t):t;return await this.provider.send("personal_sign",[ht(r),this.address.toLowerCase()])}async signTypedData(t,r,s){const i=Yx(s),o=await Q1.resolveNames(t,r,i,async a=>{const l=await Ys(a);return we(l!=null,"TypedData does not support null address","value",a),l});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(Q1.getPayload(o.domain,r,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const r=typeof t=="string"?Dl(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),ht(r)])}}var Tf,yp,Tl,Ia,zo,oo,di,g0,c2;class Kke extends Pke{constructor(t,r){super(t,r);_e(this,g0);_e(this,Tf);_e(this,yp);_e(this,Tl);_e(this,Ia);_e(this,zo);_e(this,oo);_e(this,di);se(this,yp,1),se(this,Tf,Object.assign({},JW,r||{})),se(this,Tl,[]),se(this,Ia,null),se(this,oo,null),se(this,di,null);{let i=null;const o=new Promise(a=>{i=a});se(this,zo,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(we(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",r),s&&t!=null&&se(this,oo,Fa.from(t))):s&&(we(t==null||s.matches(t),"staticNetwork MUST match network object","options",r),se(this,oo,s))}_getOption(t){return Y(this,Tf)[t]}get _network(){return je(Y(this,oo),"network is not available yet","NETWORK_ERROR"),Y(this,oo)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&wt(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const r=this.getRpcRequest(t);return r!=null?await this.send(r.method,r.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(Y(this,oo))return Y(this,oo)}else return t;return Y(this,di)?await Y(this,di):this.ready?(se(this,di,(async()=>{try{const r=Fa.from(wt(await this.send("eth_chainId",[])));return se(this,di,null),r}catch(r){throw se(this,di,null),r}})()),await Y(this,di)):(se(this,di,(async()=>{const r={id:Gg(this,yp)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:r});let s;try{s=(await this._send(r))[0],se(this,di,null)}catch(i){throw se(this,di,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return Fa.from(wt(s.result));throw this.getRpcError(r,s)})()),await Y(this,di))}_start(){Y(this,zo)==null||Y(this,zo).resolve==null||(Y(this,zo).resolve(),se(this,zo,null),(async()=>{for(;Y(this,oo)==null&&!this.destroyed;)try{se(this,oo,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",ur("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await jke(1e3)}rt(this,g0,c2).call(this)})())}async _waitUntilReady(){if(Y(this,zo)!=null)return await Y(this,zo).promise}_getSubscriber(t){return t.type==="pending"?new Gke(this):t.type==="event"?this._getOption("polling")?new qN(this,t.filter):new Wke(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new QW("orphan"):super._getSubscriber(t)}get ready(){return Y(this,zo)==null}getRpcTransaction(t){const r={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),r[i]=yd(wt(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(r[s]=ht(t[s]))}),t.accessList&&(r.accessList=Ch(t.accessList)),t.blobVersionedHashes&&(r.blobVersionedHashes=t.blobVersionedHashes.map(s=>s.toLowerCase())),r}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[ld(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[ld(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[ld(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[ld(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(ld):t.filter.address=ld(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,r){const{method:s}=t,{error:i}=r;if(s==="eth_estimateGas"&&i.message){const l=i.message;if(!l.match(/revert/i)&&l.match(/insufficient funds/i))return ur("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const l=f2(i),u=t0.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],l?l.data:null);return u.info={error:i,payload:t},u}const o=JSON.stringify(Qke(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return ur("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const l=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return ur("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:l,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return ur("nonce has already been used","NONCE_EXPIRED",{transaction:l,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return ur("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:l,info:{error:i}});if(o.match(/only replay-protected/i))return ur("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:l,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?ur("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):ur("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,r){if(this.destroyed)return Promise.reject(ur("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=Gg(this,yp)._++,i=new Promise((o,a)=>{Y(this,Tl).push({resolve:o,reject:a,payload:{method:t,params:r,id:s,jsonrpc:"2.0"}})});return rt(this,g0,c2).call(this),i}async getSigner(t){t==null&&(t=0);const r=this.send("eth_accounts",[]);if(typeof t=="number"){const i=await r;if(t>=i.length)throw new Error("no such account");return new Zk(this,i[t])}const{accounts:s}=await Gs({network:this.getNetwork(),accounts:r});t=Cn(t);for(const i of s)if(Cn(i)===t)return new Zk(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(r=>new Zk(this,r))}destroy(){Y(this,Ia)&&(clearTimeout(Y(this,Ia)),se(this,Ia,null));for(const{payload:t,reject:r}of Y(this,Tl))r(ur("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));se(this,Tl,[]),super.destroy()}}Tf=new WeakMap,yp=new WeakMap,Tl=new WeakMap,Ia=new WeakMap,zo=new WeakMap,oo=new WeakMap,di=new WeakMap,g0=new WeakSet,c2=function(){if(Y(this,Ia))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");se(this,Ia,setTimeout(()=>{se(this,Ia,null);const r=Y(this,Tl);for(se(this,Tl,[]);r.length;){const s=[r.shift()];for(;r.length&&s.length!==Y(this,Tf).batchMaxCount;)if(s.push(r.shift()),JSON.stringify(s.map(o=>o.payload)).length>Y(this,Tf).batchMaxSize){r.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:l,payload:u}of s){if(this.destroyed){l(ur("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:u.method}));continue}const f=o.filter(h=>h.id===u.id)[0];if(f==null){const h=ur("missing response for request","BAD_DATA",{value:o,info:{payload:u}});this.emit("error",h),l(h);continue}if("error"in f){l(this.getRpcError(u,f));continue}a(f.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},t))};var Uu;class qke extends Kke{constructor(t,r){super(t,r);_e(this,Uu);let s=this._getOption("pollingInterval");s==null&&(s=JW.pollingInterval),se(this,Uu,s)}_getSubscriber(t){const r=super._getSubscriber(t);return pF(r)&&(r.pollingInterval=Y(this,Uu)),r}get pollingInterval(){return Y(this,Uu)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");se(this,Uu,t),this._forEachSubscriber(r=>{pF(r)&&(r.pollingInterval=Y(this,Uu))})}}Uu=new WeakMap;var wp;class Xke extends qke{constructor(t,r,s){t==null&&(t="http://localhost:8545");super(r,s);_e(this,wp);typeof t=="string"?se(this,wp,new zl(t)):se(this,wp,t.clone())}_getConnection(){return Y(this,wp).clone()}async send(t,r){return await this._start(),await super.send(t,r)}async _send(t){const r=this._getConnection();r.body=JSON.stringify(t),r.setHeader("content-type","application/json");const s=await r.send();s.assertOk();let i=s.bodyJson;return Array.isArray(i)||(i=[i]),i}}wp=new WeakMap;function f2(n){if(n==null)return null;if(typeof n.message=="string"&&n.message.match(/revert/i)&&zn(n.data))return{message:n.message,data:n.data};if(typeof n=="object"){for(const e in n){const t=f2(n[e]);if(t)return t}return null}if(typeof n=="string")try{return f2(JSON.parse(n))}catch{}return null}function h2(n,e){if(n!=null){if(typeof n.message=="string"&&e.push(n.message),typeof n=="object")for(const t in n)h2(n[t],e);if(typeof n=="string")try{return h2(JSON.parse(n),e)}catch{}}}function Qke(n){const e=[];return h2(n,e),e}var Jx={exports:{}},Yke=Jx.exports,gF;function XN(){return gF||(gF=1,function(n){(function(e,t){function r(I,v){if(!I)throw new Error(v||"Assertion failed")}function s(I,v){I.super_=v;var A=function(){};A.prototype=v.prototype,I.prototype=new A,I.prototype.constructor=I}function i(I,v,A){if(i.isBN(I))return I;this.negative=0,this.words=null,this.length=0,this.red=null,I!==null&&((v==="le"||v==="be")&&(A=v,v=10),this._init(I||0,v||10,A||"be"))}typeof e=="object"?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=tL.Buffer}catch{}i.isBN=function(v){return v instanceof i?!0:v!==null&&typeof v=="object"&&v.constructor.wordSize===i.wordSize&&Array.isArray(v.words)},i.max=function(v,A){return v.cmp(A)>0?v:A},i.min=function(v,A){return v.cmp(A)<0?v:A},i.prototype._init=function(v,A,M){if(typeof v=="number")return this._initNumber(v,A,M);if(typeof v=="object")return this._initArray(v,A,M);A==="hex"&&(A=16),r(A===(A|0)&&A>=2&&A<=36),v=v.toString().replace(/\s+/g,"");var D=0;v[0]==="-"&&(D++,this.negative=1),D<v.length&&(A===16?this._parseHex(v,D,M):(this._parseBase(v,A,D),M==="le"&&this._initArray(this.toArray(),A,M)))},i.prototype._initNumber=function(v,A,M){v<0&&(this.negative=1,v=-v),v<67108864?(this.words=[v&67108863],this.length=1):v<4503599627370496?(this.words=[v&67108863,v/67108864&67108863],this.length=2):(r(v<9007199254740992),this.words=[v&67108863,v/67108864&67108863,1],this.length=3),M==="le"&&this._initArray(this.toArray(),A,M)},i.prototype._initArray=function(v,A,M){if(r(typeof v.length=="number"),v.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(v.length/3),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var B,j,W=0;if(M==="be")for(D=v.length-1,B=0;D>=0;D-=3)j=v[D]|v[D-1]<<8|v[D-2]<<16,this.words[B]|=j<<W&67108863,this.words[B+1]=j>>>26-W&67108863,W+=24,W>=26&&(W-=26,B++);else if(M==="le")for(D=0,B=0;D<v.length;D+=3)j=v[D]|v[D+1]<<8|v[D+2]<<16,this.words[B]|=j<<W&67108863,this.words[B+1]=j>>>26-W&67108863,W+=24,W>=26&&(W-=26,B++);return this.strip()};function a(I,v){var A=I.charCodeAt(v);return A>=65&&A<=70?A-55:A>=97&&A<=102?A-87:A-48&15}function l(I,v,A){var M=a(I,A);return A-1>=v&&(M|=a(I,A-1)<<4),M}i.prototype._parseHex=function(v,A,M){this.length=Math.ceil((v.length-A)/6),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var B=0,j=0,W;if(M==="be")for(D=v.length-1;D>=A;D-=2)W=l(v,A,D)<<B,this.words[j]|=W&67108863,B>=18?(B-=18,j+=1,this.words[j]|=W>>>26):B+=8;else{var P=v.length-A;for(D=P%2===0?A+1:A;D<v.length;D+=2)W=l(v,A,D)<<B,this.words[j]|=W&67108863,B>=18?(B-=18,j+=1,this.words[j]|=W>>>26):B+=8}this.strip()};function u(I,v,A,M){for(var D=0,B=Math.min(I.length,A),j=v;j<B;j++){var W=I.charCodeAt(j)-48;D*=M,W>=49?D+=W-49+10:W>=17?D+=W-17+10:D+=W}return D}i.prototype._parseBase=function(v,A,M){this.words=[0],this.length=1;for(var D=0,B=1;B<=67108863;B*=A)D++;D--,B=B/A|0;for(var j=v.length-M,W=j%D,P=Math.min(j,j-W)+M,E=0,R=M;R<P;R+=D)E=u(v,R,R+D,A),this.imuln(B),this.words[0]+E<67108864?this.words[0]+=E:this._iaddn(E);if(W!==0){var H=1;for(E=u(v,R,v.length,A),R=0;R<W;R++)H*=A;this.imuln(H),this.words[0]+E<67108864?this.words[0]+=E:this._iaddn(E)}this.strip()},i.prototype.copy=function(v){v.words=new Array(this.length);for(var A=0;A<this.length;A++)v.words[A]=this.words[A];v.length=this.length,v.negative=this.negative,v.red=this.red},i.prototype.clone=function(){var v=new i(null);return this.copy(v),v},i.prototype._expand=function(v){for(;this.length<v;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(v,A){v=v||10,A=A|0||1;var M;if(v===16||v==="hex"){M="";for(var D=0,B=0,j=0;j<this.length;j++){var W=this.words[j],P=((W<<D|B)&16777215).toString(16);B=W>>>24-D&16777215,D+=2,D>=26&&(D-=26,j--),B!==0||j!==this.length-1?M=f[6-P.length]+P+M:M=P+M}for(B!==0&&(M=B.toString(16)+M);M.length%A!==0;)M="0"+M;return this.negative!==0&&(M="-"+M),M}if(v===(v|0)&&v>=2&&v<=36){var E=h[v],R=p[v];M="";var H=this.clone();for(H.negative=0;!H.isZero();){var K=H.modn(R).toString(v);H=H.idivn(R),H.isZero()?M=K+M:M=f[E-K.length]+K+M}for(this.isZero()&&(M="0"+M);M.length%A!==0;)M="0"+M;return this.negative!==0&&(M="-"+M),M}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var v=this.words[0];return this.length===2?v+=this.words[1]*67108864:this.length===3&&this.words[2]===1?v+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-v:v},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(v,A){return r(typeof o<"u"),this.toArrayLike(o,v,A)},i.prototype.toArray=function(v,A){return this.toArrayLike(Array,v,A)},i.prototype.toArrayLike=function(v,A,M){var D=this.byteLength(),B=M||Math.max(1,D);r(D<=B,"byte array longer than desired length"),r(B>0,"Requested array length <= 0"),this.strip();var j=A==="le",W=new v(B),P,E,R=this.clone();if(j){for(E=0;!R.isZero();E++)P=R.andln(255),R.iushrn(8),W[E]=P;for(;E<B;E++)W[E]=0}else{for(E=0;E<B-D;E++)W[E]=0;for(E=0;!R.isZero();E++)P=R.andln(255),R.iushrn(8),W[B-E-1]=P}return W},Math.clz32?i.prototype._countBits=function(v){return 32-Math.clz32(v)}:i.prototype._countBits=function(v){var A=v,M=0;return A>=4096&&(M+=13,A>>>=13),A>=64&&(M+=7,A>>>=7),A>=8&&(M+=4,A>>>=4),A>=2&&(M+=2,A>>>=2),M+A},i.prototype._zeroBits=function(v){if(v===0)return 26;var A=v,M=0;return A&8191||(M+=13,A>>>=13),A&127||(M+=7,A>>>=7),A&15||(M+=4,A>>>=4),A&3||(M+=2,A>>>=2),A&1||M++,M},i.prototype.bitLength=function(){var v=this.words[this.length-1],A=this._countBits(v);return(this.length-1)*26+A};function g(I){for(var v=new Array(I.bitLength()),A=0;A<v.length;A++){var M=A/26|0,D=A%26;v[A]=(I.words[M]&1<<D)>>>D}return v}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var v=0,A=0;A<this.length;A++){var M=this._zeroBits(this.words[A]);if(v+=M,M!==26)break}return v},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(v){return this.negative!==0?this.abs().inotn(v).iaddn(1):this.clone()},i.prototype.fromTwos=function(v){return this.testn(v-1)?this.notn(v).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(v){for(;this.length<v.length;)this.words[this.length++]=0;for(var A=0;A<v.length;A++)this.words[A]=this.words[A]|v.words[A];return this.strip()},i.prototype.ior=function(v){return r((this.negative|v.negative)===0),this.iuor(v)},i.prototype.or=function(v){return this.length>v.length?this.clone().ior(v):v.clone().ior(this)},i.prototype.uor=function(v){return this.length>v.length?this.clone().iuor(v):v.clone().iuor(this)},i.prototype.iuand=function(v){var A;this.length>v.length?A=v:A=this;for(var M=0;M<A.length;M++)this.words[M]=this.words[M]&v.words[M];return this.length=A.length,this.strip()},i.prototype.iand=function(v){return r((this.negative|v.negative)===0),this.iuand(v)},i.prototype.and=function(v){return this.length>v.length?this.clone().iand(v):v.clone().iand(this)},i.prototype.uand=function(v){return this.length>v.length?this.clone().iuand(v):v.clone().iuand(this)},i.prototype.iuxor=function(v){var A,M;this.length>v.length?(A=this,M=v):(A=v,M=this);for(var D=0;D<M.length;D++)this.words[D]=A.words[D]^M.words[D];if(this!==A)for(;D<A.length;D++)this.words[D]=A.words[D];return this.length=A.length,this.strip()},i.prototype.ixor=function(v){return r((this.negative|v.negative)===0),this.iuxor(v)},i.prototype.xor=function(v){return this.length>v.length?this.clone().ixor(v):v.clone().ixor(this)},i.prototype.uxor=function(v){return this.length>v.length?this.clone().iuxor(v):v.clone().iuxor(this)},i.prototype.inotn=function(v){r(typeof v=="number"&&v>=0);var A=Math.ceil(v/26)|0,M=v%26;this._expand(A),M>0&&A--;for(var D=0;D<A;D++)this.words[D]=~this.words[D]&67108863;return M>0&&(this.words[D]=~this.words[D]&67108863>>26-M),this.strip()},i.prototype.notn=function(v){return this.clone().inotn(v)},i.prototype.setn=function(v,A){r(typeof v=="number"&&v>=0);var M=v/26|0,D=v%26;return this._expand(M+1),A?this.words[M]=this.words[M]|1<<D:this.words[M]=this.words[M]&~(1<<D),this.strip()},i.prototype.iadd=function(v){var A;if(this.negative!==0&&v.negative===0)return this.negative=0,A=this.isub(v),this.negative^=1,this._normSign();if(this.negative===0&&v.negative!==0)return v.negative=0,A=this.isub(v),v.negative=1,A._normSign();var M,D;this.length>v.length?(M=this,D=v):(M=v,D=this);for(var B=0,j=0;j<D.length;j++)A=(M.words[j]|0)+(D.words[j]|0)+B,this.words[j]=A&67108863,B=A>>>26;for(;B!==0&&j<M.length;j++)A=(M.words[j]|0)+B,this.words[j]=A&67108863,B=A>>>26;if(this.length=M.length,B!==0)this.words[this.length]=B,this.length++;else if(M!==this)for(;j<M.length;j++)this.words[j]=M.words[j];return this},i.prototype.add=function(v){var A;return v.negative!==0&&this.negative===0?(v.negative=0,A=this.sub(v),v.negative^=1,A):v.negative===0&&this.negative!==0?(this.negative=0,A=v.sub(this),this.negative=1,A):this.length>v.length?this.clone().iadd(v):v.clone().iadd(this)},i.prototype.isub=function(v){if(v.negative!==0){v.negative=0;var A=this.iadd(v);return v.negative=1,A._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(v),this.negative=1,this._normSign();var M=this.cmp(v);if(M===0)return this.negative=0,this.length=1,this.words[0]=0,this;var D,B;M>0?(D=this,B=v):(D=v,B=this);for(var j=0,W=0;W<B.length;W++)A=(D.words[W]|0)-(B.words[W]|0)+j,j=A>>26,this.words[W]=A&67108863;for(;j!==0&&W<D.length;W++)A=(D.words[W]|0)+j,j=A>>26,this.words[W]=A&67108863;if(j===0&&W<D.length&&D!==this)for(;W<D.length;W++)this.words[W]=D.words[W];return this.length=Math.max(this.length,W),D!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(v){return this.clone().isub(v)};function m(I,v,A){A.negative=v.negative^I.negative;var M=I.length+v.length|0;A.length=M,M=M-1|0;var D=I.words[0]|0,B=v.words[0]|0,j=D*B,W=j&67108863,P=j/67108864|0;A.words[0]=W;for(var E=1;E<M;E++){for(var R=P>>>26,H=P&67108863,K=Math.min(E,v.length-1),Q=Math.max(0,E-I.length+1);Q<=K;Q++){var J=E-Q|0;D=I.words[J]|0,B=v.words[Q]|0,j=D*B+H,R+=j/67108864|0,H=j&67108863}A.words[E]=H|0,P=R|0}return P!==0?A.words[E]=P|0:A.length--,A.strip()}var w=function(v,A,M){var D=v.words,B=A.words,j=M.words,W=0,P,E,R,H=D[0]|0,K=H&8191,Q=H>>>13,J=D[1]|0,ie=J&8191,ce=J>>>13,ge=D[2]|0,be=ge&8191,Ae=ge>>>13,ne=D[3]|0,he=ne&8191,Ie=ne>>>13,ze=D[4]|0,Re=ze&8191,Ke=ze>>>13,tt=D[5]|0,Xe=tt&8191,ot=tt>>>13,et=D[6]|0,mt=et&8191,Ue=et>>>13,Vt=D[7]|0,At=Vt&8191,St=Vt>>>13,Dn=D[8]|0,q=Dn&8191,z=Dn>>>13,G=D[9]|0,Z=G&8191,ae=G>>>13,ke=B[0]|0,Ne=ke&8191,Ye=ke>>>13,He=B[1]|0,Me=He&8191,Ze=He>>>13,at=B[2]|0,bt=at&8191,_t=at>>>13,sr=B[3]|0,Wt=sr&8191,Qt=sr>>>13,Ms=B[4]|0,kn=Ms&8191,In=Ms>>>13,Ja=B[5]|0,cn=Ja&8191,Un=Ja>>>13,na=B[6]|0,_n=na&8191,bn=na>>>13,kh=B[7]|0,mn=kh&8191,yn=kh>>>13,Ls=B[8]|0,Pn=Ls&8191,qn=Ls>>>13,Ih=B[9]|0,Xn=Ih&8191,fn=Ih>>>13;M.negative=v.negative^A.negative,M.length=19,P=Math.imul(K,Ne),E=Math.imul(K,Ye),E=E+Math.imul(Q,Ne)|0,R=Math.imul(Q,Ye);var ws=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(ws>>>26)|0,ws&=67108863,P=Math.imul(ie,Ne),E=Math.imul(ie,Ye),E=E+Math.imul(ce,Ne)|0,R=Math.imul(ce,Ye),P=P+Math.imul(K,Me)|0,E=E+Math.imul(K,Ze)|0,E=E+Math.imul(Q,Me)|0,R=R+Math.imul(Q,Ze)|0;var ql=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(ql>>>26)|0,ql&=67108863,P=Math.imul(be,Ne),E=Math.imul(be,Ye),E=E+Math.imul(Ae,Ne)|0,R=Math.imul(Ae,Ye),P=P+Math.imul(ie,Me)|0,E=E+Math.imul(ie,Ze)|0,E=E+Math.imul(ce,Me)|0,R=R+Math.imul(ce,Ze)|0,P=P+Math.imul(K,bt)|0,E=E+Math.imul(K,_t)|0,E=E+Math.imul(Q,bt)|0,R=R+Math.imul(Q,_t)|0;var xc=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(xc>>>26)|0,xc&=67108863,P=Math.imul(he,Ne),E=Math.imul(he,Ye),E=E+Math.imul(Ie,Ne)|0,R=Math.imul(Ie,Ye),P=P+Math.imul(be,Me)|0,E=E+Math.imul(be,Ze)|0,E=E+Math.imul(Ae,Me)|0,R=R+Math.imul(Ae,Ze)|0,P=P+Math.imul(ie,bt)|0,E=E+Math.imul(ie,_t)|0,E=E+Math.imul(ce,bt)|0,R=R+Math.imul(ce,_t)|0,P=P+Math.imul(K,Wt)|0,E=E+Math.imul(K,Qt)|0,E=E+Math.imul(Q,Wt)|0,R=R+Math.imul(Q,Qt)|0;var Xl=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(Xl>>>26)|0,Xl&=67108863,P=Math.imul(Re,Ne),E=Math.imul(Re,Ye),E=E+Math.imul(Ke,Ne)|0,R=Math.imul(Ke,Ye),P=P+Math.imul(he,Me)|0,E=E+Math.imul(he,Ze)|0,E=E+Math.imul(Ie,Me)|0,R=R+Math.imul(Ie,Ze)|0,P=P+Math.imul(be,bt)|0,E=E+Math.imul(be,_t)|0,E=E+Math.imul(Ae,bt)|0,R=R+Math.imul(Ae,_t)|0,P=P+Math.imul(ie,Wt)|0,E=E+Math.imul(ie,Qt)|0,E=E+Math.imul(ce,Wt)|0,R=R+Math.imul(ce,Qt)|0,P=P+Math.imul(K,kn)|0,E=E+Math.imul(K,In)|0,E=E+Math.imul(Q,kn)|0,R=R+Math.imul(Q,In)|0;var Ql=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(Ql>>>26)|0,Ql&=67108863,P=Math.imul(Xe,Ne),E=Math.imul(Xe,Ye),E=E+Math.imul(ot,Ne)|0,R=Math.imul(ot,Ye),P=P+Math.imul(Re,Me)|0,E=E+Math.imul(Re,Ze)|0,E=E+Math.imul(Ke,Me)|0,R=R+Math.imul(Ke,Ze)|0,P=P+Math.imul(he,bt)|0,E=E+Math.imul(he,_t)|0,E=E+Math.imul(Ie,bt)|0,R=R+Math.imul(Ie,_t)|0,P=P+Math.imul(be,Wt)|0,E=E+Math.imul(be,Qt)|0,E=E+Math.imul(Ae,Wt)|0,R=R+Math.imul(Ae,Qt)|0,P=P+Math.imul(ie,kn)|0,E=E+Math.imul(ie,In)|0,E=E+Math.imul(ce,kn)|0,R=R+Math.imul(ce,In)|0,P=P+Math.imul(K,cn)|0,E=E+Math.imul(K,Un)|0,E=E+Math.imul(Q,cn)|0,R=R+Math.imul(Q,Un)|0;var Yl=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(Yl>>>26)|0,Yl&=67108863,P=Math.imul(mt,Ne),E=Math.imul(mt,Ye),E=E+Math.imul(Ue,Ne)|0,R=Math.imul(Ue,Ye),P=P+Math.imul(Xe,Me)|0,E=E+Math.imul(Xe,Ze)|0,E=E+Math.imul(ot,Me)|0,R=R+Math.imul(ot,Ze)|0,P=P+Math.imul(Re,bt)|0,E=E+Math.imul(Re,_t)|0,E=E+Math.imul(Ke,bt)|0,R=R+Math.imul(Ke,_t)|0,P=P+Math.imul(he,Wt)|0,E=E+Math.imul(he,Qt)|0,E=E+Math.imul(Ie,Wt)|0,R=R+Math.imul(Ie,Qt)|0,P=P+Math.imul(be,kn)|0,E=E+Math.imul(be,In)|0,E=E+Math.imul(Ae,kn)|0,R=R+Math.imul(Ae,In)|0,P=P+Math.imul(ie,cn)|0,E=E+Math.imul(ie,Un)|0,E=E+Math.imul(ce,cn)|0,R=R+Math.imul(ce,Un)|0,P=P+Math.imul(K,_n)|0,E=E+Math.imul(K,bn)|0,E=E+Math.imul(Q,_n)|0,R=R+Math.imul(Q,bn)|0;var ri=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(ri>>>26)|0,ri&=67108863,P=Math.imul(At,Ne),E=Math.imul(At,Ye),E=E+Math.imul(St,Ne)|0,R=Math.imul(St,Ye),P=P+Math.imul(mt,Me)|0,E=E+Math.imul(mt,Ze)|0,E=E+Math.imul(Ue,Me)|0,R=R+Math.imul(Ue,Ze)|0,P=P+Math.imul(Xe,bt)|0,E=E+Math.imul(Xe,_t)|0,E=E+Math.imul(ot,bt)|0,R=R+Math.imul(ot,_t)|0,P=P+Math.imul(Re,Wt)|0,E=E+Math.imul(Re,Qt)|0,E=E+Math.imul(Ke,Wt)|0,R=R+Math.imul(Ke,Qt)|0,P=P+Math.imul(he,kn)|0,E=E+Math.imul(he,In)|0,E=E+Math.imul(Ie,kn)|0,R=R+Math.imul(Ie,In)|0,P=P+Math.imul(be,cn)|0,E=E+Math.imul(be,Un)|0,E=E+Math.imul(Ae,cn)|0,R=R+Math.imul(Ae,Un)|0,P=P+Math.imul(ie,_n)|0,E=E+Math.imul(ie,bn)|0,E=E+Math.imul(ce,_n)|0,R=R+Math.imul(ce,bn)|0,P=P+Math.imul(K,mn)|0,E=E+Math.imul(K,yn)|0,E=E+Math.imul(Q,mn)|0,R=R+Math.imul(Q,yn)|0;var bc=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(bc>>>26)|0,bc&=67108863,P=Math.imul(q,Ne),E=Math.imul(q,Ye),E=E+Math.imul(z,Ne)|0,R=Math.imul(z,Ye),P=P+Math.imul(At,Me)|0,E=E+Math.imul(At,Ze)|0,E=E+Math.imul(St,Me)|0,R=R+Math.imul(St,Ze)|0,P=P+Math.imul(mt,bt)|0,E=E+Math.imul(mt,_t)|0,E=E+Math.imul(Ue,bt)|0,R=R+Math.imul(Ue,_t)|0,P=P+Math.imul(Xe,Wt)|0,E=E+Math.imul(Xe,Qt)|0,E=E+Math.imul(ot,Wt)|0,R=R+Math.imul(ot,Qt)|0,P=P+Math.imul(Re,kn)|0,E=E+Math.imul(Re,In)|0,E=E+Math.imul(Ke,kn)|0,R=R+Math.imul(Ke,In)|0,P=P+Math.imul(he,cn)|0,E=E+Math.imul(he,Un)|0,E=E+Math.imul(Ie,cn)|0,R=R+Math.imul(Ie,Un)|0,P=P+Math.imul(be,_n)|0,E=E+Math.imul(be,bn)|0,E=E+Math.imul(Ae,_n)|0,R=R+Math.imul(Ae,bn)|0,P=P+Math.imul(ie,mn)|0,E=E+Math.imul(ie,yn)|0,E=E+Math.imul(ce,mn)|0,R=R+Math.imul(ce,yn)|0,P=P+Math.imul(K,Pn)|0,E=E+Math.imul(K,qn)|0,E=E+Math.imul(Q,Pn)|0,R=R+Math.imul(Q,qn)|0;var vc=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(vc>>>26)|0,vc&=67108863,P=Math.imul(Z,Ne),E=Math.imul(Z,Ye),E=E+Math.imul(ae,Ne)|0,R=Math.imul(ae,Ye),P=P+Math.imul(q,Me)|0,E=E+Math.imul(q,Ze)|0,E=E+Math.imul(z,Me)|0,R=R+Math.imul(z,Ze)|0,P=P+Math.imul(At,bt)|0,E=E+Math.imul(At,_t)|0,E=E+Math.imul(St,bt)|0,R=R+Math.imul(St,_t)|0,P=P+Math.imul(mt,Wt)|0,E=E+Math.imul(mt,Qt)|0,E=E+Math.imul(Ue,Wt)|0,R=R+Math.imul(Ue,Qt)|0,P=P+Math.imul(Xe,kn)|0,E=E+Math.imul(Xe,In)|0,E=E+Math.imul(ot,kn)|0,R=R+Math.imul(ot,In)|0,P=P+Math.imul(Re,cn)|0,E=E+Math.imul(Re,Un)|0,E=E+Math.imul(Ke,cn)|0,R=R+Math.imul(Ke,Un)|0,P=P+Math.imul(he,_n)|0,E=E+Math.imul(he,bn)|0,E=E+Math.imul(Ie,_n)|0,R=R+Math.imul(Ie,bn)|0,P=P+Math.imul(be,mn)|0,E=E+Math.imul(be,yn)|0,E=E+Math.imul(Ae,mn)|0,R=R+Math.imul(Ae,yn)|0,P=P+Math.imul(ie,Pn)|0,E=E+Math.imul(ie,qn)|0,E=E+Math.imul(ce,Pn)|0,R=R+Math.imul(ce,qn)|0,P=P+Math.imul(K,Xn)|0,E=E+Math.imul(K,fn)|0,E=E+Math.imul(Q,Xn)|0,R=R+Math.imul(Q,fn)|0;var En=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(En>>>26)|0,En&=67108863,P=Math.imul(Z,Me),E=Math.imul(Z,Ze),E=E+Math.imul(ae,Me)|0,R=Math.imul(ae,Ze),P=P+Math.imul(q,bt)|0,E=E+Math.imul(q,_t)|0,E=E+Math.imul(z,bt)|0,R=R+Math.imul(z,_t)|0,P=P+Math.imul(At,Wt)|0,E=E+Math.imul(At,Qt)|0,E=E+Math.imul(St,Wt)|0,R=R+Math.imul(St,Qt)|0,P=P+Math.imul(mt,kn)|0,E=E+Math.imul(mt,In)|0,E=E+Math.imul(Ue,kn)|0,R=R+Math.imul(Ue,In)|0,P=P+Math.imul(Xe,cn)|0,E=E+Math.imul(Xe,Un)|0,E=E+Math.imul(ot,cn)|0,R=R+Math.imul(ot,Un)|0,P=P+Math.imul(Re,_n)|0,E=E+Math.imul(Re,bn)|0,E=E+Math.imul(Ke,_n)|0,R=R+Math.imul(Ke,bn)|0,P=P+Math.imul(he,mn)|0,E=E+Math.imul(he,yn)|0,E=E+Math.imul(Ie,mn)|0,R=R+Math.imul(Ie,yn)|0,P=P+Math.imul(be,Pn)|0,E=E+Math.imul(be,qn)|0,E=E+Math.imul(Ae,Pn)|0,R=R+Math.imul(Ae,qn)|0,P=P+Math.imul(ie,Xn)|0,E=E+Math.imul(ie,fn)|0,E=E+Math.imul(ce,Xn)|0,R=R+Math.imul(ce,fn)|0;var Sc=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(Sc>>>26)|0,Sc&=67108863,P=Math.imul(Z,bt),E=Math.imul(Z,_t),E=E+Math.imul(ae,bt)|0,R=Math.imul(ae,_t),P=P+Math.imul(q,Wt)|0,E=E+Math.imul(q,Qt)|0,E=E+Math.imul(z,Wt)|0,R=R+Math.imul(z,Qt)|0,P=P+Math.imul(At,kn)|0,E=E+Math.imul(At,In)|0,E=E+Math.imul(St,kn)|0,R=R+Math.imul(St,In)|0,P=P+Math.imul(mt,cn)|0,E=E+Math.imul(mt,Un)|0,E=E+Math.imul(Ue,cn)|0,R=R+Math.imul(Ue,Un)|0,P=P+Math.imul(Xe,_n)|0,E=E+Math.imul(Xe,bn)|0,E=E+Math.imul(ot,_n)|0,R=R+Math.imul(ot,bn)|0,P=P+Math.imul(Re,mn)|0,E=E+Math.imul(Re,yn)|0,E=E+Math.imul(Ke,mn)|0,R=R+Math.imul(Ke,yn)|0,P=P+Math.imul(he,Pn)|0,E=E+Math.imul(he,qn)|0,E=E+Math.imul(Ie,Pn)|0,R=R+Math.imul(Ie,qn)|0,P=P+Math.imul(be,Xn)|0,E=E+Math.imul(be,fn)|0,E=E+Math.imul(Ae,Xn)|0,R=R+Math.imul(Ae,fn)|0;var Za=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(Za>>>26)|0,Za&=67108863,P=Math.imul(Z,Wt),E=Math.imul(Z,Qt),E=E+Math.imul(ae,Wt)|0,R=Math.imul(ae,Qt),P=P+Math.imul(q,kn)|0,E=E+Math.imul(q,In)|0,E=E+Math.imul(z,kn)|0,R=R+Math.imul(z,In)|0,P=P+Math.imul(At,cn)|0,E=E+Math.imul(At,Un)|0,E=E+Math.imul(St,cn)|0,R=R+Math.imul(St,Un)|0,P=P+Math.imul(mt,_n)|0,E=E+Math.imul(mt,bn)|0,E=E+Math.imul(Ue,_n)|0,R=R+Math.imul(Ue,bn)|0,P=P+Math.imul(Xe,mn)|0,E=E+Math.imul(Xe,yn)|0,E=E+Math.imul(ot,mn)|0,R=R+Math.imul(ot,yn)|0,P=P+Math.imul(Re,Pn)|0,E=E+Math.imul(Re,qn)|0,E=E+Math.imul(Ke,Pn)|0,R=R+Math.imul(Ke,qn)|0,P=P+Math.imul(he,Xn)|0,E=E+Math.imul(he,fn)|0,E=E+Math.imul(Ie,Xn)|0,R=R+Math.imul(Ie,fn)|0;var Co=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(Co>>>26)|0,Co&=67108863,P=Math.imul(Z,kn),E=Math.imul(Z,In),E=E+Math.imul(ae,kn)|0,R=Math.imul(ae,In),P=P+Math.imul(q,cn)|0,E=E+Math.imul(q,Un)|0,E=E+Math.imul(z,cn)|0,R=R+Math.imul(z,Un)|0,P=P+Math.imul(At,_n)|0,E=E+Math.imul(At,bn)|0,E=E+Math.imul(St,_n)|0,R=R+Math.imul(St,bn)|0,P=P+Math.imul(mt,mn)|0,E=E+Math.imul(mt,yn)|0,E=E+Math.imul(Ue,mn)|0,R=R+Math.imul(Ue,yn)|0,P=P+Math.imul(Xe,Pn)|0,E=E+Math.imul(Xe,qn)|0,E=E+Math.imul(ot,Pn)|0,R=R+Math.imul(ot,qn)|0,P=P+Math.imul(Re,Xn)|0,E=E+Math.imul(Re,fn)|0,E=E+Math.imul(Ke,Xn)|0,R=R+Math.imul(Ke,fn)|0;var ra=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(ra>>>26)|0,ra&=67108863,P=Math.imul(Z,cn),E=Math.imul(Z,Un),E=E+Math.imul(ae,cn)|0,R=Math.imul(ae,Un),P=P+Math.imul(q,_n)|0,E=E+Math.imul(q,bn)|0,E=E+Math.imul(z,_n)|0,R=R+Math.imul(z,bn)|0,P=P+Math.imul(At,mn)|0,E=E+Math.imul(At,yn)|0,E=E+Math.imul(St,mn)|0,R=R+Math.imul(St,yn)|0,P=P+Math.imul(mt,Pn)|0,E=E+Math.imul(mt,qn)|0,E=E+Math.imul(Ue,Pn)|0,R=R+Math.imul(Ue,qn)|0,P=P+Math.imul(Xe,Xn)|0,E=E+Math.imul(Xe,fn)|0,E=E+Math.imul(ot,Xn)|0,R=R+Math.imul(ot,fn)|0;var Cc=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(Cc>>>26)|0,Cc&=67108863,P=Math.imul(Z,_n),E=Math.imul(Z,bn),E=E+Math.imul(ae,_n)|0,R=Math.imul(ae,bn),P=P+Math.imul(q,mn)|0,E=E+Math.imul(q,yn)|0,E=E+Math.imul(z,mn)|0,R=R+Math.imul(z,yn)|0,P=P+Math.imul(At,Pn)|0,E=E+Math.imul(At,qn)|0,E=E+Math.imul(St,Pn)|0,R=R+Math.imul(St,qn)|0,P=P+Math.imul(mt,Xn)|0,E=E+Math.imul(mt,fn)|0,E=E+Math.imul(Ue,Xn)|0,R=R+Math.imul(Ue,fn)|0;var Bs=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(Bs>>>26)|0,Bs&=67108863,P=Math.imul(Z,mn),E=Math.imul(Z,yn),E=E+Math.imul(ae,mn)|0,R=Math.imul(ae,yn),P=P+Math.imul(q,Pn)|0,E=E+Math.imul(q,qn)|0,E=E+Math.imul(z,Pn)|0,R=R+Math.imul(z,qn)|0,P=P+Math.imul(At,Xn)|0,E=E+Math.imul(At,fn)|0,E=E+Math.imul(St,Xn)|0,R=R+Math.imul(St,fn)|0;var sa=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(sa>>>26)|0,sa&=67108863,P=Math.imul(Z,Pn),E=Math.imul(Z,qn),E=E+Math.imul(ae,Pn)|0,R=Math.imul(ae,qn),P=P+Math.imul(q,Xn)|0,E=E+Math.imul(q,fn)|0,E=E+Math.imul(z,Xn)|0,R=R+Math.imul(z,fn)|0;var xs=(W+P|0)+((E&8191)<<13)|0;W=(R+(E>>>13)|0)+(xs>>>26)|0,xs&=67108863,P=Math.imul(Z,Xn),E=Math.imul(Z,fn),E=E+Math.imul(ae,Xn)|0,R=Math.imul(ae,fn);var kc=(W+P|0)+((E&8191)<<13)|0;return W=(R+(E>>>13)|0)+(kc>>>26)|0,kc&=67108863,j[0]=ws,j[1]=ql,j[2]=xc,j[3]=Xl,j[4]=Ql,j[5]=Yl,j[6]=ri,j[7]=bc,j[8]=vc,j[9]=En,j[10]=Sc,j[11]=Za,j[12]=Co,j[13]=ra,j[14]=Cc,j[15]=Bs,j[16]=sa,j[17]=xs,j[18]=kc,W!==0&&(j[19]=W,M.length++),M};Math.imul||(w=m);function x(I,v,A){A.negative=v.negative^I.negative,A.length=I.length+v.length;for(var M=0,D=0,B=0;B<A.length-1;B++){var j=D;D=0;for(var W=M&67108863,P=Math.min(B,v.length-1),E=Math.max(0,B-I.length+1);E<=P;E++){var R=B-E,H=I.words[R]|0,K=v.words[E]|0,Q=H*K,J=Q&67108863;j=j+(Q/67108864|0)|0,J=J+W|0,W=J&67108863,j=j+(J>>>26)|0,D+=j>>>26,j&=67108863}A.words[B]=W,M=j,j=D}return M!==0?A.words[B]=M:A.length--,A.strip()}function b(I,v,A){var M=new C;return M.mulp(I,v,A)}i.prototype.mulTo=function(v,A){var M,D=this.length+v.length;return this.length===10&&v.length===10?M=w(this,v,A):D<63?M=m(this,v,A):D<1024?M=x(this,v,A):M=b(this,v,A),M};function C(I,v){this.x=I,this.y=v}C.prototype.makeRBT=function(v){for(var A=new Array(v),M=i.prototype._countBits(v)-1,D=0;D<v;D++)A[D]=this.revBin(D,M,v);return A},C.prototype.revBin=function(v,A,M){if(v===0||v===M-1)return v;for(var D=0,B=0;B<A;B++)D|=(v&1)<<A-B-1,v>>=1;return D},C.prototype.permute=function(v,A,M,D,B,j){for(var W=0;W<j;W++)D[W]=A[v[W]],B[W]=M[v[W]]},C.prototype.transform=function(v,A,M,D,B,j){this.permute(j,v,A,M,D,B);for(var W=1;W<B;W<<=1)for(var P=W<<1,E=Math.cos(2*Math.PI/P),R=Math.sin(2*Math.PI/P),H=0;H<B;H+=P)for(var K=E,Q=R,J=0;J<W;J++){var ie=M[H+J],ce=D[H+J],ge=M[H+J+W],be=D[H+J+W],Ae=K*ge-Q*be;be=K*be+Q*ge,ge=Ae,M[H+J]=ie+ge,D[H+J]=ce+be,M[H+J+W]=ie-ge,D[H+J+W]=ce-be,J!==P&&(Ae=E*K-R*Q,Q=E*Q+R*K,K=Ae)}},C.prototype.guessLen13b=function(v,A){var M=Math.max(A,v)|1,D=M&1,B=0;for(M=M/2|0;M;M=M>>>1)B++;return 1<<B+1+D},C.prototype.conjugate=function(v,A,M){if(!(M<=1))for(var D=0;D<M/2;D++){var B=v[D];v[D]=v[M-D-1],v[M-D-1]=B,B=A[D],A[D]=-A[M-D-1],A[M-D-1]=-B}},C.prototype.normalize13b=function(v,A){for(var M=0,D=0;D<A/2;D++){var B=Math.round(v[2*D+1]/A)*8192+Math.round(v[2*D]/A)+M;v[D]=B&67108863,B<67108864?M=0:M=B/67108864|0}return v},C.prototype.convert13b=function(v,A,M,D){for(var B=0,j=0;j<A;j++)B=B+(v[j]|0),M[2*j]=B&8191,B=B>>>13,M[2*j+1]=B&8191,B=B>>>13;for(j=2*A;j<D;++j)M[j]=0;r(B===0),r((B&-8192)===0)},C.prototype.stub=function(v){for(var A=new Array(v),M=0;M<v;M++)A[M]=0;return A},C.prototype.mulp=function(v,A,M){var D=2*this.guessLen13b(v.length,A.length),B=this.makeRBT(D),j=this.stub(D),W=new Array(D),P=new Array(D),E=new Array(D),R=new Array(D),H=new Array(D),K=new Array(D),Q=M.words;Q.length=D,this.convert13b(v.words,v.length,W,D),this.convert13b(A.words,A.length,R,D),this.transform(W,j,P,E,D,B),this.transform(R,j,H,K,D,B);for(var J=0;J<D;J++){var ie=P[J]*H[J]-E[J]*K[J];E[J]=P[J]*K[J]+E[J]*H[J],P[J]=ie}return this.conjugate(P,E,D),this.transform(P,E,Q,j,D,B),this.conjugate(Q,j,D),this.normalize13b(Q,D),M.negative=v.negative^A.negative,M.length=v.length+A.length,M.strip()},i.prototype.mul=function(v){var A=new i(null);return A.words=new Array(this.length+v.length),this.mulTo(v,A)},i.prototype.mulf=function(v){var A=new i(null);return A.words=new Array(this.length+v.length),b(this,v,A)},i.prototype.imul=function(v){return this.clone().mulTo(v,this)},i.prototype.imuln=function(v){r(typeof v=="number"),r(v<67108864);for(var A=0,M=0;M<this.length;M++){var D=(this.words[M]|0)*v,B=(D&67108863)+(A&67108863);A>>=26,A+=D/67108864|0,A+=B>>>26,this.words[M]=B&67108863}return A!==0&&(this.words[M]=A,this.length++),this},i.prototype.muln=function(v){return this.clone().imuln(v)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(v){var A=g(v);if(A.length===0)return new i(1);for(var M=this,D=0;D<A.length&&A[D]===0;D++,M=M.sqr());if(++D<A.length)for(var B=M.sqr();D<A.length;D++,B=B.sqr())A[D]!==0&&(M=M.mul(B));return M},i.prototype.iushln=function(v){r(typeof v=="number"&&v>=0);var A=v%26,M=(v-A)/26,D=67108863>>>26-A<<26-A,B;if(A!==0){var j=0;for(B=0;B<this.length;B++){var W=this.words[B]&D,P=(this.words[B]|0)-W<<A;this.words[B]=P|j,j=W>>>26-A}j&&(this.words[B]=j,this.length++)}if(M!==0){for(B=this.length-1;B>=0;B--)this.words[B+M]=this.words[B];for(B=0;B<M;B++)this.words[B]=0;this.length+=M}return this.strip()},i.prototype.ishln=function(v){return r(this.negative===0),this.iushln(v)},i.prototype.iushrn=function(v,A,M){r(typeof v=="number"&&v>=0);var D;A?D=(A-A%26)/26:D=0;var B=v%26,j=Math.min((v-B)/26,this.length),W=67108863^67108863>>>B<<B,P=M;if(D-=j,D=Math.max(0,D),P){for(var E=0;E<j;E++)P.words[E]=this.words[E];P.length=j}if(j!==0)if(this.length>j)for(this.length-=j,E=0;E<this.length;E++)this.words[E]=this.words[E+j];else this.words[0]=0,this.length=1;var R=0;for(E=this.length-1;E>=0&&(R!==0||E>=D);E--){var H=this.words[E]|0;this.words[E]=R<<26-B|H>>>B,R=H&W}return P&&R!==0&&(P.words[P.length++]=R),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(v,A,M){return r(this.negative===0),this.iushrn(v,A,M)},i.prototype.shln=function(v){return this.clone().ishln(v)},i.prototype.ushln=function(v){return this.clone().iushln(v)},i.prototype.shrn=function(v){return this.clone().ishrn(v)},i.prototype.ushrn=function(v){return this.clone().iushrn(v)},i.prototype.testn=function(v){r(typeof v=="number"&&v>=0);var A=v%26,M=(v-A)/26,D=1<<A;if(this.length<=M)return!1;var B=this.words[M];return!!(B&D)},i.prototype.imaskn=function(v){r(typeof v=="number"&&v>=0);var A=v%26,M=(v-A)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=M)return this;if(A!==0&&M++,this.length=Math.min(M,this.length),A!==0){var D=67108863^67108863>>>A<<A;this.words[this.length-1]&=D}return this.strip()},i.prototype.maskn=function(v){return this.clone().imaskn(v)},i.prototype.iaddn=function(v){return r(typeof v=="number"),r(v<67108864),v<0?this.isubn(-v):this.negative!==0?this.length===1&&(this.words[0]|0)<v?(this.words[0]=v-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(v),this.negative=1,this):this._iaddn(v)},i.prototype._iaddn=function(v){this.words[0]+=v;for(var A=0;A<this.length&&this.words[A]>=67108864;A++)this.words[A]-=67108864,A===this.length-1?this.words[A+1]=1:this.words[A+1]++;return this.length=Math.max(this.length,A+1),this},i.prototype.isubn=function(v){if(r(typeof v=="number"),r(v<67108864),v<0)return this.iaddn(-v);if(this.negative!==0)return this.negative=0,this.iaddn(v),this.negative=1,this;if(this.words[0]-=v,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var A=0;A<this.length&&this.words[A]<0;A++)this.words[A]+=67108864,this.words[A+1]-=1;return this.strip()},i.prototype.addn=function(v){return this.clone().iaddn(v)},i.prototype.subn=function(v){return this.clone().isubn(v)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(v,A,M){var D=v.length+M,B;this._expand(D);var j,W=0;for(B=0;B<v.length;B++){j=(this.words[B+M]|0)+W;var P=(v.words[B]|0)*A;j-=P&67108863,W=(j>>26)-(P/67108864|0),this.words[B+M]=j&67108863}for(;B<this.length-M;B++)j=(this.words[B+M]|0)+W,W=j>>26,this.words[B+M]=j&67108863;if(W===0)return this.strip();for(r(W===-1),W=0,B=0;B<this.length;B++)j=-(this.words[B]|0)+W,W=j>>26,this.words[B]=j&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(v,A){var M=this.length-v.length,D=this.clone(),B=v,j=B.words[B.length-1]|0,W=this._countBits(j);M=26-W,M!==0&&(B=B.ushln(M),D.iushln(M),j=B.words[B.length-1]|0);var P=D.length-B.length,E;if(A!=="mod"){E=new i(null),E.length=P+1,E.words=new Array(E.length);for(var R=0;R<E.length;R++)E.words[R]=0}var H=D.clone()._ishlnsubmul(B,1,P);H.negative===0&&(D=H,E&&(E.words[P]=1));for(var K=P-1;K>=0;K--){var Q=(D.words[B.length+K]|0)*67108864+(D.words[B.length+K-1]|0);for(Q=Math.min(Q/j|0,67108863),D._ishlnsubmul(B,Q,K);D.negative!==0;)Q--,D.negative=0,D._ishlnsubmul(B,1,K),D.isZero()||(D.negative^=1);E&&(E.words[K]=Q)}return E&&E.strip(),D.strip(),A!=="div"&&M!==0&&D.iushrn(M),{div:E||null,mod:D}},i.prototype.divmod=function(v,A,M){if(r(!v.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var D,B,j;return this.negative!==0&&v.negative===0?(j=this.neg().divmod(v,A),A!=="mod"&&(D=j.div.neg()),A!=="div"&&(B=j.mod.neg(),M&&B.negative!==0&&B.iadd(v)),{div:D,mod:B}):this.negative===0&&v.negative!==0?(j=this.divmod(v.neg(),A),A!=="mod"&&(D=j.div.neg()),{div:D,mod:j.mod}):this.negative&v.negative?(j=this.neg().divmod(v.neg(),A),A!=="div"&&(B=j.mod.neg(),M&&B.negative!==0&&B.isub(v)),{div:j.div,mod:B}):v.length>this.length||this.cmp(v)<0?{div:new i(0),mod:this}:v.length===1?A==="div"?{div:this.divn(v.words[0]),mod:null}:A==="mod"?{div:null,mod:new i(this.modn(v.words[0]))}:{div:this.divn(v.words[0]),mod:new i(this.modn(v.words[0]))}:this._wordDiv(v,A)},i.prototype.div=function(v){return this.divmod(v,"div",!1).div},i.prototype.mod=function(v){return this.divmod(v,"mod",!1).mod},i.prototype.umod=function(v){return this.divmod(v,"mod",!0).mod},i.prototype.divRound=function(v){var A=this.divmod(v);if(A.mod.isZero())return A.div;var M=A.div.negative!==0?A.mod.isub(v):A.mod,D=v.ushrn(1),B=v.andln(1),j=M.cmp(D);return j<0||B===1&&j===0?A.div:A.div.negative!==0?A.div.isubn(1):A.div.iaddn(1)},i.prototype.modn=function(v){r(v<=67108863);for(var A=(1<<26)%v,M=0,D=this.length-1;D>=0;D--)M=(A*M+(this.words[D]|0))%v;return M},i.prototype.idivn=function(v){r(v<=67108863);for(var A=0,M=this.length-1;M>=0;M--){var D=(this.words[M]|0)+A*67108864;this.words[M]=D/v|0,A=D%v}return this.strip()},i.prototype.divn=function(v){return this.clone().idivn(v)},i.prototype.egcd=function(v){r(v.negative===0),r(!v.isZero());var A=this,M=v.clone();A.negative!==0?A=A.umod(v):A=A.clone();for(var D=new i(1),B=new i(0),j=new i(0),W=new i(1),P=0;A.isEven()&&M.isEven();)A.iushrn(1),M.iushrn(1),++P;for(var E=M.clone(),R=A.clone();!A.isZero();){for(var H=0,K=1;!(A.words[0]&K)&&H<26;++H,K<<=1);if(H>0)for(A.iushrn(H);H-- >0;)(D.isOdd()||B.isOdd())&&(D.iadd(E),B.isub(R)),D.iushrn(1),B.iushrn(1);for(var Q=0,J=1;!(M.words[0]&J)&&Q<26;++Q,J<<=1);if(Q>0)for(M.iushrn(Q);Q-- >0;)(j.isOdd()||W.isOdd())&&(j.iadd(E),W.isub(R)),j.iushrn(1),W.iushrn(1);A.cmp(M)>=0?(A.isub(M),D.isub(j),B.isub(W)):(M.isub(A),j.isub(D),W.isub(B))}return{a:j,b:W,gcd:M.iushln(P)}},i.prototype._invmp=function(v){r(v.negative===0),r(!v.isZero());var A=this,M=v.clone();A.negative!==0?A=A.umod(v):A=A.clone();for(var D=new i(1),B=new i(0),j=M.clone();A.cmpn(1)>0&&M.cmpn(1)>0;){for(var W=0,P=1;!(A.words[0]&P)&&W<26;++W,P<<=1);if(W>0)for(A.iushrn(W);W-- >0;)D.isOdd()&&D.iadd(j),D.iushrn(1);for(var E=0,R=1;!(M.words[0]&R)&&E<26;++E,R<<=1);if(E>0)for(M.iushrn(E);E-- >0;)B.isOdd()&&B.iadd(j),B.iushrn(1);A.cmp(M)>=0?(A.isub(M),D.isub(B)):(M.isub(A),B.isub(D))}var H;return A.cmpn(1)===0?H=D:H=B,H.cmpn(0)<0&&H.iadd(v),H},i.prototype.gcd=function(v){if(this.isZero())return v.abs();if(v.isZero())return this.abs();var A=this.clone(),M=v.clone();A.negative=0,M.negative=0;for(var D=0;A.isEven()&&M.isEven();D++)A.iushrn(1),M.iushrn(1);do{for(;A.isEven();)A.iushrn(1);for(;M.isEven();)M.iushrn(1);var B=A.cmp(M);if(B<0){var j=A;A=M,M=j}else if(B===0||M.cmpn(1)===0)break;A.isub(M)}while(!0);return M.iushln(D)},i.prototype.invm=function(v){return this.egcd(v).a.umod(v)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(v){return this.words[0]&v},i.prototype.bincn=function(v){r(typeof v=="number");var A=v%26,M=(v-A)/26,D=1<<A;if(this.length<=M)return this._expand(M+1),this.words[M]|=D,this;for(var B=D,j=M;B!==0&&j<this.length;j++){var W=this.words[j]|0;W+=B,B=W>>>26,W&=67108863,this.words[j]=W}return B!==0&&(this.words[j]=B,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(v){var A=v<0;if(this.negative!==0&&!A)return-1;if(this.negative===0&&A)return 1;this.strip();var M;if(this.length>1)M=1;else{A&&(v=-v),r(v<=67108863,"Number is too big");var D=this.words[0]|0;M=D===v?0:D<v?-1:1}return this.negative!==0?-M|0:M},i.prototype.cmp=function(v){if(this.negative!==0&&v.negative===0)return-1;if(this.negative===0&&v.negative!==0)return 1;var A=this.ucmp(v);return this.negative!==0?-A|0:A},i.prototype.ucmp=function(v){if(this.length>v.length)return 1;if(this.length<v.length)return-1;for(var A=0,M=this.length-1;M>=0;M--){var D=this.words[M]|0,B=v.words[M]|0;if(D!==B){D<B?A=-1:D>B&&(A=1);break}}return A},i.prototype.gtn=function(v){return this.cmpn(v)===1},i.prototype.gt=function(v){return this.cmp(v)===1},i.prototype.gten=function(v){return this.cmpn(v)>=0},i.prototype.gte=function(v){return this.cmp(v)>=0},i.prototype.ltn=function(v){return this.cmpn(v)===-1},i.prototype.lt=function(v){return this.cmp(v)===-1},i.prototype.lten=function(v){return this.cmpn(v)<=0},i.prototype.lte=function(v){return this.cmp(v)<=0},i.prototype.eqn=function(v){return this.cmpn(v)===0},i.prototype.eq=function(v){return this.cmp(v)===0},i.red=function(v){return new L(v)},i.prototype.toRed=function(v){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),v.convertTo(this)._forceRed(v)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(v){return this.red=v,this},i.prototype.forceRed=function(v){return r(!this.red,"Already a number in reduction context"),this._forceRed(v)},i.prototype.redAdd=function(v){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,v)},i.prototype.redIAdd=function(v){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,v)},i.prototype.redSub=function(v){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,v)},i.prototype.redISub=function(v){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,v)},i.prototype.redShl=function(v){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,v)},i.prototype.redMul=function(v){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,v),this.red.mul(this,v)},i.prototype.redIMul=function(v){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,v),this.red.imul(this,v)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(v){return r(this.red&&!v.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,v)};var $={k256:null,p224:null,p192:null,p25519:null};function k(I,v){this.name=I,this.p=new i(v,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}k.prototype._tmp=function(){var v=new i(null);return v.words=new Array(Math.ceil(this.n/13)),v},k.prototype.ireduce=function(v){var A=v,M;do this.split(A,this.tmp),A=this.imulK(A),A=A.iadd(this.tmp),M=A.bitLength();while(M>this.n);var D=M<this.n?-1:A.ucmp(this.p);return D===0?(A.words[0]=0,A.length=1):D>0?A.isub(this.p):A.strip!==void 0?A.strip():A._strip(),A},k.prototype.split=function(v,A){v.iushrn(this.n,0,A)},k.prototype.imulK=function(v){return v.imul(this.k)};function N(){k.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(N,k),N.prototype.split=function(v,A){for(var M=4194303,D=Math.min(v.length,9),B=0;B<D;B++)A.words[B]=v.words[B];if(A.length=D,v.length<=9){v.words[0]=0,v.length=1;return}var j=v.words[9];for(A.words[A.length++]=j&M,B=10;B<v.length;B++){var W=v.words[B]|0;v.words[B-10]=(W&M)<<4|j>>>22,j=W}j>>>=22,v.words[B-10]=j,j===0&&v.length>10?v.length-=10:v.length-=9},N.prototype.imulK=function(v){v.words[v.length]=0,v.words[v.length+1]=0,v.length+=2;for(var A=0,M=0;M<v.length;M++){var D=v.words[M]|0;A+=D*977,v.words[M]=A&67108863,A=D*64+(A/67108864|0)}return v.words[v.length-1]===0&&(v.length--,v.words[v.length-1]===0&&v.length--),v};function _(){k.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(_,k);function U(){k.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(U,k);function O(){k.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(O,k),O.prototype.imulK=function(v){for(var A=0,M=0;M<v.length;M++){var D=(v.words[M]|0)*19+A,B=D&67108863;D>>>=26,v.words[M]=B,A=D}return A!==0&&(v.words[v.length++]=A),v},i._prime=function(v){if($[v])return $[v];var A;if(v==="k256")A=new N;else if(v==="p224")A=new _;else if(v==="p192")A=new U;else if(v==="p25519")A=new O;else throw new Error("Unknown prime "+v);return $[v]=A,A};function L(I){if(typeof I=="string"){var v=i._prime(I);this.m=v.p,this.prime=v}else r(I.gtn(1),"modulus must be greater than 1"),this.m=I,this.prime=null}L.prototype._verify1=function(v){r(v.negative===0,"red works only with positives"),r(v.red,"red works only with red numbers")},L.prototype._verify2=function(v,A){r((v.negative|A.negative)===0,"red works only with positives"),r(v.red&&v.red===A.red,"red works only with red numbers")},L.prototype.imod=function(v){return this.prime?this.prime.ireduce(v)._forceRed(this):v.umod(this.m)._forceRed(this)},L.prototype.neg=function(v){return v.isZero()?v.clone():this.m.sub(v)._forceRed(this)},L.prototype.add=function(v,A){this._verify2(v,A);var M=v.add(A);return M.cmp(this.m)>=0&&M.isub(this.m),M._forceRed(this)},L.prototype.iadd=function(v,A){this._verify2(v,A);var M=v.iadd(A);return M.cmp(this.m)>=0&&M.isub(this.m),M},L.prototype.sub=function(v,A){this._verify2(v,A);var M=v.sub(A);return M.cmpn(0)<0&&M.iadd(this.m),M._forceRed(this)},L.prototype.isub=function(v,A){this._verify2(v,A);var M=v.isub(A);return M.cmpn(0)<0&&M.iadd(this.m),M},L.prototype.shl=function(v,A){return this._verify1(v),this.imod(v.ushln(A))},L.prototype.imul=function(v,A){return this._verify2(v,A),this.imod(v.imul(A))},L.prototype.mul=function(v,A){return this._verify2(v,A),this.imod(v.mul(A))},L.prototype.isqr=function(v){return this.imul(v,v.clone())},L.prototype.sqr=function(v){return this.mul(v,v)},L.prototype.sqrt=function(v){if(v.isZero())return v.clone();var A=this.m.andln(3);if(r(A%2===1),A===3){var M=this.m.add(new i(1)).iushrn(2);return this.pow(v,M)}for(var D=this.m.subn(1),B=0;!D.isZero()&&D.andln(1)===0;)B++,D.iushrn(1);r(!D.isZero());var j=new i(1).toRed(this),W=j.redNeg(),P=this.m.subn(1).iushrn(1),E=this.m.bitLength();for(E=new i(2*E*E).toRed(this);this.pow(E,P).cmp(W)!==0;)E.redIAdd(W);for(var R=this.pow(E,D),H=this.pow(v,D.addn(1).iushrn(1)),K=this.pow(v,D),Q=B;K.cmp(j)!==0;){for(var J=K,ie=0;J.cmp(j)!==0;ie++)J=J.redSqr();r(ie<Q);var ce=this.pow(R,new i(1).iushln(Q-ie-1));H=H.redMul(ce),R=ce.redSqr(),K=K.redMul(R),Q=ie}return H},L.prototype.invm=function(v){var A=v._invmp(this.m);return A.negative!==0?(A.negative=0,this.imod(A).redNeg()):this.imod(A)},L.prototype.pow=function(v,A){if(A.isZero())return new i(1).toRed(this);if(A.cmpn(1)===0)return v.clone();var M=4,D=new Array(1<<M);D[0]=new i(1).toRed(this),D[1]=v;for(var B=2;B<D.length;B++)D[B]=this.mul(D[B-1],v);var j=D[0],W=0,P=0,E=A.bitLength()%26;for(E===0&&(E=26),B=A.length-1;B>=0;B--){for(var R=A.words[B],H=E-1;H>=0;H--){var K=R>>H&1;if(j!==D[0]&&(j=this.sqr(j)),K===0&&W===0){P=0;continue}W<<=1,W|=K,P++,!(P!==M&&(B!==0||H!==0))&&(j=this.mul(j,D[W]),P=0,W=0)}E=26}return j},L.prototype.convertTo=function(v){var A=v.umod(this.m);return A===v?A.clone():A},L.prototype.convertFrom=function(v){var A=v.clone();return A.red=null,A},i.mont=function(v){return new T(v)};function T(I){L.call(this,I),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(T,L),T.prototype.convertTo=function(v){return this.imod(v.ushln(this.shift))},T.prototype.convertFrom=function(v){var A=this.imod(v.mul(this.rinv));return A.red=null,A},T.prototype.imul=function(v,A){if(v.isZero()||A.isZero())return v.words[0]=0,v.length=1,v;var M=v.imul(A),D=M.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=M.isub(D).iushrn(this.shift),j=B;return B.cmp(this.m)>=0?j=B.isub(this.m):B.cmpn(0)<0&&(j=B.iadd(this.m)),j._forceRed(this)},T.prototype.mul=function(v,A){if(v.isZero()||A.isZero())return new i(0)._forceRed(this);var M=v.mul(A),D=M.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=M.isub(D).iushrn(this.shift),j=B;return B.cmp(this.m)>=0?j=B.isub(this.m):B.cmpn(0)<0&&(j=B.iadd(this.m)),j._forceRed(this)},T.prototype.invm=function(v){var A=this.imod(v._invmp(this.m).mul(this.r2));return A._forceRed(this)}})(n,Yke)}(Jx)),Jx.exports}var eI,mF;function Jke(){if(mF)return eI;mF=1;var n=1/0,e=9007199254740991,t=17976931348623157e292,r=NaN,s="[object Function]",i="[object GeneratorFunction]",o="[object Symbol]",a=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,f=/^0o[0-7]+$/i,h=/^(?:0|[1-9]\d*)$/,p=parseInt,g=Object.prototype,m=g.toString,w=Math.ceil,x=Math.max;function b(D,B,j){var W=-1,P=D.length;B<0&&(B=-B>P?0:P+B),j=j>P?P:j,j<0&&(j+=P),P=B>j?0:j-B>>>0,B>>>=0;for(var E=Array(P);++W<P;)E[W]=D[W+B];return E}function C(D,B){return B=B??e,!!B&&(typeof D=="number"||h.test(D))&&D>-1&&D%1==0&&D<B}function $(D,B,j){if(!L(j))return!1;var W=typeof B;return(W=="number"?_(j)&&C(B,j.length):W=="string"&&B in j)?N(j[B],D):!1}function k(D,B,j){(j?$(D,B,j):B===void 0)?B=1:B=x(A(B),0);var W=D?D.length:0;if(!W||B<1)return[];for(var P=0,E=0,R=Array(w(W/B));P<W;)R[E++]=b(D,P,P+=B);return R}function N(D,B){return D===B||D!==D&&B!==B}function _(D){return D!=null&&O(D.length)&&!U(D)}function U(D){var B=L(D)?m.call(D):"";return B==s||B==i}function O(D){return typeof D=="number"&&D>-1&&D%1==0&&D<=e}function L(D){var B=typeof D;return!!D&&(B=="object"||B=="function")}function T(D){return!!D&&typeof D=="object"}function I(D){return typeof D=="symbol"||T(D)&&m.call(D)==o}function v(D){if(!D)return D===0?D:0;if(D=M(D),D===n||D===-1/0){var B=D<0?-1:1;return B*t}return D===D?D:0}function A(D){var B=v(D),j=B%1;return B===B?j?B-j:B:0}function M(D){if(typeof D=="number")return D;if(I(D))return r;if(L(D)){var B=typeof D.valueOf=="function"?D.valueOf():D;D=L(B)?B+"":B}if(typeof D!="string")return D===0?D:+D;D=D.replace(a,"");var j=u.test(D);return j||f.test(D)?p(D.slice(2),j?2:8):l.test(D)?r:+D}return eI=k,eI}var vm={exports:{}};vm.exports;var yF;function Zke(){return yF||(yF=1,function(n,e){var t=200,r="__lodash_hash_undefined__",s=1,i=2,o=9007199254740991,a="[object Arguments]",l="[object Array]",u="[object AsyncFunction]",f="[object Boolean]",h="[object Date]",p="[object Error]",g="[object Function]",m="[object GeneratorFunction]",w="[object Map]",x="[object Number]",b="[object Null]",C="[object Object]",$="[object Promise]",k="[object Proxy]",N="[object RegExp]",_="[object Set]",U="[object String]",O="[object Symbol]",L="[object Undefined]",T="[object WeakMap]",I="[object ArrayBuffer]",v="[object DataView]",A="[object Float32Array]",M="[object Float64Array]",D="[object Int8Array]",B="[object Int16Array]",j="[object Int32Array]",W="[object Uint8Array]",P="[object Uint8ClampedArray]",E="[object Uint16Array]",R="[object Uint32Array]",H=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,J={};J[A]=J[M]=J[D]=J[B]=J[j]=J[W]=J[P]=J[E]=J[R]=!0,J[a]=J[l]=J[I]=J[f]=J[v]=J[h]=J[p]=J[g]=J[w]=J[x]=J[C]=J[N]=J[_]=J[U]=J[T]=!1;var ie=typeof jw=="object"&&jw&&jw.Object===Object&&jw,ce=typeof self=="object"&&self&&self.Object===Object&&self,ge=ie||ce||Function("return this")(),be=e&&!e.nodeType&&e,Ae=be&&!0&&n&&!n.nodeType&&n,ne=Ae&&Ae.exports===be,he=ne&&ie.process,Ie=function(){try{return he&&he.binding&&he.binding("util")}catch{}}(),ze=Ie&&Ie.isTypedArray;function Re(te,me){for(var Le=-1,ut=te==null?0:te.length,wn=0,Ot=[];++Le<ut;){var Fn=te[Le];me(Fn,Le,te)&&(Ot[wn++]=Fn)}return Ot}function Ke(te,me){for(var Le=-1,ut=me.length,wn=te.length;++Le<ut;)te[wn+Le]=me[Le];return te}function tt(te,me){for(var Le=-1,ut=te==null?0:te.length;++Le<ut;)if(me(te[Le],Le,te))return!0;return!1}function Xe(te,me){for(var Le=-1,ut=Array(te);++Le<te;)ut[Le]=me(Le);return ut}function ot(te){return function(me){return te(me)}}function et(te,me){return te.has(me)}function mt(te,me){return te==null?void 0:te[me]}function Ue(te){var me=-1,Le=Array(te.size);return te.forEach(function(ut,wn){Le[++me]=[wn,ut]}),Le}function Vt(te,me){return function(Le){return te(me(Le))}}function At(te){var me=-1,Le=Array(te.size);return te.forEach(function(ut){Le[++me]=ut}),Le}var St=Array.prototype,Dn=Function.prototype,q=Object.prototype,z=ge["__core-js_shared__"],G=Dn.toString,Z=q.hasOwnProperty,ae=function(){var te=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||"");return te?"Symbol(src)_1."+te:""}(),ke=q.toString,Ne=RegExp("^"+G.call(Z).replace(H,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ye=ne?ge.Buffer:void 0,He=ge.Symbol,Me=ge.Uint8Array,Ze=q.propertyIsEnumerable,at=St.splice,bt=He?He.toStringTag:void 0,_t=Object.getOwnPropertySymbols,sr=Ye?Ye.isBuffer:void 0,Wt=Vt(Object.keys,Object),Qt=el(ge,"DataView"),Ms=el(ge,"Map"),kn=el(ge,"Promise"),In=el(ge,"Set"),Ja=el(ge,"WeakMap"),cn=el(Object,"create"),Un=bs(Qt),na=bs(Ms),_n=bs(kn),bn=bs(In),kh=bs(Ja),mn=He?He.prototype:void 0,yn=mn?mn.valueOf:void 0;function Ls(te){var me=-1,Le=te==null?0:te.length;for(this.clear();++me<Le;){var ut=te[me];this.set(ut[0],ut[1])}}function Pn(){this.__data__=cn?cn(null):{},this.size=0}function qn(te){var me=this.has(te)&&delete this.__data__[te];return this.size-=me?1:0,me}function Ih(te){var me=this.__data__;if(cn){var Le=me[te];return Le===r?void 0:Le}return Z.call(me,te)?me[te]:void 0}function Xn(te){var me=this.__data__;return cn?me[te]!==void 0:Z.call(me,te)}function fn(te,me){var Le=this.__data__;return this.size+=this.has(te)?0:1,Le[te]=cn&&me===void 0?r:me,this}Ls.prototype.clear=Pn,Ls.prototype.delete=qn,Ls.prototype.get=Ih,Ls.prototype.has=Xn,Ls.prototype.set=fn;function ws(te){var me=-1,Le=te==null?0:te.length;for(this.clear();++me<Le;){var ut=te[me];this.set(ut[0],ut[1])}}function ql(){this.__data__=[],this.size=0}function xc(te){var me=this.__data__,Le=Eh(me,te);if(Le<0)return!1;var ut=me.length-1;return Le==ut?me.pop():at.call(me,Le,1),--this.size,!0}function Xl(te){var me=this.__data__,Le=Eh(me,te);return Le<0?void 0:me[Le][1]}function Ql(te){return Eh(this.__data__,te)>-1}function Yl(te,me){var Le=this.__data__,ut=Eh(Le,te);return ut<0?(++this.size,Le.push([te,me])):Le[ut][1]=me,this}ws.prototype.clear=ql,ws.prototype.delete=xc,ws.prototype.get=Xl,ws.prototype.has=Ql,ws.prototype.set=Yl;function ri(te){var me=-1,Le=te==null?0:te.length;for(this.clear();++me<Le;){var ut=te[me];this.set(ut[0],ut[1])}}function bc(){this.size=0,this.__data__={hash:new Ls,map:new(Ms||ws),string:new Ls}}function vc(te){var me=Yt(this,te).delete(te);return this.size-=me?1:0,me}function En(te){return Yt(this,te).get(te)}function Sc(te){return Yt(this,te).has(te)}function Za(te,me){var Le=Yt(this,te),ut=Le.size;return Le.set(te,me),this.size+=Le.size==ut?0:1,this}ri.prototype.clear=bc,ri.prototype.delete=vc,ri.prototype.get=En,ri.prototype.has=Sc,ri.prototype.set=Za;function Co(te){var me=-1,Le=te==null?0:te.length;for(this.__data__=new ri;++me<Le;)this.add(te[me])}function ra(te){return this.__data__.set(te,r),this}function Cc(te){return this.__data__.has(te)}Co.prototype.add=Co.prototype.push=ra,Co.prototype.has=Cc;function Bs(te){var me=this.__data__=new ws(te);this.size=me.size}function sa(){this.__data__=new ws,this.size=0}function xs(te){var me=this.__data__,Le=me.delete(te);return this.size=me.size,Le}function kc(te){return this.__data__.get(te)}function ki(te){return this.__data__.has(te)}function IS(te,me){var Le=this.__data__;if(Le instanceof ws){var ut=Le.__data__;if(!Ms||ut.length<t-1)return ut.push([te,me]),this.size=++Le.size,this;Le=this.__data__=new ri(ut)}return Le.set(te,me),this.size=Le.size,this}Bs.prototype.clear=sa,Bs.prototype.delete=xs,Bs.prototype.get=kc,Bs.prototype.has=ki,Bs.prototype.set=IS;function ES(te,me){var Le=aa(te),ut=!Le&&Ac(te),wn=!Le&&!ut&&mg(te),Ot=!Le&&!ut&&!wn&&wg(te),Fn=Le||ut||wn||Ot,yr=Fn?Xe(te.length,String):[],Mn=yr.length;for(var An in te)Z.call(te,An)&&!(Fn&&(An=="length"||wn&&(An=="offset"||An=="parent")||Ot&&(An=="buffer"||An=="byteLength"||An=="byteOffset")||Xy(An,Mn)))&&yr.push(An);return yr}function Eh(te,me){for(var Le=te.length;Le--;)if(Io(te[Le][0],me))return Le;return-1}function Ah(te,me,Le){var ut=me(te);return aa(te)?ut:Ke(ut,Le(te))}function ia(te){return te==null?te===void 0?L:b:bt&&bt in Object(te)?qy(te):oa(te)}function Jl(te){return ua(te)&&ia(te)==a}function Ic(te,me,Le,ut,wn){return te===me?!0:te==null||me==null||!ua(te)&&!ua(me)?te!==te&&me!==me:AS(te,me,Le,ut,Ic,wn)}function AS(te,me,Le,ut,wn,Ot){var Fn=aa(te),yr=aa(me),Mn=Fn?l:ko(te),An=yr?l:ko(me);Mn=Mn==a?C:Mn,An=An==a?C:An;var Hr=Mn==C,si=An==C,wr=Mn==An;if(wr&&mg(te)){if(!mg(me))return!1;Fn=!0,Hr=!1}if(wr&&!Hr)return Ot||(Ot=new Bs),Fn||wg(te)?Th(te,me,Le,ut,wn,Ot):Ec(te,me,Mn,Le,ut,wn,Ot);if(!(Le&s)){var ss=Hr&&Z.call(te,"__wrapped__"),zs=si&&Z.call(me,"__wrapped__");if(ss||zs){var ir=ss?te.value():te,vs=zs?me.value():me;return Ot||(Ot=new Bs),wn(ir,vs,Le,ut,Ot)}}return wr?(Ot||(Ot=new Bs),NS(te,me,Le,ut,wn,Ot)):!1}function TS(te){if(!yg(te)||gg(te))return!1;var me=Zl(te)?Ne:K;return me.test(bs(te))}function dg(te){return ua(te)&&Jy(te.length)&&!!J[ia(te)]}function Ky(te){if(!$h(te))return Wt(te);var me=[];for(var Le in Object(te))Z.call(te,Le)&&Le!="constructor"&&me.push(Le);return me}function Th(te,me,Le,ut,wn,Ot){var Fn=Le&s,yr=te.length,Mn=me.length;if(yr!=Mn&&!(Fn&&Mn>yr))return!1;var An=Ot.get(te);if(An&&Ot.get(me))return An==me;var Hr=-1,si=!0,wr=Le&i?new Co:void 0;for(Ot.set(te,me),Ot.set(me,te);++Hr<yr;){var ss=te[Hr],zs=me[Hr];if(ut)var ir=Fn?ut(zs,ss,Hr,me,te,Ot):ut(ss,zs,Hr,te,me,Ot);if(ir!==void 0){if(ir)continue;si=!1;break}if(wr){if(!tt(me,function(vs,Eo){if(!et(wr,Eo)&&(ss===vs||wn(ss,vs,Le,ut,Ot)))return wr.push(Eo)})){si=!1;break}}else if(!(ss===zs||wn(ss,zs,Le,ut,Ot))){si=!1;break}}return Ot.delete(te),Ot.delete(me),si}function Ec(te,me,Le,ut,wn,Ot,Fn){switch(Le){case v:if(te.byteLength!=me.byteLength||te.byteOffset!=me.byteOffset)return!1;te=te.buffer,me=me.buffer;case I:return!(te.byteLength!=me.byteLength||!Ot(new Me(te),new Me(me)));case f:case h:case x:return Io(+te,+me);case p:return te.name==me.name&&te.message==me.message;case N:case U:return te==me+"";case w:var yr=Ue;case _:var Mn=ut&s;if(yr||(yr=At),te.size!=me.size&&!Mn)return!1;var An=Fn.get(te);if(An)return An==me;ut|=i,Fn.set(te,me);var Hr=Th(yr(te),yr(me),ut,wn,Ot,Fn);return Fn.delete(te),Hr;case O:if(yn)return yn.call(te)==yn.call(me)}return!1}function NS(te,me,Le,ut,wn,Ot){var Fn=Le&s,yr=Nh(te),Mn=yr.length,An=Nh(me),Hr=An.length;if(Mn!=Hr&&!Fn)return!1;for(var si=Mn;si--;){var wr=yr[si];if(!(Fn?wr in me:Z.call(me,wr)))return!1}var ss=Ot.get(te);if(ss&&Ot.get(me))return ss==me;var zs=!0;Ot.set(te,me),Ot.set(me,te);for(var ir=Fn;++si<Mn;){wr=yr[si];var vs=te[wr],Eo=me[wr];if(ut)var eu=Fn?ut(Eo,vs,wr,me,te,Ot):ut(vs,Eo,wr,te,me,Ot);if(!(eu===void 0?vs===Eo||wn(vs,Eo,Le,ut,Ot):eu)){zs=!1;break}ir||(ir=wr=="constructor")}if(zs&&!ir){var Rh=te.constructor,tu=me.constructor;Rh!=tu&&"constructor"in te&&"constructor"in me&&!(typeof Rh=="function"&&Rh instanceof Rh&&typeof tu=="function"&&tu instanceof tu)&&(zs=!1)}return Ot.delete(te),Ot.delete(me),zs}function Nh(te){return Ah(te,$S,pg)}function Yt(te,me){var Le=te.__data__;return Qy(me)?Le[typeof me=="string"?"string":"hash"]:Le.map}function el(te,me){var Le=mt(te,me);return TS(Le)?Le:void 0}function qy(te){var me=Z.call(te,bt),Le=te[bt];try{te[bt]=void 0;var ut=!0}catch{}var wn=ke.call(te);return ut&&(me?te[bt]=Le:delete te[bt]),wn}var pg=_t?function(te){return te==null?[]:(te=Object(te),Re(_t(te),function(me){return Ze.call(te,me)}))}:Tc,ko=ia;(Qt&&ko(new Qt(new ArrayBuffer(1)))!=v||Ms&&ko(new Ms)!=w||kn&&ko(kn.resolve())!=$||In&&ko(new In)!=_||Ja&&ko(new Ja)!=T)&&(ko=function(te){var me=ia(te),Le=me==C?te.constructor:void 0,ut=Le?bs(Le):"";if(ut)switch(ut){case Un:return v;case na:return w;case _n:return $;case bn:return _;case kh:return T}return me});function Xy(te,me){return me=me??o,!!me&&(typeof te=="number"||Q.test(te))&&te>-1&&te%1==0&&te<me}function Qy(te){var me=typeof te;return me=="string"||me=="number"||me=="symbol"||me=="boolean"?te!=="__proto__":te===null}function gg(te){return!!ae&&ae in te}function $h(te){var me=te&&te.constructor,Le=typeof me=="function"&&me.prototype||q;return te===Le}function oa(te){return ke.call(te)}function bs(te){if(te!=null){try{return G.call(te)}catch{}try{return te+""}catch{}}return""}function Io(te,me){return te===me||te!==te&&me!==me}var Ac=Jl(function(){return arguments}())?Jl:function(te){return ua(te)&&Z.call(te,"callee")&&!Ze.call(te,"callee")},aa=Array.isArray;function la(te){return te!=null&&Jy(te.length)&&!Zl(te)}var mg=sr||Nc;function Yy(te,me){return Ic(te,me)}function Zl(te){if(!yg(te))return!1;var me=ia(te);return me==g||me==m||me==u||me==k}function Jy(te){return typeof te=="number"&&te>-1&&te%1==0&&te<=o}function yg(te){var me=typeof te;return te!=null&&(me=="object"||me=="function")}function ua(te){return te!=null&&typeof te=="object"}var wg=ze?ot(ze):dg;function $S(te){return la(te)?ES(te):Ky(te)}function Tc(){return[]}function Nc(){return!1}n.exports=Yy}(vm,vm.exports)),vm.exports}var tI,wF;function eIe(){if(wF)return tI;wF=1;const n=XN(),e=new n(255),t=new n(65280),r=new n(256),s=(o,a,l)=>{const u=l.and(e).toNumber(),f=l.and(t).div(r).toNumber(),h=String.fromCharCode(u)+String.fromCharCode(f);return new n(i(h,o))},i=(o,a)=>{let l,u,f,h,p,g,m,w;for(l=o.length&3,u=o.length-l,f=a,p=3432918353,g=461845907,w=0;w<u;)m=o.charCodeAt(w)&255|(o.charCodeAt(++w)&255)<<8|(o.charCodeAt(++w)&255)<<16|(o.charCodeAt(++w)&255)<<24,++w,m=(m&65535)*p+(((m>>>16)*p&65535)<<16)&4294967295,m=m<<15|m>>>17,m=(m&65535)*g+(((m>>>16)*g&65535)<<16)&4294967295,f^=m,f=f<<13|f>>>19,h=(f&65535)*5+(((f>>>16)*5&65535)<<16)&4294967295,f=(h&65535)+27492+(((h>>>16)+58964&65535)<<16);switch(m=0,l){case 3:m^=(o.charCodeAt(w+2)&255)<<16;case 2:m^=(o.charCodeAt(w+1)&255)<<8;case 1:m^=o.charCodeAt(w)&255,m=(m&65535)*p+(((m>>>16)*p&65535)<<16)&4294967295,m=m<<15|m>>>17,m=(m&65535)*g+(((m>>>16)*g&65535)<<16)&4294967295,f^=m}return f^=o.length,f^=f>>>16,f=(f&65535)*2246822507+(((f>>>16)*2246822507&65535)<<16)&4294967295,f^=f>>>13,f=(f&65535)*3266489909+(((f>>>16)*3266489909&65535)<<16)&4294967295,f^=f>>>16,f>>>0};return tI={muk:s},tI}var nI,xF;function ZW(){if(xF)return nI;xF=1;const n=XN(),{muk:e}=eIe(),t=new n("10000","hex"),r=new n("ffffffff","hex"),s=new n("100000000","hex"),i=new n("ffffffffffffffff","hex"),o=new n("ffffffff00000000","hex"),a=new n("65535"),l=new n("65536"),u=(C,$)=>e([3077398253,3995603712,2243735041,1261992695][C],2,$),f=C=>{const $=k=>{const N=k.and(r),_=k.and(o);return k.gte(t)&&k.lte(r)?t.add(p(k.sub(t))):k.gte(s)&&k.lte(i)?_.or($(N)):k};return $(new n(C))},h=C=>{const $=k=>{const N=k.and(r),_=k.and(o);return k.gte(t)&&k.lte(r)?t.add(w(k.sub(t))):k.gte(s)&&k.lte(i)?_.or($(N)):k};return $(new n(C))},p=C=>g(4,a,l,r,u,new n(C)),g=(C,$,k,N,_,U)=>{const O=m(C,$,k,_,U);return O.lt(N)?O:m(C,$,k,_,O)},m=(C,$,k,N,_)=>{const U=(T,I,v)=>{if(T>C)return C%2!==0||v.eq($)?$.mul(v).add(I):$.mul(I).add(v);{const A=N(T-1,v),M=T%2!==0?I.add(A).mod($):I.add(A).mod(k);return U(T+1,v,M)}},O=_.mod($),L=_.div($);return U(1,O,L)},w=C=>x(4,a,l,r,u,new n(C)),x=(C,$,k,N,_,U)=>{const O=b(C,$,k,_,U);return O.lt(N)?O:b(C,$,k,_,O)},b=(C,$,k,N,_)=>{const U=(v,A,M)=>{if(v<1)return $.mul(M).add(A);{const D=N(v-1,A),B=v%2!==0?M.add($).sub(D.mod($)).mod($):M.add(k).sub(D.mod(k)).mod(k);return U(v-1,B,A)}},O=C%2!==0?_.div($):_.mod($),L=C%2!==0?_.mod($):_.div($),T=L.eq($)?O:L,I=L.eq($)?L:O;return U(C,T,I)};return nI={F:u,fe:m,Fe:g,feis:p,fein:f,fen:b,Fen:x,tail:w,fynd:h},nI}var rI,bF;function tIe(){if(bF)return rI;bF=1;const n=XN(),e=Jke(),t=Zke(),r=ZW(),s=new n(0),i=new n(1),o=new n(2),a=new n(3),l=new n(4),u=new n(5),f=`
dozmarbinwansamlitsighidfidlissogdirwacsabwissibrigsoldopmodfoglidhopdardorlorhodfolrintogsilmirholpaslacrovlivdalsatlibtabhanticpidtorbolfosdotlosdilforpilramtirwintadbicdifrocwidbisdasmidloprilnardapmolsanlocnovsitnidtipsicropwitnatpanminritpodmottamtolsavposnapnopsomfinfonbanmorworsipronnorbotwicsocwatdolmagpicdavbidbaltimtasmalligsivtagpadsaldivdactansidfabtarmonranniswolmispallasdismaprabtobrollatlonnodnavfignomnibpagsopralbilhaddocridmocpacravripfaltodtiltinhapmicfanpattaclabmogsimsonpinlomrictapfirhasbosbatpochactidhavsaplindibhosdabbitbarracparloddosbortochilmactomdigfilfasmithobharmighinradmashalraglagfadtopmophabnilnosmilfopfamdatnoldinhatnacrisfotribhocnimlarfitwalrapsarnalmoslandondanladdovrivbacpollaptalpitnambonrostonfodponsovnocsorlavmatmipfip`,h=`
zodnecbudwessevpersutletfulpensytdurwepserwylsunrypsyxdyrnuphebpeglupdepdysputlughecryttyvsydnexlunmeplutseppesdelsulpedtemledtulmetwenbynhexfebpyldulhetmevruttylwydtepbesdexsefwycburderneppurrysrebdennutsubpetrulsynregtydsupsemwynrecmegnetsecmulnymtevwebsummutnyxrextebfushepbenmuswyxsymselrucdecwexsyrwetdylmynmesdetbetbeltuxtugmyrpelsyptermebsetdutdegtexsurfeltudnuxruxrenwytnubmedlytdusnebrumtynseglyxpunresredfunrevrefmectedrusbexlebduxrynnumpyxrygryxfeptyrtustyclegnemfermertenlusnussyltecmexpubrymtucfyllepdebbermughuttunbylsudpemdevlurdefbusbeprunmelpexdytbyttyplevmylwedducfurfexnulluclennerlexrupnedlecrydlydfenwelnydhusrelrudneshesfetdesretdunlernyrsebhulrylludremlysfynwerrycsugnysnyllyndyndemluxfedsedbecmunlyrtesmudnytbyrsenwegfyrmurtelreptegpecnelnevfes`,p=K=>K.replace(/[\^~-]/g,"").match(/.{1,3}/g)||[],g=(K,Q)=>[Q.slice(0,K),Q.slice(K)],m=f.match(/.{1,3}/g),w=h.match(/.{1,3}/g),x=K=>o.pow(K),b=(K,Q,J)=>J.div(x(x(K).mul(Q))),C=(K,Q,J=s)=>Q.eq(s)?J:C(K,b(K,i,Q),J.add(i)),$=(K,Q,J)=>J.mod(x(x(K).mul(Q))),k=K=>{if(K===null)throw new Error("hex2patp: null input");return H(new n(K,"hex"))},N=K=>{if(B(K)===!1)throw new Error("patp2hex: not a valid @p");const Q=p(K),J=be=>be.toString(2).padStart(8,"0"),ie=Q.reduce((be,Ae,ne)=>ne%2!==0||Q.length===1?be+J(w.indexOf(Ae)):be+J(m.indexOf(Ae)),""),ce=new n(ie,2),ge=r.fynd(ce).toString("hex");return ge.length%2!==0?ge.padStart(ge.length+1,"0"):ge},_=K=>new n(N(K),"hex"),U=K=>{let Q;try{Q=_(K)}catch{throw new Error("patp2dec: not a valid @p")}return Q.toString()},O=K=>{const J=new n(K).toArrayLike(Buffer);return L(J)},L=K=>{const Q=K.length%2!==0&&K.length>1?[[K[0]]].concat(e(K.slice(1),2)):e(K,2),J=ge=>ge[1]===void 0?m[0]+w[ge[0]]:m[ge[0]]+w[ge[1]],ie=ge=>ge[1]===void 0?w[ge[0]]:m[ge[0]]+w[ge[1]],ce=ge=>ge.length%2!==0&&Q.length>1?J(ge):ie(ge);return Q.reduce((ge,be)=>ge+(ge==="~"?"":"-")+ce(be),"~")},T=K=>{const Q=K.length%2!==0?K.padStart(K.length+1,"0"):K,J=Buffer.from(Q,"hex");return L(J)},I=K=>{if(B(K)===!1)throw new Error("patq2hex: not a valid @q");const Q=K.slice(1).split("-"),J=ce=>ce.toString(16).padStart(2,"0"),ie=Q.map(ce=>{let ge=g(3,ce);return ge[1]===""?J(w.indexOf(ge[0])):J(m.indexOf(ge[0]))+J(w.indexOf(ge[1]))});return K.length===0?"00":ie.join("")},v=K=>new n(I(K),"hex"),A=K=>{let Q;try{Q=v(K)}catch{throw new Error("patq2dec: not a valid @q")}return Q.toString()},M=K=>{let Q;try{Q=_(K)}catch{throw new Error("clan: not a valid @p")}const J=C(a,Q);return J.lte(i)?"galaxy":J.eq(o)?"star":J.lte(l)?"planet":J.lte(new n(8))?"moon":"comet"},D=K=>{let Q;try{Q=_(K)}catch{throw new Error("sein: not a valid @p")}let J;try{J=M(K)}catch{throw new Error("sein: not a valid @p")}const ie=J==="galaxy"?Q:J==="star"?$(a,i,Q):J==="planet"?$(l,i,Q):J==="moon"?$(u,i,Q):s;return H(ie)},B=K=>{if(typeof K!="string")throw new Error("isValidPat: non-string input");if(K.slice(0,1)==="~"===!1||K.length<4)return!1;{const J=p(K),ie=J.length%2!==0&&J.length!==1,ce=J.reduce((ge,be,Ae)=>ge&&(Ae%2!==0||J.length===1?w.includes(be):m.includes(be)),!0);return!ie&&ce}},j=K=>B(K)&&K===H(U(K)),W=K=>B(K)&&R(K,O(A(K))),P=K=>K.slice(0,2)==="00"?P(K.slice(2)):K,E=(K,Q)=>t(P(K),P(Q)),R=(K,Q)=>{let J;try{J=I(K)}catch{throw new Error("eqPatq: not a valid @q")}let ie;try{ie=I(Q)}catch{throw new Error("eqPatq: not a valid @q")}return E(J,ie)},H=K=>{if(K===null)throw new Error("patp: null input");const Q=new n(K),J=r.fein(Q),ie=C(l,J),ce=(be,Ae,ne)=>{const he=$(l,i,be),Ie=m[b(a,i,he)],ze=w[$(a,i,he)],Re=Ae.mod(l).eq(s)?Ae.eq(s)?"":"--":"-",Ke=Ie+ze+Re+ne;return Ae.eq(ie)?ne:ce(b(l,i,be),Ae.add(i),Ke)};return"~"+(C(a,J).lte(i)?w[J]:ce(J,s,""))};return rI={patp:H,patp2hex:N,hex2patp:k,patp2dec:U,sein:D,clan:M,patq:O,patq2hex:I,hex2patq:T,patq2dec:A,eqPatq:R,isValidPat:B,isValidPatp:j,isValidPatq:W},rI}var sI,vF;function nIe(){if(vF)return sI;vF=1;const n=tIe(),e=ZW();return sI=Object.assign(n,e),sI}var rIe=nIe();const sIe=fb(rIe);var wi=function(){return wi=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},wi.apply(this,arguments)};function eb(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}var Gn="-ms-",Nm="-moz-",dn="-webkit-",e5="comm",xS="rule",QN="decl",iIe="@import",t5="@keyframes",oIe="@layer",n5=Math.abs,YN=String.fromCharCode,d2=Object.assign;function aIe(n,e){return Qr(n,0)^45?(((e<<2^Qr(n,0))<<2^Qr(n,1))<<2^Qr(n,2))<<2^Qr(n,3):0}function r5(n){return n.trim()}function hl(n,e){return(n=e.exec(n))?n[0]:n}function Lt(n,e,t){return n.replace(e,t)}function Zx(n,e,t){return n.indexOf(e,t)}function Qr(n,e){return n.charCodeAt(e)|0}function zp(n,e,t){return n.slice(e,t)}function Ra(n){return n.length}function s5(n){return n.length}function Sm(n,e){return e.push(n),n}function lIe(n,e){return n.map(e).join("")}function SF(n,e){return n.filter(function(t){return!hl(t,e)})}var bS=1,Up=1,i5=0,yo=0,$r=0,fg="";function vS(n,e,t,r,s,i,o,a){return{value:n,root:e,parent:t,type:r,props:s,children:i,line:bS,column:Up,length:o,return:"",siblings:a}}function Cu(n,e){return d2(vS("",null,null,"",null,null,0,n.siblings),n,{length:-n.length},e)}function ud(n){for(;n.root;)n=Cu(n.root,{children:[n]});Sm(n,n.siblings)}function uIe(){return $r}function cIe(){return $r=yo>0?Qr(fg,--yo):0,Up--,$r===10&&(Up=1,bS--),$r}function qo(){return $r=yo<i5?Qr(fg,yo++):0,Up++,$r===10&&(Up=1,bS++),$r}function Ff(){return Qr(fg,yo)}function e1(){return yo}function SS(n,e){return zp(fg,n,e)}function p2(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function fIe(n){return bS=Up=1,i5=Ra(fg=n),yo=0,[]}function hIe(n){return fg="",n}function iI(n){return r5(SS(yo-1,g2(n===91?n+2:n===40?n+1:n)))}function dIe(n){for(;($r=Ff())&&$r<33;)qo();return p2(n)>2||p2($r)>3?"":" "}function pIe(n,e){for(;--e&&qo()&&!($r<48||$r>102||$r>57&&$r<65||$r>70&&$r<97););return SS(n,e1()+(e<6&&Ff()==32&&qo()==32))}function g2(n){for(;qo();)switch($r){case n:return yo;case 34:case 39:n!==34&&n!==39&&g2($r);break;case 40:n===41&&g2(n);break;case 92:qo();break}return yo}function gIe(n,e){for(;qo()&&n+$r!==57;)if(n+$r===84&&Ff()===47)break;return"/*"+SS(e,yo-1)+"*"+YN(n===47?n:qo())}function mIe(n){for(;!p2(Ff());)qo();return SS(n,yo)}function yIe(n){return hIe(t1("",null,null,null,[""],n=fIe(n),0,[0],n))}function t1(n,e,t,r,s,i,o,a,l){for(var u=0,f=0,h=o,p=0,g=0,m=0,w=1,x=1,b=1,C=0,$="",k=s,N=i,_=r,U=$;x;)switch(m=C,C=qo()){case 40:if(m!=108&&Qr(U,h-1)==58){Zx(U+=Lt(iI(C),"&","&\f"),"&\f",n5(u?a[u-1]:0))!=-1&&(b=-1);break}case 34:case 39:case 91:U+=iI(C);break;case 9:case 10:case 13:case 32:U+=dIe(m);break;case 92:U+=pIe(e1()-1,7);continue;case 47:switch(Ff()){case 42:case 47:Sm(wIe(gIe(qo(),e1()),e,t,l),l);break;default:U+="/"}break;case 123*w:a[u++]=Ra(U)*b;case 125*w:case 59:case 0:switch(C){case 0:case 125:x=0;case 59+f:b==-1&&(U=Lt(U,/\f/g,"")),g>0&&Ra(U)-h&&Sm(g>32?kF(U+";",r,t,h-1,l):kF(Lt(U," ","")+";",r,t,h-2,l),l);break;case 59:U+=";";default:if(Sm(_=CF(U,e,t,u,f,s,a,$,k=[],N=[],h,i),i),C===123)if(f===0)t1(U,e,_,_,k,i,h,a,N);else switch(p===99&&Qr(U,3)===110?100:p){case 100:case 108:case 109:case 115:t1(n,_,_,r&&Sm(CF(n,_,_,0,0,s,a,$,s,k=[],h,N),N),s,N,h,a,r?k:N);break;default:t1(U,_,_,_,[""],N,0,a,N)}}u=f=g=0,w=b=1,$=U="",h=o;break;case 58:h=1+Ra(U),g=m;default:if(w<1){if(C==123)--w;else if(C==125&&w++==0&&cIe()==125)continue}switch(U+=YN(C),C*w){case 38:b=f>0?1:(U+="\f",-1);break;case 44:a[u++]=(Ra(U)-1)*b,b=1;break;case 64:Ff()===45&&(U+=iI(qo())),p=Ff(),f=h=Ra($=U+=mIe(e1())),C++;break;case 45:m===45&&Ra(U)==2&&(w=0)}}return i}function CF(n,e,t,r,s,i,o,a,l,u,f,h){for(var p=s-1,g=s===0?i:[""],m=s5(g),w=0,x=0,b=0;w<r;++w)for(var C=0,$=zp(n,p+1,p=n5(x=o[w])),k=n;C<m;++C)(k=r5(x>0?g[C]+" "+$:Lt($,/&\f/g,g[C])))&&(l[b++]=k);return vS(n,e,t,s===0?xS:a,l,u,f,h)}function wIe(n,e,t,r){return vS(n,e,t,e5,YN(uIe()),zp(n,2,-2),0,r)}function kF(n,e,t,r,s){return vS(n,e,t,QN,zp(n,0,r),zp(n,r+1,-1),r,s)}function o5(n,e,t){switch(aIe(n,e)){case 5103:return dn+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return dn+n+n;case 4789:return Nm+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return dn+n+Nm+n+Gn+n+n;case 5936:switch(Qr(n,e+11)){case 114:return dn+n+Gn+Lt(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return dn+n+Gn+Lt(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return dn+n+Gn+Lt(n,/[svh]\w+-[tblr]{2}/,"lr")+n}case 6828:case 4268:case 2903:return dn+n+Gn+n+n;case 6165:return dn+n+Gn+"flex-"+n+n;case 5187:return dn+n+Lt(n,/(\w+).+(:[^]+)/,dn+"box-$1$2"+Gn+"flex-$1$2")+n;case 5443:return dn+n+Gn+"flex-item-"+Lt(n,/flex-|-self/g,"")+(hl(n,/flex-|baseline/)?"":Gn+"grid-row-"+Lt(n,/flex-|-self/g,""))+n;case 4675:return dn+n+Gn+"flex-line-pack"+Lt(n,/align-content|flex-|-self/g,"")+n;case 5548:return dn+n+Gn+Lt(n,"shrink","negative")+n;case 5292:return dn+n+Gn+Lt(n,"basis","preferred-size")+n;case 6060:return dn+"box-"+Lt(n,"-grow","")+dn+n+Gn+Lt(n,"grow","positive")+n;case 4554:return dn+Lt(n,/([^-])(transform)/g,"$1"+dn+"$2")+n;case 6187:return Lt(Lt(Lt(n,/(zoom-|grab)/,dn+"$1"),/(image-set)/,dn+"$1"),n,"")+n;case 5495:case 3959:return Lt(n,/(image-set\([^]*)/,dn+"$1$`$1");case 4968:return Lt(Lt(n,/(.+:)(flex-)?(.*)/,dn+"box-pack:$3"+Gn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+dn+n+n;case 4200:if(!hl(n,/flex-|baseline/))return Gn+"grid-column-align"+zp(n,e)+n;break;case 2592:case 3360:return Gn+Lt(n,"template-","")+n;case 4384:case 3616:return t&&t.some(function(r,s){return e=s,hl(r.props,/grid-\w+-end/)})?~Zx(n+(t=t[e].value),"span",0)?n:Gn+Lt(n,"-start","")+n+Gn+"grid-row-span:"+(~Zx(t,"span",0)?hl(t,/\d+/):+hl(t,/\d+/)-+hl(n,/\d+/))+";":Gn+Lt(n,"-start","")+n;case 4896:case 4128:return t&&t.some(function(r){return hl(r.props,/grid-\w+-start/)})?n:Gn+Lt(Lt(n,"-end","-span"),"span ","")+n;case 4095:case 3583:case 4068:case 2532:return Lt(n,/(.+)-inline(.+)/,dn+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ra(n)-1-e>6)switch(Qr(n,e+1)){case 109:if(Qr(n,e+4)!==45)break;case 102:return Lt(n,/(.+:)(.+)-([^]+)/,"$1"+dn+"$2-$3$1"+Nm+(Qr(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~Zx(n,"stretch",0)?o5(Lt(n,"stretch","fill-available"),e,t)+n:n}break;case 5152:case 5920:return Lt(n,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,s,i,o,a,l,u){return Gn+s+":"+i+u+(o?Gn+s+"-span:"+(a?l:+l-+i)+u:"")+n});case 4949:if(Qr(n,e+6)===121)return Lt(n,":",":"+dn)+n;break;case 6444:switch(Qr(n,Qr(n,14)===45?18:11)){case 120:return Lt(n,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+dn+(Qr(n,14)===45?"inline-":"")+"box$3$1"+dn+"$2$3$1"+Gn+"$2box$3")+n;case 100:return Lt(n,":",":"+Gn)+n}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Lt(n,"scroll-","scroll-snap-")+n}return n}function tb(n,e){for(var t="",r=0;r<n.length;r++)t+=e(n[r],r,n,e)||"";return t}function xIe(n,e,t,r){switch(n.type){case oIe:if(n.children.length)break;case iIe:case QN:return n.return=n.return||n.value;case e5:return"";case t5:return n.return=n.value+"{"+tb(n.children,r)+"}";case xS:if(!Ra(n.value=n.props.join(",")))return""}return Ra(t=tb(n.children,r))?n.return=n.value+"{"+t+"}":""}function bIe(n){var e=s5(n);return function(t,r,s,i){for(var o="",a=0;a<e;a++)o+=n[a](t,r,s,i)||"";return o}}function vIe(n){return function(e){e.root||(e=e.return)&&n(e)}}function SIe(n,e,t,r){if(n.length>-1&&!n.return)switch(n.type){case QN:n.return=o5(n.value,n.length,t);return;case t5:return tb([Cu(n,{value:Lt(n.value,"@","@"+dn)})],r);case xS:if(n.length)return lIe(t=n.props,function(s){switch(hl(s,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":ud(Cu(n,{props:[Lt(s,/:(read-\w+)/,":"+Nm+"$1")]})),ud(Cu(n,{props:[s]})),d2(n,{props:SF(t,r)});break;case"::placeholder":ud(Cu(n,{props:[Lt(s,/:(plac\w+)/,":"+dn+"input-$1")]})),ud(Cu(n,{props:[Lt(s,/:(plac\w+)/,":"+Nm+"$1")]})),ud(Cu(n,{props:[Lt(s,/:(plac\w+)/,Gn+"input-$1")]})),ud(Cu(n,{props:[s]})),d2(n,{props:SF(t,r)});break}return""})}}var CIe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},$i={},Vp=typeof process<"u"&&$i!==void 0&&($i.REACT_APP_SC_ATTR||$i.SC_ATTR)||"data-styled",a5="active",l5="data-styled-version",CS="6.1.14",JN=`/*!sc*/
`,nb=typeof window<"u"&&"HTMLElement"in window,kIe=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&$i!==void 0&&$i.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&$i.REACT_APP_SC_DISABLE_SPEEDY!==""?$i.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&$i.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&$i!==void 0&&$i.SC_DISABLE_SPEEDY!==void 0&&$i.SC_DISABLE_SPEEDY!==""&&$i.SC_DISABLE_SPEEDY!=="false"&&$i.SC_DISABLE_SPEEDY),kS=Object.freeze([]),Wp=Object.freeze({});function IIe(n,e,t){return t===void 0&&(t=Wp),n.theme!==t.theme&&n.theme||e||t.theme}var u5=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),EIe=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,AIe=/(^-|-$)/g;function IF(n){return n.replace(EIe,"-").replace(AIe,"")}var TIe=/(a)(d)/gi,vx=52,EF=function(n){return String.fromCharCode(n+(n>25?39:97))};function m2(n){var e,t="";for(e=Math.abs(n);e>vx;e=e/vx|0)t=EF(e%vx)+t;return(EF(e%vx)+t).replace(TIe,"$1-$2")}var oI,c5=5381,wd=function(n,e){for(var t=e.length;t;)n=33*n^e.charCodeAt(--t);return n},f5=function(n){return wd(c5,n)};function NIe(n){return m2(f5(n)>>>0)}function $Ie(n){return n.displayName||n.name||"Component"}function aI(n){return typeof n=="string"&&!0}var h5=typeof Symbol=="function"&&Symbol.for,d5=h5?Symbol.for("react.memo"):60115,RIe=h5?Symbol.for("react.forward_ref"):60112,OIe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},DIe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},p5={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},_Ie=((oI={})[RIe]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},oI[d5]=p5,oI);function AF(n){return("type"in(e=n)&&e.type.$$typeof)===d5?p5:"$$typeof"in n?_Ie[n.$$typeof]:OIe;var e}var PIe=Object.defineProperty,FIe=Object.getOwnPropertyNames,TF=Object.getOwnPropertySymbols,MIe=Object.getOwnPropertyDescriptor,LIe=Object.getPrototypeOf,NF=Object.prototype;function g5(n,e,t){if(typeof e!="string"){if(NF){var r=LIe(e);r&&r!==NF&&g5(n,r,t)}var s=FIe(e);TF&&(s=s.concat(TF(e)));for(var i=AF(n),o=AF(e),a=0;a<s.length;++a){var l=s[a];if(!(l in DIe||t&&t[l]||o&&l in o||i&&l in i)){var u=MIe(e,l);try{PIe(n,l,u)}catch{}}}}return n}function Gp(n){return typeof n=="function"}function ZN(n){return typeof n=="object"&&"styledComponentId"in n}function lf(n,e){return n&&e?"".concat(n," ").concat(e):n||e||""}function $F(n,e){if(n.length===0)return"";for(var t=n[0],r=1;r<n.length;r++)t+=n[r];return t}function r0(n){return n!==null&&typeof n=="object"&&n.constructor.name===Object.name&&!("props"in n&&n.$$typeof)}function y2(n,e,t){if(t===void 0&&(t=!1),!t&&!r0(n)&&!Array.isArray(n))return e;if(Array.isArray(e))for(var r=0;r<e.length;r++)n[r]=y2(n[r],e[r]);else if(r0(e))for(var r in e)n[r]=y2(n[r],e[r]);return n}function e$(n,e){Object.defineProperty(n,"toString",{value:e})}function Gy(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(n," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var BIe=function(){function n(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return n.prototype.indexOfGroup=function(e){for(var t=0,r=0;r<e;r++)t+=this.groupSizes[r];return t},n.prototype.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var r=this.groupSizes,s=r.length,i=s;e>=i;)if((i<<=1)<0)throw Gy(16,"".concat(e));this.groupSizes=new Uint32Array(i),this.groupSizes.set(r),this.length=i;for(var o=s;o<i;o++)this.groupSizes[o]=0}for(var a=this.indexOfGroup(e+1),l=(o=0,t.length);o<l;o++)this.tag.insertRule(a,t[o])&&(this.groupSizes[e]++,a++)},n.prototype.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],r=this.indexOfGroup(e),s=r+t;this.groupSizes[e]=0;for(var i=r;i<s;i++)this.tag.deleteRule(r)}},n.prototype.getGroup=function(e){var t="";if(e>=this.length||this.groupSizes[e]===0)return t;for(var r=this.groupSizes[e],s=this.indexOfGroup(e),i=s+r,o=s;o<i;o++)t+="".concat(this.tag.getRule(o)).concat(JN);return t},n}(),n1=new Map,rb=new Map,r1=1,Sx=function(n){if(n1.has(n))return n1.get(n);for(;rb.has(r1);)r1++;var e=r1++;return n1.set(n,e),rb.set(e,n),e},zIe=function(n,e){r1=e+1,n1.set(n,e),rb.set(e,n)},UIe="style[".concat(Vp,"][").concat(l5,'="').concat(CS,'"]'),VIe=new RegExp("^".concat(Vp,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),WIe=function(n,e,t){for(var r,s=t.split(","),i=0,o=s.length;i<o;i++)(r=s[i])&&n.registerName(e,r)},GIe=function(n,e){for(var t,r=((t=e.textContent)!==null&&t!==void 0?t:"").split(JN),s=[],i=0,o=r.length;i<o;i++){var a=r[i].trim();if(a){var l=a.match(VIe);if(l){var u=0|parseInt(l[1],10),f=l[2];u!==0&&(zIe(f,u),WIe(n,f,l[3]),n.getTag().insertRules(u,s)),s.length=0}else s.push(a)}}},RF=function(n){for(var e=document.querySelectorAll(UIe),t=0,r=e.length;t<r;t++){var s=e[t];s&&s.getAttribute(Vp)!==a5&&(GIe(n,s),s.parentNode&&s.parentNode.removeChild(s))}};function HIe(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var m5=function(n){var e=document.head,t=n||e,r=document.createElement("style"),s=function(a){var l=Array.from(a.querySelectorAll("style[".concat(Vp,"]")));return l[l.length-1]}(t),i=s!==void 0?s.nextSibling:null;r.setAttribute(Vp,a5),r.setAttribute(l5,CS);var o=HIe();return o&&r.setAttribute("nonce",o),t.insertBefore(r,i),r},jIe=function(){function n(e){this.element=m5(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(t){if(t.sheet)return t.sheet;for(var r=document.styleSheets,s=0,i=r.length;s<i;s++){var o=r[s];if(o.ownerNode===t)return o}throw Gy(17)}(this.element),this.length=0}return n.prototype.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch{return!1}},n.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},n.prototype.getRule=function(e){var t=this.sheet.cssRules[e];return t&&t.cssText?t.cssText:""},n}(),KIe=function(){function n(e){this.element=m5(e),this.nodes=this.element.childNodes,this.length=0}return n.prototype.insertRule=function(e,t){if(e<=this.length&&e>=0){var r=document.createTextNode(t);return this.element.insertBefore(r,this.nodes[e]||null),this.length++,!0}return!1},n.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},n.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},n}(),qIe=function(){function n(e){this.rules=[],this.length=0}return n.prototype.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},n.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},n.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},n}(),OF=nb,XIe={isServer:!nb,useCSSOMInjection:!kIe},y5=function(){function n(e,t,r){e===void 0&&(e=Wp),t===void 0&&(t={});var s=this;this.options=wi(wi({},XIe),e),this.gs=t,this.names=new Map(r),this.server=!!e.isServer,!this.server&&nb&&OF&&(OF=!1,RF(this)),e$(this,function(){return function(i){for(var o=i.getTag(),a=o.length,l="",u=function(h){var p=function(b){return rb.get(b)}(h);if(p===void 0)return"continue";var g=i.names.get(p),m=o.getGroup(h);if(g===void 0||!g.size||m.length===0)return"continue";var w="".concat(Vp,".g").concat(h,'[id="').concat(p,'"]'),x="";g!==void 0&&g.forEach(function(b){b.length>0&&(x+="".concat(b,","))}),l+="".concat(m).concat(w,'{content:"').concat(x,'"}').concat(JN)},f=0;f<a;f++)u(f);return l}(s)})}return n.registerId=function(e){return Sx(e)},n.prototype.rehydrate=function(){!this.server&&nb&&RF(this)},n.prototype.reconstructWithOptions=function(e,t){return t===void 0&&(t=!0),new n(wi(wi({},this.options),e),this.gs,t&&this.names||void 0)},n.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},n.prototype.getTag=function(){return this.tag||(this.tag=(e=function(t){var r=t.useCSSOMInjection,s=t.target;return t.isServer?new qIe(s):r?new jIe(s):new KIe(s)}(this.options),new BIe(e)));var e},n.prototype.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},n.prototype.registerName=function(e,t){if(Sx(e),this.names.has(e))this.names.get(e).add(t);else{var r=new Set;r.add(t),this.names.set(e,r)}},n.prototype.insertRules=function(e,t,r){this.registerName(e,t),this.getTag().insertRules(Sx(e),r)},n.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},n.prototype.clearRules=function(e){this.getTag().clearGroup(Sx(e)),this.clearNames(e)},n.prototype.clearTag=function(){this.tag=void 0},n}(),QIe=/&/g,YIe=/^\s*\/\/.*$/gm;function w5(n,e){return n.map(function(t){return t.type==="rule"&&(t.value="".concat(e," ").concat(t.value),t.value=t.value.replaceAll(",",",".concat(e," ")),t.props=t.props.map(function(r){return"".concat(e," ").concat(r)})),Array.isArray(t.children)&&t.type!=="@keyframes"&&(t.children=w5(t.children,e)),t})}function JIe(n){var e,t,r,s=Wp,i=s.options,o=i===void 0?Wp:i,a=s.plugins,l=a===void 0?kS:a,u=function(p,g,m){return m.startsWith(t)&&m.endsWith(t)&&m.replaceAll(t,"").length>0?".".concat(e):p},f=l.slice();f.push(function(p){p.type===xS&&p.value.includes("&")&&(p.props[0]=p.props[0].replace(QIe,t).replace(r,u))}),o.prefix&&f.push(SIe),f.push(xIe);var h=function(p,g,m,w){g===void 0&&(g=""),m===void 0&&(m=""),w===void 0&&(w="&"),e=w,t=g,r=new RegExp("\\".concat(t,"\\b"),"g");var x=p.replace(YIe,""),b=yIe(m||g?"".concat(m," ").concat(g," { ").concat(x," }"):x);o.namespace&&(b=w5(b,o.namespace));var C=[];return tb(b,bIe(f.concat(vIe(function($){return C.push($)})))),C};return h.hash=l.length?l.reduce(function(p,g){return g.name||Gy(15),wd(p,g.name)},c5).toString():"",h}var ZIe=new y5,w2=JIe(),x5=fo.createContext({shouldForwardProp:void 0,styleSheet:ZIe,stylis:w2});x5.Consumer;fo.createContext(void 0);function DF(){return Pe.useContext(x5)}var eEe=function(){function n(e,t){var r=this;this.inject=function(s,i){i===void 0&&(i=w2);var o=r.name+i.hash;s.hasNameForId(r.id,o)||s.insertRules(r.id,o,i(r.rules,o,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=t,e$(this,function(){throw Gy(12,String(r.name))})}return n.prototype.getName=function(e){return e===void 0&&(e=w2),this.name+e.hash},n}(),tEe=function(n){return n>="A"&&n<="Z"};function _F(n){for(var e="",t=0;t<n.length;t++){var r=n[t];if(t===1&&r==="-"&&n[0]==="-")return n;tEe(r)?e+="-"+r.toLowerCase():e+=r}return e.startsWith("ms-")?"-"+e:e}var b5=function(n){return n==null||n===!1||n===""},v5=function(n){var e,t,r=[];for(var s in n){var i=n[s];n.hasOwnProperty(s)&&!b5(i)&&(Array.isArray(i)&&i.isCss||Gp(i)?r.push("".concat(_F(s),":"),i,";"):r0(i)?r.push.apply(r,eb(eb(["".concat(s," {")],v5(i),!1),["}"],!1)):r.push("".concat(_F(s),": ").concat((e=s,(t=i)==null||typeof t=="boolean"||t===""?"":typeof t!="number"||t===0||e in CIe||e.startsWith("--")?String(t).trim():"".concat(t,"px")),";")))}return r};function Mf(n,e,t,r){if(b5(n))return[];if(ZN(n))return[".".concat(n.styledComponentId)];if(Gp(n)){if(!Gp(i=n)||i.prototype&&i.prototype.isReactComponent||!e)return[n];var s=n(e);return Mf(s,e,t,r)}var i;return n instanceof eEe?t?(n.inject(t,r),[n.getName(r)]):[n]:r0(n)?v5(n):Array.isArray(n)?Array.prototype.concat.apply(kS,n.map(function(o){return Mf(o,e,t,r)})):[n.toString()]}function nEe(n){for(var e=0;e<n.length;e+=1){var t=n[e];if(Gp(t)&&!ZN(t))return!1}return!0}var rEe=f5(CS),sEe=function(){function n(e,t,r){this.rules=e,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&nEe(e),this.componentId=t,this.baseHash=wd(rEe,t),this.baseStyle=r,y5.registerId(t)}return n.prototype.generateAndInjectStyles=function(e,t,r){var s=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,t,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&t.hasNameForId(this.componentId,this.staticRulesId))s=lf(s,this.staticRulesId);else{var i=$F(Mf(this.rules,e,t,r)),o=m2(wd(this.baseHash,i)>>>0);if(!t.hasNameForId(this.componentId,o)){var a=r(i,".".concat(o),void 0,this.componentId);t.insertRules(this.componentId,o,a)}s=lf(s,o),this.staticRulesId=o}else{for(var l=wd(this.baseHash,r.hash),u="",f=0;f<this.rules.length;f++){var h=this.rules[f];if(typeof h=="string")u+=h;else if(h){var p=$F(Mf(h,e,t,r));l=wd(l,p+f),u+=p}}if(u){var g=m2(l>>>0);t.hasNameForId(this.componentId,g)||t.insertRules(this.componentId,g,r(u,".".concat(g),void 0,this.componentId)),s=lf(s,g)}}return s},n}(),S5=fo.createContext(void 0);S5.Consumer;var lI={};function iEe(n,e,t){var r=ZN(n),s=n,i=!aI(n),o=e.attrs,a=o===void 0?kS:o,l=e.componentId,u=l===void 0?function(k,N){var _=typeof k!="string"?"sc":IF(k);lI[_]=(lI[_]||0)+1;var U="".concat(_,"-").concat(NIe(CS+_+lI[_]));return N?"".concat(N,"-").concat(U):U}(e.displayName,e.parentComponentId):l,f=e.displayName,h=f===void 0?function(k){return aI(k)?"styled.".concat(k):"Styled(".concat($Ie(k),")")}(n):f,p=e.displayName&&e.componentId?"".concat(IF(e.displayName),"-").concat(e.componentId):e.componentId||u,g=r&&s.attrs?s.attrs.concat(a).filter(Boolean):a,m=e.shouldForwardProp;if(r&&s.shouldForwardProp){var w=s.shouldForwardProp;if(e.shouldForwardProp){var x=e.shouldForwardProp;m=function(k,N){return w(k,N)&&x(k,N)}}else m=w}var b=new sEe(t,p,r?s.componentStyle:void 0);function C(k,N){return function(_,U,O){var L=_.attrs,T=_.componentStyle,I=_.defaultProps,v=_.foldedComponentIds,A=_.styledComponentId,M=_.target,D=fo.useContext(S5),B=DF(),j=_.shouldForwardProp||B.shouldForwardProp,W=IIe(U,D,I)||Wp,P=function(J,ie,ce){for(var ge,be=wi(wi({},ie),{className:void 0,theme:ce}),Ae=0;Ae<J.length;Ae+=1){var ne=Gp(ge=J[Ae])?ge(be):ge;for(var he in ne)be[he]=he==="className"?lf(be[he],ne[he]):he==="style"?wi(wi({},be[he]),ne[he]):ne[he]}return ie.className&&(be.className=lf(be.className,ie.className)),be}(L,U,W),E=P.as||M,R={};for(var H in P)P[H]===void 0||H[0]==="$"||H==="as"||H==="theme"&&P.theme===W||(H==="forwardedAs"?R.as=P.forwardedAs:j&&!j(H,E)||(R[H]=P[H]));var K=function(J,ie){var ce=DF(),ge=J.generateAndInjectStyles(ie,ce.styleSheet,ce.stylis);return ge}(T,P),Q=lf(v,A);return K&&(Q+=" "+K),P.className&&(Q+=" "+P.className),R[aI(E)&&!u5.has(E)?"class":"className"]=Q,O&&(R.ref=O),Pe.createElement(E,R)}($,k,N)}C.displayName=h;var $=fo.forwardRef(C);return $.attrs=g,$.componentStyle=b,$.displayName=h,$.shouldForwardProp=m,$.foldedComponentIds=r?lf(s.foldedComponentIds,s.styledComponentId):"",$.styledComponentId=p,$.target=r?s.target:n,Object.defineProperty($,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(k){this._foldedDefaultProps=r?function(N){for(var _=[],U=1;U<arguments.length;U++)_[U-1]=arguments[U];for(var O=0,L=_;O<L.length;O++)y2(N,L[O],!0);return N}({},s.defaultProps,k):k}}),e$($,function(){return".".concat($.styledComponentId)}),i&&g5($,n,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),$}function PF(n,e){for(var t=[n[0]],r=0,s=e.length;r<s;r+=1)t.push(e[r],n[r+1]);return t}var FF=function(n){return Object.assign(n,{isCss:!0})};function C5(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];if(Gp(n)||r0(n))return FF(Mf(PF(kS,eb([n],e,!0))));var r=n;return e.length===0&&r.length===1&&typeof r[0]=="string"?Mf(r):FF(Mf(PF(r,e)))}function x2(n,e,t){if(t===void 0&&(t=Wp),!e)throw Gy(1,e);var r=function(s){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];return n(e,t,C5.apply(void 0,eb([s],i,!1)))};return r.attrs=function(s){return x2(n,e,wi(wi({},t),{attrs:Array.prototype.concat(t.attrs,s).filter(Boolean)}))},r.withConfig=function(s){return x2(n,e,wi(wi({},t),s))},r}var k5=function(n){return x2(iEe,n)},Hy=k5;u5.forEach(function(n){Hy[n]=k5(n)});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Lf=function(){return Lf=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var s in e=arguments[t])Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s]);return n},Lf.apply(this,arguments)};function jy(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var MF,LF,BF,zF,UF,oEe=C5(MF||(MF=jy([`
  display: flex;
  align-items: center;
  min-width: 322px;
  max-width: 508px;
  height: 48px;
  border: dashed 2px `,`;
  padding: 8px 16px 8px 8px;
  border-radius: 5px;
  cursor: pointer;
  flex-grow: 0;

  &.is-disabled {
    border: dashed 2px `,`;
    cursor: no-drop;
    svg {
      fill: `,`;
      color: `,`;
      path {
        fill: `,`;
        color: `,`;
      }
    }
  }
`],[`
  display: flex;
  align-items: center;
  min-width: 322px;
  max-width: 508px;
  height: 48px;
  border: dashed 2px `,`;
  padding: 8px 16px 8px 8px;
  border-radius: 5px;
  cursor: pointer;
  flex-grow: 0;

  &.is-disabled {
    border: dashed 2px `,`;
    cursor: no-drop;
    svg {
      fill: `,`;
      color: `,`;
      path {
        fill: `,`;
        color: `,`;
      }
    }
  }
`])),"#0658c2","#666","#666","#666","#666","#666"),aEe=Hy.label(LF||(LF=jy([`
  position: relative;
  `,`;
  &:focus-within {
    outline: 2px solid black;
  }
  & > input {
    display: block;
    opacity: 0;
    position: absolute;
    pointer-events: none;
  }
`],[`
  position: relative;
  `,`;
  &:focus-within {
    outline: 2px solid black;
  }
  & > input {
    display: block;
    opacity: 0;
    position: absolute;
    pointer-events: none;
  }
`])),function(n){return n.overRide?"":oEe}),lEe=Hy.div(BF||(BF=jy([`
  border: dashed 2px `,`;
  border-radius: 5px;
  background-color: `,`;
  opacity: 0.9;
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 999;
  & > span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
  }
`],[`
  border: dashed 2px `,`;
  border-radius: 5px;
  background-color: `,`;
  opacity: 0.9;
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 999;
  & > span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
  }
`])),"#666","#999"),uEe=Hy.div(zF||(zF=jy([`
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
  & > span {
    font-size: 12px;
    color: `,`;
  }
  .file-types {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 100px;
  }
`],[`
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
  & > span {
    font-size: 12px;
    color: `,`;
  }
  .file-types {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 100px;
  }
`])),function(n){return n.error?"red":"#666"}),cEe=Hy.span(UF||(UF=jy([`
  font-size: 14px;
  color: `,`;
  span {
    text-decoration: underline;
  }
`],[`
  font-size: 14px;
  color: `,`;
  span {
    text-decoration: underline;
  }
`])),"#666"),VF=function(n){return n/1024/1024},fEe=function(n){return n===void 0?"":n.map(function(e){return".".concat(e.toLowerCase())}).join(",")};function hEe(n){var e=n.types,t=n.minSize,r=n.maxSize;if(e){var s=e.toString(),i="";return r&&(i+="size >= ".concat(r,", ")),t&&(i+="size <= ".concat(t,", ")),Be.jsx("span",Lf({title:"".concat(i,"types: ").concat(s),className:"file-types"},{children:s}),void 0)}return null}function dEe(){return Be.jsxs("svg",Lf({width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[Be.jsx("path",{d:"M5.33317 6.66667H22.6665V16H25.3332V6.66667C25.3332 5.196 24.1372 4 22.6665 4H5.33317C3.8625 4 2.6665 5.196 2.6665 6.66667V22.6667C2.6665 24.1373 3.8625 25.3333 5.33317 25.3333H15.9998V22.6667H5.33317V6.66667Z",fill:"#0658C2"},void 0),Be.jsx("path",{d:"M10.6665 14.6667L6.6665 20H21.3332L15.9998 12L11.9998 17.3333L10.6665 14.6667Z",fill:"#0658C2"},void 0),Be.jsx("path",{d:"M25.3332 18.6667H22.6665V22.6667H18.6665V25.3333H22.6665V29.3333H25.3332V25.3333H29.3332V22.6667H25.3332V18.6667Z",fill:"#0658C2"},void 0)]}),void 0)}var uI=0,pEe=function(n,e,t,r,s,i){return t?Be.jsx("span",{children:"File type/size error, Hovered on types!"},void 0):Be.jsx(cEe,{children:r?Be.jsx("span",{children:"Upload disabled"},void 0):Be.jsx(Be.Fragment,n||e?{children:i?Be.jsx(Be.Fragment,{children:Be.jsx("span",{children:i},void 0)},void 0):Be.jsxs(Be.Fragment,{children:[Be.jsx("span",{children:"Uploaded Successfully!"},void 0)," Upload another?"]},void 0)}:{children:Be.jsxs(Be.Fragment,s?{children:[Be.jsx("span",{children:s.split(" ")[0]},void 0)," ",s.substr(s.indexOf(" ")+1)]}:{children:[Be.jsx("span",{children:"Upload"},void 0)," or drop a file right here"]},void 0)},void 0)},void 0)},gEe=function(n){var e=n.name,t=n.hoverTitle,r=n.types,s=n.handleChange,i=n.classes,o=n.children,a=n.maxSize,l=n.minSize,u=n.fileOrFiles,f=n.onSizeError,h=n.onTypeError,p=n.onSelect,g=n.onDrop,m=n.disabled,w=n.label,x=n.uploadedLabel,b=n.multiple,C=n.required,$=n.onDraggingStateChange,k=n.dropMessageStyle,N=n.ariaLabel,_=n.ariaDescribedby,U=Pe.useRef(null),O=Pe.useRef(null),L=Pe.useState(!1),T=L[0],I=L[1],v=Pe.useState(null),A=v[0],M=v[1],D=Pe.useState(!1),B=D[0],j=D[1],W=function(R){return r&&!function(H,K){var Q=H.name.split(".").pop();return K.map(function(J){return J.toLowerCase()}).includes(Q.toLowerCase())}(R,r)?(j(!0),h&&h("File type is not supported"),!1):a&&VF(R.size)>a?(j(!0),f&&f("File size is too big"),!1):!(l&&VF(R.size)<l)||(j(!0),f&&f("File size is too small"),!1)},P=function(R){var H=!1;if(R){if(R instanceof File)H=!W(R);else for(var K=0;K<R.length;K++){var Q=R[K];H=!W(Q)||H}return!H&&(s&&s(R),M(R),I(!0),j(!1),!0)}return!1},E=function(R){var H=R.labelRef,K=R.inputRef,Q=R.multiple,J=R.handleChanges,ie=R.onDrop,ce=Pe.useState(!1),ge=ce[0],be=ce[1],Ae=Pe.useCallback(function(){K.current.click()},[K]),ne=Pe.useCallback(function(Re){Re.preventDefault(),Re.stopPropagation(),uI++,Re.dataTransfer.items&&Re.dataTransfer.items.length!==0&&be(!0)},[]),he=Pe.useCallback(function(Re){Re.preventDefault(),Re.stopPropagation(),--uI>0||be(!1)},[]),Ie=Pe.useCallback(function(Re){Re.preventDefault(),Re.stopPropagation()},[]),ze=Pe.useCallback(function(Re){Re.preventDefault(),Re.stopPropagation(),be(!1),uI=0;var Ke=Re.dataTransfer.files;if(Ke&&Ke.length>0){var tt=Q?Ke:Ke[0],Xe=J(tt);ie&&Xe&&ie(tt)}},[J]);return Pe.useEffect(function(){var Re=H.current;return Re.addEventListener("click",Ae),Re.addEventListener("dragenter",ne),Re.addEventListener("dragleave",he),Re.addEventListener("dragover",Ie),Re.addEventListener("drop",ze),function(){Re.removeEventListener("click",Ae),Re.removeEventListener("dragenter",ne),Re.removeEventListener("dragleave",he),Re.removeEventListener("dragover",Ie),Re.removeEventListener("drop",ze)}},[Ae,ne,he,Ie,ze,H]),ge}({labelRef:U,inputRef:O,multiple:b,handleChanges:P,onDrop:g});return Pe.useEffect(function(){$==null||$(E)},[E]),Pe.useEffect(function(){u?(I(!0),M(u)):(O.current&&(O.current.value=""),I(!1),M(null))},[u]),Be.jsxs(aEe,Lf({overRide:o,className:"".concat(i||""," ").concat(m?"is-disabled":""),ref:U,htmlFor:e,onClick:function(R){R.preventDefault(),R.stopPropagation()},"aria-describedby":_,role:"button","aria-label":N},{children:[Be.jsx("input",{onClick:function(R){R.stopPropagation(),O&&O.current&&(O.current.value="",O.current.click())},onChange:function(R){var H=R.target.files,K=b?H:H[0],Q=P(K);p&&Q&&p(K)},accept:fEe(r),ref:O,type:"file",id:e,name:e,disabled:m,multiple:b,required:C},void 0),E&&Be.jsx(lEe,Lf({style:k},{children:Be.jsx("span",{children:t||"Drop Here"},void 0)}),void 0),!o&&Be.jsxs(Be.Fragment,{children:[Be.jsx(dEe,{},void 0),Be.jsxs(uEe,Lf({error:B},{children:[pEe(A,T,B,m,w,x),Be.jsx(hEe,{types:r,minSize:l,maxSize:a},void 0)]}),void 0)]},void 0),o]}),void 0)},cI={},fI,WF;function mEe(){if(WF)return fI;WF=1;function n(e,t){if(e===t)return!0;if(!e||!t)return!1;var r=e.length;if(t.length!==r)return!1;for(var s=0;s<r;s++)if(e[s]!==t[s])return!1;return!0}return fI=n,fI}var hI={},dI,GF;function yEe(){if(GF)return dI;GF=1;var n=function(){function e(t,r){var s=[],i=!0,o=!1,a=void 0;try{for(var l=t[Symbol.iterator](),u;!(i=(u=l.next()).done)&&(s.push(u.value),!(r&&s.length===r));i=!0);}catch(f){o=!0,a=f}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}return s}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();return dI=function(e){var t=e.data,r=e.multiSection;function s(u){for(u===null?u=0:u++;u<t.length&&t[u]===0;)u++;return u===t.length?null:u}function i(u){for(u===null?u=t.length-1:u--;u>=0&&t[u]===0;)u--;return u===-1?null:u}function o(u){var f=n(u,2),h=f[0],p=f[1];return r?p===null||p===t[h]-1?(h=s(h),h===null?[null,null]:[h,0]):[h,p+1]:t===0||p===t-1?[null,null]:p===null?[null,0]:[null,p+1]}function a(u){var f=n(u,2),h=f[0],p=f[1];return r?p===null||p===0?(h=i(h),h===null?[null,null]:[h,t[h]-1]):[h,p-1]:t===0||p===0?[null,null]:p===null?[null,t-1]:[null,p-1]}function l(u){return o(u)[1]===null}return{next:o,prev:a,isLast:l}},dI}var Cx={exports:{}},pI,HF;function wEe(){if(HF)return pI;HF=1;var n=Object.prototype.propertyIsEnumerable;function e(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function t(r){var s=Object.getOwnPropertyNames(r);return Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r))),s.filter(function(i){return n.call(r,i)})}return pI=Object.assign||function(r,s){for(var i,o,a=e(r),l=1;l<arguments.length;l++){i=arguments[l],o=t(Object(i));for(var u=0;u<o.length;u++)a[o[u]]=i[o[u]]}return a},pI}var jF;function xEe(){return jF||(jF=1,function(n,e){Object.defineProperty(e,"__esModule",{value:!0});var t=function(){function l(u,f){var h=[],p=!0,g=!1,m=void 0;try{for(var w=u[Symbol.iterator](),x;!(p=(x=w.next()).done)&&(h.push(x.value),!(f&&h.length===f));p=!0);}catch(b){g=!0,m=b}finally{try{!p&&w.return&&w.return()}finally{if(g)throw m}}return h}return function(u,f){if(Array.isArray(u))return u;if(Symbol.iterator in Object(u))return l(u,f);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function r(l){return l&&l.__esModule?l:{default:l}}function s(l){if(Array.isArray(l)){for(var u=0,f=Array(l.length);u<l.length;u++)f[u]=l[u];return f}else return Array.from(l)}var i=wEe(),o=r(i),a=function(u){return u};e.default=function(l){var u=Array.isArray(l)&&l.length===2?l:[l,null],f=t(u,2),h=f[0],p=f[1];return function(g){for(var m=arguments.length,w=Array(m>1?m-1:0),x=1;x<m;x++)w[x-1]=arguments[x];var b=w.map(function(C){return h[C]}).filter(a);return typeof b[0]=="string"||typeof p=="function"?{key:g,className:p?p.apply(void 0,s(b)):b.join(" ")}:{key:g,style:o.default.apply(void 0,[{}].concat(s(b)))}}},n.exports=e.default}(Cx,Cx.exports)),Cx.exports}var gI={},mI={},KF;function t$(){return KF||(KF=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;function e(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(i){return typeof i}:e=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},e(r)}function t(r,s){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(r===s)return!1;var o=Object.keys(r),a=Object.keys(s);if(o.length!==a.length)return!0;var l={},u,f;for(u=0,f=i.length;u<f;u++)l[i[u]]=!0;for(u=0,f=o.length;u<f;u++){var h=o[u],p=r[h],g=s[h];if(p!==g){if(!l[h]||p===null||g===null||e(p)!=="object"||e(g)!=="object")return!0;var m=Object.keys(p),w=Object.keys(g);if(m.length!==w.length)return!0;for(var x=0,b=m.length;x<b;x++){var C=m[x];if(p[C]!==g[C])return!0}}}return!1}}(mI)),mI}var qF;function bEe(){return qF||(qF=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=o(oc()),t=s(_y()),r=s(t$());function s(k){return k&&k.__esModule?k:{default:k}}function i(){if(typeof WeakMap!="function")return null;var k=new WeakMap;return i=function(){return k},k}function o(k){if(k&&k.__esModule)return k;if(k===null||a(k)!=="object"&&typeof k!="function")return{default:k};var N=i();if(N&&N.has(k))return N.get(k);var _={},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in k)if(Object.prototype.hasOwnProperty.call(k,O)){var L=U?Object.getOwnPropertyDescriptor(k,O):null;L&&(L.get||L.set)?Object.defineProperty(_,O,L):_[O]=k[O]}return _.default=k,N&&N.set(k,_),_}function a(k){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a=function(_){return typeof _}:a=function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},a(k)}function l(k,N){if(!(k instanceof N))throw new TypeError("Cannot call a class as a function")}function u(k,N){for(var _=0;_<N.length;_++){var U=N[_];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(k,U.key,U)}}function f(k,N,_){return u(k.prototype,N),k}function h(k){return function(){var N=w(k),_;if(m()){var U=w(this).constructor;_=Reflect.construct(N,arguments,U)}else _=N.apply(this,arguments);return p(this,_)}}function p(k,N){return N&&(a(N)==="object"||typeof N=="function")?N:g(k)}function g(k){if(k===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k}function m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function w(k){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(_){return _.__proto__||Object.getPrototypeOf(_)},w(k)}function x(k,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(N&&N.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),N&&b(k,N)}function b(k,N){return b=Object.setPrototypeOf||function(U,O){return U.__proto__=O,U},b(k,N)}function C(k,N,_){return N in k?Object.defineProperty(k,N,{value:_,enumerable:!0,configurable:!0,writable:!0}):k[N]=_,k}var $=function(k){x(_,k);var N=h(_);function _(){return l(this,_),N.apply(this,arguments)}return f(_,[{key:"shouldComponentUpdate",value:function(O){return(0,r.default)(O,this.props)}},{key:"render",value:function(){var O=this.props,L=O.section,T=O.renderSectionTitle,I=O.theme,v=O.sectionKeyPrefix,A=T(L);return A?e.default.createElement("div",I("".concat(v,"title"),"sectionTitle"),A):null}}]),_}(e.Component);n.default=$,C($,"propTypes",{section:t.default.any.isRequired,renderSectionTitle:t.default.func.isRequired,theme:t.default.func.isRequired,sectionKeyPrefix:t.default.string.isRequired})}(gI)),gI}var yI={},wI={},XF;function vEe(){return XF||(XF=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=o(oc()),t=s(_y()),r=s(t$());function s(L){return L&&L.__esModule?L:{default:L}}function i(){if(typeof WeakMap!="function")return null;var L=new WeakMap;return i=function(){return L},L}function o(L){if(L&&L.__esModule)return L;if(L===null||a(L)!=="object"&&typeof L!="function")return{default:L};var T=i();if(T&&T.has(L))return T.get(L);var I={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var A in L)if(Object.prototype.hasOwnProperty.call(L,A)){var M=v?Object.getOwnPropertyDescriptor(L,A):null;M&&(M.get||M.set)?Object.defineProperty(I,A,M):I[A]=L[A]}return I.default=L,T&&T.set(L,I),I}function a(L){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a=function(I){return typeof I}:a=function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},a(L)}function l(){return l=Object.assign||function(L){for(var T=1;T<arguments.length;T++){var I=arguments[T];for(var v in I)Object.prototype.hasOwnProperty.call(I,v)&&(L[v]=I[v])}return L},l.apply(this,arguments)}function u(L,T){var I=Object.keys(L);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(L);T&&(v=v.filter(function(A){return Object.getOwnPropertyDescriptor(L,A).enumerable})),I.push.apply(I,v)}return I}function f(L){for(var T=1;T<arguments.length;T++){var I=arguments[T]!=null?arguments[T]:{};T%2?u(Object(I),!0).forEach(function(v){U(L,v,I[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(L,Object.getOwnPropertyDescriptors(I)):u(Object(I)).forEach(function(v){Object.defineProperty(L,v,Object.getOwnPropertyDescriptor(I,v))})}return L}function h(L,T){if(L==null)return{};var I=p(L,T),v,A;if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(L);for(A=0;A<M.length;A++)v=M[A],!(T.indexOf(v)>=0)&&Object.prototype.propertyIsEnumerable.call(L,v)&&(I[v]=L[v])}return I}function p(L,T){if(L==null)return{};var I={},v=Object.keys(L),A,M;for(M=0;M<v.length;M++)A=v[M],!(T.indexOf(A)>=0)&&(I[A]=L[A]);return I}function g(L,T){if(!(L instanceof T))throw new TypeError("Cannot call a class as a function")}function m(L,T){for(var I=0;I<T.length;I++){var v=T[I];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(L,v.key,v)}}function w(L,T,I){return m(L.prototype,T),L}function x(L){return function(){var T=k(L),I;if($()){var v=k(this).constructor;I=Reflect.construct(T,arguments,v)}else I=T.apply(this,arguments);return b(this,I)}}function b(L,T){return T&&(a(T)==="object"||typeof T=="function")?T:C(L)}function C(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L}function $(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function k(L){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(I){return I.__proto__||Object.getPrototypeOf(I)},k(L)}function N(L,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function");L.prototype=Object.create(T&&T.prototype,{constructor:{value:L,writable:!0,configurable:!0}}),T&&_(L,T)}function _(L,T){return _=Object.setPrototypeOf||function(v,A){return v.__proto__=A,v},_(L,T)}function U(L,T,I){return T in L?Object.defineProperty(L,T,{value:I,enumerable:!0,configurable:!0,writable:!0}):L[T]=I,L}var O=function(L){N(I,L);var T=x(I);function I(){var v;g(this,I);for(var A=arguments.length,M=new Array(A),D=0;D<A;D++)M[D]=arguments[D];return v=T.call.apply(T,[this].concat(M)),U(C(v),"storeItemReference",function(B){B!==null&&(v.item=B)}),U(C(v),"onMouseEnter",function(B){var j=v.props,W=j.sectionIndex,P=j.itemIndex;v.props.onMouseEnter(B,{sectionIndex:W,itemIndex:P})}),U(C(v),"onMouseLeave",function(B){var j=v.props,W=j.sectionIndex,P=j.itemIndex;v.props.onMouseLeave(B,{sectionIndex:W,itemIndex:P})}),U(C(v),"onMouseDown",function(B){var j=v.props,W=j.sectionIndex,P=j.itemIndex;v.props.onMouseDown(B,{sectionIndex:W,itemIndex:P})}),U(C(v),"onClick",function(B){var j=v.props,W=j.sectionIndex,P=j.itemIndex;v.props.onClick(B,{sectionIndex:W,itemIndex:P})}),v}return w(I,[{key:"shouldComponentUpdate",value:function(A){return(0,r.default)(A,this.props,["renderItemData"])}},{key:"render",value:function(){var A=this.props,M=A.isHighlighted,D=A.item,B=A.renderItem,j=A.renderItemData,W=h(A,["isHighlighted","item","renderItem","renderItemData"]);return delete W.sectionIndex,delete W.itemIndex,typeof W.onMouseEnter=="function"&&(W.onMouseEnter=this.onMouseEnter),typeof W.onMouseLeave=="function"&&(W.onMouseLeave=this.onMouseLeave),typeof W.onMouseDown=="function"&&(W.onMouseDown=this.onMouseDown),typeof W.onClick=="function"&&(W.onClick=this.onClick),e.default.createElement("li",l({role:"option"},W,{ref:this.storeItemReference}),B(D,f({isHighlighted:M},j)))}}]),I}(e.Component);n.default=O,U(O,"propTypes",{sectionIndex:t.default.number,isHighlighted:t.default.bool.isRequired,itemIndex:t.default.number.isRequired,item:t.default.any.isRequired,renderItem:t.default.func.isRequired,renderItemData:t.default.object.isRequired,onMouseEnter:t.default.func,onMouseLeave:t.default.func,onMouseDown:t.default.func,onClick:t.default.func})}(wI)),wI}var QF;function SEe(){return QF||(QF=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=a(oc()),t=i(_y()),r=i(vEe()),s=i(t$());function i(O){return O&&O.__esModule?O:{default:O}}function o(){if(typeof WeakMap!="function")return null;var O=new WeakMap;return o=function(){return O},O}function a(O){if(O&&O.__esModule)return O;if(O===null||l(O)!=="object"&&typeof O!="function")return{default:O};var L=o();if(L&&L.has(O))return L.get(O);var T={},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in O)if(Object.prototype.hasOwnProperty.call(O,v)){var A=I?Object.getOwnPropertyDescriptor(O,v):null;A&&(A.get||A.set)?Object.defineProperty(T,v,A):T[v]=O[v]}return T.default=O,L&&L.set(O,T),T}function l(O){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(T){return typeof T}:l=function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},l(O)}function u(){return u=Object.assign||function(O){for(var L=1;L<arguments.length;L++){var T=arguments[L];for(var I in T)Object.prototype.hasOwnProperty.call(T,I)&&(O[I]=T[I])}return O},u.apply(this,arguments)}function f(O,L){var T=Object.keys(O);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(O);L&&(I=I.filter(function(v){return Object.getOwnPropertyDescriptor(O,v).enumerable})),T.push.apply(T,I)}return T}function h(O){for(var L=1;L<arguments.length;L++){var T=arguments[L]!=null?arguments[L]:{};L%2?f(Object(T),!0).forEach(function(I){_(O,I,T[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(T)):f(Object(T)).forEach(function(I){Object.defineProperty(O,I,Object.getOwnPropertyDescriptor(T,I))})}return O}function p(O,L){if(!(O instanceof L))throw new TypeError("Cannot call a class as a function")}function g(O,L){for(var T=0;T<L.length;T++){var I=L[T];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(O,I.key,I)}}function m(O,L,T){return g(O.prototype,L),O}function w(O){return function(){var L=$(O),T;if(C()){var I=$(this).constructor;T=Reflect.construct(L,arguments,I)}else T=L.apply(this,arguments);return x(this,T)}}function x(O,L){return L&&(l(L)==="object"||typeof L=="function")?L:b(O)}function b(O){if(O===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function $(O){return $=Object.setPrototypeOf?Object.getPrototypeOf:function(T){return T.__proto__||Object.getPrototypeOf(T)},$(O)}function k(O,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function");O.prototype=Object.create(L&&L.prototype,{constructor:{value:O,writable:!0,configurable:!0}}),L&&N(O,L)}function N(O,L){return N=Object.setPrototypeOf||function(I,v){return I.__proto__=v,I},N(O,L)}function _(O,L,T){return L in O?Object.defineProperty(O,L,{value:T,enumerable:!0,configurable:!0,writable:!0}):O[L]=T,O}var U=function(O){k(T,O);var L=w(T);function T(){var I;p(this,T);for(var v=arguments.length,A=new Array(v),M=0;M<v;M++)A[M]=arguments[M];return I=L.call.apply(L,[this].concat(A)),_(b(I),"storeHighlightedItemReference",function(D){I.props.onHighlightedItemChange(D===null?null:D.item)}),I}return m(T,[{key:"shouldComponentUpdate",value:function(v){return(0,s.default)(v,this.props,["itemProps"])}},{key:"render",value:function(){var v=this,A=this.props,M=A.items,D=A.itemProps,B=A.renderItem,j=A.renderItemData,W=A.sectionIndex,P=A.highlightedItemIndex,E=A.getItemId,R=A.theme,H=A.keyPrefix,K=W===null?H:"".concat(H,"section-").concat(W,"-"),Q=typeof D=="function";return e.default.createElement("ul",u({role:"listbox"},R("".concat(K,"items-list"),"itemsList")),M.map(function(J,ie){var ce=ie===0,ge=ie===P,be="".concat(K,"item-").concat(ie),Ae=Q?D({sectionIndex:W,itemIndex:ie}):D,ne=h({id:E(W,ie),"aria-selected":ge},R(be,"item",ce&&"itemFirst",ge&&"itemHighlighted"),{},Ae);return ge&&(ne.ref=v.storeHighlightedItemReference),e.default.createElement(r.default,u({},ne,{sectionIndex:W,isHighlighted:ge,itemIndex:ie,item:J,renderItem:B,renderItemData:j}))}))}}]),T}(e.Component);n.default=U,_(U,"propTypes",{items:t.default.array.isRequired,itemProps:t.default.oneOfType([t.default.object,t.default.func]),renderItem:t.default.func.isRequired,renderItemData:t.default.object.isRequired,sectionIndex:t.default.number,highlightedItemIndex:t.default.number,onHighlightedItemChange:t.default.func.isRequired,getItemId:t.default.func.isRequired,theme:t.default.func.isRequired,keyPrefix:t.default.string.isRequired}),_(U,"defaultProps",{sectionIndex:null})}(yI)),yI}var YF;function CEe(){return YF||(YF=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=u(oc()),t=a(_y()),r=a(yEe()),s=a(xEe()),i=a(bEe()),o=a(SEe());function a(P){return P&&P.__esModule?P:{default:P}}function l(){if(typeof WeakMap!="function")return null;var P=new WeakMap;return l=function(){return P},P}function u(P){if(P&&P.__esModule)return P;if(P===null||C(P)!=="object"&&typeof P!="function")return{default:P};var E=l();if(E&&E.has(P))return E.get(P);var R={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in P)if(Object.prototype.hasOwnProperty.call(P,K)){var Q=H?Object.getOwnPropertyDescriptor(P,K):null;Q&&(Q.get||Q.set)?Object.defineProperty(R,K,Q):R[K]=P[K]}return R.default=P,E&&E.set(P,R),R}function f(P,E){var R=Object.keys(P);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(P);E&&(H=H.filter(function(K){return Object.getOwnPropertyDescriptor(P,K).enumerable})),R.push.apply(R,H)}return R}function h(P){for(var E=1;E<arguments.length;E++){var R=arguments[E]!=null?arguments[E]:{};E%2?f(Object(R),!0).forEach(function(H){A(P,H,R[H])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(R)):f(Object(R)).forEach(function(H){Object.defineProperty(P,H,Object.getOwnPropertyDescriptor(R,H))})}return P}function p(P,E){return b(P)||x(P,E)||m(P,E)||g()}function g(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m(P,E){if(P){if(typeof P=="string")return w(P,E);var R=Object.prototype.toString.call(P).slice(8,-1);if(R==="Object"&&P.constructor&&(R=P.constructor.name),R==="Map"||R==="Set")return Array.from(R);if(R==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(R))return w(P,E)}}function w(P,E){(E==null||E>P.length)&&(E=P.length);for(var R=0,H=new Array(E);R<E;R++)H[R]=P[R];return H}function x(P,E){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(P)))){var R=[],H=!0,K=!1,Q=void 0;try{for(var J=P[Symbol.iterator](),ie;!(H=(ie=J.next()).done)&&(R.push(ie.value),!(E&&R.length===E));H=!0);}catch(ce){K=!0,Q=ce}finally{try{!H&&J.return!=null&&J.return()}finally{if(K)throw Q}}return R}}function b(P){if(Array.isArray(P))return P}function C(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?C=function(R){return typeof R}:C=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},C(P)}function $(P,E){if(!(P instanceof E))throw new TypeError("Cannot call a class as a function")}function k(P,E){for(var R=0;R<E.length;R++){var H=E[R];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(P,H.key,H)}}function N(P,E,R){return k(P.prototype,E),P}function _(P){return function(){var E=T(P),R;if(L()){var H=T(this).constructor;R=Reflect.construct(E,arguments,H)}else R=E.apply(this,arguments);return U(this,R)}}function U(P,E){return E&&(C(E)==="object"||typeof E=="function")?E:O(P)}function O(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function T(P){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(R){return R.__proto__||Object.getPrototypeOf(R)},T(P)}function I(P,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function");P.prototype=Object.create(E&&E.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),E&&v(P,E)}function v(P,E){return v=Object.setPrototypeOf||function(H,K){return H.__proto__=K,H},v(P,E)}function A(P,E,R){return E in P?Object.defineProperty(P,E,{value:R,enumerable:!0,configurable:!0,writable:!0}):P[E]=R,P}var M={},D=function(E){return e.default.createElement("input",E)},B=function(E){var R=E.containerProps,H=E.children;return e.default.createElement("div",R,H)},j={container:"react-autowhatever__container",containerOpen:"react-autowhatever__container--open",input:"react-autowhatever__input",inputOpen:"react-autowhatever__input--open",inputFocused:"react-autowhatever__input--focused",itemsContainer:"react-autowhatever__items-container",itemsContainerOpen:"react-autowhatever__items-container--open",itemsList:"react-autowhatever__items-list",item:"react-autowhatever__item",itemFirst:"react-autowhatever__item--first",itemHighlighted:"react-autowhatever__item--highlighted",sectionContainer:"react-autowhatever__section-container",sectionContainerFirst:"react-autowhatever__section-container--first",sectionTitle:"react-autowhatever__section-title"},W=function(P){I(R,P);var E=_(R);function R(H){var K;return $(this,R),K=E.call(this,H),A(O(K),"storeInputReference",function(Q){Q!==null&&(K.input=Q);var J=K.props.inputProps.ref;J&&(typeof J=="function"?J(Q):C(J)==="object"&&Object.prototype.hasOwnProperty.call(J,"current")&&(J.current=Q))}),A(O(K),"storeItemsContainerReference",function(Q){Q!==null&&(K.itemsContainer=Q)}),A(O(K),"onHighlightedItemChange",function(Q){K.highlightedItem=Q}),A(O(K),"getItemId",function(Q,J){if(J===null)return null;var ie=K.props.id,ce=Q===null?"":"section-".concat(Q);return"react-autowhatever-".concat(ie,"-").concat(ce,"-item-").concat(J)}),A(O(K),"onFocus",function(Q){var J=K.props.inputProps;K.setState({isInputFocused:!0}),J.onFocus&&J.onFocus(Q)}),A(O(K),"onBlur",function(Q){var J=K.props.inputProps;K.setState({isInputFocused:!1}),J.onBlur&&J.onBlur(Q)}),A(O(K),"onKeyDown",function(Q){var J=K.props,ie=J.inputProps,ce=J.highlightedSectionIndex,ge=J.highlightedItemIndex,be=Q.keyCode;switch(be){case 40:case 38:{var Ae=be===40?"next":"prev",ne=K.sectionIterator[Ae]([ce,ge]),he=p(ne,2),Ie=he[0],ze=he[1];ie.onKeyDown(Q,{newHighlightedSectionIndex:Ie,newHighlightedItemIndex:ze});break}default:ie.onKeyDown(Q,{highlightedSectionIndex:ce,highlightedItemIndex:ge})}}),K.highlightedItem=null,K.state={isInputFocused:!1},K.setSectionsItems(H),K.setSectionIterator(H),K.setTheme(H),K}return N(R,[{key:"componentDidMount",value:function(){this.ensureHighlightedItemIsVisible()}},{key:"UNSAFE_componentWillReceiveProps",value:function(K){K.items!==this.props.items&&this.setSectionsItems(K),(K.items!==this.props.items||K.multiSection!==this.props.multiSection)&&this.setSectionIterator(K),K.theme!==this.props.theme&&this.setTheme(K)}},{key:"componentDidUpdate",value:function(){this.ensureHighlightedItemIsVisible()}},{key:"setSectionsItems",value:function(K){K.multiSection&&(this.sectionsItems=K.items.map(function(Q){return K.getSectionItems(Q)}),this.sectionsLengths=this.sectionsItems.map(function(Q){return Q.length}),this.allSectionsAreEmpty=this.sectionsLengths.every(function(Q){return Q===0}))}},{key:"setSectionIterator",value:function(K){this.sectionIterator=(0,r.default)({multiSection:K.multiSection,data:K.multiSection?this.sectionsLengths:K.items.length})}},{key:"setTheme",value:function(K){this.theme=(0,s.default)(K.theme)}},{key:"renderSections",value:function(){var K=this;if(this.allSectionsAreEmpty)return null;var Q=this.theme,J=this.props,ie=J.id,ce=J.items,ge=J.renderItem,be=J.renderItemData,Ae=J.renderSectionTitle,ne=J.highlightedSectionIndex,he=J.highlightedItemIndex,Ie=J.itemProps;return ce.map(function(ze,Re){var Ke="react-autowhatever-".concat(ie,"-"),tt="".concat(Ke,"section-").concat(Re,"-"),Xe=Re===0;return e.default.createElement("div",Q("".concat(tt,"container"),"sectionContainer",Xe&&"sectionContainerFirst"),e.default.createElement(i.default,{section:ze,renderSectionTitle:Ae,theme:Q,sectionKeyPrefix:tt}),e.default.createElement(o.default,{items:K.sectionsItems[Re],itemProps:Ie,renderItem:ge,renderItemData:be,sectionIndex:Re,highlightedItemIndex:ne===Re?he:null,onHighlightedItemChange:K.onHighlightedItemChange,getItemId:K.getItemId,theme:Q,keyPrefix:Ke,ref:K.storeItemsListReference}))})}},{key:"renderItems",value:function(){var K=this.props.items;if(K.length===0)return null;var Q=this.theme,J=this.props,ie=J.id,ce=J.renderItem,ge=J.renderItemData,be=J.highlightedSectionIndex,Ae=J.highlightedItemIndex,ne=J.itemProps;return e.default.createElement(o.default,{items:K,itemProps:ne,renderItem:ce,renderItemData:ge,highlightedItemIndex:be===null?Ae:null,onHighlightedItemChange:this.onHighlightedItemChange,getItemId:this.getItemId,theme:Q,keyPrefix:"react-autowhatever-".concat(ie,"-")})}},{key:"ensureHighlightedItemIsVisible",value:function(){var K=this.highlightedItem;if(K){var Q=this.itemsContainer,J=K.offsetParent===Q?K.offsetTop:K.offsetTop-Q.offsetTop,ie=Q.scrollTop;J<ie?ie=J:J+K.offsetHeight>ie+Q.offsetHeight&&(ie=J+K.offsetHeight-Q.offsetHeight),ie!==Q.scrollTop&&(Q.scrollTop=ie)}}},{key:"render",value:function(){var K=this.theme,Q=this.props,J=Q.id,ie=Q.multiSection,ce=Q.renderInputComponent,ge=Q.renderItemsContainer,be=Q.highlightedSectionIndex,Ae=Q.highlightedItemIndex,ne=this.state.isInputFocused,he=ie?this.renderSections():this.renderItems(),Ie=he!==null,ze=this.getItemId(be,Ae),Re="react-autowhatever-".concat(J),Ke=h({role:"combobox","aria-haspopup":"listbox","aria-owns":Re,"aria-expanded":Ie},K("react-autowhatever-".concat(J,"-container"),"container",Ie&&"containerOpen"),{},this.props.containerProps),tt=ce(h({type:"text",value:"",autoComplete:"off","aria-autocomplete":"list","aria-controls":Re,"aria-activedescendant":ze},K("react-autowhatever-".concat(J,"-input"),"input",Ie&&"inputOpen",ne&&"inputFocused"),{},this.props.inputProps,{onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.props.inputProps.onKeyDown&&this.onKeyDown,ref:this.storeInputReference})),Xe=ge({containerProps:h({id:Re,role:"listbox"},K("react-autowhatever-".concat(J,"-items-container"),"itemsContainer",Ie&&"itemsContainerOpen"),{ref:this.storeItemsContainerReference}),children:he});return e.default.createElement("div",Ke,tt,Xe)}}]),R}(e.Component);n.default=W,A(W,"propTypes",{id:t.default.string,multiSection:t.default.bool,renderInputComponent:t.default.func,renderItemsContainer:t.default.func,items:t.default.array.isRequired,renderItem:t.default.func,renderItemData:t.default.object,renderSectionTitle:t.default.func,getSectionItems:t.default.func,containerProps:t.default.object,inputProps:t.default.object,itemProps:t.default.oneOfType([t.default.object,t.default.func]),highlightedSectionIndex:t.default.number,highlightedItemIndex:t.default.number,theme:t.default.oneOfType([t.default.object,t.default.array])}),A(W,"defaultProps",{id:"1",multiSection:!1,renderInputComponent:D,renderItemsContainer:B,renderItem:function(){throw new Error("`renderItem` must be provided")},renderItemData:M,renderSectionTitle:function(){throw new Error("`renderSectionTitle` must be provided")},getSectionItems:function(){throw new Error("`getSectionItems` must be provided")},containerProps:M,inputProps:M,itemProps:M,highlightedSectionIndex:null,highlightedItemIndex:null,theme:j})}(hI)),hI}var Gc={},JF;function kEe(){if(JF)return Gc;JF=1,Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.mapToAutowhateverTheme=Gc.defaultTheme=void 0;var n={container:"react-autosuggest__container",containerOpen:"react-autosuggest__container--open",input:"react-autosuggest__input",inputOpen:"react-autosuggest__input--open",inputFocused:"react-autosuggest__input--focused",suggestionsContainer:"react-autosuggest__suggestions-container",suggestionsContainerOpen:"react-autosuggest__suggestions-container--open",suggestionsList:"react-autosuggest__suggestions-list",suggestion:"react-autosuggest__suggestion",suggestionFirst:"react-autosuggest__suggestion--first",suggestionHighlighted:"react-autosuggest__suggestion--highlighted",sectionContainer:"react-autosuggest__section-container",sectionContainerFirst:"react-autosuggest__section-container--first",sectionTitle:"react-autosuggest__section-title"};Gc.defaultTheme=n;var e=function(r){var s={};for(var i in r)switch(i){case"suggestionsContainer":s.itemsContainer=r[i];break;case"suggestionsContainerOpen":s.itemsContainerOpen=r[i];break;case"suggestion":s.item=r[i];break;case"suggestionFirst":s.itemFirst=r[i];break;case"suggestionHighlighted":s.itemHighlighted=r[i];break;case"suggestionsList":s.itemsList=r[i];break;default:s[i]=r[i]}return s};return Gc.mapToAutowhateverTheme=e,Gc}var ZF;function IEe(){return ZF||(ZF=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=l(oc()),t=o(_y()),r=o(mEe()),s=o(CEe()),i=kEe();function o(W){return W&&W.__esModule?W:{default:W}}function a(){if(typeof WeakMap!="function")return null;var W=new WeakMap;return a=function(){return W},W}function l(W){if(W&&W.__esModule)return W;if(W===null||u(W)!=="object"&&typeof W!="function")return{default:W};var P=a();if(P&&P.has(W))return P.get(W);var E={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in W)if(Object.prototype.hasOwnProperty.call(W,H)){var K=R?Object.getOwnPropertyDescriptor(W,H):null;K&&(K.get||K.set)?Object.defineProperty(E,H,K):E[H]=W[H]}return E.default=W,P&&P.set(W,E),E}function u(W){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u=function(E){return typeof E}:u=function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},u(W)}function f(W,P){var E=Object.keys(W);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(W);P&&(R=R.filter(function(H){return Object.getOwnPropertyDescriptor(W,H).enumerable})),E.push.apply(E,R)}return E}function h(W){for(var P=1;P<arguments.length;P++){var E=arguments[P]!=null?arguments[P]:{};P%2?f(Object(E),!0).forEach(function(R){_(W,R,E[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(W,Object.getOwnPropertyDescriptors(E)):f(Object(E)).forEach(function(R){Object.defineProperty(W,R,Object.getOwnPropertyDescriptor(E,R))})}return W}function p(W,P){if(!(W instanceof P))throw new TypeError("Cannot call a class as a function")}function g(W,P){for(var E=0;E<P.length;E++){var R=P[E];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(W,R.key,R)}}function m(W,P,E){return g(W.prototype,P),W}function w(W){return function(){var P=$(W),E;if(C()){var R=$(this).constructor;E=Reflect.construct(P,arguments,R)}else E=P.apply(this,arguments);return x(this,E)}}function x(W,P){return P&&(u(P)==="object"||typeof P=="function")?P:b(W)}function b(W){if(W===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return W}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function $(W){return $=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)},$(W)}function k(W,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function");W.prototype=Object.create(P&&P.prototype,{constructor:{value:W,writable:!0,configurable:!0}}),P&&N(W,P)}function N(W,P){return N=Object.setPrototypeOf||function(R,H){return R.__proto__=H,R},N(W,P)}function _(W,P,E){return P in W?Object.defineProperty(W,P,{value:E,enumerable:!0,configurable:!0,writable:!0}):W[P]=E,W}var U=function(){return!0},O=function(P){return P.trim().length>0},L=function(P){var E=P.containerProps,R=P.children;return e.default.createElement("div",E,R)},T="suggestions-revealed",I="suggestions-updated",v="suggestion-selected",A="input-focused",M="input-changed",D="input-blurred",B="escape-pressed",j=function(W){k(E,W);var P=w(E);function E(R){var H,K=R.alwaysRenderSuggestions;return p(this,E),H=P.call(this),_(b(H),"onDocumentMouseDown",function(Q){H.justClickedOnSuggestionsContainer=!1;for(var J=Q.detail&&Q.detail.target||Q.target;J!==null&&J!==document;){if(J.getAttribute&&J.getAttribute("data-suggestion-index")!==null)return;if(J===H.suggestionsContainer){H.justClickedOnSuggestionsContainer=!0;return}J=J.parentNode}}),_(b(H),"storeAutowhateverRef",function(Q){Q!==null&&(H.autowhatever=Q)}),_(b(H),"onSuggestionMouseEnter",function(Q,J){var ie=J.sectionIndex,ce=J.itemIndex;H.updateHighlightedSuggestion(ie,ce),Q.target===H.pressedSuggestion&&(H.justSelectedSuggestion=!0),H.justMouseEntered=!0,setTimeout(function(){H.justMouseEntered=!1})}),_(b(H),"highlightFirstSuggestion",function(){H.updateHighlightedSuggestion(H.props.multiSection?0:null,0)}),_(b(H),"onDocumentMouseUp",function(){H.pressedSuggestion&&!H.justSelectedSuggestion&&H.input.focus(),H.pressedSuggestion=null}),_(b(H),"onSuggestionMouseDown",function(Q){H.justSelectedSuggestion||(H.justSelectedSuggestion=!0,H.pressedSuggestion=Q.target)}),_(b(H),"onSuggestionsClearRequested",function(){var Q=H.props.onSuggestionsClearRequested;Q&&Q()}),_(b(H),"onSuggestionSelected",function(Q,J){var ie=H.props,ce=ie.alwaysRenderSuggestions,ge=ie.onSuggestionSelected,be=ie.onSuggestionsFetchRequested;ge&&ge(Q,J);var Ae=H.props.shouldKeepSuggestionsOnSelect(J.suggestion);ce||Ae?be({value:J.suggestionValue,reason:v}):H.onSuggestionsClearRequested(),H.resetHighlightedSuggestion()}),_(b(H),"onSuggestionClick",function(Q){var J=H.props,ie=J.alwaysRenderSuggestions,ce=J.focusInputOnSuggestionClick,ge=H.getSuggestionIndices(H.findSuggestionElement(Q.target)),be=ge.sectionIndex,Ae=ge.suggestionIndex,ne=H.getSuggestion(be,Ae),he=H.props.getSuggestionValue(ne);H.maybeCallOnChange(Q,he,"click"),H.onSuggestionSelected(Q,{suggestion:ne,suggestionValue:he,suggestionIndex:Ae,sectionIndex:be,method:"click"});var Ie=H.props.shouldKeepSuggestionsOnSelect(ne);ie||Ie||H.closeSuggestions(),ce===!0?H.input.focus():H.onBlur(),setTimeout(function(){H.justSelectedSuggestion=!1})}),_(b(H),"onBlur",function(){var Q=H.props,J=Q.inputProps,ie=Q.shouldRenderSuggestions,ce=J.value,ge=J.onBlur,be=H.getHighlightedSuggestion(),Ae=ie(ce,D);H.setState({isFocused:!1,highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:null,isCollapsed:!Ae}),ge&&ge(H.blurEvent,{highlightedSuggestion:be})}),_(b(H),"onSuggestionMouseLeave",function(Q){H.resetHighlightedSuggestion(!1),H.justSelectedSuggestion&&Q.target===H.pressedSuggestion&&(H.justSelectedSuggestion=!1)}),_(b(H),"onSuggestionTouchStart",function(){H.justSelectedSuggestion=!0}),_(b(H),"onSuggestionTouchMove",function(){H.justSelectedSuggestion=!1,H.pressedSuggestion=null,H.input.focus()}),_(b(H),"itemProps",function(Q){var J=Q.sectionIndex,ie=Q.itemIndex;return{"data-section-index":J,"data-suggestion-index":ie,onMouseEnter:H.onSuggestionMouseEnter,onMouseLeave:H.onSuggestionMouseLeave,onMouseDown:H.onSuggestionMouseDown,onTouchStart:H.onSuggestionTouchStart,onTouchMove:H.onSuggestionTouchMove,onClick:H.onSuggestionClick}}),_(b(H),"renderSuggestionsContainer",function(Q){var J=Q.containerProps,ie=Q.children,ce=H.props.renderSuggestionsContainer;return ce({containerProps:J,children:ie,query:H.getQuery()})}),H.state={isFocused:!1,isCollapsed:!K,highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:null},H.justPressedUpDown=!1,H.justMouseEntered=!1,H.pressedSuggestion=null,H}return m(E,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onDocumentMouseDown),document.addEventListener("mouseup",this.onDocumentMouseUp),this.input=this.autowhatever.input,this.suggestionsContainer=this.autowhatever.itemsContainer}},{key:"UNSAFE_componentWillReceiveProps",value:function(H){var K=this.state.highlightedSuggestionIndex===0&&this.props.highlightFirstSuggestion&&!H.highlightFirstSuggestion;(0,r.default)(H.suggestions,this.props.suggestions)?H.highlightFirstSuggestion&&H.suggestions.length>0&&this.justPressedUpDown===!1&&this.justMouseEntered===!1?this.highlightFirstSuggestion():K&&this.resetHighlightedSuggestion():this.willRenderSuggestions(H,I)?(this.state.isCollapsed&&!this.justSelectedSuggestion&&this.revealSuggestions(),K&&this.resetHighlightedSuggestion()):this.resetHighlightedSuggestion()}},{key:"componentDidUpdate",value:function(H,K){var Q=this.props,J=Q.suggestions,ie=Q.onSuggestionHighlighted,ce=Q.highlightFirstSuggestion;if(!(0,r.default)(J,H.suggestions)&&J.length>0&&ce){this.highlightFirstSuggestion();return}if(ie){var ge=this.getHighlightedSuggestion(),be=K.highlightedSuggestion;ge!=be&&ie({suggestion:ge})}}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onDocumentMouseDown),document.removeEventListener("mouseup",this.onDocumentMouseUp)}},{key:"updateHighlightedSuggestion",value:function(H,K,Q){var J=this;this.setState(function(ie){var ce=ie.valueBeforeUpDown;return K===null?ce=null:ce===null&&typeof Q<"u"&&(ce=Q),{highlightedSectionIndex:H,highlightedSuggestionIndex:K,highlightedSuggestion:K===null?null:J.getSuggestion(H,K),valueBeforeUpDown:ce}})}},{key:"resetHighlightedSuggestion",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.setState(function(K){var Q=K.valueBeforeUpDown;return{highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:H?null:Q}})}},{key:"revealSuggestions",value:function(){this.setState({isCollapsed:!1})}},{key:"closeSuggestions",value:function(){this.setState({highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null,valueBeforeUpDown:null,isCollapsed:!0})}},{key:"getSuggestion",value:function(H,K){var Q=this.props,J=Q.suggestions,ie=Q.multiSection,ce=Q.getSectionSuggestions;return ie?ce(J[H])[K]:J[K]}},{key:"getHighlightedSuggestion",value:function(){var H=this.state,K=H.highlightedSectionIndex,Q=H.highlightedSuggestionIndex;return Q===null?null:this.getSuggestion(K,Q)}},{key:"getSuggestionValueByIndex",value:function(H,K){var Q=this.props.getSuggestionValue;return Q(this.getSuggestion(H,K))}},{key:"getSuggestionIndices",value:function(H){var K=H.getAttribute("data-section-index"),Q=H.getAttribute("data-suggestion-index");return{sectionIndex:typeof K=="string"?parseInt(K,10):null,suggestionIndex:parseInt(Q,10)}}},{key:"findSuggestionElement",value:function(H){var K=H;do{if(K.getAttribute&&K.getAttribute("data-suggestion-index")!==null)return K;K=K.parentNode}while(K!==null);throw console.error("Clicked element:",H),new Error("Couldn't find suggestion element")}},{key:"maybeCallOnChange",value:function(H,K,Q){var J=this.props.inputProps,ie=J.value,ce=J.onChange;K!==ie&&ce(H,{newValue:K,method:Q})}},{key:"willRenderSuggestions",value:function(H,K){var Q=H.suggestions,J=H.inputProps,ie=H.shouldRenderSuggestions,ce=J.value;return Q.length>0&&ie(ce,K)}},{key:"getQuery",value:function(){var H=this.props.inputProps,K=H.value,Q=this.state.valueBeforeUpDown;return(Q===null?K:Q).trim()}},{key:"render",value:function(){var H=this,K=this.props,Q=K.suggestions,J=K.renderInputComponent,ie=K.onSuggestionsFetchRequested,ce=K.renderSuggestion,ge=K.inputProps,be=K.multiSection,Ae=K.renderSectionTitle,ne=K.id,he=K.getSectionSuggestions,Ie=K.theme,ze=K.getSuggestionValue,Re=K.alwaysRenderSuggestions,Ke=K.highlightFirstSuggestion,tt=K.containerProps,Xe=this.state,ot=Xe.isFocused,et=Xe.isCollapsed,mt=Xe.highlightedSectionIndex,Ue=Xe.highlightedSuggestionIndex,Vt=Xe.valueBeforeUpDown,At=Re?U:this.props.shouldRenderSuggestions,St=ge.value,Dn=ge.onFocus,q=ge.onKeyDown,z=this.willRenderSuggestions(this.props,"render"),G=Re||ot&&!et&&z,Z=G?Q:[],ae=h({},ge,{onFocus:function(Ye){if(!H.justSelectedSuggestion&&!H.justClickedOnSuggestionsContainer){var He=At(St,A);H.setState({isFocused:!0,isCollapsed:!He}),Dn&&Dn(Ye),He&&ie({value:St,reason:A})}},onBlur:function(Ye){if(H.justClickedOnSuggestionsContainer){H.input.focus();return}H.blurEvent=Ye,H.justSelectedSuggestion||(H.onBlur(),H.onSuggestionsClearRequested())},onChange:function(Ye){var He=Ye.target.value,Me=At(He,M);H.maybeCallOnChange(Ye,He,"type"),H.suggestionsContainer&&(H.suggestionsContainer.scrollTop=0),H.setState(h({},Ke?{}:{highlightedSectionIndex:null,highlightedSuggestionIndex:null,highlightedSuggestion:null},{valueBeforeUpDown:null,isCollapsed:!Me})),Me?ie({value:He,reason:M}):H.onSuggestionsClearRequested()},onKeyDown:function(Ye,He){var Me=Ye.keyCode;switch(Me){case 40:case 38:if(et)At(St,T)&&(ie({value:St,reason:T}),H.revealSuggestions(),Ye.preventDefault());else if(Q.length>0){var Ze=He.newHighlightedSectionIndex,at=He.newHighlightedItemIndex,bt;at===null?bt=Vt===null?St:Vt:bt=H.getSuggestionValueByIndex(Ze,at),H.updateHighlightedSuggestion(Ze,at,St),H.maybeCallOnChange(Ye,bt,Me===40?"down":"up"),Ye.preventDefault()}H.justPressedUpDown=!0,setTimeout(function(){H.justPressedUpDown=!1});break;case 13:{if(Ye.keyCode===229)break;var _t=H.getHighlightedSuggestion();if(G&&!Re&&H.closeSuggestions(),_t!=null){Ye.preventDefault();var sr=ze(_t);H.maybeCallOnChange(Ye,sr,"enter"),H.onSuggestionSelected(Ye,{suggestion:_t,suggestionValue:sr,suggestionIndex:Ue,sectionIndex:mt,method:"enter"}),H.justSelectedSuggestion=!0,setTimeout(function(){H.justSelectedSuggestion=!1})}break}case 27:{G&&Ye.preventDefault();var Wt=G&&!Re;if(Vt===null){if(!Wt){var Qt="";H.maybeCallOnChange(Ye,Qt,"escape"),At(Qt,B)?ie({value:Qt,reason:B}):H.onSuggestionsClearRequested()}}else H.maybeCallOnChange(Ye,Vt,"escape");Wt?(H.onSuggestionsClearRequested(),H.closeSuggestions()):H.resetHighlightedSuggestion();break}}q&&q(Ye)}}),ke={query:this.getQuery()};return e.default.createElement(s.default,{multiSection:be,items:Z,renderInputComponent:J,renderItemsContainer:this.renderSuggestionsContainer,renderItem:ce,renderItemData:ke,renderSectionTitle:Ae,getSectionItems:he,highlightedSectionIndex:mt,highlightedItemIndex:Ue,containerProps:tt,inputProps:ae,itemProps:this.itemProps,theme:(0,i.mapToAutowhateverTheme)(Ie),id:ne,ref:this.storeAutowhateverRef})}}]),E}(e.Component);n.default=j,_(j,"propTypes",{suggestions:t.default.array.isRequired,onSuggestionsFetchRequested:function(P,E){var R=P[E];if(typeof R!="function")throw new Error("'onSuggestionsFetchRequested' must be implemented. See: https://github.com/moroshko/react-autosuggest#onSuggestionsFetchRequestedProp")},onSuggestionsClearRequested:function(P,E){var R=P[E];if(P.alwaysRenderSuggestions===!1&&typeof R!="function")throw new Error("'onSuggestionsClearRequested' must be implemented. See: https://github.com/moroshko/react-autosuggest#onSuggestionsClearRequestedProp")},shouldKeepSuggestionsOnSelect:t.default.func,onSuggestionSelected:t.default.func,onSuggestionHighlighted:t.default.func,renderInputComponent:t.default.func,renderSuggestionsContainer:t.default.func,getSuggestionValue:t.default.func.isRequired,renderSuggestion:t.default.func.isRequired,inputProps:function(P,E){var R=P[E];if(!R)throw new Error("'inputProps' must be passed.");if(!Object.prototype.hasOwnProperty.call(R,"value"))throw new Error("'inputProps' must have 'value'.");if(!Object.prototype.hasOwnProperty.call(R,"onChange"))throw new Error("'inputProps' must have 'onChange'.")},shouldRenderSuggestions:t.default.func,alwaysRenderSuggestions:t.default.bool,multiSection:t.default.bool,renderSectionTitle:function(P,E){var R=P[E];if(P.multiSection===!0&&typeof R!="function")throw new Error("'renderSectionTitle' must be implemented. See: https://github.com/moroshko/react-autosuggest#renderSectionTitleProp")},getSectionSuggestions:function(P,E){var R=P[E];if(P.multiSection===!0&&typeof R!="function")throw new Error("'getSectionSuggestions' must be implemented. See: https://github.com/moroshko/react-autosuggest#getSectionSuggestionsProp")},focusInputOnSuggestionClick:t.default.bool,highlightFirstSuggestion:t.default.bool,theme:t.default.object,id:t.default.string,containerProps:t.default.object}),_(j,"defaultProps",{renderSuggestionsContainer:L,shouldRenderSuggestions:O,alwaysRenderSuggestions:!1,multiSection:!1,shouldKeepSuggestionsOnSelect:function(){return!1},focusInputOnSuggestionClick:!0,highlightFirstSuggestion:!1,theme:i.defaultTheme,id:"1",containerProps:{}})}(cI)),cI}var xI,e3;function EEe(){return e3||(e3=1,xI=IEe().default),xI}var AEe=EEe();const TEe=fb(AEe);var bI={},bu={},kx={},vI={},t3;function NEe(){return t3||(t3=1,vI.supports=function(...e){const t=e.reduce((i,o)=>Object.assign(i,o),{}),r=t.implicitSnapshots||t.snapshots||!1,s=t.explicitSnapshots||!1;return Object.assign(t,{implicitSnapshots:r,explicitSnapshots:s,snapshots:r,has:t.has||!1,permanence:t.permanence||!1,seek:t.seek||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods),signals:Object.assign({},t.signals)})}),vI}var SI={},CI,n3;function Kl(){return n3||(n3=1,CI=class extends Error{constructor(e,t){super(e||""),typeof t=="object"&&t!==null&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}),CI}var vu={},kI={},tm={},r3;function $Ee(){if(r3)return tm;r3=1,tm.byteLength=a,tm.toByteArray=u,tm.fromByteArray=p;for(var n=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,i=r.length;s<i;++s)n[s]=r[s],e[r.charCodeAt(s)]=s;e[45]=62,e[95]=63;function o(g){var m=g.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var w=g.indexOf("=");w===-1&&(w=m);var x=w===m?0:4-w%4;return[w,x]}function a(g){var m=o(g),w=m[0],x=m[1];return(w+x)*3/4-x}function l(g,m,w){return(m+w)*3/4-w}function u(g){var m,w=o(g),x=w[0],b=w[1],C=new t(l(g,x,b)),$=0,k=b>0?x-4:x,N;for(N=0;N<k;N+=4)m=e[g.charCodeAt(N)]<<18|e[g.charCodeAt(N+1)]<<12|e[g.charCodeAt(N+2)]<<6|e[g.charCodeAt(N+3)],C[$++]=m>>16&255,C[$++]=m>>8&255,C[$++]=m&255;return b===2&&(m=e[g.charCodeAt(N)]<<2|e[g.charCodeAt(N+1)]>>4,C[$++]=m&255),b===1&&(m=e[g.charCodeAt(N)]<<10|e[g.charCodeAt(N+1)]<<4|e[g.charCodeAt(N+2)]>>2,C[$++]=m>>8&255,C[$++]=m&255),C}function f(g){return n[g>>18&63]+n[g>>12&63]+n[g>>6&63]+n[g&63]}function h(g,m,w){for(var x,b=[],C=m;C<w;C+=3)x=(g[C]<<16&16711680)+(g[C+1]<<8&65280)+(g[C+2]&255),b.push(f(x));return b.join("")}function p(g){for(var m,w=g.length,x=w%3,b=[],C=16383,$=0,k=w-x;$<k;$+=C)b.push(h(g,$,$+C>k?k:$+C));return x===1?(m=g[w-1],b.push(n[m>>2]+n[m<<4&63]+"==")):x===2&&(m=(g[w-2]<<8)+g[w-1],b.push(n[m>>10]+n[m>>4&63]+n[m<<2&63]+"=")),b.join("")}return tm}var Ix={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var s3;function REe(){return s3||(s3=1,Ix.read=function(n,e,t,r,s){var i,o,a=s*8-r-1,l=(1<<a)-1,u=l>>1,f=-7,h=t?s-1:0,p=t?-1:1,g=n[e+h];for(h+=p,i=g&(1<<-f)-1,g>>=-f,f+=a;f>0;i=i*256+n[e+h],h+=p,f-=8);for(o=i&(1<<-f)-1,i>>=-f,f+=r;f>0;o=o*256+n[e+h],h+=p,f-=8);if(i===0)i=1-u;else{if(i===l)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,r),i=i-u}return(g?-1:1)*o*Math.pow(2,i-r)},Ix.write=function(n,e,t,r,s,i){var o,a,l,u=i*8-s-1,f=(1<<u)-1,h=f>>1,p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,m=r?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?e+=p/l:e+=p*Math.pow(2,1-h),e*l>=2&&(o++,l/=2),o+h>=f?(a=0,o=f):o+h>=1?(a=(e*l-1)*Math.pow(2,s),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,s),o=0));s>=8;n[t+g]=a&255,g+=m,a/=256,s-=8);for(o=o<<s|a,u+=s;u>0;n[t+g]=o&255,g+=m,o/=256,u-=8);n[t+g-m]|=w*128}),Ix}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var i3;function n$(){return i3||(i3=1,function(n){const e=$Ee(),t=REe(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=a,n.SlowBuffer=C,n.INSPECT_MAX_BYTES=50;const s=2147483647;n.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const q=new Uint8Array(1),z={foo:function(){return 42}};return Object.setPrototypeOf(z,Uint8Array.prototype),Object.setPrototypeOf(q,z),q.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(q){if(q>s)throw new RangeError('The value "'+q+'" is invalid for option "size"');const z=new Uint8Array(q);return Object.setPrototypeOf(z,a.prototype),z}function a(q,z,G){if(typeof q=="number"){if(typeof z=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(q)}return l(q,z,G)}a.poolSize=8192;function l(q,z,G){if(typeof q=="string")return p(q,z);if(ArrayBuffer.isView(q))return m(q);if(q==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof q);if(Ue(q,ArrayBuffer)||q&&Ue(q.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ue(q,SharedArrayBuffer)||q&&Ue(q.buffer,SharedArrayBuffer)))return w(q,z,G);if(typeof q=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Z=q.valueOf&&q.valueOf();if(Z!=null&&Z!==q)return a.from(Z,z,G);const ae=x(q);if(ae)return ae;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof q[Symbol.toPrimitive]=="function")return a.from(q[Symbol.toPrimitive]("string"),z,G);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof q)}a.from=function(q,z,G){return l(q,z,G)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function u(q){if(typeof q!="number")throw new TypeError('"size" argument must be of type number');if(q<0)throw new RangeError('The value "'+q+'" is invalid for option "size"')}function f(q,z,G){return u(q),q<=0?o(q):z!==void 0?typeof G=="string"?o(q).fill(z,G):o(q).fill(z):o(q)}a.alloc=function(q,z,G){return f(q,z,G)};function h(q){return u(q),o(q<0?0:b(q)|0)}a.allocUnsafe=function(q){return h(q)},a.allocUnsafeSlow=function(q){return h(q)};function p(q,z){if((typeof z!="string"||z==="")&&(z="utf8"),!a.isEncoding(z))throw new TypeError("Unknown encoding: "+z);const G=$(q,z)|0;let Z=o(G);const ae=Z.write(q,z);return ae!==G&&(Z=Z.slice(0,ae)),Z}function g(q){const z=q.length<0?0:b(q.length)|0,G=o(z);for(let Z=0;Z<z;Z+=1)G[Z]=q[Z]&255;return G}function m(q){if(Ue(q,Uint8Array)){const z=new Uint8Array(q);return w(z.buffer,z.byteOffset,z.byteLength)}return g(q)}function w(q,z,G){if(z<0||q.byteLength<z)throw new RangeError('"offset" is outside of buffer bounds');if(q.byteLength<z+(G||0))throw new RangeError('"length" is outside of buffer bounds');let Z;return z===void 0&&G===void 0?Z=new Uint8Array(q):G===void 0?Z=new Uint8Array(q,z):Z=new Uint8Array(q,z,G),Object.setPrototypeOf(Z,a.prototype),Z}function x(q){if(a.isBuffer(q)){const z=b(q.length)|0,G=o(z);return G.length===0||q.copy(G,0,0,z),G}if(q.length!==void 0)return typeof q.length!="number"||Vt(q.length)?o(0):g(q);if(q.type==="Buffer"&&Array.isArray(q.data))return g(q.data)}function b(q){if(q>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return q|0}function C(q){return+q!=q&&(q=0),a.alloc(+q)}a.isBuffer=function(z){return z!=null&&z._isBuffer===!0&&z!==a.prototype},a.compare=function(z,G){if(Ue(z,Uint8Array)&&(z=a.from(z,z.offset,z.byteLength)),Ue(G,Uint8Array)&&(G=a.from(G,G.offset,G.byteLength)),!a.isBuffer(z)||!a.isBuffer(G))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(z===G)return 0;let Z=z.length,ae=G.length;for(let ke=0,Ne=Math.min(Z,ae);ke<Ne;++ke)if(z[ke]!==G[ke]){Z=z[ke],ae=G[ke];break}return Z<ae?-1:ae<Z?1:0},a.isEncoding=function(z){switch(String(z).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(z,G){if(!Array.isArray(z))throw new TypeError('"list" argument must be an Array of Buffers');if(z.length===0)return a.alloc(0);let Z;if(G===void 0)for(G=0,Z=0;Z<z.length;++Z)G+=z[Z].length;const ae=a.allocUnsafe(G);let ke=0;for(Z=0;Z<z.length;++Z){let Ne=z[Z];if(Ue(Ne,Uint8Array))ke+Ne.length>ae.length?(a.isBuffer(Ne)||(Ne=a.from(Ne)),Ne.copy(ae,ke)):Uint8Array.prototype.set.call(ae,Ne,ke);else if(a.isBuffer(Ne))Ne.copy(ae,ke);else throw new TypeError('"list" argument must be an Array of Buffers');ke+=Ne.length}return ae};function $(q,z){if(a.isBuffer(q))return q.length;if(ArrayBuffer.isView(q)||Ue(q,ArrayBuffer))return q.byteLength;if(typeof q!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof q);const G=q.length,Z=arguments.length>2&&arguments[2]===!0;if(!Z&&G===0)return 0;let ae=!1;for(;;)switch(z){case"ascii":case"latin1":case"binary":return G;case"utf8":case"utf-8":return tt(q).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G*2;case"hex":return G>>>1;case"base64":return et(q).length;default:if(ae)return Z?-1:tt(q).length;z=(""+z).toLowerCase(),ae=!0}}a.byteLength=$;function k(q,z,G){let Z=!1;if((z===void 0||z<0)&&(z=0),z>this.length||((G===void 0||G>this.length)&&(G=this.length),G<=0)||(G>>>=0,z>>>=0,G<=z))return"";for(q||(q="utf8");;)switch(q){case"hex":return P(this,z,G);case"utf8":case"utf-8":return M(this,z,G);case"ascii":return j(this,z,G);case"latin1":case"binary":return W(this,z,G);case"base64":return A(this,z,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,z,G);default:if(Z)throw new TypeError("Unknown encoding: "+q);q=(q+"").toLowerCase(),Z=!0}}a.prototype._isBuffer=!0;function N(q,z,G){const Z=q[z];q[z]=q[G],q[G]=Z}a.prototype.swap16=function(){const z=this.length;if(z%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let G=0;G<z;G+=2)N(this,G,G+1);return this},a.prototype.swap32=function(){const z=this.length;if(z%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let G=0;G<z;G+=4)N(this,G,G+3),N(this,G+1,G+2);return this},a.prototype.swap64=function(){const z=this.length;if(z%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let G=0;G<z;G+=8)N(this,G,G+7),N(this,G+1,G+6),N(this,G+2,G+5),N(this,G+3,G+4);return this},a.prototype.toString=function(){const z=this.length;return z===0?"":arguments.length===0?M(this,0,z):k.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(z){if(!a.isBuffer(z))throw new TypeError("Argument must be a Buffer");return this===z?!0:a.compare(this,z)===0},a.prototype.inspect=function(){let z="";const G=n.INSPECT_MAX_BYTES;return z=this.toString("hex",0,G).replace(/(.{2})/g,"$1 ").trim(),this.length>G&&(z+=" ... "),"<Buffer "+z+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(z,G,Z,ae,ke){if(Ue(z,Uint8Array)&&(z=a.from(z,z.offset,z.byteLength)),!a.isBuffer(z))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof z);if(G===void 0&&(G=0),Z===void 0&&(Z=z?z.length:0),ae===void 0&&(ae=0),ke===void 0&&(ke=this.length),G<0||Z>z.length||ae<0||ke>this.length)throw new RangeError("out of range index");if(ae>=ke&&G>=Z)return 0;if(ae>=ke)return-1;if(G>=Z)return 1;if(G>>>=0,Z>>>=0,ae>>>=0,ke>>>=0,this===z)return 0;let Ne=ke-ae,Ye=Z-G;const He=Math.min(Ne,Ye),Me=this.slice(ae,ke),Ze=z.slice(G,Z);for(let at=0;at<He;++at)if(Me[at]!==Ze[at]){Ne=Me[at],Ye=Ze[at];break}return Ne<Ye?-1:Ye<Ne?1:0};function _(q,z,G,Z,ae){if(q.length===0)return-1;if(typeof G=="string"?(Z=G,G=0):G>2147483647?G=2147483647:G<-2147483648&&(G=-2147483648),G=+G,Vt(G)&&(G=ae?0:q.length-1),G<0&&(G=q.length+G),G>=q.length){if(ae)return-1;G=q.length-1}else if(G<0)if(ae)G=0;else return-1;if(typeof z=="string"&&(z=a.from(z,Z)),a.isBuffer(z))return z.length===0?-1:U(q,z,G,Z,ae);if(typeof z=="number")return z=z&255,typeof Uint8Array.prototype.indexOf=="function"?ae?Uint8Array.prototype.indexOf.call(q,z,G):Uint8Array.prototype.lastIndexOf.call(q,z,G):U(q,[z],G,Z,ae);throw new TypeError("val must be string, number or Buffer")}function U(q,z,G,Z,ae){let ke=1,Ne=q.length,Ye=z.length;if(Z!==void 0&&(Z=String(Z).toLowerCase(),Z==="ucs2"||Z==="ucs-2"||Z==="utf16le"||Z==="utf-16le")){if(q.length<2||z.length<2)return-1;ke=2,Ne/=2,Ye/=2,G/=2}function He(Ze,at){return ke===1?Ze[at]:Ze.readUInt16BE(at*ke)}let Me;if(ae){let Ze=-1;for(Me=G;Me<Ne;Me++)if(He(q,Me)===He(z,Ze===-1?0:Me-Ze)){if(Ze===-1&&(Ze=Me),Me-Ze+1===Ye)return Ze*ke}else Ze!==-1&&(Me-=Me-Ze),Ze=-1}else for(G+Ye>Ne&&(G=Ne-Ye),Me=G;Me>=0;Me--){let Ze=!0;for(let at=0;at<Ye;at++)if(He(q,Me+at)!==He(z,at)){Ze=!1;break}if(Ze)return Me}return-1}a.prototype.includes=function(z,G,Z){return this.indexOf(z,G,Z)!==-1},a.prototype.indexOf=function(z,G,Z){return _(this,z,G,Z,!0)},a.prototype.lastIndexOf=function(z,G,Z){return _(this,z,G,Z,!1)};function O(q,z,G,Z){G=Number(G)||0;const ae=q.length-G;Z?(Z=Number(Z),Z>ae&&(Z=ae)):Z=ae;const ke=z.length;Z>ke/2&&(Z=ke/2);let Ne;for(Ne=0;Ne<Z;++Ne){const Ye=parseInt(z.substr(Ne*2,2),16);if(Vt(Ye))return Ne;q[G+Ne]=Ye}return Ne}function L(q,z,G,Z){return mt(tt(z,q.length-G),q,G,Z)}function T(q,z,G,Z){return mt(Xe(z),q,G,Z)}function I(q,z,G,Z){return mt(et(z),q,G,Z)}function v(q,z,G,Z){return mt(ot(z,q.length-G),q,G,Z)}a.prototype.write=function(z,G,Z,ae){if(G===void 0)ae="utf8",Z=this.length,G=0;else if(Z===void 0&&typeof G=="string")ae=G,Z=this.length,G=0;else if(isFinite(G))G=G>>>0,isFinite(Z)?(Z=Z>>>0,ae===void 0&&(ae="utf8")):(ae=Z,Z=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ke=this.length-G;if((Z===void 0||Z>ke)&&(Z=ke),z.length>0&&(Z<0||G<0)||G>this.length)throw new RangeError("Attempt to write outside buffer bounds");ae||(ae="utf8");let Ne=!1;for(;;)switch(ae){case"hex":return O(this,z,G,Z);case"utf8":case"utf-8":return L(this,z,G,Z);case"ascii":case"latin1":case"binary":return T(this,z,G,Z);case"base64":return I(this,z,G,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,z,G,Z);default:if(Ne)throw new TypeError("Unknown encoding: "+ae);ae=(""+ae).toLowerCase(),Ne=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(q,z,G){return z===0&&G===q.length?e.fromByteArray(q):e.fromByteArray(q.slice(z,G))}function M(q,z,G){G=Math.min(q.length,G);const Z=[];let ae=z;for(;ae<G;){const ke=q[ae];let Ne=null,Ye=ke>239?4:ke>223?3:ke>191?2:1;if(ae+Ye<=G){let He,Me,Ze,at;switch(Ye){case 1:ke<128&&(Ne=ke);break;case 2:He=q[ae+1],(He&192)===128&&(at=(ke&31)<<6|He&63,at>127&&(Ne=at));break;case 3:He=q[ae+1],Me=q[ae+2],(He&192)===128&&(Me&192)===128&&(at=(ke&15)<<12|(He&63)<<6|Me&63,at>2047&&(at<55296||at>57343)&&(Ne=at));break;case 4:He=q[ae+1],Me=q[ae+2],Ze=q[ae+3],(He&192)===128&&(Me&192)===128&&(Ze&192)===128&&(at=(ke&15)<<18|(He&63)<<12|(Me&63)<<6|Ze&63,at>65535&&at<1114112&&(Ne=at))}}Ne===null?(Ne=65533,Ye=1):Ne>65535&&(Ne-=65536,Z.push(Ne>>>10&1023|55296),Ne=56320|Ne&1023),Z.push(Ne),ae+=Ye}return B(Z)}const D=4096;function B(q){const z=q.length;if(z<=D)return String.fromCharCode.apply(String,q);let G="",Z=0;for(;Z<z;)G+=String.fromCharCode.apply(String,q.slice(Z,Z+=D));return G}function j(q,z,G){let Z="";G=Math.min(q.length,G);for(let ae=z;ae<G;++ae)Z+=String.fromCharCode(q[ae]&127);return Z}function W(q,z,G){let Z="";G=Math.min(q.length,G);for(let ae=z;ae<G;++ae)Z+=String.fromCharCode(q[ae]);return Z}function P(q,z,G){const Z=q.length;(!z||z<0)&&(z=0),(!G||G<0||G>Z)&&(G=Z);let ae="";for(let ke=z;ke<G;++ke)ae+=At[q[ke]];return ae}function E(q,z,G){const Z=q.slice(z,G);let ae="";for(let ke=0;ke<Z.length-1;ke+=2)ae+=String.fromCharCode(Z[ke]+Z[ke+1]*256);return ae}a.prototype.slice=function(z,G){const Z=this.length;z=~~z,G=G===void 0?Z:~~G,z<0?(z+=Z,z<0&&(z=0)):z>Z&&(z=Z),G<0?(G+=Z,G<0&&(G=0)):G>Z&&(G=Z),G<z&&(G=z);const ae=this.subarray(z,G);return Object.setPrototypeOf(ae,a.prototype),ae};function R(q,z,G){if(q%1!==0||q<0)throw new RangeError("offset is not uint");if(q+z>G)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(z,G,Z){z=z>>>0,G=G>>>0,Z||R(z,G,this.length);let ae=this[z],ke=1,Ne=0;for(;++Ne<G&&(ke*=256);)ae+=this[z+Ne]*ke;return ae},a.prototype.readUintBE=a.prototype.readUIntBE=function(z,G,Z){z=z>>>0,G=G>>>0,Z||R(z,G,this.length);let ae=this[z+--G],ke=1;for(;G>0&&(ke*=256);)ae+=this[z+--G]*ke;return ae},a.prototype.readUint8=a.prototype.readUInt8=function(z,G){return z=z>>>0,G||R(z,1,this.length),this[z]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(z,G){return z=z>>>0,G||R(z,2,this.length),this[z]|this[z+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(z,G){return z=z>>>0,G||R(z,2,this.length),this[z]<<8|this[z+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(z,G){return z=z>>>0,G||R(z,4,this.length),(this[z]|this[z+1]<<8|this[z+2]<<16)+this[z+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(z,G){return z=z>>>0,G||R(z,4,this.length),this[z]*16777216+(this[z+1]<<16|this[z+2]<<8|this[z+3])},a.prototype.readBigUInt64LE=St(function(z){z=z>>>0,Ie(z,"offset");const G=this[z],Z=this[z+7];(G===void 0||Z===void 0)&&ze(z,this.length-8);const ae=G+this[++z]*2**8+this[++z]*2**16+this[++z]*2**24,ke=this[++z]+this[++z]*2**8+this[++z]*2**16+Z*2**24;return BigInt(ae)+(BigInt(ke)<<BigInt(32))}),a.prototype.readBigUInt64BE=St(function(z){z=z>>>0,Ie(z,"offset");const G=this[z],Z=this[z+7];(G===void 0||Z===void 0)&&ze(z,this.length-8);const ae=G*2**24+this[++z]*2**16+this[++z]*2**8+this[++z],ke=this[++z]*2**24+this[++z]*2**16+this[++z]*2**8+Z;return(BigInt(ae)<<BigInt(32))+BigInt(ke)}),a.prototype.readIntLE=function(z,G,Z){z=z>>>0,G=G>>>0,Z||R(z,G,this.length);let ae=this[z],ke=1,Ne=0;for(;++Ne<G&&(ke*=256);)ae+=this[z+Ne]*ke;return ke*=128,ae>=ke&&(ae-=Math.pow(2,8*G)),ae},a.prototype.readIntBE=function(z,G,Z){z=z>>>0,G=G>>>0,Z||R(z,G,this.length);let ae=G,ke=1,Ne=this[z+--ae];for(;ae>0&&(ke*=256);)Ne+=this[z+--ae]*ke;return ke*=128,Ne>=ke&&(Ne-=Math.pow(2,8*G)),Ne},a.prototype.readInt8=function(z,G){return z=z>>>0,G||R(z,1,this.length),this[z]&128?(255-this[z]+1)*-1:this[z]},a.prototype.readInt16LE=function(z,G){z=z>>>0,G||R(z,2,this.length);const Z=this[z]|this[z+1]<<8;return Z&32768?Z|4294901760:Z},a.prototype.readInt16BE=function(z,G){z=z>>>0,G||R(z,2,this.length);const Z=this[z+1]|this[z]<<8;return Z&32768?Z|4294901760:Z},a.prototype.readInt32LE=function(z,G){return z=z>>>0,G||R(z,4,this.length),this[z]|this[z+1]<<8|this[z+2]<<16|this[z+3]<<24},a.prototype.readInt32BE=function(z,G){return z=z>>>0,G||R(z,4,this.length),this[z]<<24|this[z+1]<<16|this[z+2]<<8|this[z+3]},a.prototype.readBigInt64LE=St(function(z){z=z>>>0,Ie(z,"offset");const G=this[z],Z=this[z+7];(G===void 0||Z===void 0)&&ze(z,this.length-8);const ae=this[z+4]+this[z+5]*2**8+this[z+6]*2**16+(Z<<24);return(BigInt(ae)<<BigInt(32))+BigInt(G+this[++z]*2**8+this[++z]*2**16+this[++z]*2**24)}),a.prototype.readBigInt64BE=St(function(z){z=z>>>0,Ie(z,"offset");const G=this[z],Z=this[z+7];(G===void 0||Z===void 0)&&ze(z,this.length-8);const ae=(G<<24)+this[++z]*2**16+this[++z]*2**8+this[++z];return(BigInt(ae)<<BigInt(32))+BigInt(this[++z]*2**24+this[++z]*2**16+this[++z]*2**8+Z)}),a.prototype.readFloatLE=function(z,G){return z=z>>>0,G||R(z,4,this.length),t.read(this,z,!0,23,4)},a.prototype.readFloatBE=function(z,G){return z=z>>>0,G||R(z,4,this.length),t.read(this,z,!1,23,4)},a.prototype.readDoubleLE=function(z,G){return z=z>>>0,G||R(z,8,this.length),t.read(this,z,!0,52,8)},a.prototype.readDoubleBE=function(z,G){return z=z>>>0,G||R(z,8,this.length),t.read(this,z,!1,52,8)};function H(q,z,G,Z,ae,ke){if(!a.isBuffer(q))throw new TypeError('"buffer" argument must be a Buffer instance');if(z>ae||z<ke)throw new RangeError('"value" argument is out of bounds');if(G+Z>q.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(z,G,Z,ae){if(z=+z,G=G>>>0,Z=Z>>>0,!ae){const Ye=Math.pow(2,8*Z)-1;H(this,z,G,Z,Ye,0)}let ke=1,Ne=0;for(this[G]=z&255;++Ne<Z&&(ke*=256);)this[G+Ne]=z/ke&255;return G+Z},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(z,G,Z,ae){if(z=+z,G=G>>>0,Z=Z>>>0,!ae){const Ye=Math.pow(2,8*Z)-1;H(this,z,G,Z,Ye,0)}let ke=Z-1,Ne=1;for(this[G+ke]=z&255;--ke>=0&&(Ne*=256);)this[G+ke]=z/Ne&255;return G+Z},a.prototype.writeUint8=a.prototype.writeUInt8=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,1,255,0),this[G]=z&255,G+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,2,65535,0),this[G]=z&255,this[G+1]=z>>>8,G+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,2,65535,0),this[G]=z>>>8,this[G+1]=z&255,G+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,4,4294967295,0),this[G+3]=z>>>24,this[G+2]=z>>>16,this[G+1]=z>>>8,this[G]=z&255,G+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,4,4294967295,0),this[G]=z>>>24,this[G+1]=z>>>16,this[G+2]=z>>>8,this[G+3]=z&255,G+4};function K(q,z,G,Z,ae){he(z,Z,ae,q,G,7);let ke=Number(z&BigInt(4294967295));q[G++]=ke,ke=ke>>8,q[G++]=ke,ke=ke>>8,q[G++]=ke,ke=ke>>8,q[G++]=ke;let Ne=Number(z>>BigInt(32)&BigInt(4294967295));return q[G++]=Ne,Ne=Ne>>8,q[G++]=Ne,Ne=Ne>>8,q[G++]=Ne,Ne=Ne>>8,q[G++]=Ne,G}function Q(q,z,G,Z,ae){he(z,Z,ae,q,G,7);let ke=Number(z&BigInt(4294967295));q[G+7]=ke,ke=ke>>8,q[G+6]=ke,ke=ke>>8,q[G+5]=ke,ke=ke>>8,q[G+4]=ke;let Ne=Number(z>>BigInt(32)&BigInt(4294967295));return q[G+3]=Ne,Ne=Ne>>8,q[G+2]=Ne,Ne=Ne>>8,q[G+1]=Ne,Ne=Ne>>8,q[G]=Ne,G+8}a.prototype.writeBigUInt64LE=St(function(z,G=0){return K(this,z,G,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=St(function(z,G=0){return Q(this,z,G,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(z,G,Z,ae){if(z=+z,G=G>>>0,!ae){const He=Math.pow(2,8*Z-1);H(this,z,G,Z,He-1,-He)}let ke=0,Ne=1,Ye=0;for(this[G]=z&255;++ke<Z&&(Ne*=256);)z<0&&Ye===0&&this[G+ke-1]!==0&&(Ye=1),this[G+ke]=(z/Ne>>0)-Ye&255;return G+Z},a.prototype.writeIntBE=function(z,G,Z,ae){if(z=+z,G=G>>>0,!ae){const He=Math.pow(2,8*Z-1);H(this,z,G,Z,He-1,-He)}let ke=Z-1,Ne=1,Ye=0;for(this[G+ke]=z&255;--ke>=0&&(Ne*=256);)z<0&&Ye===0&&this[G+ke+1]!==0&&(Ye=1),this[G+ke]=(z/Ne>>0)-Ye&255;return G+Z},a.prototype.writeInt8=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,1,127,-128),z<0&&(z=255+z+1),this[G]=z&255,G+1},a.prototype.writeInt16LE=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,2,32767,-32768),this[G]=z&255,this[G+1]=z>>>8,G+2},a.prototype.writeInt16BE=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,2,32767,-32768),this[G]=z>>>8,this[G+1]=z&255,G+2},a.prototype.writeInt32LE=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,4,2147483647,-2147483648),this[G]=z&255,this[G+1]=z>>>8,this[G+2]=z>>>16,this[G+3]=z>>>24,G+4},a.prototype.writeInt32BE=function(z,G,Z){return z=+z,G=G>>>0,Z||H(this,z,G,4,2147483647,-2147483648),z<0&&(z=4294967295+z+1),this[G]=z>>>24,this[G+1]=z>>>16,this[G+2]=z>>>8,this[G+3]=z&255,G+4},a.prototype.writeBigInt64LE=St(function(z,G=0){return K(this,z,G,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=St(function(z,G=0){return Q(this,z,G,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function J(q,z,G,Z,ae,ke){if(G+Z>q.length)throw new RangeError("Index out of range");if(G<0)throw new RangeError("Index out of range")}function ie(q,z,G,Z,ae){return z=+z,G=G>>>0,ae||J(q,z,G,4),t.write(q,z,G,Z,23,4),G+4}a.prototype.writeFloatLE=function(z,G,Z){return ie(this,z,G,!0,Z)},a.prototype.writeFloatBE=function(z,G,Z){return ie(this,z,G,!1,Z)};function ce(q,z,G,Z,ae){return z=+z,G=G>>>0,ae||J(q,z,G,8),t.write(q,z,G,Z,52,8),G+8}a.prototype.writeDoubleLE=function(z,G,Z){return ce(this,z,G,!0,Z)},a.prototype.writeDoubleBE=function(z,G,Z){return ce(this,z,G,!1,Z)},a.prototype.copy=function(z,G,Z,ae){if(!a.isBuffer(z))throw new TypeError("argument should be a Buffer");if(Z||(Z=0),!ae&&ae!==0&&(ae=this.length),G>=z.length&&(G=z.length),G||(G=0),ae>0&&ae<Z&&(ae=Z),ae===Z||z.length===0||this.length===0)return 0;if(G<0)throw new RangeError("targetStart out of bounds");if(Z<0||Z>=this.length)throw new RangeError("Index out of range");if(ae<0)throw new RangeError("sourceEnd out of bounds");ae>this.length&&(ae=this.length),z.length-G<ae-Z&&(ae=z.length-G+Z);const ke=ae-Z;return this===z&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(G,Z,ae):Uint8Array.prototype.set.call(z,this.subarray(Z,ae),G),ke},a.prototype.fill=function(z,G,Z,ae){if(typeof z=="string"){if(typeof G=="string"?(ae=G,G=0,Z=this.length):typeof Z=="string"&&(ae=Z,Z=this.length),ae!==void 0&&typeof ae!="string")throw new TypeError("encoding must be a string");if(typeof ae=="string"&&!a.isEncoding(ae))throw new TypeError("Unknown encoding: "+ae);if(z.length===1){const Ne=z.charCodeAt(0);(ae==="utf8"&&Ne<128||ae==="latin1")&&(z=Ne)}}else typeof z=="number"?z=z&255:typeof z=="boolean"&&(z=Number(z));if(G<0||this.length<G||this.length<Z)throw new RangeError("Out of range index");if(Z<=G)return this;G=G>>>0,Z=Z===void 0?this.length:Z>>>0,z||(z=0);let ke;if(typeof z=="number")for(ke=G;ke<Z;++ke)this[ke]=z;else{const Ne=a.isBuffer(z)?z:a.from(z,ae),Ye=Ne.length;if(Ye===0)throw new TypeError('The value "'+z+'" is invalid for argument "value"');for(ke=0;ke<Z-G;++ke)this[ke+G]=Ne[ke%Ye]}return this};const ge={};function be(q,z,G){ge[q]=class extends G{constructor(){super(),Object.defineProperty(this,"message",{value:z.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${q}]`,this.stack,delete this.name}get code(){return q}set code(ae){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ae,writable:!0})}toString(){return`${this.name} [${q}]: ${this.message}`}}}be("ERR_BUFFER_OUT_OF_BOUNDS",function(q){return q?`${q} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),be("ERR_INVALID_ARG_TYPE",function(q,z){return`The "${q}" argument must be of type number. Received type ${typeof z}`},TypeError),be("ERR_OUT_OF_RANGE",function(q,z,G){let Z=`The value of "${q}" is out of range.`,ae=G;return Number.isInteger(G)&&Math.abs(G)>2**32?ae=Ae(String(G)):typeof G=="bigint"&&(ae=String(G),(G>BigInt(2)**BigInt(32)||G<-(BigInt(2)**BigInt(32)))&&(ae=Ae(ae)),ae+="n"),Z+=` It must be ${z}. Received ${ae}`,Z},RangeError);function Ae(q){let z="",G=q.length;const Z=q[0]==="-"?1:0;for(;G>=Z+4;G-=3)z=`_${q.slice(G-3,G)}${z}`;return`${q.slice(0,G)}${z}`}function ne(q,z,G){Ie(z,"offset"),(q[z]===void 0||q[z+G]===void 0)&&ze(z,q.length-(G+1))}function he(q,z,G,Z,ae,ke){if(q>G||q<z){const Ne=typeof z=="bigint"?"n":"";let Ye;throw z===0||z===BigInt(0)?Ye=`>= 0${Ne} and < 2${Ne} ** ${(ke+1)*8}${Ne}`:Ye=`>= -(2${Ne} ** ${(ke+1)*8-1}${Ne}) and < 2 ** ${(ke+1)*8-1}${Ne}`,new ge.ERR_OUT_OF_RANGE("value",Ye,q)}ne(Z,ae,ke)}function Ie(q,z){if(typeof q!="number")throw new ge.ERR_INVALID_ARG_TYPE(z,"number",q)}function ze(q,z,G){throw Math.floor(q)!==q?(Ie(q,G),new ge.ERR_OUT_OF_RANGE("offset","an integer",q)):z<0?new ge.ERR_BUFFER_OUT_OF_BOUNDS:new ge.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${z}`,q)}const Re=/[^+/0-9A-Za-z-_]/g;function Ke(q){if(q=q.split("=")[0],q=q.trim().replace(Re,""),q.length<2)return"";for(;q.length%4!==0;)q=q+"=";return q}function tt(q,z){z=z||1/0;let G;const Z=q.length;let ae=null;const ke=[];for(let Ne=0;Ne<Z;++Ne){if(G=q.charCodeAt(Ne),G>55295&&G<57344){if(!ae){if(G>56319){(z-=3)>-1&&ke.push(239,191,189);continue}else if(Ne+1===Z){(z-=3)>-1&&ke.push(239,191,189);continue}ae=G;continue}if(G<56320){(z-=3)>-1&&ke.push(239,191,189),ae=G;continue}G=(ae-55296<<10|G-56320)+65536}else ae&&(z-=3)>-1&&ke.push(239,191,189);if(ae=null,G<128){if((z-=1)<0)break;ke.push(G)}else if(G<2048){if((z-=2)<0)break;ke.push(G>>6|192,G&63|128)}else if(G<65536){if((z-=3)<0)break;ke.push(G>>12|224,G>>6&63|128,G&63|128)}else if(G<1114112){if((z-=4)<0)break;ke.push(G>>18|240,G>>12&63|128,G>>6&63|128,G&63|128)}else throw new Error("Invalid code point")}return ke}function Xe(q){const z=[];for(let G=0;G<q.length;++G)z.push(q.charCodeAt(G)&255);return z}function ot(q,z){let G,Z,ae;const ke=[];for(let Ne=0;Ne<q.length&&!((z-=2)<0);++Ne)G=q.charCodeAt(Ne),Z=G>>8,ae=G%256,ke.push(ae),ke.push(Z);return ke}function et(q){return e.toByteArray(Ke(q))}function mt(q,z,G,Z){let ae;for(ae=0;ae<Z&&!(ae+G>=z.length||ae>=q.length);++ae)z[ae+G]=q[ae];return ae}function Ue(q,z){return q instanceof z||q!=null&&q.constructor!=null&&q.constructor.name!=null&&q.constructor.name===z.name}function Vt(q){return q!==q}const At=function(){const q="0123456789abcdef",z=new Array(256);for(let G=0;G<16;++G){const Z=G*16;for(let ae=0;ae<16;++ae)z[Z+ae]=q[G]+q[ae]}return z}();function St(q){return typeof BigInt>"u"?Dn:q}function Dn(){throw new Error("BigInt not supported")}}(kI)),kI}var II,o3;function I5(){if(o3)return II;o3=1;let n=null;return II=function(){return n===null&&(n={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),n},II}var nm={},EI={},a3;function E5(){if(a3)return EI;a3=1;const n=Kl(),e=new Set(["buffer","view","utf8"]);class t{constructor(s){if(this.encode=s.encode||this.encode,this.decode=s.decode||this.decode,this.name=s.name||this.name,this.format=s.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!e.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");s.createViewTranscoder&&(this.createViewTranscoder=s.createViewTranscoder),s.createBufferTranscoder&&(this.createBufferTranscoder=s.createBufferTranscoder),s.createUTF8Transcoder&&(this.createUTF8Transcoder=s.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}return EI.Encoding=t,EI}var l3;function A5(){if(l3)return nm;l3=1;const{Buffer:n}=n$()||{},{Encoding:e}=E5(),t=I5();class r extends e{constructor(a){super({...a,format:"buffer"})}createViewTranscoder(){return new s({encode:this.encode,decode:a=>this.decode(n.from(a.buffer,a.byteOffset,a.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class s extends e{constructor(a){super({...a,format:"view"})}createBufferTranscoder(){return new r({encode:a=>{const l=this.encode(a);return n.from(l.buffer,l.byteOffset,l.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}class i extends e{constructor(a){super({...a,format:"utf8"})}createBufferTranscoder(){return new r({encode:a=>n.from(this.encode(a),"utf8"),decode:a=>this.decode(a.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:a,textDecoder:l}=t();return new s({encode:u=>a.encode(this.encode(u)),decode:u=>this.decode(l.decode(u)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}return nm.BufferFormat=r,nm.ViewFormat=s,nm.UTF8Format=i,nm}var u3;function OEe(){if(u3)return vu;u3=1;const{Buffer:n}=n$()||{Buffer:{isBuffer:()=>!1}},{textEncoder:e,textDecoder:t}=I5()(),{BufferFormat:r,ViewFormat:s,UTF8Format:i}=A5(),o=a=>a;return vu.utf8=new i({encode:function(a){return n.isBuffer(a)?a.toString("utf8"):ArrayBuffer.isView(a)?t.decode(a):String(a)},decode:o,name:"utf8",createViewTranscoder(){return new s({encode:function(a){return ArrayBuffer.isView(a)?a:e.encode(a)},decode:function(a){return t.decode(a)},name:`${this.name}+view`})},createBufferTranscoder(){return new r({encode:function(a){return n.isBuffer(a)?a:ArrayBuffer.isView(a)?n.from(a.buffer,a.byteOffset,a.byteLength):n.from(String(a),"utf8")},decode:function(a){return a.toString("utf8")},name:`${this.name}+buffer`})}}),vu.json=new i({encode:JSON.stringify,decode:JSON.parse,name:"json"}),vu.buffer=new r({encode:function(a){return n.isBuffer(a)?a:ArrayBuffer.isView(a)?n.from(a.buffer,a.byteOffset,a.byteLength):n.from(String(a),"utf8")},decode:o,name:"buffer",createViewTranscoder(){return new s({encode:function(a){return ArrayBuffer.isView(a)?a:n.from(String(a),"utf8")},decode:function(a){return n.from(a.buffer,a.byteOffset,a.byteLength)},name:`${this.name}+view`})}}),vu.view=new s({encode:function(a){return ArrayBuffer.isView(a)?a:e.encode(a)},decode:o,name:"view",createBufferTranscoder(){return new r({encode:function(a){return n.isBuffer(a)?a:ArrayBuffer.isView(a)?n.from(a.buffer,a.byteOffset,a.byteLength):n.from(String(a),"utf8")},decode:o,name:`${this.name}+buffer`})}}),vu.hex=new r({encode:function(a){return n.isBuffer(a)?a:n.from(String(a),"hex")},decode:function(a){return a.toString("hex")},name:"hex"}),vu.base64=new r({encode:function(a){return n.isBuffer(a)?a:n.from(String(a),"base64")},decode:function(a){return a.toString("base64")},name:"base64"}),vu}var c3;function DEe(){if(c3)return SI;c3=1;const n=Kl(),e=OEe(),{Encoding:t}=E5(),{BufferFormat:r,ViewFormat:s,UTF8Format:i}=A5(),o=Symbol("formats"),a=Symbol("encodings"),l=new Set(["buffer","view","utf8"]);class u{constructor(x){if(Array.isArray(x)){if(!x.every(b=>l.has(b)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[a]=new Map,this[o]=new Set(x);for(const b in e)try{this.encoding(b)}catch(C){if(C.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw C}}encodings(){return Array.from(new Set(this[a].values()))}encoding(x){let b=this[a].get(x);if(b===void 0){if(typeof x=="string"&&x!==""){if(b=g[x],!b)throw new n(`Encoding '${x}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof x!="object"||x===null)throw new TypeError("First argument 'encoding' must be a string or object");b=f(x)}const{name:C,format:$}=b;if(!this[o].has($))if(this[o].has("view"))b=b.createViewTranscoder();else if(this[o].has("buffer"))b=b.createBufferTranscoder();else if(this[o].has("utf8"))b=b.createUTF8Transcoder();else throw new n(`Encoding '${C}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const k of[x,C,b.name,b.commonName])this[a].set(k,b)}return b}}SI.Transcoder=u;function f(w){if(w instanceof t)return w;const x="type"in w&&typeof w.type=="string"?w.type:void 0,b=w.name||x||`anonymous-${m++}`;switch(h(w)){case"view":return new s({...w,name:b});case"utf8":return new i({...w,name:b});case"buffer":return new r({...w,name:b});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function h(w){return"format"in w&&w.format!==void 0?w.format:"buffer"in w&&typeof w.buffer=="boolean"?w.buffer?"buffer":"utf8":"code"in w&&Number.isInteger(w.code)?"view":"buffer"}const p={binary:e.buffer,"utf-8":e.utf8},g={...e,...p};let m=0;return SI}var Ex={exports:{}},f3;function _Ee(){if(f3)return Ex.exports;f3=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(N,_,U){return Function.prototype.apply.call(N,_,U)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(N){return Object.getOwnPropertyNames(N).concat(Object.getOwnPropertySymbols(N))}:t=function(N){return Object.getOwnPropertyNames(N)};function r(k){console&&console.warn&&console.warn(k)}var s=Number.isNaN||function(N){return N!==N};function i(){i.init.call(this)}Ex.exports=i,Ex.exports.once=b,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");o=k}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(N){if(typeof N!="number"||N<0||s(N))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+N+".");return this._maxListeners=N,this};function l(k){return k._maxListeners===void 0?i.defaultMaxListeners:k._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(N){for(var _=[],U=1;U<arguments.length;U++)_.push(arguments[U]);var O=N==="error",L=this._events;if(L!==void 0)O=O&&L.error===void 0;else if(!O)return!1;if(O){var T;if(_.length>0&&(T=_[0]),T instanceof Error)throw T;var I=new Error("Unhandled error."+(T?" ("+T.message+")":""));throw I.context=T,I}var v=L[N];if(v===void 0)return!1;if(typeof v=="function")e(v,this,_);else for(var A=v.length,M=m(v,A),U=0;U<A;++U)e(M[U],this,_);return!0};function u(k,N,_,U){var O,L,T;if(a(_),L=k._events,L===void 0?(L=k._events=Object.create(null),k._eventsCount=0):(L.newListener!==void 0&&(k.emit("newListener",N,_.listener?_.listener:_),L=k._events),T=L[N]),T===void 0)T=L[N]=_,++k._eventsCount;else if(typeof T=="function"?T=L[N]=U?[_,T]:[T,_]:U?T.unshift(_):T.push(_),O=l(k),O>0&&T.length>O&&!T.warned){T.warned=!0;var I=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(N)+" listeners added. Use emitter.setMaxListeners() to increase limit");I.name="MaxListenersExceededWarning",I.emitter=k,I.type=N,I.count=T.length,r(I)}return k}i.prototype.addListener=function(N,_){return u(this,N,_,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(N,_){return u(this,N,_,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(k,N,_){var U={fired:!1,wrapFn:void 0,target:k,type:N,listener:_},O=f.bind(U);return O.listener=_,U.wrapFn=O,O}i.prototype.once=function(N,_){return a(_),this.on(N,h(this,N,_)),this},i.prototype.prependOnceListener=function(N,_){return a(_),this.prependListener(N,h(this,N,_)),this},i.prototype.removeListener=function(N,_){var U,O,L,T,I;if(a(_),O=this._events,O===void 0)return this;if(U=O[N],U===void 0)return this;if(U===_||U.listener===_)--this._eventsCount===0?this._events=Object.create(null):(delete O[N],O.removeListener&&this.emit("removeListener",N,U.listener||_));else if(typeof U!="function"){for(L=-1,T=U.length-1;T>=0;T--)if(U[T]===_||U[T].listener===_){I=U[T].listener,L=T;break}if(L<0)return this;L===0?U.shift():w(U,L),U.length===1&&(O[N]=U[0]),O.removeListener!==void 0&&this.emit("removeListener",N,I||_)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(N){var _,U,O;if(U=this._events,U===void 0)return this;if(U.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):U[N]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete U[N]),this;if(arguments.length===0){var L=Object.keys(U),T;for(O=0;O<L.length;++O)T=L[O],T!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(_=U[N],typeof _=="function")this.removeListener(N,_);else if(_!==void 0)for(O=_.length-1;O>=0;O--)this.removeListener(N,_[O]);return this};function p(k,N,_){var U=k._events;if(U===void 0)return[];var O=U[N];return O===void 0?[]:typeof O=="function"?_?[O.listener||O]:[O]:_?x(O):m(O,O.length)}i.prototype.listeners=function(N){return p(this,N,!0)},i.prototype.rawListeners=function(N){return p(this,N,!1)},i.listenerCount=function(k,N){return typeof k.listenerCount=="function"?k.listenerCount(N):g.call(k,N)},i.prototype.listenerCount=g;function g(k){var N=this._events;if(N!==void 0){var _=N[k];if(typeof _=="function")return 1;if(_!==void 0)return _.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function m(k,N){for(var _=new Array(N),U=0;U<N;++U)_[U]=k[U];return _}function w(k,N){for(;N+1<k.length;N++)k[N]=k[N+1];k.pop()}function x(k){for(var N=new Array(k.length),_=0;_<N.length;++_)N[_]=k[_].listener||k[_];return N}function b(k,N){return new Promise(function(_,U){function O(T){k.removeListener(N,L),U(T)}function L(){typeof k.removeListener=="function"&&k.removeListener("error",O),_([].slice.call(arguments))}$(k,N,L,{once:!0}),N!=="error"&&C(k,O,{once:!0})})}function C(k,N,_){typeof k.on=="function"&&$(k,"error",N,_)}function $(k,N,_,U){if(typeof k.on=="function")U.once?k.once(N,_):k.on(N,_);else if(typeof k.addEventListener=="function")k.addEventListener(N,function O(L){U.once&&k.removeEventListener(N,O),_(L)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}return Ex.exports}var AI,h3;function r$(){if(h3)return AI;h3=1;const n=Symbol("kErrors");AI=function(u){if(u=u.filter(s),u.length!==0)return u.length===1?u[0]:new e(u)};class e extends Error{constructor(f){const h=new Set(f.map(i).filter(Boolean)),p=Array.from(h).join("; ");super(p),t(this,"name","CombinedError"),t(this,n,f),r(this,"stack",()=>f.map(o).join(`

`)),r(this,"transient",()=>f.length>0&&f.every(a)),r(this,"expected",()=>f.length>0&&f.every(l))}[Symbol.iterator](){return this[n][Symbol.iterator]()}}function t(u,f,h){Object.defineProperty(u,f,{value:h})}function r(u,f,h){Object.defineProperty(u,f,{get:h})}function s(u){return u!=null}function i(u){return u.message}function o(u){return u.stack}function a(u){return u.transient===!0}function l(u){return u.expected===!0}return AI}var rm={},Hc={},d3;function hg(){if(d3)return Hc;d3=1;const n=Kl(),e=new Set;return Hc.getOptions=function(t,r){return typeof t=="object"&&t!==null?t:r!==void 0?r:{}},Hc.emptyOptions=Object.freeze({}),Hc.noop=function(){},Hc.resolvedPromise=Promise.resolve(),Hc.deprecate=function(t){if(!e.has(t)){e.add(t);const r=globalThis.console;typeof r<"u"&&typeof r.warn=="function"&&r.warn(new n(t,{code:"LEVEL_LEGACY"}))}},Hc}var TI={},p3;function T5(){if(p3)return TI;p3=1;const n=Kl();class e extends n{constructor(r){super("Operation has been aborted",{code:"LEVEL_ABORTED",cause:r})}get name(){return"AbortError"}}return TI.AbortError=e,TI}var g3;function Bf(){if(g3)return rm;g3=1;const n=Kl(),e=r$(),{getOptions:t,emptyOptions:r,noop:s}=hg(),{AbortError:i}=T5(),o=Symbol("working"),a=Symbol("decodeOne"),l=Symbol("decodeMany"),u=Symbol("signal"),f=Symbol("pendingClose"),h=Symbol("closingPromise"),p=Symbol("keyEncoding"),g=Symbol("valueEncoding"),m=Symbol("keys"),w=Symbol("values"),x=Symbol("limit"),b=Symbol("count"),C=Symbol("ended");class ${constructor(A,M){if(typeof A!="object"||A===null){const D=A===null?"null":typeof A;throw new TypeError(`The first argument must be an abstract-level database, received ${D}`)}if(typeof M!="object"||M===null)throw new TypeError("The second argument must be an options object");this[o]=!1,this[f]=null,this[h]=null,this[p]=M[p],this[g]=M[g],this[x]=Number.isInteger(M.limit)&&M.limit>=0?M.limit:1/0,this[b]=0,this[u]=M.signal!=null?M.signal:null,this[C]=!1,this.db=A,this.db.attachResource(this)}get count(){return this[b]}get limit(){return this[x]}async next(){O(this);try{if(this[C]||this[b]>=this[x]){this[C]=!0;return}let A=await this._next();if(A===void 0){this[C]=!0;return}try{A=this[a](A)}catch(M){throw new U(M)}return this[b]++,A}finally{L(this)}}async _next(){}async nextv(A,M){if(!Number.isInteger(A))throw new TypeError("The first argument 'size' must be an integer");M=t(M,r),A<1&&(A=1),this[x]<1/0&&(A=Math.min(A,this[x]-this[b])),O(this);try{if(this[C]||A<=0)return this[C]=!0,[];const D=await this._nextv(A,M);if(D.length===0)return this[C]=!0,D;try{this[l](D)}catch(B){throw new U(B)}return this[b]+=D.length,D}finally{L(this)}}async _nextv(A,M){const D=[];for(;D.length<A;){const B=await this._next(M);if(B!==void 0)D.push(B);else{this[C]=!0;break}}return D}async all(A){A=t(A,r),O(this);try{if(this[C]||this[b]>=this[x])return[];const M=await this._all(A);try{this[l](M)}catch(D){throw new U(D)}return this[b]+=M.length,M}catch(M){L(this),await I(this,M)}finally{this[C]=!0,this[o]&&(L(this),await this.close())}}async _all(A){let M=this[b];const D=[];for(;;){const B=this[x]<1/0?Math.min(1e3,this[x]-M):1e3;if(B<=0)return D;const j=await this._nextv(B,A);if(j.length===0)return D;D.push.apply(D,j),M+=j.length}}seek(A,M){if(M=t(M,r),this[h]===null){if(this[o])throw new n("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const D=this.db.keyEncoding(M.keyEncoding||this[p]),B=D.format;M.keyEncoding!==B&&(M={...M,keyEncoding:B});const j=this.db.prefixKey(D.encode(A),B,!1);this._seek(j,M),this[C]=!1}}}_seek(A,M){throw new n("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}async close(){return this[h]!==null?this[h].catch(s):(this[h]=new Promise((A,M)=>{this[f]=()=>{this[f]=null,T(this).then(A,M)}}),this[o]||this[f](),this[h])}async _close(){}async*[Symbol.asyncIterator](){try{let A;for(;(A=await this.next())!==void 0;)yield A}catch(A){await I(this,A)}finally{await this.close()}}}class k extends ${constructor(A,M){super(A,M),this[m]=M.keys!==!1,this[w]=M.values!==!1}[a](A){const M=A[0],D=A[1];return M!==void 0&&(A[0]=this[m]?this[p].decode(M):void 0),D!==void 0&&(A[1]=this[w]?this[g].decode(D):void 0),A}[l](A){const M=this[p],D=this[g];for(const B of A){const j=B[0],W=B[1];j!==void 0&&(B[0]=this[m]?M.decode(j):void 0),W!==void 0&&(B[1]=this[w]?D.decode(W):void 0)}}}class N extends ${[a](A){return this[p].decode(A)}[l](A){const M=this[p];for(let D=0;D<A.length;D++){const B=A[D];B!==void 0&&(A[D]=M.decode(B))}}}class _ extends ${[a](A){return this[g].decode(A)}[l](A){const M=this[g];for(let D=0;D<A.length;D++){const B=A[D];B!==void 0&&(A[D]=M.decode(B))}}}class U extends n{constructor(A){super("Iterator could not decode data",{code:"LEVEL_DECODE_ERROR",cause:A})}}const O=function(v){if(v[h]!==null)throw new n("Iterator is not open: cannot read after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"});if(v[o])throw new n("Iterator is busy: cannot read until previous read has completed",{code:"LEVEL_ITERATOR_BUSY"});if(v[u]!==null&&v[u].aborted)throw new i;v[o]=!0},L=function(v){v[o]=!1,v[f]!==null&&v[f]()},T=async function(v){await v._close(),v.db.detachResource(v)},I=async function(v,A){try{await v.close()}catch(M){throw e([A,M])}throw A};return k.keyEncoding=p,k.valueEncoding=g,rm.AbstractIterator=k,rm.AbstractKeyIterator=N,rm.AbstractValueIterator=_,rm}var Ax={},m3;function PEe(){if(m3)return Ax;m3=1;const{AbstractKeyIterator:n,AbstractValueIterator:e}=Bf(),t=Symbol("iterator"),r=Symbol("handleOne"),s=Symbol("handleMany");class i extends n{constructor(l,u){super(l,u),this[t]=l.iterator({...u,keys:!0,values:!1})}[r](l){return l[0]}[s](l){for(let u=0;u<l.length;u++)l[u]=l[u][0]}}class o extends e{constructor(l,u){super(l,u),this[t]=l.iterator({...u,keys:!1,values:!0})}[r](l){return l[1]}[s](l){for(let u=0;u<l.length;u++)l[u]=l[u][1]}}for(const a of[i,o])a.prototype._next=async function(){const l=await this[t].next();return l===void 0?l:this[r](l)},a.prototype._nextv=async function(l,u){const f=await this[t].nextv(l,u);return this[s](f),f},a.prototype._all=async function(l){const u=await this[t].all(l);return this[s](u),u},a.prototype._seek=function(l,u){this[t].seek(l,u)},a.prototype._close=async function(){return this[t].close()};return Ax.DefaultKeyIterator=i,Ax.DefaultValueIterator=o,Ax}var sm={},y3;function FEe(){if(y3)return sm;y3=1;const{AbstractIterator:n,AbstractKeyIterator:e,AbstractValueIterator:t}=Bf(),r=Kl(),s=Symbol("nut"),i=Symbol("undefer"),o=Symbol("factory"),a=Symbol("signalOptions");class l extends n{constructor(p,g){super(p,g),this[s]=null,this[o]=()=>p.iterator(g),this[a]={signal:g.signal},this.db.defer(()=>this[i](),this[a])}}class u extends e{constructor(p,g){super(p,g),this[s]=null,this[o]=()=>p.keys(g),this[a]={signal:g.signal},this.db.defer(()=>this[i](),this[a])}}class f extends t{constructor(p,g){super(p,g),this[s]=null,this[o]=()=>p.values(g),this[a]={signal:g.signal},this.db.defer(()=>this[i](),this[a])}}for(const h of[l,u,f])h.prototype[i]=function(){this.db.status==="open"&&(this[s]=this[o]())},h.prototype._next=async function(){if(this[s]!==null)return this[s].next();if(this.db.status==="opening")return this.db.deferAsync(()=>this._next(),this[a]);throw new r("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})},h.prototype._nextv=async function(p,g){if(this[s]!==null)return this[s].nextv(p,g);if(this.db.status==="opening")return this.db.deferAsync(()=>this._nextv(p,g),this[a]);throw new r("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})},h.prototype._all=async function(p){if(this[s]!==null)return this[s].all();if(this.db.status==="opening")return this.db.deferAsync(()=>this._all(p),this[a]);throw new r("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})},h.prototype._seek=function(p,g){this[s]!==null?this[s]._seek(p,g):this.db.status==="opening"&&this.db.defer(()=>this._seek(p,g),this[a])},h.prototype._close=async function(){if(this[s]!==null)return this[s].close();if(this.db.status==="opening")return this.db.deferAsync(()=>this._close())};return sm.DeferredIterator=l,sm.DeferredKeyIterator=u,sm.DeferredValueIterator=f,sm}var NI={},$I={},Tx={},w3;function s$(){return w3||(w3=1,Tx.prefixDescendantKey=function(n,e,t,r){for(;t!==null&&t!==r;)n=t.prefixKey(n,e,!0),t=t.parent;return n},Tx.isDescendant=function(n,e){for(;;){if(n.parent==null)return!1;if(n.parent===e)return!0;n=n.parent}}),Tx}var RI={},x3;function N5(){if(x3)return RI;x3=1;const{prefixDescendantKey:n,isDescendant:e}=s$(),t=Symbol("db"),r=Symbol("privateOperations"),s=Symbol("publicOperations");class i{constructor(a,l,u){this[t]=a,this[r]=l,this[s]=u}add(a){const l=a.type==="put",u=a.sublevel!=null,f=u?a.sublevel:this[t],h=f._checkKey(a.key);if(h!=null)throw h;if(a.keyEncoding=f.keyEncoding(a.keyEncoding),l){const C=f._checkValue(a.value);if(C!=null)throw C;a.valueEncoding=f.valueEncoding(a.valueEncoding)}else if(a.type!=="del")throw new TypeError("A batch operation must have a type property that is 'put' or 'del'");const p=a.keyEncoding,g=p.encode(a.key),m=p.format,w=u&&!e(a.sublevel,this[t])&&a.sublevel!==this[t],x=u&&!w?n(g,m,f,this[t]):g;u&&!w&&(a.sublevel=null);let b=null;if(this[s]!==null&&!w&&(b=Object.assign({},a),b.encodedKey=x,u&&(b.key=x,b.keyEncoding=this[t].keyEncoding(m)),this[s].push(b)),a.key=w?x:this[t].prefixKey(x,m,!0),a.keyEncoding=m,l){const C=a.valueEncoding,$=C.encode(a.value),k=C.format;a.value=$,a.valueEncoding=k,b!==null&&(b.encodedValue=$,u&&(b.value=$,b.valueEncoding=this[t].valueEncoding(k)))}return this[r].push(a),this}}return RI.PrewriteBatch=i,RI}var b3;function $5(){if(b3)return $I;b3=1;const n=r$(),e=Kl(),{getOptions:t,emptyOptions:r,noop:s}=hg(),{prefixDescendantKey:i,isDescendant:o}=s$(),{PrewriteBatch:a}=N5(),l=Symbol("status"),u=Symbol("publicOperations"),f=Symbol("legacyOperations"),h=Symbol("privateOperations"),p=Symbol("closePromise"),g=Symbol("length"),m=Symbol("prewriteRun"),w=Symbol("prewriteBatch"),x=Symbol("prewriteData"),b=Symbol("addMode");class C{constructor(O,L){if(typeof O!="object"||O===null){const v=O===null?"null":typeof O;throw new TypeError(`The first argument must be an abstract-level database, received ${v}`)}const T=O.listenerCount("write")>0,I=!O.hooks.prewrite.noop;if(this[u]=T?[]:null,this[f]=T||I?null:[],this[g]=0,this[l]="open",this[p]=null,this[b]=t(L,r).add===!0,I){const v=new N([],T?[]:null);this[x]=v,this[w]=new a(O,v[h],v[u]),this[m]=O.hooks.prewrite.run}else this[x]=null,this[w]=null,this[m]=null;this.db=O,this.db.attachResource(this)}get length(){return this[x]!==null?this[g]+this[x].length:this[g]}put(O,L,T){_(this),T=t(T,r);const I=T.sublevel!=null,v=I?T.sublevel:this.db,A=T,M=v._checkKey(O),D=v._checkValue(L);if(M!=null)throw M;if(D!=null)throw D;const B=Object.assign({},T,{type:"put",key:O,value:L,keyEncoding:v.keyEncoding(T.keyEncoding),valueEncoding:v.valueEncoding(T.valueEncoding)});if(this[m]!==null)try{this[m](B,this[w]),B.keyEncoding=v.keyEncoding(B.keyEncoding),B.valueEncoding=v.valueEncoding(B.valueEncoding)}catch(J){throw new e("The prewrite hook failed on batch.put()",{code:"LEVEL_HOOK_ERROR",cause:J})}const j=B.keyEncoding,W=j.encode(B.key),P=j.format,E=I&&!o(B.sublevel,this.db)&&B.sublevel!==this.db,R=I&&!E?i(W,P,v,this.db):W,H=B.valueEncoding,K=H.encode(B.value),Q=H.format;if(I&&!E&&(B.sublevel=null),this[u]!==null&&!E){const J=Object.assign({},B);J.encodedKey=R,J.encodedValue=K,I&&(J.key=R,J.value=K,J.keyEncoding=this.db.keyEncoding(P),J.valueEncoding=this.db.valueEncoding(Q)),this[u].push(J)}else if(this[f]!==null&&!E){const J=Object.assign({},A);J.type="put",J.key=O,J.value=L,this[f].push(J)}return B.key=E?R:this.db.prefixKey(R,P,!0),B.value=K,B.keyEncoding=P,B.valueEncoding=Q,this[b]?this._add(B):this._put(B.key,K,B),this[g]++,this}_put(O,L,T){}del(O,L){_(this),L=t(L,r);const T=L.sublevel!=null,I=T?L.sublevel:this.db,v=L,A=I._checkKey(O);if(A!=null)throw A;const M=Object.assign({},L,{type:"del",key:O,keyEncoding:I.keyEncoding(L.keyEncoding)});if(this[m]!==null)try{this[m](M,this[w]),M.keyEncoding=I.keyEncoding(M.keyEncoding)}catch(P){throw new e("The prewrite hook failed on batch.del()",{code:"LEVEL_HOOK_ERROR",cause:P})}const D=M.keyEncoding,B=D.encode(M.key),j=D.format,W=T?i(B,j,I,this.db):B;if(T&&(M.sublevel=null),this[u]!==null){const P=Object.assign({},M);P.encodedKey=W,T&&(P.key=W,P.keyEncoding=this.db.keyEncoding(j)),this[u].push(P)}else if(this[f]!==null){const P=Object.assign({},v);P.type="del",P.key=O,this[f].push(P)}return M.key=this.db.prefixKey(W,j,!0),M.keyEncoding=j,this[b]?this._add(M):this._del(M.key,M),this[g]++,this}_del(O,L){}_add(O){}clear(){return _(this),this._clear(),this[u]!==null&&(this[u]=[]),this[f]!==null&&(this[f]=[]),this[x]!==null&&this[x].clear(),this[g]=0,this}_clear(){}async write(O){if(_(this),O=t(O),this[g]===0)return this.close();{this[l]="writing";const L=$(this);try{if(this[x]!==null){const T=this[x][u],I=this[x][h],v=this[x].length;for(let A=0;A<v;A++){const M=I[A];this[b]?this._add(M):M.type==="put"?this._put(M.key,M.value,M):this._del(M.key,M)}T!==null&&v!==0&&(this[u]=this[u].concat(T))}await this._write(O)}catch(T){L();try{await this[p]}catch(I){T=n([T,I])}throw T}return L(),this[u]!==null?this.db.emit("write",this[u]):this[f]!==null&&this.db.emit("batch",this[f]),this[p]}}async _write(O){}async close(){return this[p]!==null?this[p].catch(s):($(this)(),this[p])}async _close(){}}const $=function(U){let O;return U[p]=new Promise((L,T)=>{O=()=>{k(U).then(L,T)}}),O},k=async function(U){U[l]="closing",await U._close(),U.db.detachResource(U)};class N{constructor(O,L){this[h]=O,this[u]=L}get length(){return this[h].length}clear(){for(const O of[u,h]){const L=this[O];L!==null&&L.splice(0,L.length)}}}const _=function(U){if(U[l]!=="open")throw new e("Batch is not open: cannot change operations after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});if(U.db.status!=="open")throw new e("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})};return $I.AbstractChainedBatch=C,$I}var v3;function MEe(){if(v3)return NI;v3=1;const{AbstractChainedBatch:n}=$5(),e=Symbol("encoded");class t extends n{constructor(s){super(s,{add:!0}),this[e]=[]}_add(s){this[e].push(s)}_clear(){this[e]=[]}async _write(s){return this.db._batch(this[e],s)}}return NI.DefaultChainedBatch=t,NI}var OI={},S3;function LEe(){if(S3)return OI;S3=1;const{noop:n}=hg(),e=Symbol("functions"),t=Symbol("async");class r{constructor(){this.postopen=new s({async:!0}),this.prewrite=new s({async:!1}),this.newsub=new s({async:!1})}}class s{constructor(l){this[t]=l.async,this[e]=new Set,this.noop=!0,this.run=o(this)}add(l){i(l),this[e].add(l),this.noop=!1,this.run=o(this)}delete(l){i(l),this[e].delete(l),this.noop=this[e].size===0,this.run=o(this)}}const i=function(a){if(typeof a!="function"){const l=a===null?"null":typeof a;throw new TypeError(`The first argument must be a function, received ${l}`)}},o=function(a){if(a.noop)return n;if(a[e].size===1){const[l]=a[e];return l}else return a[t]?(async function(u,...f){for(const h of u)await h(...f)}).bind(null,Array.from(a[e])):(function(u,...f){for(const h of u)h(...f)}).bind(null,Array.from(a[e]))};return OI.DatabaseHooks=r,OI}var DI={},C3;function BEe(){if(C3)return DI;C3=1;const{deprecate:n}=hg();return DI.EventMonitor=class{constructor(t,r){for(const l of r)this[l.name]=!1,l.deprecated&&(l.message=`The '${l.name}' event is deprecated in favor of '${l.alt}' and will be removed in a future version of abstract-level`);const s=new Map(r.map(l=>[l.name,l])),i=this;t.on("newListener",o),t.on("removeListener",a);function o(l){const u=s.get(l);u!==void 0&&(i[l]=!0,u.deprecated&&n(u.message))}function a(l){s.has(l)&&(i[l]=this.listenerCount(l)>0)}}},DI}var _I={},k3;function zEe(){if(k3)return _I;k3=1;const{getOptions:n,emptyOptions:e}=hg(),{AbortError:t}=T5(),r=Symbol("operations"),s=Symbol("signals"),i=Symbol("handleAbort");class o{constructor(u,f){this.fn=u,this.signal=f}}class a{constructor(){this[r]=[],this[s]=new Set,this[i]=this[i].bind(this)}add(u,f){f=n(f,e);const h=f.signal;if(h==null){this[r].push(new o(u,null));return}if(h.aborted){u(new t);return}this[s].has(h)||(this[s].add(h),h.addEventListener("abort",this[i],{once:!0})),this[r].push(new o(u,h))}drain(){const u=this[r],f=this[s];this[r]=[],this[s]=new Set;for(const h of f)h.removeEventListener("abort",this[i]);for(const h of u)h.fn.call(null)}[i](u){const f=u.target,h=new t,p=[];this[r]=this[r].filter(function(g){return g.signal!==null&&g.signal===f?(p.push(g),!1):!0}),this[s].delete(f);for(const g of p)g.fn.call(null,h)}}return _I.DeferredQueue=a,_I}var PI,I3;function UEe(){if(I3)return PI;I3=1;const n=Object.prototype.hasOwnProperty,e=new Set(["lt","lte","gt","gte"]);return PI=function(t,r){const s={};for(const i in t)n.call(t,i)&&(i==="keyEncoding"||i==="valueEncoding"||(e.has(i)?s[i]=r.encode(t[i]):s[i]=t[i]));return s.reverse=!!s.reverse,s.limit=Number.isInteger(s.limit)&&s.limit>=0?s.limit:-1,s},PI}var im={},E3;function VEe(){if(E3)return im;E3=1;const{AbstractIterator:n,AbstractKeyIterator:e,AbstractValueIterator:t}=Bf(),r=Symbol("unfix"),s=Symbol("iterator");class i extends n{constructor(u,f,h,p){super(u,f),this[s]=h,this[r]=p}async _next(){const u=await this[s].next();if(u!==void 0){const f=u[0];f!==void 0&&(u[0]=this[r](f))}return u}async _nextv(u,f){const h=await this[s].nextv(u,f),p=this[r];for(const g of h){const m=g[0];m!==void 0&&(g[0]=p(m))}return h}async _all(u){const f=await this[s].all(u),h=this[r];for(const p of f){const g=p[0];g!==void 0&&(p[0]=h(g))}return f}}class o extends e{constructor(u,f,h,p){super(u,f),this[s]=h,this[r]=p}async _next(){const u=await this[s].next();return u===void 0?u:this[r](u)}async _nextv(u,f){const h=await this[s].nextv(u,f),p=this[r];for(let g=0;g<h.length;g++){const m=h[g];m!==void 0&&(h[g]=p(m))}return h}async _all(u){const f=await this[s].all(u),h=this[r];for(let p=0;p<f.length;p++){const g=f[p];g!==void 0&&(f[p]=h(g))}return f}}class a extends t{constructor(u,f,h){super(u,f),this[s]=h}async _next(){return this[s].next()}async _nextv(u,f){return this[s].nextv(u,f)}async _all(u){return this[s].all(u)}}for(const l of[i,o,a])l.prototype._seek=function(u,f){this[s].seek(u,f)},l.prototype._close=async function(){return this[s].close()};return im.AbstractSublevelIterator=i,im.AbstractSublevelKeyIterator=o,im.AbstractSublevelValueIterator=a,im}var FI,A3;function WEe(){if(A3)return FI;A3=1;const n=Kl(),{Buffer:e}=n$()||{},{AbstractSublevelIterator:t,AbstractSublevelKeyIterator:r,AbstractSublevelValueIterator:s}=VEe(),i=Symbol("prefix"),o=Symbol("localPrefix"),a=Symbol("localPath"),l=Symbol("globalPath"),u=Symbol("upperBound"),f=Symbol("prefixRange"),h=Symbol("root"),p=Symbol("parent"),g=Symbol("unfix"),m=new TextEncoder,w={separator:"!"};FI=function({AbstractLevel:N}){class _ extends N{static defaults(O){return O==null?w:O.separator?O:{...O,separator:"!"}}constructor(O,L,T){const{separator:I,manifest:v,...A}=_.defaults(T),M=[].concat(L).map(E=>k(E,I)),D=I.charCodeAt(0)+1,B=O[h]||O;if(!M.every(E=>m.encode(E).every(R=>R>D&&R<127)))throw new n(`Sublevel name must use bytes > ${D} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(x(O,v),A);const j=M.map(E=>I+E+I).join(""),W=(O.prefix||"")+j,P=W.slice(0,-1)+String.fromCharCode(D);this[h]=B,this[p]=O,this[a]=M,this[l]=O.prefix?O.path().concat(M):M,this[i]=new C(W),this[u]=new C(P),this[o]=new C(j),this[g]=new $}prefixKey(O,L,T){const I=T?this[o]:this[i];if(L==="utf8")return I.utf8+O;if(O.byteLength===0)return I[L];if(L==="view"){const v=I.view,A=new Uint8Array(v.byteLength+O.byteLength);return A.set(v,0),A.set(O,v.byteLength),A}else{const v=I.buffer;return e.concat([v,O],v.byteLength+O.byteLength)}}[f](O,L){O.gte!==void 0?O.gte=this.prefixKey(O.gte,L,!1):O.gt!==void 0?O.gt=this.prefixKey(O.gt,L,!1):O.gte=this[i][L],O.lte!==void 0?O.lte=this.prefixKey(O.lte,L,!1):O.lt!==void 0?O.lt=this.prefixKey(O.lt,L,!1):O.lte=this[u][L]}get prefix(){return this[i].utf8}get db(){return this[h]}get parent(){return this[p]}path(O=!1){return O?this[a]:this[l]}async _open(O){return this[p].open({passive:!0})}async _put(O,L,T){return this[p].put(O,L,T)}async _get(O,L){return this[p].get(O,L)}async _getMany(O,L){return this[p].getMany(O,L)}async _del(O,L){return this[p].del(O,L)}async _batch(O,L){return this[p].batch(O,L)}async _clear(O){return this[f](O,O.keyEncoding),this[h].clear(O)}_iterator(O){this[f](O,O.keyEncoding);const L=this[h].iterator(O),T=this[g].get(this[i].utf8.length,O.keyEncoding);return new t(this,O,L,T)}_keys(O){this[f](O,O.keyEncoding);const L=this[h].keys(O),T=this[g].get(this[i].utf8.length,O.keyEncoding);return new r(this,O,L,T)}_values(O){this[f](O,O.keyEncoding);const L=this[h].values(O);return new s(this,O,L)}}return{AbstractSublevel:_}};const x=function(N,_){return{...N.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},..._,encodings:{utf8:b(N,"utf8"),buffer:b(N,"buffer"),view:b(N,"view")}}},b=function(N,_){return N.supports.encodings[_]?N.keyEncoding(_).name===_:!1};class C{constructor(_){this.utf8=_,this.view=m.encode(_),this.buffer=e?e.from(this.view.buffer,0,this.view.byteLength):{}}}class ${constructor(){this.cache=new Map}get(_,U){let O=this.cache.get(U);return O===void 0&&(U==="view"?O=(function(L,T){return T.subarray(L)}).bind(null,_):O=(function(L,T){return T.slice(L)}).bind(null,_),this.cache.set(U,O)),O}}const k=function(N,_){let U=0,O=N.length;for(;U<O&&N[U]===_;)U++;for(;O>U&&N[O-1]===_;)O--;return N.slice(U,O)};return FI}var T3;function N3(){if(T3)return kx;T3=1;const{supports:n}=NEe(),{Transcoder:e}=DEe(),{EventEmitter:t}=_Ee(),r=Kl(),s=r$(),{AbstractIterator:i}=Bf(),{DefaultKeyIterator:o,DefaultValueIterator:a}=PEe(),{DeferredIterator:l,DeferredKeyIterator:u,DeferredValueIterator:f}=FEe(),{DefaultChainedBatch:h}=MEe(),{DatabaseHooks:p}=LEe(),{PrewriteBatch:g}=N5(),{EventMonitor:m}=BEe(),{getOptions:w,noop:x,emptyOptions:b,resolvedPromise:C}=hg(),{prefixDescendantKey:$,isDescendant:k}=s$(),{DeferredQueue:N}=zEe(),_=UEe(),U=Symbol("resources"),O=Symbol("closeResources"),L=Symbol("queue"),T=Symbol("deferOpen"),I=Symbol("options"),v=Symbol("status"),A=Symbol("statusChange"),M=Symbol("statusLocked"),D=Symbol("defaultOptions"),B=Symbol("transcoder"),j=Symbol("keyEncoding"),W=Symbol("valueEncoding"),P=Symbol("eventMonitor"),E=Symbol("arrayBatch");class R extends t{constructor(ne,he){if(super(),typeof ne!="object"||ne===null)throw new TypeError("The first argument 'manifest' must be an object");he=w(he);const{keyEncoding:Ie,valueEncoding:ze,passive:Re,...Ke}=he;this[U]=new Set,this[L]=new N,this[T]=!0,this[I]=Ke,this[v]="opening",this[A]=null,this[M]=!1,this.hooks=new p,this.supports=n(ne,{deferredOpen:!0,snapshots:ne.snapshots!==!1,permanence:ne.permanence!==!1,encodings:ne.encodings||{},events:Object.assign({},ne.events,{opening:!0,open:!0,closing:!0,closed:!0,write:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[P]=new m(this,[{name:"write"},{name:"put",deprecated:!0,alt:"write"},{name:"del",deprecated:!0,alt:"write"},{name:"batch",deprecated:!0,alt:"write"}]),this[B]=new e(J(this)),this[j]=this[B].encoding(Ie||"utf8"),this[W]=this[B].encoding(ze||"utf8");for(const tt of this[B].encodings())this.supports.encodings[tt.commonName]||(this.supports.encodings[tt.commonName]=!0);this[D]={empty:b,entry:Object.freeze({keyEncoding:this[j].commonName,valueEncoding:this[W].commonName}),entryFormat:Object.freeze({keyEncoding:this[j].format,valueEncoding:this[W].format}),key:Object.freeze({keyEncoding:this[j].commonName}),keyFormat:Object.freeze({keyEncoding:this[j].format})},queueMicrotask(()=>{this[T]&&this.open({passive:!1}).catch(x)})}get status(){return this[v]}get parent(){return null}keyEncoding(ne){return this[B].encoding(ne??this[j])}valueEncoding(ne){return this[B].encoding(ne??this[W])}async open(ne){ne={...this[I],...w(ne)},ne.createIfMissing=ne.createIfMissing!==!1,ne.errorIfExists=!!ne.errorIfExists;const he=this.hooks.postopen.noop?null:this.hooks.postopen.run,Ie=ne.passive;for(Ie&&this[T]&&await void 0,Q(this);this[A]!==null;)await this[A].catch(x);if(Q(this),Ie){if(this[v]!=="open")throw new ge}else if(this[v]==="closed"||this[T]){this[T]=!1,this[A]=C,this[A]=(async()=>{this[v]="opening";try{this.emit("opening"),await this._open(ne)}catch(ze){this[v]="closed",this[L].drain();try{await this[O]()}catch(Re){ze=s([ze,Re])}throw new ge(ze)}if(this[v]="open",he!==null){let ze;try{this[M]=!0,await he(ne)}catch(Re){ze=ce(Re)}finally{this[M]=!1}if(ze){this[v]="closing",this[L].drain();try{await this[O](),await this._close()}catch(Re){this[M]=!0,ze=s([ze,Re])}throw this[v]="closed",new r("The postopen hook failed on open()",{code:"LEVEL_HOOK_ERROR",cause:ze})}}this[L].drain(),this.emit("open")})();try{await this[A]}finally{this[A]=null}}else if(this[v]!=="open")throw new ge}async _open(ne){}async close(){for(Q(this);this[A]!==null;)await this[A].catch(x);if(Q(this),this[v]==="open"||this[T]){const ne=this[T];this[T]=!1,this[A]=C,this[A]=(async()=>{this[v]="closing",this[L].drain();try{this.emit("closing"),await this[O](),ne||await this._close()}catch(he){throw this[v]="open",this[L].drain(),new be(he)}this[v]="closed",this[L].drain(),this.emit("closed")})();try{await this[A]}finally{this[A]=null}}else if(this[v]!=="closed")throw new be}async[O](){if(this[U].size===0)return;const ne=Array.from(this[U]),he=ne.map(ie);return Promise.allSettled(he).then(async Ie=>{const ze=[];for(let Re=0;Re<Ie.length;Re++)Ie[Re].status==="fulfilled"?this[U].delete(ne[Re]):ze.push(ce(Ie[Re].reason));if(ze.length>0)throw s(ze)})}async _close(){}async get(ne,he){if(he=w(he,this[D].entry),this[v]==="opening")return this.deferAsync(()=>this.get(ne,he));K(this);const Ie=this._checkKey(ne);if(Ie)throw Ie;const ze=this.keyEncoding(he.keyEncoding),Re=this.valueEncoding(he.valueEncoding),Ke=ze.format,tt=Re.format;(he.keyEncoding!==Ke||he.valueEncoding!==tt)&&(he=Object.assign({},he,{keyEncoding:Ke,valueEncoding:tt}));const Xe=ze.encode(ne),ot=await this._get(this.prefixKey(Xe,Ke,!0),he);try{return ot===void 0?ot:Re.decode(ot)}catch(et){throw new r("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:et})}}async _get(ne,he){}async getMany(ne,he){if(he=w(he,this[D].entry),this[v]==="opening")return this.deferAsync(()=>this.getMany(ne,he));if(K(this),!Array.isArray(ne))throw new TypeError("The first argument 'keys' must be an array");if(ne.length===0)return[];const Ie=this.keyEncoding(he.keyEncoding),ze=this.valueEncoding(he.valueEncoding),Re=Ie.format,Ke=ze.format;(he.keyEncoding!==Re||he.valueEncoding!==Ke)&&(he=Object.assign({},he,{keyEncoding:Re,valueEncoding:Ke}));const tt=new Array(ne.length);for(let ot=0;ot<ne.length;ot++){const et=ne[ot],mt=this._checkKey(et);if(mt)throw mt;tt[ot]=this.prefixKey(Ie.encode(et),Re,!0)}const Xe=await this._getMany(tt,he);try{for(let ot=0;ot<Xe.length;ot++)Xe[ot]!==void 0&&(Xe[ot]=ze.decode(Xe[ot]))}catch(ot){throw new r(`Could not decode one or more of ${Xe.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:ot})}return Xe}async _getMany(ne,he){return new Array(ne.length).fill(void 0)}async put(ne,he,Ie){if(!this.hooks.prewrite.noop)return this.batch([{type:"put",key:ne,value:he}],Ie);if(Ie=w(Ie,this[D].entry),this[v]==="opening")return this.deferAsync(()=>this.put(ne,he,Ie));K(this);const ze=this._checkKey(ne)||this._checkValue(he);if(ze)throw ze;const Re=this.keyEncoding(Ie.keyEncoding),Ke=this.valueEncoding(Ie.valueEncoding),tt=Re.format,Xe=Ke.format,ot=this[P].write,et=Ie;Ie===this[D].entry?Ie=this[D].entryFormat:(Ie.keyEncoding!==tt||Ie.valueEncoding!==Xe)&&(Ie=Object.assign({},Ie,{keyEncoding:tt,valueEncoding:Xe}));const mt=Re.encode(ne),Ue=this.prefixKey(mt,tt,!0),Vt=Ke.encode(he);if(await this._put(Ue,Vt,Ie),ot){const At=Object.assign({},et,{type:"put",key:ne,value:he,keyEncoding:Re,valueEncoding:Ke,encodedKey:mt,encodedValue:Vt});this.emit("write",[At])}else this.emit("put",ne,he)}async _put(ne,he,Ie){}async del(ne,he){if(!this.hooks.prewrite.noop)return this.batch([{type:"del",key:ne}],he);if(he=w(he,this[D].key),this[v]==="opening")return this.deferAsync(()=>this.del(ne,he));K(this);const Ie=this._checkKey(ne);if(Ie)throw Ie;const ze=this.keyEncoding(he.keyEncoding),Re=ze.format,Ke=this[P].write,tt=he;he===this[D].key?he=this[D].keyFormat:he.keyEncoding!==Re&&(he=Object.assign({},he,{keyEncoding:Re}));const Xe=ze.encode(ne),ot=this.prefixKey(Xe,Re,!0);if(await this._del(ot,he),Ke){const et=Object.assign({},tt,{type:"del",key:ne,keyEncoding:ze,encodedKey:Xe});this.emit("write",[et])}else this.emit("del",ne)}async _del(ne,he){}batch(ne,he){return arguments.length?(he=w(he,this[D].empty),this[E](ne,he)):(K(this),this._chainedBatch())}async[E](ne,he){if(this[v]==="opening")return this.deferAsync(()=>this[E](ne,he));if(K(this),!Array.isArray(ne))throw new TypeError("The first argument 'operations' must be an array");if(ne.length===0)return;const Ie=ne.length,ze=!this.hooks.prewrite.noop,Re=this[P].write,Ke=Re?new Array(Ie):null,tt=new Array(Ie),Xe=ze?new g(this,tt,Ke):null;for(let ot=0;ot<Ie;ot++){const et=Object.assign({},he,ne[ot]),mt=et.type==="put",Ue=et.sublevel!=null,Vt=Ue?et.sublevel:this,At=Vt._checkKey(et.key);if(At!=null)throw At;if(et.keyEncoding=Vt.keyEncoding(et.keyEncoding),mt){const ae=Vt._checkValue(et.value);if(ae!=null)throw ae;et.valueEncoding=Vt.valueEncoding(et.valueEncoding)}else if(et.type!=="del")throw new TypeError("A batch operation must have a type property that is 'put' or 'del'");if(ze)try{this.hooks.prewrite.run(et,Xe),et.keyEncoding=Vt.keyEncoding(et.keyEncoding),mt&&(et.valueEncoding=Vt.valueEncoding(et.valueEncoding))}catch(ae){throw new r("The prewrite hook failed on batch()",{code:"LEVEL_HOOK_ERROR",cause:ae})}const St=et.keyEncoding,Dn=St.encode(et.key),q=St.format,z=Ue&&!k(et.sublevel,this)&&et.sublevel!==this,G=Ue&&!z?$(Dn,q,Vt,this):Dn;Ue&&!z&&(et.sublevel=null);let Z=null;if(Re&&!z&&(Z=Object.assign({},et),Z.encodedKey=G,Ue&&(Z.key=G,Z.keyEncoding=this.keyEncoding(q)),Ke[ot]=Z),et.key=z?G:this.prefixKey(G,q,!0),et.keyEncoding=q,mt){const ae=et.valueEncoding,ke=ae.encode(et.value),Ne=ae.format;et.value=ke,et.valueEncoding=Ne,Re&&!z&&(Z.encodedValue=ke,Ue&&(Z.value=ke,Z.valueEncoding=this.valueEncoding(Ne)))}tt[ot]=et}await this._batch(tt,he),Re?this.emit("write",Ke):ze||this.emit("batch",ne)}async _batch(ne,he){}sublevel(ne,he){const Ie=H.defaults(he),ze=this._sublevel(ne,Ie);if(!this.hooks.newsub.noop)try{this.hooks.newsub.run(ze,Ie)}catch(Re){throw new r("The newsub hook failed on sublevel()",{code:"LEVEL_HOOK_ERROR",cause:Re})}return ze}_sublevel(ne,he){return new H(this,ne,he)}prefixKey(ne,he,Ie){return ne}async clear(ne){if(ne=w(ne,this[D].empty),this[v]==="opening")return this.deferAsync(()=>this.clear(ne));K(this);const he=ne,Ie=this.keyEncoding(ne.keyEncoding);ne=_(ne,Ie),ne.keyEncoding=Ie.format,ne.limit!==0&&(await this._clear(ne),this.emit("clear",he))}async _clear(ne){}iterator(ne){const he=this.keyEncoding(ne&&ne.keyEncoding),Ie=this.valueEncoding(ne&&ne.valueEncoding);return ne=_(ne,he),ne.keys=ne.keys!==!1,ne.values=ne.values!==!1,ne[i.keyEncoding]=he,ne[i.valueEncoding]=Ie,ne.keyEncoding=he.format,ne.valueEncoding=Ie.format,this[v]==="opening"?new l(this,ne):(K(this),this._iterator(ne))}_iterator(ne){return new i(this,ne)}keys(ne){const he=this.keyEncoding(ne&&ne.keyEncoding),Ie=this.valueEncoding(ne&&ne.valueEncoding);return ne=_(ne,he),ne[i.keyEncoding]=he,ne[i.valueEncoding]=Ie,ne.keyEncoding=he.format,ne.valueEncoding=Ie.format,this[v]==="opening"?new u(this,ne):(K(this),this._keys(ne))}_keys(ne){return new o(this,ne)}values(ne){const he=this.keyEncoding(ne&&ne.keyEncoding),Ie=this.valueEncoding(ne&&ne.valueEncoding);return ne=_(ne,he),ne[i.keyEncoding]=he,ne[i.valueEncoding]=Ie,ne.keyEncoding=he.format,ne.valueEncoding=Ie.format,this[v]==="opening"?new f(this,ne):(K(this),this._values(ne))}_values(ne){return new a(this,ne)}defer(ne,he){if(typeof ne!="function")throw new TypeError("The first argument must be a function");this[L].add(function(Ie){Ie||ne()},he)}deferAsync(ne,he){if(typeof ne!="function")throw new TypeError("The first argument must be a function");return new Promise((Ie,ze)=>{this[L].add(function(Re){Re?ze(Re):ne().then(Ie,ze)},he)})}attachResource(ne){if(typeof ne!="object"||ne===null||typeof ne.close!="function")throw new TypeError("The first argument must be a resource object");this[U].add(ne)}detachResource(ne){this[U].delete(ne)}_chainedBatch(){return new h(this)}_checkKey(ne){if(ne==null)return new r("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(ne){if(ne==null)return new r("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}const{AbstractSublevel:H}=WEe()({AbstractLevel:R});kx.AbstractLevel=R,kx.AbstractSublevel=H;const K=function(Ae){if(Ae[v]!=="open")throw new r("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})},Q=function(Ae){if(Ae[M])throw new r("Database status is locked",{code:"LEVEL_STATUS_LOCKED"})},J=function(Ae){return Object.keys(Ae.supports.encodings).filter(ne=>!!Ae.supports.encodings[ne])},ie=function(Ae){return Ae.close()},ce=function(Ae){if(Ae instanceof Error||Object.prototype.toString.call(Ae)==="[object Error]")return Ae;const he=`Promise rejection reason must be an Error, received ${Ae===null?"null":typeof Ae}`;return new TypeError(he)};class ge extends r{constructor(ne){super("Database failed to open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:ne})}}class be extends r{constructor(ne){super("Database failed to close",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:ne})}}return kx}var $3;function R5(){return $3||($3=1,bu.AbstractLevel=N3().AbstractLevel,bu.AbstractSublevel=N3().AbstractSublevel,bu.AbstractIterator=Bf().AbstractIterator,bu.AbstractKeyIterator=Bf().AbstractKeyIterator,bu.AbstractValueIterator=Bf().AbstractValueIterator,bu.AbstractChainedBatch=$5().AbstractChainedBatch),bu}var MI={},LI,R3;function O5(){return R3||(R3=1,LI=function(e){const t=e.gte!==void 0?e.gte:e.gt!==void 0?e.gt:void 0,r=e.lte!==void 0?e.lte:e.lt!==void 0?e.lt:void 0,s=e.gte===void 0,i=e.lte===void 0;return t!==void 0&&r!==void 0?IDBKeyRange.bound(t,r,s,i):t!==void 0?IDBKeyRange.lowerBound(t,s):r!==void 0?IDBKeyRange.upperBound(r,i):null}),LI}var BI,O3;function D5(){if(O3)return BI;O3=1;const n=new TextEncoder;return BI=function(e){return e===void 0||e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):n.encode(e)},BI}var D3;function GEe(){if(D3)return MI;D3=1;const{AbstractIterator:n}=R5(),e=O5(),t=D5(),r=Symbol("cache"),s=Symbol("finished"),i=Symbol("options"),o=Symbol("currentOptions"),a=Symbol("position"),l=Symbol("location"),u=Symbol("first"),f={};class h extends n{constructor(m,w,x){super(m,x),this[r]=[],this[s]=this.limit===0,this[i]=x,this[o]={...x},this[a]=void 0,this[l]=w,this[u]=!0}async _nextv(m,w){if(this[u]=!1,this[s])return[];if(this[r].length>0)return m=Math.min(m,this[r].length),this[r].splice(0,m);this[a]!==void 0&&(this[i].reverse?(this[o].lt=this[a],this[o].lte=void 0):(this[o].gt=this[a],this[o].gte=void 0));let x;try{x=e(this[o])}catch{return this[s]=!0,[]}const b=this.db.db.transaction([this[l]],"readonly"),C=b.objectStore(this[l]),$=[],k=new Promise(function(N,_){b.onabort=()=>{_(b.error||new Error("aborted by user"))},b.oncomplete=()=>{N($)}});if(this[i].reverse){const N=!this[i].values&&C.openKeyCursor?"openKeyCursor":"openCursor";C[N](x,"prev").onsuccess=_=>{const U=_.target.result;if(U){const{key:O,value:L}=U;this[a]=O,$.push([this[i].keys&&O!==void 0?t(O):void 0,this[i].values&&L!==void 0?t(L):void 0]),$.length<m?U.continue():p(b)}else this[s]=!0}}else{let N,_;const U=()=>{if(N===void 0||_===void 0)return;const O=Math.max(N.length,_.length);O===0||m===1/0?this[s]=!0:this[a]=N[O-1],$.length=O;for(let L=0;L<O;L++){const T=N[L],I=_[L];$[L]=[this[i].keys?t(T):void 0,this[i].values?t(I):void 0]}p(b)};this[i].keys||m<1/0?C.getAllKeys(x,m<1/0?m:void 0).onsuccess=O=>{N=O.target.result,U()}:(N=[],U()),this[i].values?C.getAll(x,m<1/0?m:void 0).onsuccess=O=>{_=O.target.result,U()}:(_=[],U())}return k}async _next(){if(this[r].length>0)return this[r].shift();if(!this[s]){let m=Math.min(100,this.limit-this.count);return this[u]&&(this[u]=!1,m=1),this[r]=await this._nextv(m,f),this[r].shift()}}async _all(m){this[u]=!1;const w=this[r].splice(0,this[r].length),x=this.limit-this.count-w.length;if(x<=0)return w;let b=await this._nextv(x,f);return w.length>0&&(b=w.concat(b)),b}_seek(m,w){this[u]=!0,this[r]=[],this[s]=!1,this[a]=void 0,this[o]={...this[i]};let x;try{x=e(this[i])}catch{this[s]=!0;return}x!==null&&!x.includes(m)?this[s]=!0:this[i].reverse?this[o].lte=m:this[o].gte=m}}MI.Iterator=h;function p(g){typeof g.commit=="function"&&g.commit()}return MI}var zI,_3;function HEe(){return _3||(_3=1,zI=async function(e,t,r,s){if(s.limit===0)return;const i=e.db.transaction([t],"readwrite"),o=i.objectStore(t);let a=0;const l=new Promise(function(h,p){i.oncomplete=h,i.onabort=function(){p(i.error||new Error("aborted by user"))}}),u=o.openKeyCursor?"openKeyCursor":"openCursor",f=s.reverse?"prev":"next";return o[u](r,f).onsuccess=function(h){const p=h.target.result;p&&(o.delete(p.key).onsuccess=function(){(s.limit<=0||++a<s.limit)&&p.continue()})},l}),zI}var P3;function jEe(){if(P3)return bI;P3=1;const{AbstractLevel:n}=R5(),{Iterator:e}=GEe(),t=D5(),r=HEe(),s=O5(),i="level-js-",o=Symbol("idb"),a=Symbol("namePrefix"),l=Symbol("location"),u=Symbol("version"),f=Symbol("store"),h=Symbol("onComplete");class p extends n{constructor(m,w){const{prefix:x,version:b,...C}=w||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},C),typeof m!="string"||m==="")throw new TypeError("The first argument 'location' must be a non-empty string");this[l]=m,this[a]=x??i,this[u]=parseInt(b||1,10),this[o]=null}get location(){return this[l]}get namePrefix(){return this[a]}get version(){return this[u]}get db(){return this[o]}get type(){return"browser-level"}async _open(m){const w=indexedDB.open(this[a]+this[l],this[u]);return w.onupgradeneeded=x=>{const b=x.target.result;b.objectStoreNames.contains(this[l])||b.createObjectStore(this[l])},new Promise((x,b)=>{w.onerror=function(){b(w.error||new Error("unknown error"))},w.onsuccess=()=>{this[o]=w.result,x()}})}[f](m){return this[o].transaction([this[l]],m).objectStore(this[l])}[h](m){const w=m.transaction;return new Promise(function(x,b){w.onabort=function(){b(w.error||new Error("aborted by user"))},w.oncomplete=function(){x(m.result)}})}async _get(m,w){const b=this[f]("readonly").get(m),C=await this[h](b);return t(C)}async _getMany(m,w){const x=this[f]("readonly"),b=m.values(),C=Math.min(16,m.length),$=new Array(C),k=new Array(m.length);let N=0,_=!1;const U=async function(){try{for(const O of b){if(_)break;const L=N++,T=x.get(O);await new Promise(function(I,v){T.onsuccess=()=>{k[L]=t(T.result),I()},T.onerror=A=>{A.stopPropagation(),v(T.error)}})}}catch(O){throw _=!0,O}};for(let O=0;O<C;O++)$[O]=U();return await Promise.allSettled($),k}async _del(m,w){const b=this[f]("readwrite").delete(m);return this[h](b)}async _put(m,w,x){const C=this[f]("readwrite").put(w,m);return this[h](C)}_iterator(m){return new e(this,this[l],m)}async _batch(m,w){const x=this[f]("readwrite"),b=x.transaction;let C=0,$;const k=new Promise(function(_,U){b.onabort=function(){U($||b.error||new Error("aborted by user"))},b.oncomplete=_});function N(){const _=m[C++],U=_.key;let O;try{O=_.type==="del"?x.delete(U):x.put(_.value,U)}catch(L){$=L,b.abort();return}C<m.length?O.onsuccess=N:typeof b.commit=="function"&&b.commit()}return N(),k}async _clear(m){let w;try{w=s(m)}catch{return}if(m.limit>=0)return r(this,this[l],w,m);const x=this[f]("readwrite"),b=w?x.delete(w):x.clear();return this[h](b)}async _close(){this[o].close()}}return p.destroy=async function(g,m){m==null&&(m=i);const w=indexedDB.deleteDatabase(m+g);return new Promise(function(x,b){w.onsuccess=x,w.onerror=b})},bI.BrowserLevel=p,bI}var KEe=jEe();let UI;const qEe=[{title:"1970s",languages:[{name:"C",year:1972}]},{title:"1980s",languages:[{name:"C++",year:1983},{name:"Perl",year:1987}]},{title:"1990s",languages:[{name:"Haskell",year:1990},{name:"Python",year:1991},{name:"Java",year:1995},{name:"Javascript",year:1995},{name:"PHP",year:1995},{name:"Ruby",year:1995}]},{title:"2000s",languages:[{name:"C#",year:2e3},{name:"Scala",year:2003},{name:"Clojure",year:2007},{name:"Go",year:2009}]},{title:"2010s",languages:[{name:"Elm",year:2012}]}];function XEe(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function QEe(n){const e=XEe(n.trim());if(e==="")return[];const t=new RegExp("^"+e,"i");return qEe.map(r=>({title:r.title,languages:r.languages.filter(s=>t.test(s.name))})).filter(r=>r.languages.length>0)}function YEe(n){return n.name}function JEe(n){return Be.jsx("span",{children:n.name})}function ZEe(n){return Be.jsx("strong",{children:n.title})}function e2e(n){return n.languages}class t2e extends fo.Component{constructor(t){super();Se(this,"onChange",(t,{newValue:r})=>{clearInterval(UI),document.getElementsByClassName("react-autosuggest__suggestions-container--open").length>0&&(document.getElementById("react-autowhatever-1").style.left="0px !important"),UI=setTimeout(async()=>{let s=r.split(" ").map((f,h)=>{if(Ma[f]&&h<5)return Ma[f];if(h<5)return null});if(s.length<=5)for(let f=0;s.length<5;f++)s.push(null);const i=Im(s,[1,5]),o=Array.from(this.state.model.predict(i).dataSync()),a=await Cm.iterator().all();console.log(a);const l=[];a.map((f,h)=>{console.log(M3(f[1].vector,o)),l.push({cosine:M3(f[1].vector,o),image:f})});const u=t.orderBy(l,["cosine"],["desc"]).filter(f=>f.cosine>.9);console.log(u),this.props.setImages(u)},700),r.length==0&&(this.props.setImages([]),clearInterval(UI)),console.log(r),this.setState({value:r})});Se(this,"onSuggestionsFetchRequested",({value:t})=>{this.setState({suggestions:QEe(t)})});Se(this,"onSuggestionsClearRequested",()=>{this.setState({suggestions:[],images:[]})});this.state={value:"",cols:t.cols,model:t.model,suggestions:[],images:[]}}render(){const{value:t,suggestions:r}=this.state,s={placeholder:"search",value:t,onChange:this.onChange};return Be.jsx(TEe,{multiSection:!0,suggestions:r,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:YEe,renderSuggestion:JEe,renderSectionTitle:ZEe,getSectionSuggestions:e2e,inputProps:s})}}const n2e=["JPG","PNG","GIF"];function r2e(n){const[e,t]=Pe.useState(null),r=s=>{if(console.log(s),s){const i=new FileReader;i.readAsDataURL(s),i.addEventListener("load",function(){console.log(this.result),n.setImage(this.result)})}t(s)};return Be.jsx(gEe,{handleChange:r,name:"file",types:n2e})}const _5=["The cat sat on the porch","The dog ran in the park","The bird sang in the tree","The bat screeched in the night"],Ma={};_5.map(n=>n.split(" ")).map(n=>{n.map(e=>{!Ma[e.toLowerCase()]&&Ma[e.toLowerCase()]!=0&&(Ma[e.toLowerCase()]=Object.entries(Ma).length)})});const om=_5.map(n=>n.split(" ")).map(n=>n.map(e=>Ma[e.toLowerCase()])),P5=[],i$=[],s2e=Object.entries(Ma).length+1,i2e=10,s1=2;for(let n=0;n<om.length;n++)for(let e=0;e<om[n].length-s1;e++)P5.push(om[n].filter((t,r)=>{if(r!=s1+e)return om[n].filter((s,i)=>{if(i!=i+1+s1+1)return[t+s]})})),i$.push(om[n]);const o2e=Nf(P5),a2e=Nf(i$),l2e=(n,e)=>{let t=0;for(let r=0;r<n.length;r++)t+=n[r]*e[r];return t},F3=n=>{let e=0;for(let t of n)e+=t*t;return Math.sqrt(e)},M3=(n,e)=>l2e(n,e)/(F3(n)*F3(e));let Cm;function u2e(){const[n,e]=Pe.useState(null),[t,r]=Pe.useState(0),[s,i]=Pe.useState(null),[o,a]=Pe.useState(!0),[l,u]=Pe.useState(null),[f,h]=Pe.useState([]);Pe.useEffect(()=>{n&&(Cm=new KEe.BrowserLevel(n,{valueEncoding:"json"}))},[n]);const p=async()=>{if(typeof window.ethereum<"u")try{let O=function(D){return sIe.patp(D)};const L=await window.ethereum.request({method:"eth_requestAccounts"});console.log("Connected account:",L[0]);const T=new Xke("https://nodes.sequence.app/mainnet"),I="0x223c067f8cf28ae173ee5cafea60ca44c335fecb",v=["function getOwner(uint32 point) view returns (address)","function getOwnedPoints(address owner) view returns (uint32[])"],M=await new Dd(I,v,T).getOwnedPoints(L[0]);if(M!=""){console.log(`Urbit IDs associated with ${M}:`);const D=O(Number(M));console.log(`Urbit ID for point ${M}: ${D}`),e(D)}else alert("No Urbit ID associated with this address")}catch(O){console.error("Error connecting to MetaMask:",O)}else console.error("MetaMask is not installed")},g=(O,L)=>{console.log(L),r(L)},[m,w]=Pe.useState([]),[x,b]=Pe.useState([]),[C,$]=Pe.useState(null);Pe.useEffect(()=>{setTimeout(async()=>{if(n){const O=await Cm.iterator().all();b(O.map(L=>Be.jsx("div",{style:{width:"280px",height:"280px",border:"1px solid lightgrey",margin:"20px",padding:"0px"},children:Be.jsx("img",{style:{objectFit:"cover",padding:"0px",maxWidth:"280px",maxHeight:"280px"},src:L[1].image})})))}},0)},[f,t]),Pe.useEffect(()=>{setTimeout(async()=>{if(localStorage.getItem("tensorflowjs_models/my-model-1/info")){const O=await eZ("localstorage://my-model-1");u(O),a(!1)}else{console.log("fitting model"),a(!0);const O=rZ();O.add(CZ({inputDim:s2e,outputDim:i2e,inputLength:2*s1+1})),O.add(SZ()),O.add(vZ({units:i$[0].length,activation:"softmax"})),O.compile({optimizer:"adam",loss:"categoricalCrossentropy",metrics:["accuracy"]}),await O.fit(o2e,a2e,{epochs:100}),await O.save("localstorage://my-model-1"),a(!1)}},0)},[l,o]),Pe.useEffect(()=>{},[x]);const k=O=>{console.log(O.target.value),$(O.target.value)},N=async()=>{console.log(C),console.log(s);const O=await Cm.iterator().all();console.log(O);const L=l;let T=C.split(" ").map((v,A)=>{if(Ma[v]&&A<5)return Ma[v];if(A<5)return null});if(console.log(T),T=T.filter(function(v){return v!==void 0}),T.length<=5)for(let v=0;T.length<5;v++)T.push(null);console.log(T);const I=Im(T,[1,5]);Cm.put(O.length,{image:s,metadata:C,vector:Array.from(L.predict(I).dataSync())})},[_,U]=Pe.useState([]);return Pe.useEffect(()=>{U(f.map(O=>(console.log(O),Be.jsx("div",{style:{width:"280px",height:"280px",border:"1px solid lightgrey",margin:"20px",padding:"0px"},children:Be.jsx("img",{style:{objectFit:"cover",padding:"0px",maxWidth:"280px",maxHeight:"280px"},src:O.image[1].image})}))))},[f]),Be.jsx(Be.Fragment,{children:n?o?Be.jsx(Be.Fragment,{children:"loading..."}):Be.jsxs(Be.Fragment,{children:[Be.jsx("br",{}),Be.jsx(Jg,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:Be.jsxs(mbe,{value:t,onChange:g,"aria-label":"disabled tabs example",children:[Be.jsx(Fk,{label:"U p l o a d",style:{outline:"none",fontFamily:"Avenir"}}),Be.jsx(Fk,{label:"B r o w s e",style:{outline:"none",fontFamily:"Avenir"}}),Be.jsx(Fk,{label:"S e a r c h",style:{outline:"none",fontFamily:"Avenir"}})]})}),Be.jsx("br",{}),Be.jsx("br",{}),t==2?Be.jsxs(Be.Fragment,{children:[Be.jsx(Jg,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:Be.jsx(t2e,{setImages:h,model:l,cols:m,setCols:w})}),Be.jsx("br",{}),Be.jsx("br",{}),Be.jsx(Jg,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:Be.jsx("div",{className:"container",children:_})})]}):t==0?Be.jsx(Be.Fragment,{children:Be.jsxs(Jg,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Be.jsxs(fx,{container:!0,spacing:1,columns:12,children:[Be.jsx(fx,{size:12,style:{},children:Be.jsx("textarea",{onChange:k,placeholder:"metadata / filename",style:{width:"400px",height:"60px"}})}),Be.jsx("br",{}),Be.jsx(fx,{size:12,style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"auto"},children:Be.jsx(r2e,{setImage:i})}),Be.jsx("br",{}),Be.jsx(fx,{size:12,style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"auto"},children:Be.jsx("button",{onClick:N,children:"save"})})]}),Be.jsx("br",{})]})}):Be.jsx(Be.Fragment,{children:Be.jsx(Jg,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:Be.jsx("div",{className:"container",children:x})})})]}):Be.jsx("button",{onClick:p,children:"L1 Urbit sign-in"})})}w8.createRoot(document.getElementById("root")).render(Be.jsx(Pe.StrictMode,{children:Be.jsx(u2e,{})}));
